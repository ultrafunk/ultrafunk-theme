{
  "version": 3,
  "sources": ["../src/shared/debuglogger.js", "../src/shared/settings/settings.js", "../src/shared/settings/validate-settings.js", "../src/shared/storage.js", "../src/shared/session-data.js", "../src/playback/gallery/crossfade.js", "../src/playback/mediaplayers.js", "../src/shared/utils.js", "../src/shared/snackbar.js", "../src/shared/element-click.js", "../src/playback/gallery/single-track-fetch.js", "../src/shared/element-toggle.js", "../src/playback/playback-events.js", "../src/playback/element-wrappers.js", "../src/playback/playback-controls.js", "../src/playback/list/list-track-templates.js", "../src/playback/list/list-tracks-rest.js", "../src/playback/list/list-controls.js", "../src/shared/modal-templates.js", "../src/shared/modal.js", "../src/playback/list/up-next-modal.js", "../src/playback/shared-gallery-list.js", "../src/playback/footer-toggles.js"],
  "sourcesContent": ["//\r\n// Debug logging helper classes\r\n//\r\n// https://ultrafunk.com\r\n//\r\n\r\n\r\nconst DEBUG = false;\r\n\r\n\r\n/*************************************************************************************************/\r\n\r\n\r\nlet executionStart = 0;\r\nlet executionStop  = 0;\r\n\r\n\r\n// ************************************************************************************************\r\n// DebugLog parent and child classes\r\n// ************************************************************************************************\r\n\r\nclass DebugLog\r\n{\r\n  constructor(moduleName = 'unknown')\r\n  {\r\n    this.moduleName = padString(moduleName.toUpperCase(), 20, '.');\r\n  }\r\n  \r\n  isDebug()   { return DEBUG;                               }\r\n  warn(data)  { console.warn(`${this.moduleName}:`,  data); }\r\n  error(data) { console.error(`${this.moduleName}:`, data); }\r\n}\r\n\r\nclass DevBuild extends DebugLog\r\n{\r\n  log(data)\r\n  {\r\n    console.log(`${this.moduleName}:`, data);\r\n  }\r\n\r\n  logEventLog(eventLog, eventSource, eventType)\r\n  {\r\n    const entries = [];\r\n    \r\n    for (let i = 0; i < eventLog.length; i++)\r\n    {\r\n      const data = {\r\n        eventSource: this.getKeyForValue(eventSource, eventLog[i].eventSource),\r\n        eventType:   this.getKeyForValue(eventType, eventLog[i].eventType),\r\n        uId:         eventLog[i].uId,\r\n        timeStamp:   eventLog[i].timeStamp,\r\n      };\r\n\r\n      entries.push(data);\r\n    }\r\n    \r\n    this.log(entries);\r\n  }\r\n\r\n  getKeyForValue(object, value)\r\n  {\r\n    return Object.keys(object).find(key => (object[key] === value));\r\n  }\r\n}\r\n\r\nclass ProdBuild extends DebugLog\r\n{\r\n  log()            {}\r\n  logEventLog()    {}\r\n  getKeyForValue() {}\r\n}\r\n\r\n\r\n// ************************************************************************************************\r\n// DebugLog class support functions\r\n// ************************************************************************************************\r\n\r\nexport function newInstance(moduleName)\r\n{\r\n  return ((DEBUG === true)\r\n           ? new DevBuild(moduleName)\r\n           : new ProdBuild(moduleName));\r\n}\r\n\r\nfunction padString(string, maxLength, padChar)\r\n{\r\n  return ((string.length > maxLength)\r\n           ? string.slice(0, maxLength)\r\n           : string.padEnd(maxLength, padChar));\r\n}\r\n\r\nexport function logErrorOnServer(errorCategory, errorData)\r\n{\r\n  const eventAction = errorData.mediaUrl + ' | ' + errorData.mediaTitle;\r\n  \r\n  console.warn(`logErrorOnServer(): ${errorCategory} - ${eventAction}`);\r\n  \r\n  gtag('event', eventAction, // eslint-disable-line no-undef\r\n  {\r\n    event_category: errorCategory,\r\n    event_label:    'Ultrafunk Client Error',\r\n  });\r\n}\r\n\r\nexport function measureStartupExecutionTime()\r\n{\r\n  executionStart = performance.now();\r\n}\r\n\r\nconst logCss = `\r\n  background-color: rgb(40, 80, 160);\r\n  padding: 2px 4px`;\r\n\r\nexport function logStartupExecutionTime()\r\n{\r\n  executionStop = performance.now();\r\n  console.log(`%cultrafunk.com startup JavaScript execution time: ${(Math.round((executionStop - executionStart) * 100) / 100)} ms.`, logCss);\r\n}\r\n", "//\r\n// Schemas and default objects for settings data\r\n//\r\n// https://ultrafunk.com\r\n//\r\n\r\n\r\nconst INTEGER = 1;\r\nconst BOOLEAN = 2;\r\nconst STRING  = 3;\r\n\r\nexport {\r\n  INTEGER as TYPE_INTEGER,\r\n  BOOLEAN as TYPE_BOOLEAN,\r\n  STRING  as TYPE_STRING,\r\n};\r\n\r\nexport const PREF_PLAYER = {\r\n  NONE:    0,\r\n  GALLERY: 1,\r\n  LIST:    2,\r\n};\r\n\r\n\r\n// ************************************************************************************************\r\n// Ultrafunk (user) settings:     Playback, List, Gallery, Mobile and Site\r\n// Ultrafunk (internal) settings: Tips and Banners\r\n// ************************************************************************************************\r\n\r\nconst galleryPerPageValues       = [...Array(22).keys()].map(i => i + 3);\r\nconst galleryPerPageValueStrings = [...Array(22).keys()].map(i => `${i + 3}`);\r\n\r\nexport const settingsSchema = {\r\n  version: { description: '', type: INTEGER, values: [1, 999999], default: 18, valueStrings: [] },\r\n  playback: {\r\n    preferredPlayer:      { description: 'Preferred Player',                type: INTEGER, values: [1, 2],               default: 2,     valueStrings: ['Gallery', 'List'] },\r\n    keyboardShortcuts:    { description: 'Keyboard Shortcuts',              type: BOOLEAN, values: [true, false],        default: true,  valueStrings: ['ON', 'OFF'] },\r\n    masterVolume:         { description: 'Master Volume',                   type: INTEGER, values: [0, 25, 50, 75, 100], default: 100,   valueStrings: ['0%', '25%', '50%', '75%', '100%'] },\r\n    masterMute:           { description: 'Master Mute',                     type: BOOLEAN, values: [true, false],        default: false, valueStrings: ['ON', 'OFF'] },\r\n    autoplay:             { description: 'Autoplay next track',             type: BOOLEAN, values: [true, false],        default: true,  valueStrings: ['ON', 'OFF'] },\r\n    autoExitFullscreen:   { description: 'Exit Fullscreen on next track',   type: BOOLEAN, values: [true, false],        default: true,  valueStrings: ['ON', 'OFF'] },\r\n    timeRemainingWarning: { description: 'Track Time Remaining Warning',    type: BOOLEAN, values: [true, false],        default: true,  valueStrings: ['ON', 'OFF'] },\r\n    timeRemainingSeconds: { description: 'Time Remaining Warning Seconds',  type: INTEGER, values: [30, 60, 90, 120],    default: 60,    valueStrings: ['30 sec', '60 sec', '90 sec', '120 sec'] },\r\n    autoExitFsOnWarning:  { description: 'Exit Fullscreen on Time Warning', type: BOOLEAN, values: [true, false],        default: true,  valueStrings: ['ON', 'OFF'] },\r\n  },\r\n  list: {\r\n    moveTrackOnPlayNext: { description: 'Move Track on Play as Next',        type: BOOLEAN, values: [true, false], default: true, valueStrings: ['ON', 'OFF'] },\r\n    showUpNextModal:     { description: 'Show Up Next Modal',                type: BOOLEAN, values: [true, false], default: true, valueStrings: ['ON', 'OFF'] },\r\n    showLoadMoreTracks:  { description: 'Show \"Load More Tracks...\" prompt', type: BOOLEAN, values: [true, false], default: true, valueStrings: ['ON', 'OFF'] },\r\n  },\r\n  gallery: {\r\n    layout:                  { description: 'Track Layout',                         type: STRING,  values: ['1-column', '2-column', '3-column'],    default: '3-column', valueStrings: ['1 Column', '2 Column', '3 / 4 Column'] },\r\n    fetchNextSingleTrack:    { description: 'Play single tracks without page load', type: BOOLEAN, values: [true, false],           default: true,  valueStrings: ['ON', 'OFF'] },\r\n    tracksPerPage:           { description: 'Tracks Per Page: Search & Shuffle',    type: INTEGER, values: galleryPerPageValues,    default: 12,    valueStrings: galleryPerPageValueStrings },\r\n    autoCrossfade:           { description: 'Auto Crossfade to next track',         type: BOOLEAN, values: [true, false],           default: false, valueStrings: ['ON', 'OFF'] },\r\n    autoCrossfadeLength:     { description: 'Auto Crossfade Length',                type: INTEGER, values: [5, 10, 15, 20, 25, 30], default: 20,    valueStrings: ['5 sec', '10 sec', '15 sec', '20 sec', '25 sec', '30 sec'] },\r\n    autoCrossfadeCurve:      { description: 'Auto Crossfade Curve',                 type: INTEGER, values: [1, 2],                  default: 2,     valueStrings: ['Equal Power', 'Linear'] },\r\n    autoScroll:              { description: 'Autoscroll to next track',             type: BOOLEAN, values: [true, false],           default: true,  valueStrings: ['ON', 'OFF'] },\r\n    animateNowPlayingIcon:   { description: 'Animate Now Playing Track Icon',       type: BOOLEAN, values: [true, false],           default: true,  valueStrings: ['ON', 'OFF'] },\r\n    trackCrossfadeDefPreset: { description: 'Track Crossfade Def. Preset',          type: INTEGER, values: [0, 1, 2, 3, 4, 5],      default: 1,     valueStrings: ['10 sec EqPow (1)', '20 sec EqPow (2)', '30 sec EqPow (3)', '10 sec Linear (4)', '20 sec Linear (5)', '30 sec Linear (6)'] },\r\n  },\r\n  mobile: {\r\n    keepScreenOn:        { description: 'Keep Screen On when playing', type: BOOLEAN, values: [true, false], default: false, valueStrings: ['ON', 'OFF'] },\r\n    showTrackThumbnail:  { description: 'Show Track Thumbnail',        type: BOOLEAN, values: [true, false], default: true,  valueStrings: ['ON', 'OFF'] },\r\n    showTrackTimes:      { description: 'Show Track Times',            type: BOOLEAN, values: [true, false], default: true,  valueStrings: ['ON', 'OFF'] },\r\n    showPrevTrackButton: { description: 'Show Previous Track button',  type: BOOLEAN, values: [true, false], default: true,  valueStrings: ['ON', 'OFF'] },\r\n  },\r\n  site: {\r\n    keyboardShortcuts:   { description: 'Keyboard Shortcuts',                    type: BOOLEAN, values: [true, false],                        default: true,   valueStrings: ['ON', 'OFF'] },\r\n    theme:               { description: 'Theme',                                 type: STRING,  values: ['light', 'dark', 'auto'],            default: 'auto', valueStrings: ['Light', 'Dark', 'Auto / System'] },\r\n    smoothScrolling:     { description: 'Use Smooth Scrolling (where possible)', type: BOOLEAN, values: [true, false],                        default: true,   valueStrings: ['ON', 'OFF'] },\r\n    modalOverlayOpacity: { description: 'Modal overlay opacity',                 type: INTEGER, values: [10, 20, 30, 40, 50, 60, 70, 80, 90], default: 60,     valueStrings: ['10%', '20%', '30%', '40%', '50%', '60%', '70%', '80%', '90%'] },\r\n  },\r\n  experimental: {\r\n    fetchNextSingleTrack: { description: '<b>Gallery Player</b><br>Play single tracks without page reload', type: BOOLEAN, values: [true, false], default: false, valueStrings: ['ON', 'OFF'] },\r\n  },\r\n  tips: {\r\n    showTrackDetailsHint:          { description: '', type: BOOLEAN, values: [true, false], default: true,  valueStrings: [] },\r\n    showUpNextModalHint:           { description: '', type: BOOLEAN, values: [true, false], default: true,  valueStrings: [] },\r\n    showGalleryTrackThumbnailHint: { description: '', type: BOOLEAN, values: [true, false], default: true,  valueStrings: [] },\r\n    showListTrackThumbnailHint:    { description: '', type: BOOLEAN, values: [true, false], default: true,  valueStrings: [] },\r\n    showTrackTimerHint:            { description: '', type: BOOLEAN, values: [true, false], default: true,  valueStrings: [] },\r\n  },\r\n  banners: {\r\n    showFrontpageIntro: { description: '', type: BOOLEAN, values: [true, false], default: true, valueStrings: [] },\r\n    showPremiumIntro:   { description: '', type: BOOLEAN, values: [true, false], default: true, valueStrings: [] },\r\n    showPromoIntro:     { description: '', type: BOOLEAN, values: [true, false], default: true, valueStrings: [] },\r\n  }\r\n};\r\n\r\nexport const defaultSettings = {\r\n  version: settingsSchema.version.default,\r\n  playback: {\r\n    preferredPlayer:      settingsSchema.playback.preferredPlayer.default,\r\n    keyboardShortcuts:    settingsSchema.playback.keyboardShortcuts.default,\r\n    masterVolume:         settingsSchema.playback.masterVolume.default,\r\n    masterMute:           settingsSchema.playback.masterMute.default,\r\n    autoplay:             settingsSchema.playback.autoplay.default,\r\n    autoExitFullscreen:   settingsSchema.playback.autoExitFullscreen.default,\r\n    timeRemainingWarning: settingsSchema.playback.timeRemainingWarning.default,\r\n    timeRemainingSeconds: settingsSchema.playback.timeRemainingSeconds.default,\r\n    autoExitFsOnWarning:  settingsSchema.playback.autoExitFsOnWarning.default,\r\n  },\r\n  list: {\r\n    moveTrackOnPlayNext: settingsSchema.list.moveTrackOnPlayNext.default,\r\n    showUpNextModal:     settingsSchema.list.showUpNextModal.default,\r\n    showLoadMoreTracks:  settingsSchema.list.showLoadMoreTracks.default,\r\n  },\r\n  gallery: {\r\n    layout:                  settingsSchema.gallery.layout.default,\r\n    fetchNextSingleTrack:    settingsSchema.gallery.fetchNextSingleTrack.default,\r\n    tracksPerPage:           settingsSchema.gallery.tracksPerPage.default,\r\n    autoCrossfade:           settingsSchema.gallery.autoCrossfade.default,\r\n    autoCrossfadeLength:     settingsSchema.gallery.autoCrossfadeLength.default,\r\n    autoCrossfadeCurve:      settingsSchema.gallery.autoCrossfadeCurve.default,\r\n    autoScroll:              settingsSchema.gallery.autoScroll.default,\r\n    animateNowPlayingIcon:   settingsSchema.gallery.animateNowPlayingIcon.default,\r\n    trackCrossfadeDefPreset: settingsSchema.gallery.trackCrossfadeDefPreset.default,\r\n  },\r\n  mobile: {\r\n    keepScreenOn:        settingsSchema.mobile.keepScreenOn.default,\r\n    showTrackThumbnail:  settingsSchema.mobile.showTrackThumbnail.default,\r\n    showTrackTimes:      settingsSchema.mobile.showTrackTimes.default,\r\n    showPrevTrackButton: settingsSchema.mobile.showPrevTrackButton.default,\r\n  },\r\n  site: {\r\n    keyboardShortcuts:   settingsSchema.site.keyboardShortcuts.default,\r\n    theme:               settingsSchema.site.theme.default,\r\n    smoothScrolling:     settingsSchema.site.smoothScrolling.default,\r\n    modalOverlayOpacity: settingsSchema.site.modalOverlayOpacity.default,\r\n  },\r\n  experimental: {\r\n    fetchNextSingleTrack: settingsSchema.experimental.fetchNextSingleTrack.default,\r\n  },\r\n  tips: {\r\n    showTrackDetailsHint:          settingsSchema.tips.showTrackDetailsHint.default,\r\n    showUpNextModalHint:           settingsSchema.tips.showUpNextModalHint.default,\r\n    showGalleryTrackThumbnailHint: settingsSchema.tips.showGalleryTrackThumbnailHint.default,\r\n    showListTrackThumbnailHint:    settingsSchema.tips.showListTrackThumbnailHint.default,\r\n    showTrackTimerHint:            settingsSchema.tips.showTrackTimerHint.default,\r\n  },\r\n  banners: {\r\n    showFrontpageIntro: settingsSchema.banners.showFrontpageIntro.default,\r\n    showPremiumIntro:   settingsSchema.banners.showPremiumIntro.default,\r\n    showPromoIntro:     settingsSchema.banners.showPromoIntro.default,\r\n  },\r\n};\r\n\r\n\r\n// ************************************************************************************************\r\n// Presets\r\n// ************************************************************************************************\r\n\r\nexport const presetsSchema = {\r\n  version: { description: '', type: INTEGER, values: [1, 999999], default: 1, valueStrings: [] },\r\n  crossfade: [\r\n    {\r\n      name:   { description: 'Preset 1',         type: STRING,  values: [5, 50],                 default: '10 sec EqPow', valueStrings: [] },\r\n      length: { description: 'Crossfade Length', type: INTEGER, values: [5, 10, 15, 20, 25, 30], default: 10,             valueStrings: ['5 sec', '10 sec', '15 sec', '20 sec', '25 sec', '30 sec'] },\r\n      curve:  { description: 'Crossfade Curve',  type: INTEGER, values: [1, 2],                  default: 1,              valueStrings: ['Equal Power', 'Linear'] },\r\n    },\r\n    {\r\n      name:   { description: 'Preset 2',         type: STRING,  values: [5, 50],                 default: '20 sec EqPow', valueStrings: [] },\r\n      length: { description: 'Crossfade Length', type: INTEGER, values: [5, 10, 15, 20, 25, 30], default: 20,             valueStrings: ['5 sec', '10 sec', '15 sec', '20 sec', '25 sec', '30 sec'] },\r\n      curve:  { description: 'Crossfade Curve',  type: INTEGER, values: [1, 2],                  default: 1,              valueStrings: ['Equal Power', 'Linear'] },\r\n    },\r\n    {\r\n      name:   { description: 'Preset 3',         type: STRING,  values: [5, 50],                 default: '30 sec EqPow', valueStrings: [] },\r\n      length: { description: 'Crossfade Length', type: INTEGER, values: [5, 10, 15, 20, 25, 30], default: 30,             valueStrings: ['5 sec', '10 sec', '15 sec', '20 sec', '25 sec', '30 sec'] },\r\n      curve:  { description: 'Crossfade Curve',  type: INTEGER, values: [1, 2],                  default: 1,              valueStrings: ['Equal Power', 'Linear'] },\r\n    },\r\n    {\r\n      name:   { description: 'Preset 4',         type: STRING,  values: [5, 50],                 default: '10 sec Linear', valueStrings: [] },\r\n      length: { description: 'Crossfade Length', type: INTEGER, values: [5, 10, 15, 20, 25, 30], default: 10,              valueStrings: ['5 sec', '10 sec', '15 sec', '20 sec', '25 sec', '30 sec'] },\r\n      curve:  { description: 'Crossfade Curve',  type: INTEGER, values: [1, 2],                  default: 2,               valueStrings: ['Equal Power', 'Linear'] },\r\n    },\r\n    {\r\n      name:   { description: 'Preset 5',         type: STRING,  values: [5, 50],                 default: '20 sec Linear', valueStrings: [] },\r\n      length: { description: 'Crossfade Length', type: INTEGER, values: [5, 10, 15, 20, 25, 30], default: 20,              valueStrings: ['5 sec', '10 sec', '15 sec', '20 sec', '25 sec', '30 sec'] },\r\n      curve:  { description: 'Crossfade Curve',  type: INTEGER, values: [1, 2],                  default: 2,               valueStrings: ['Equal Power', 'Linear'] },\r\n    },\r\n    {\r\n      name:   { description: 'Preset 6',         type: STRING,  values: [5, 50],                 default: '30 sec Linear', valueStrings: [] },\r\n      length: { description: 'Crossfade Length', type: INTEGER, values: [5, 10, 15, 20, 25, 30], default: 30,              valueStrings: ['5 sec', '10 sec', '15 sec', '20 sec', '25 sec', '30 sec'] },\r\n      curve:  { description: 'Crossfade Curve',  type: INTEGER, values: [1, 2],                  default: 2,               valueStrings: ['Equal Power', 'Linear'] },\r\n    },\r\n  ],\r\n};\r\n\r\nexport const presetList = {\r\n  version: presetsSchema.version.default,\r\n  crossfade: [\r\n    {\r\n      name:   presetsSchema.crossfade[0].name.default,\r\n      length: presetsSchema.crossfade[0].length.default,\r\n      curve:  presetsSchema.crossfade[0].curve.default,\r\n    },\r\n    {\r\n      name:   presetsSchema.crossfade[1].name.default,\r\n      length: presetsSchema.crossfade[1].length.default,\r\n      curve:  presetsSchema.crossfade[1].curve.default,\r\n    },\r\n    {\r\n      name:   presetsSchema.crossfade[2].name.default,\r\n      length: presetsSchema.crossfade[2].length.default,\r\n      curve:  presetsSchema.crossfade[2].curve.default,\r\n    },\r\n    {\r\n      name:   presetsSchema.crossfade[3].name.default,\r\n      length: presetsSchema.crossfade[3].length.default,\r\n      curve:  presetsSchema.crossfade[3].curve.default,\r\n    },\r\n    {\r\n      name:   presetsSchema.crossfade[4].name.default,\r\n      length: presetsSchema.crossfade[4].length.default,\r\n      curve:  presetsSchema.crossfade[4].curve.default,\r\n    },\r\n    {\r\n      name:   presetsSchema.crossfade[5].name.default,\r\n      length: presetsSchema.crossfade[5].length.default,\r\n      curve:  presetsSchema.crossfade[5].curve.default,\r\n    },\r\n  ],\r\n};\r\n", "//\r\n// Validation for playback and site settings\r\n//\r\n// https://ultrafunk.com\r\n//\r\n\r\n\r\nimport * as debugLogger from '../debuglogger.js';\r\n\r\nimport {\r\n  TYPE_INTEGER,\r\n  TYPE_BOOLEAN,\r\n  TYPE_STRING\r\n} from './settings.js';\r\n\r\n\r\n/*************************************************************************************************/\r\n\r\n\r\nconst debug = debugLogger.newInstance('validate-settings');\r\n\r\n\r\n// ************************************************************************************************\r\n// Validation\r\n// ************************************************************************************************\r\n\r\nexport function validateSettings(settings, schema)\r\n{\r\n  let invalidCount = 0;\r\n\r\n  validateRecursive(settings, schema);\r\n\r\n  return invalidCount;\r\n\r\n  function validateRecursive(settingsObject, schemaObject)\r\n  {\r\n    for (const key in settingsObject)\r\n    {\r\n      if (settingsObject && schemaObject && (typeof settingsObject[key] === 'object') && (typeof schemaObject[key] === 'object'))\r\n      {\r\n        validateRecursive(settingsObject[key], schemaObject[key]);\r\n      }\r\n      else\r\n      {\r\n        if (schemaObject[key] !== undefined)\r\n        {\r\n          if (isEntryInvalid(settingsObject, schemaObject[key], settingsObject[key], key))\r\n            invalidCount++;\r\n        }\r\n        else\r\n        {\r\n          throw(`'${key}' ${(typeof settingsObject[key] === 'object') ? 'object' : 'property'} is not in schema`);\r\n        }\r\n      }\r\n    }\r\n  }\r\n}\r\n\r\nfunction isEntryInvalid(settings, schemaEntry, settingValue, entryKey)\r\n{\r\n  switch (schemaEntry.type)\r\n  {\r\n    case TYPE_INTEGER:\r\n      if ((Number.isInteger(settingValue) === false) || (settingValue < schemaEntry.values[0]) || (settingValue > schemaEntry.values[schemaEntry.values.length - 1]))\r\n      {\r\n        debug.warn(`validate() - '${entryKey}' has invalid value: ${settingValue} ('${entryKey}' is type: INTEGER - min: ${schemaEntry.values[0]} - max: ${schemaEntry.values[schemaEntry.values.length - 1]}) -- setting default value: ${schemaEntry.default}`);\r\n        settings[entryKey] = schemaEntry.default;\r\n        return true;\r\n      }\r\n      break;\r\n    \r\n    case TYPE_BOOLEAN:\r\n      if ((settingValue !== true) && (settingValue !== false))\r\n      {\r\n        debug.warn(`validate() - '${entryKey}' has invalid value: ${settingValue} ('${entryKey}' is type: BOOLEAN) -- setting default value: ${schemaEntry.default}`);\r\n        settings[entryKey] = schemaEntry.default;\r\n        return true;\r\n      }\r\n      break;\r\n\r\n    case TYPE_STRING:\r\n      if (typeof settingValue !== 'string')\r\n      {\r\n        debug.warn(`validate() - '${entryKey}' has invalid value: ${settingValue} ('${entryKey}' is type: STRING) -- setting default value: ${schemaEntry.default}`);\r\n        settings[entryKey] = schemaEntry.default;\r\n        return true;\r\n      }\r\n      break;\r\n\r\n    default:\r\n      debug.warn(`validate() - '${entryKey}' has unknown type: ${schemaEntry.type}`);\r\n      return true;\r\n  }\r\n}\r\n\r\n", "//\r\n// Set and get storage values\r\n// Read, write and parse storage JSON data\r\n//\r\n// https://ultrafunk.com\r\n//\r\n\r\n\r\nimport * as debugLogger   from './debuglogger.js';\r\nimport { settingsSchema } from  './settings/settings.js';\r\n\r\nimport {\r\n  validateSettings as validateSettingsDeep\r\n} from './settings/validate-settings.js';\r\n\r\n\r\n/*************************************************************************************************/\r\n\r\n\r\nconst debug     = debugLogger.newInstance('storage');\r\nconst observers = {};\r\n\r\nexport const KEY = {\r\n//sessionStorage keys\r\n  UF_AUTOPLAY:         'uf_autoplay',\r\n  UF_TERMLIST_CACHE:   'uf_termlist_cache',\r\n  UF_TERMLIST_STATE:   'uf_termlist_state',\r\n//localStorage keys\r\n  UF_SETTINGS:         'uf_settings',\r\n  UF_PRESET_LIST:      'uf_preset_list',\r\n  UF_SITE_THEME:       'uf_site_theme',\r\n  UF_GALLERY_LAYOUT:   'uf_gallery_layout',\r\n//document.cookie keys\r\n//Merge all cookies into one cookie (UF_USER_SETTINGS) as a JSON encoded string\r\n//UF_USER_SETTINGS:    'uf_user_settings',\r\n//UF_LIST_PER_PAGE:    'uf_list_per_page',\r\n  UF_GALLERY_PER_PAGE: 'uf_gallery_per_page',\r\n  UF_PREFERRED_PLAYER: 'uf_preferred_player',\r\n  UF_SHUFFLE_UID:      'uf_shuffle_uid',\r\n//Temp document.cookie keys\r\n  UF_RESHUFFLE:        'uf_reshuffle',\r\n};\r\n\r\nconst DEPRECATED_KEYS = {\r\n//localStorage keys\r\n  UF_PLAYBACK_SETTINGS: 'UF_PLAYBACK_SETTINGS',\r\n  UF_SITE_SETTINGS:     'UF_SITE_SETTINGS',\r\n  UF_SITE_THEME:        'UF_SITE_THEME',\r\n  UF_TRACK_LAYOUT:      'UF_TRACK_LAYOUT',\r\n  UF_GALLERY_LAYOUT:    'UF_GALLERY_LAYOUT',\r\n//document.cookie keys\r\n  UF_TRACKS_PER_PAGE:  'UF_TRACKS_PER_PAGE',\r\n  UF_PREFERRED_PLAYER: 'UF_PREFERRED_PLAYER',\r\n  UF_SHUFFLE_UID:      'UF_SHUFFLE_UID',\r\n  UF_RESHUFFLE:        'UF_RESHUFFLE',\r\n  ULTRAFUNK_UID:       'ultrafunk_uid',\r\n};\r\n\r\nexport const YEAR_IN_SECONDS = (60 * 60 * 24 * 365);\r\n\r\n\r\n// ************************************************************************************************\r\n// https://developer.mozilla.org/en-US/docs/Web/API/Web_Storage_API/Using_the_Web_Storage_API\r\n// ************************************************************************************************\r\n\r\nexport function isAvailable(storageType)\r\n{\r\n  let storage;\r\n\r\n  try\r\n  {\r\n    storage = window[storageType];\r\n    const test = '__storage_test__';\r\n    storage.setItem(test, test);\r\n    storage.removeItem(test);\r\n    return true;\r\n  }\r\n  catch(exception)\r\n  {\r\n    return exception instanceof DOMException && (\r\n      // everything except Firefox\r\n      exception.code === 22 ||\r\n      // Firefox\r\n      exception.code === 1014 ||\r\n      // test name field too, because code might not be present\r\n      // everything except Firefox\r\n      exception.name === 'QuotaExceededError' ||\r\n      // Firefox\r\n      exception.name === 'NS_ERROR_DOM_QUOTA_REACHED') &&\r\n      // acknowledge QuotaExceededError only if there's something already stored\r\n      (storage && storage.length !== 0);\r\n  }\r\n}\r\n\r\n\r\n// ************************************************************************************************\r\n// Set and delete cookie key => value pairs\r\n// ************************************************************************************************\r\n\r\nexport function setCookie(keyName, keyValue = '', maxAge = YEAR_IN_SECONDS, path = '/')\r\n{\r\n  document.cookie = `${keyName}=${keyValue}; Max-Age=${maxAge}; Path=${path}; Secure; SameSite=Strict`;\r\n}\r\n\r\nexport function deleteCookie(keyName, path = '/')\r\n{\r\n  document.cookie = `${keyName}=; expires=Thu, 01 Jan 1970 00:00:00 UTC; path=${path}`;\r\n}\r\n\r\n\r\n// ************************************************************************************************\r\n// get / set local storage key => value pairs\r\n// ************************************************************************************************\r\n\r\nexport function getValue(keyName, defaultValue = null, setDefault = false)\r\n{\r\n  const keyValue = localStorage.getItem(keyName);\r\n\r\n  if (keyValue === null)\r\n  {\r\n    if (setDefault && (defaultValue !== null))\r\n      setValue(keyName, defaultValue);\r\n\r\n    return defaultValue;\r\n  }\r\n  \r\n  return keyValue;\r\n}\r\n\r\nexport function setValue(keyName, keyValue)\r\n{\r\n  try\r\n  {\r\n    localStorage.setItem(keyName, keyValue);\r\n  }\r\n  catch(exception)\r\n  {\r\n    debug.error(exception);\r\n  }\r\n}\r\n\r\n\r\n// ************************************************************************************************\r\n// Read (parse) and write (stringify) JSON data from local storage\r\n// ************************************************************************************************\r\n\r\nexport function readJson(keyName, defaultValue = null, setDefault = false)\r\n{\r\n  debug.log(`readJson(): ${keyName} - ${defaultValue} - ${setDefault}`);\r\n  \r\n  const keyValue     = localStorage.getItem(keyName);\r\n  let parsedKeyValue = null;\r\n\r\n  if (keyValue === null)\r\n  {\r\n    if (setDefault && (defaultValue !== null))\r\n      writeJson(keyName, defaultValue);\r\n\r\n    return defaultValue;\r\n  }\r\n  else\r\n  {\r\n    try\r\n    {\r\n      parsedKeyValue = JSON.parse(keyValue);\r\n    }\r\n    catch(exception)\r\n    {\r\n      debug.error(exception);\r\n\r\n      // ToDo: Return error state to specify (for the user) that default settings are used??\r\n      if (defaultValue !== null)\r\n        parsedKeyValue = defaultValue;\r\n    }\r\n  }\r\n\r\n  return parsedKeyValue;\r\n}\r\n\r\nexport function writeJson(keyName, keyData)\r\n{\r\n  debug.log(`writeJson(): ${keyName} - ${keyData}`);\r\n\r\n  try\r\n  {\r\n    localStorage.setItem(keyName, JSON.stringify(keyData));\r\n  }\r\n  catch(exception)\r\n  {\r\n    debug.error(exception);\r\n  }\r\n}\r\n\r\n\r\n// ************************************************************************************************\r\n// Recursive merge and cleanup for settings objects on new version\r\n// ************************************************************************************************\r\n\r\nfunction mergeSettings(oldSettings, newSettings, settingsKey)\r\n{\r\n  debug.log(`mergeSettings(): Merging ${settingsKey} from version ${oldSettings.version} to version ${newSettings.version}`);\r\n\r\n  const mergedSettings = { version: newSettings.version };\r\n\r\n  mergeDeep(oldSettings, newSettings, mergedSettings);\r\n  cleanDeep(mergedSettings, newSettings);\r\n\r\n  return mergedSettings;\r\n}\r\n\r\nfunction mergeDeep(oldSettings, newSettings, destination)\r\n{\r\n  for (const key in newSettings)\r\n  {\r\n    if (typeof newSettings[key] === 'object')\r\n    {\r\n      if (oldSettings && (typeof oldSettings[key] === 'object'))\r\n      {\r\n        debug.log(`mergeDeep() - Merging: ${key}`);\r\n        destination[key] = { ...newSettings[key], ...oldSettings[key] };\r\n        mergeDeep(oldSettings[key], newSettings[key], destination[key]);\r\n      }\r\n      else\r\n      {\r\n        debug.log(`mergeDeep() - Copying: ${key}`);\r\n        destination[key] = { ...newSettings[key] };\r\n        mergeDeep({}, newSettings[key], destination[key]);\r\n      }\r\n    }\r\n  }\r\n}\r\n\r\n//\r\n// Delete all orphaned Settings properties / objects that are no longer in use after merge\r\n//\r\nfunction cleanDeep(mergedSettings, newSettings)\r\n{\r\n  for (const key in mergedSettings)\r\n  {\r\n    if ((key in newSettings) === false)\r\n    {\r\n      debug.log(`cleanDeep() - Deleting: ${key} (${(typeof mergedSettings[key] === 'object') ? 'object' : 'property'})`);\r\n      delete mergedSettings[key];\r\n    }\r\n    \r\n    if (typeof mergedSettings[key] === 'object')\r\n      cleanDeep(mergedSettings[key], newSettings[key]);\r\n  }\r\n}\r\n\r\n//\r\n// Clean up (delete) any localStorage or cookie-data that is no longer in use...\r\n//\r\nfunction cleanupOldData(skipOldDataCheck = false)\r\n{\r\n  debug.log(`cleanupOldData(): ${skipOldDataCheck ? 'Skipping' : 'Performing quick'} old data cleanup check...`);\r\n\r\n  if (skipOldDataCheck || (localStorage.getItem(DEPRECATED_KEYS.UF_SITE_THEME) !== null))\r\n  {\r\n    debug.log(`cleanupOldData(): Running cleanup...`);\r\n\r\n    localStorage.removeItem(DEPRECATED_KEYS.UF_PLAYBACK_SETTINGS);\r\n    localStorage.removeItem(DEPRECATED_KEYS.UF_SITE_SETTINGS);\r\n    localStorage.removeItem(DEPRECATED_KEYS.UF_SITE_THEME);\r\n    localStorage.removeItem(DEPRECATED_KEYS.UF_TRACK_LAYOUT);\r\n    localStorage.removeItem(DEPRECATED_KEYS.UF_GALLERY_LAYOUT);\r\n    deleteCookie(DEPRECATED_KEYS.UF_TRACKS_PER_PAGE);\r\n    deleteCookie(DEPRECATED_KEYS.UF_PREFERRED_PLAYER);\r\n    deleteCookie(DEPRECATED_KEYS.UF_SHUFFLE_UID);\r\n    deleteCookie(DEPRECATED_KEYS.UF_RESHUFFLE);\r\n    deleteCookie(DEPRECATED_KEYS.ULTRAFUNK_UID);\r\n  }\r\n}\r\n\r\nfunction validateSettings(settingsKey, settingsObject, defaultSettings)\r\n{\r\n  try\r\n  {\r\n    const invalidSettingsCount = validateSettingsDeep(settingsObject, settingsSchema);\r\n\r\n    if (invalidSettingsCount > 0)\r\n      writeJson(settingsKey, settingsObject);\r\n  }\r\n  catch(exception)\r\n  {\r\n    debug.error(`validateSettings() exception: ${exception} -- using default settings`);\r\n\r\n    writeJson(settingsKey, defaultSettings);\r\n\r\n    return defaultSettings;\r\n  }\r\n\r\n  return settingsObject;\r\n}\r\n\r\n\r\n// ************************************************************************************************\r\n// Read and write settings proxy\r\n// ************************************************************************************************\r\n\r\nexport function readWriteSettingsProxy(settingsKey, defaultSettings = null, setDefault = false)\r\n{\r\n  const parsedJson = readJson(settingsKey, defaultSettings, setDefault);\r\n\r\n  if ((parsedJson !== null) && (defaultSettings !== null) && (parsedJson.version !== undefined))\r\n  {\r\n    let settingsObject = parsedJson;\r\n    \r\n    // If version is new, perform settings merge, cleanup and deletion of deprecated settings\r\n    if (parsedJson.version < defaultSettings.version)\r\n    {\r\n      debug.log(parsedJson);\r\n\r\n      settingsObject = mergeSettings(parsedJson, defaultSettings, settingsKey);\r\n      writeJson(settingsKey, settingsObject);\r\n\r\n      // Always run cleanup on version update\r\n      cleanupOldData(true);\r\n\r\n      debug.log(settingsObject);\r\n    }\r\n    else\r\n    {\r\n      // Only run cleanup if old data is detected (much quicker)\r\n      cleanupOldData(false);\r\n    }\r\n\r\n    return onSettingsChange(settingsKey, validateSettings(settingsKey, settingsObject, defaultSettings));\r\n  }\r\n\r\n  if (defaultSettings !== null)\r\n  {\r\n    debug.warn(`readWriteSettingsProxy() - Failed for: ${settingsKey} -- using default settings`);\r\n\r\n    writeJson(settingsKey, defaultSettings);\r\n\r\n    return onSettingsChange(settingsKey, defaultSettings);\r\n  }\r\n\r\n  debug.error(`readWriteSettingsProxy() - Fatal error for: ${settingsKey} -- unable to read settings!`);\r\n\r\n  return null;\r\n}\r\n\r\n\r\n// ************************************************************************************************\r\n// Proxy traps (handlers) for settings get and set\r\n// ************************************************************************************************\r\n\r\nconst onSettingsChange = (settingsKey, settingsObject) =>\r\n{ \r\n  const handler =\r\n  {\r\n    get(target, property, receiver)\r\n    {\r\n    //debug.log(`onSettingsChange(): Get property: ${property}`);\r\n      \r\n      if (property in target)\r\n      {      \r\n        const value = Reflect.get(target, property, receiver);\r\n        \r\n        if (typeof value === 'object')\r\n          return new Proxy(value, handler);\r\n\r\n        return value;\r\n      }\r\n\r\n      debug.error(`onSettingsChange(): Get unknown property: ${property}`);\r\n    },\r\n    \r\n    set(target, property, newValue, receiver)\r\n    {\r\n    //debug.log(`onSettingsChange(): Set property: ${property}`);\r\n\r\n      if (property in target)\r\n      {\r\n        const oldValue = Reflect.get(target, property, receiver);\r\n\r\n        // Only update and write data if it has changed\r\n        if (newValue !== oldValue)\r\n        {\r\n          Reflect.set(target, property, newValue);\r\n          writeJson(settingsKey, settingsObject);\r\n          callSettingsObservers(property, oldValue, newValue);\r\n        }\r\n\r\n        return true;\r\n      }\r\n\r\n      debug.error(`onSettingsChange(): Set unknown property: ${property}`);\r\n      return true;\r\n    },\r\n  };\r\n\r\n  return new Proxy(settingsObject, handler);\r\n};\r\n\r\n\r\n// ************************************************************************************************\r\n// Add and call settings observers on property changes\r\n// ************************************************************************************************\r\n\r\nexport function addSettingsObserver(property, observer)\r\n{\r\n  debug.log(`addSettingsObserver() for property: ${property}`);\r\n\r\n  if ((property in observers) === false)\r\n    observers[property] = [];\r\n\r\n  observers[property].push(observer);\r\n}\r\n\r\nfunction callSettingsObservers(property, oldValue, newValue)\r\n{\r\n  if (property in observers)\r\n  {\r\n    debug.log(`callSettingsObserver() for property: ${property} - oldValue: ${oldValue} - newValue: ${newValue}`);\r\n    observers[property].forEach(observer => observer(oldValue, newValue));\r\n  }\r\n}\r\n", "//\r\n// Get session data\r\n//\r\n// https://ultrafunk.com\r\n//\r\n\r\n\r\nimport * as debugLogger    from './debuglogger.js';\r\nimport { defaultSettings } from './settings/settings.js';\r\n\r\nimport {\r\n  KEY,\r\n  readWriteSettingsProxy,\r\n} from './storage.js';\r\n\r\n\r\n/*************************************************************************************************/\r\n\r\n\r\nconst debug = debugLogger.newInstance('session-data');\r\n\r\nexport let response = {};\r\nexport let settings = {};\r\n\r\n\r\n// ************************************************************************************************\r\n//\r\n// ************************************************************************************************\r\n\r\nexport function getSessionData()\r\n{\r\n  debug.log('UF_RESPONSE_DATA');\r\n  response = UF_RESPONSE_DATA; // eslint-disable-line no-undef\r\n  debug.log(response);\r\n\r\n  readSettings();\r\n}\r\n\r\nexport function readSettings()\r\n{\r\n  settings = readWriteSettingsProxy(KEY.UF_SETTINGS, defaultSettings, true);\r\n  debug.log(settings);\r\n}\r\n", "//\r\n// Track to track crossfade module\r\n//\r\n// https://ultrafunk.com\r\n//\r\n\r\n\r\nimport * as debugLogger from '../../shared/debuglogger.js';\r\nimport { settings }     from '../../shared/session-data.js';\r\n\r\n\r\n/*************************************************************************************************/\r\n\r\n\r\nconst debug = debugLogger.newInstance('crossfade');\r\n\r\nexport const VOLUME = {\r\n  MIN:   0,\r\n  MAX: 100,\r\n};\r\n\r\nconst TYPE = {\r\n  NONE:  0,\r\n  AUTO:  1,\r\n  TRACK: 2,\r\n};\r\n\r\nexport { TYPE as CROSSFADE_TYPE };\r\n\r\nconst CURVE = {\r\n  NONE:        0,\r\n  EQUAL_POWER: 1,\r\n  LINEAR:      2,\r\n};\r\n\r\nconst STATE = {\r\n  NONE:   0,\r\n  INIT:   1,\r\n  FADING: 2,\r\n};\r\n\r\nconst config = {\r\n  intervalEqPow:   33, // Milliseconds between each crossfade update event\r\n  intervalLinear: 100,\r\n};\r\n\r\n\r\n// ************************************************************************************************\r\n// Crossfade closure\r\n// ************************************************************************************************\r\n\r\nexport const crossfadeClosure = ((galleryPlayers) =>\r\n{\r\n  const players       = galleryPlayers;\r\n  let fadeState       = STATE.NONE;\r\n  let intervalId      = -1;\r\n  let fadeOutPlayer   = null;\r\n  let fadeInPlayer    = null;\r\n  let fadeLength      = 0;\r\n  let fadeStartVolume = 0;\r\n  let fadeType        = TYPE.NONE;\r\n  let fadePreset      = null;\r\n  let fadeStartTime   = 0;\r\n\r\n  return {\r\n    isFading() { return (fadeState !== STATE.NONE); },\r\n    init,\r\n    start,\r\n    stop,\r\n    mute,\r\n  };\r\n  \r\n  function init(crossfadeType, crossfadePreset, fadeInUid = null)\r\n  {\r\n    if ((fadeState === STATE.NONE) && (set(fadeInUid) === true))\r\n    {\r\n      debug.log(`init() - type: ${debug.getKeyForValue(TYPE, crossfadeType)} - fadeInUid: ${fadeInUid} - preset: ${crossfadePreset.length} sec ${debug.getKeyForValue(CURVE, crossfadePreset.curve)} (Name: ${crossfadePreset.name})`);\r\n  \r\n      fadeState       = STATE.INIT;\r\n      fadeStartVolume = settings.playback.masterVolume;\r\n      fadeType        = crossfadeType;\r\n      fadePreset      = crossfadePreset;\r\n      \r\n      fadeInPlayer.setVolume(0);\r\n  \r\n      if (fadeInUid === null)\r\n        players.nextTrack(true);\r\n      else\r\n        players.jumpToTrack(players.trackFromUid(fadeInUid), true, false);\r\n  \r\n      return {\r\n        fadeOutPlayer: players.indexMap.get(fadeOutPlayer.getUid()),\r\n        fadeInPlayer:  players.indexMap.get(fadeInPlayer.getUid())\r\n      };\r\n    }\r\n  \r\n    return null;\r\n  }\r\n  \r\n  function start()\r\n  {\r\n    if (fadeState === STATE.INIT)\r\n    {\r\n      fadeState = STATE.FADING;\r\n\r\n      fadeOutPlayer.getPosition((positionMilliseconds) =>\r\n      {\r\n        const updateInterval = (fadePreset.curve === CURVE.EQUAL_POWER) ? config.intervalEqPow : config.intervalLinear;\r\n        fadeStartTime        = ((positionMilliseconds + updateInterval) / 1000);\r\n        const timeRemaining  = fadeOutPlayer.getDuration() - fadeStartTime;\r\n        const fadeRemaining  = timeRemaining - (updateInterval / 1000);\r\n  \r\n        if (fadeType === TYPE.AUTO)\r\n          fadeLength = fadeRemaining;\r\n        else if (fadeType === TYPE.TRACK)\r\n          fadeLength = (timeRemaining > fadePreset.length) ? fadePreset.length : fadeRemaining;\r\n  \r\n        debug.log(`start() - fadeStartTime: ${fadeStartTime.toFixed(2)} sec - timeRemaining: ${timeRemaining.toFixed(2)} sec - fadeLength: ${fadeLength.toFixed(2)} sec - updateInterval: ${updateInterval} ms`);\r\n  \r\n        intervalId = setInterval((fadePreset.curve === CURVE.EQUAL_POWER) ? equalPowerFade : linearFade, updateInterval);\r\n      });\r\n    }\r\n  }\r\n  \r\n  function stop()\r\n  {\r\n    debug.log(`stop() - fadeState: ${debug.getKeyForValue(STATE, fadeState)}`);\r\n  \r\n    if (fadeState !== STATE.NONE)\r\n    {\r\n      if (intervalId !== -1)\r\n      {\r\n        clearInterval(intervalId);\r\n        intervalId = -1;\r\n      }\r\n  \r\n      if (fadeOutPlayer !== null)\r\n      {\r\n        fadeOutPlayer.pause();\r\n        fadeOutPlayer.seekTo(0);\r\n  \r\n        // ToDo: Temp fix for: This might POP on fade out end, check if there is a safer way to reset the volume\r\n        setTimeout(() =>\r\n        {\r\n          fadeOutPlayer.setVolume(settings.playback.masterVolume); // ToDo: fadeStartVolume is 0 because of setTimeout()\r\n          fadeOutPlayer = null;\r\n        },\r\n        200);\r\n      }\r\n    \r\n      if (fadeInPlayer !== null)\r\n        fadeInPlayer = null;\r\n    \r\n      fadeState       = STATE.NONE;\r\n      fadeLength      = 0;\r\n      fadeStartVolume = 0;\r\n      fadeType        = TYPE.NONE;\r\n      fadePreset      = null;\r\n      fadeStartTime   = 0;\r\n    }\r\n  }\r\n  \r\n  function mute(setMute)\r\n  {\r\n    if (fadeOutPlayer !== null)\r\n      fadeOutPlayer.mute(setMute);\r\n  }\r\n  \r\n  function set(fadeInUid)\r\n  {\r\n    fadeOutPlayer = players.current;\r\n    fadeInPlayer  = (fadeInUid === null) ? players.next : players.playerFromUid(fadeInUid);\r\n  \r\n    if (fadeOutPlayer.getIsPlayable() && fadeInPlayer.getIsPlayable())\r\n      return true;\r\n  \r\n    return false;\r\n  }\r\n  \r\n  //\r\n  // https://dsp.stackexchange.com/questions/14754/equal-power-crossfade\r\n  //\r\n  function equalPowerFade()\r\n  {\r\n    fadeOutPlayer.getPosition((positionMilliseconds) =>\r\n    {\r\n      // Clamp negative position values\r\n      const position     = ((positionMilliseconds / 1000) - fadeStartTime);\r\n      const fadePosition = (position >= 0) ? position : 0;\r\n  \r\n      // Clamp negative volume values\r\n      const volume     = fadeStartVolume - (fadeStartVolume * (fadePosition / fadeLength));\r\n      const fadeVolume = (volume >= VOLUME.MIN) ? volume : VOLUME.MIN;\r\n  \r\n      const fadeOutVolume = Math.round(Math.sqrt(fadeStartVolume * fadeVolume));\r\n      const fadeInVolume  = Math.round(Math.sqrt(fadeStartVolume * (fadeStartVolume - fadeVolume)));\r\n  \r\n      if ((fadePosition >= fadeLength) && (fadeVolume <= VOLUME.MIN) && (fadeInVolume >= fadeStartVolume))\r\n      {\r\n        fadeOutPlayer.setVolume(VOLUME.MIN);\r\n        fadeInPlayer.setVolume(fadeStartVolume);\r\n        stop();\r\n      }\r\n      else\r\n      {\r\n        fadeOutPlayer.setVolume(fadeOutVolume);\r\n        fadeInPlayer.setVolume(fadeInVolume);\r\n      }\r\n    });\r\n  }\r\n  \r\n  function linearFade()\r\n  {\r\n    fadeOutPlayer.getPosition((positionMilliseconds) =>\r\n    {\r\n      const fadePosition  = ((positionMilliseconds / 1000) - fadeStartTime);\r\n      const fadeInVolume  = Math.round(fadeStartVolume * (fadePosition / fadeLength));\r\n      const fadeOutVolume = fadeStartVolume - fadeInVolume;\r\n  \r\n      if ((fadePosition > fadeLength) && (fadeOutVolume < VOLUME.MIN) && (fadeInVolume > fadeStartVolume))\r\n      {\r\n        fadeOutPlayer.setVolume(VOLUME.MIN);\r\n        fadeInPlayer.setVolume(fadeStartVolume);\r\n        stop();\r\n      }\r\n      else\r\n      {\r\n        fadeOutPlayer.setVolume(fadeOutVolume);\r\n        fadeInPlayer.setVolume(fadeInVolume);\r\n      }\r\n    });\r\n  }\r\n});\r\n", "//\r\n// Embedded media player classes + playlist\r\n//\r\n// https://ultrafunk.com\r\n//\r\n\r\n\r\nimport * as debugLogger from '../shared/debuglogger.js';\r\nimport { VOLUME }       from './gallery/crossfade.js';\r\n\r\n\r\n/*************************************************************************************************/\r\n\r\n\r\nconst debug = debugLogger.newInstance('mediaplayers');\r\n\r\nexport const TRACK_TYPE = {\r\n  NONE:       0,\r\n  YOUTUBE:    1,\r\n  SOUNDCLOUD: 2,\r\n};\r\n\r\n\r\n// ************************************************************************************************\r\n// MediaPlayer parent class\r\n// ************************************************************************************************\r\n\r\nclass MediaPlayer\r\n{\r\n  constructor(trackId, iframeId, embeddedPlayer)\r\n  {\r\n    this.trackType      = TRACK_TYPE.NONE;\r\n    this.trackId        = trackId;\r\n    this.iframeId       = iframeId;\r\n    this.embeddedPlayer = embeddedPlayer;\r\n    this.isPlayable     = true;\r\n\r\n    this.duration = 0;\r\n    this.artist   = null;\r\n    this.title    = null;\r\n\r\n    this.thumbnailSrc       = null;\r\n    this.thumbnailClass     = 'type-default';\r\n    this.thumbnail          = new Image();\r\n    this.thumbnail.decoding = 'async';\r\n  }\r\n\r\n  // Abstract methods to be overriden in child class if needed\r\n  cueTrackById()  {}\r\n  playTrackById() {}\r\n  \r\n  getTrackType()        { return this.trackType;      }\r\n  getTrackId()          { return this.trackId;        }\r\n  getIframeId()         { return this.iframeId;       }\r\n  getUid()              { return this.iframeId;       }\r\n  getEmbeddedPlayer()   { return this.embeddedPlayer; }\r\n\r\n  getIsPlayable()           { return this.isPlayable;       }\r\n  setIsPlayable(isPlayable) { this.isPlayable = isPlayable; }\r\n\r\n  getDuration()         { return this.duration;     }\r\n  setDuration(duration) { this.duration = duration; }\r\n\r\n  getArtist()           { return this.artist;   }\r\n  setArtist(artist)     { this.artist = artist; }\r\n\r\n  getTitle()            { return this.title;  }\r\n  setTitle(title)       { this.title = title; }\r\n\r\n  getThumbnailSrc()     { return this.thumbnailSrc;   }\r\n  getThumbnailClass()   { return this.thumbnailClass; }\r\n\r\n  seekTo(position)      { this.embeddedPlayer.seekTo(position);  }\r\n  setVolume(volume)     { this.embeddedPlayer.setVolume(volume); }\r\n\r\n  setArtistTitle(artist, title)\r\n  {\r\n    this.artist = artist;\r\n    this.title  = title;\r\n  }\r\n\r\n  setThumbnail(thumbnail)\r\n  {\r\n    this.thumbnailSrc   = thumbnail.src;\r\n    this.thumbnailClass = thumbnail.class;\r\n    this.thumbnail.src  = thumbnail.src;\r\n  }\r\n}\r\n\r\n\r\n// ************************************************************************************************\r\n// YouTube child class\r\n// ************************************************************************************************\r\n\r\nexport class YouTube extends MediaPlayer\r\n{\r\n  constructor(trackId, iframeId, embeddedPlayer, videoId)\r\n  {\r\n    super(trackId, iframeId, embeddedPlayer);\r\n    this.trackType = TRACK_TYPE.YOUTUBE;\r\n    super.setThumbnail(getYouTubeImgUrl(videoId));\r\n  }\r\n\r\n  cueTrackById(id)  { this.embeddedPlayer.cueVideoById(id);  }\r\n  playTrackById(id) { this.embeddedPlayer.loadVideoById(id); }\r\n  pause()           { this.embeddedPlayer.pauseVideo();      }\r\n  stop()            { this.embeddedPlayer.stopVideo();       }\r\n\r\n  play(onErrorCallback)\r\n  {\r\n    if (this.isPlayable === true)\r\n      this.embeddedPlayer.playVideo();\r\n    else\r\n      onErrorCallback(this, this.embeddedPlayer.getVideoUrl());\r\n  }\r\n\r\n  getVolume(callback)\r\n  {\r\n    callback(this.embeddedPlayer.getVolume());\r\n  }\r\n\r\n  mute(setMute)\r\n  {\r\n    if (setMute)\r\n      this.embeddedPlayer.mute();\r\n    else\r\n      this.embeddedPlayer.unMute();\r\n  }\r\n\r\n  getPosition(callback)\r\n  {\r\n    callback((this.embeddedPlayer.getCurrentTime() * 1000), this.duration);\r\n  }\r\n}\r\n\r\n\r\n// ************************************************************************************************\r\n// SoundCloud child class\r\n// ************************************************************************************************\r\n\r\nexport class SoundCloud extends MediaPlayer\r\n{\r\n  constructor(trackId, iframeId, embeddedPlayer, iframeSrc)\r\n  {\r\n    super(trackId, iframeId, embeddedPlayer);\r\n    this.trackType = TRACK_TYPE.SOUNDCLOUD;\r\n    this.soundId   = this.getSoundId(iframeSrc);\r\n    this.volume    = VOLUME.MAX;\r\n    this.muted     = false;\r\n  }\r\n\r\n  getSoundId(iframeSrc)\r\n  {\r\n    if (iframeSrc)\r\n    {\r\n      const iframeSrcParts = new URL(decodeURIComponent(iframeSrc));\r\n      const trackUrl       = iframeSrcParts.searchParams.get('url');\r\n      \r\n      if (trackUrl !== null)\r\n      {\r\n        const trackUrlParts = trackUrl.split('/');\r\n        const tracksString  = 'tracks'.toUpperCase();\r\n  \r\n        for (let i = 0; i < trackUrlParts.length; i++)\r\n        {\r\n          if (trackUrlParts[i].toUpperCase() === tracksString)\r\n            return parseInt(trackUrlParts[i + 1]);\r\n        }\r\n      }\r\n    }\r\n    \r\n    debug.error(`MediaPlayer.SoundCloud.getSoundId() failed for: ${this.iframeId}`);\r\n\r\n    return null;\r\n  }\r\n\r\n  setThumbnail(trackThumbnailUrlElement)\r\n  {\r\n    this.embeddedPlayer.getCurrentSound(soundObject =>\r\n    {\r\n      super.setThumbnail(getSoundCloudImgUrl(soundObject));\r\n      trackThumbnailUrlElement?.setAttribute('data-track-thumbnail-url', this.getThumbnailSrc());\r\n    });\r\n  }\r\n\r\n  // Override parent getUid() because SoundCloud provides its own UID\r\n  getUid() { return this.soundId;         }\r\n  pause()  { this.embeddedPlayer.pause(); }\r\n  \r\n  play(onErrorCallback)\r\n  {\r\n    // playable is set to FALSE if the widget fires SC.Widget.Events.ERROR (track does not exist)\r\n    if (this.isPlayable === true)\r\n    {\r\n      this.embeddedPlayer.getCurrentSound(soundObject =>\r\n      {\r\n        if (soundObject.playable === true)\r\n          this.embeddedPlayer.play();\r\n        else\r\n          onErrorCallback(this, soundObject.permalink_url);\r\n      });\r\n    }\r\n    else\r\n    {\r\n      onErrorCallback(this, 'https://soundcloud.com');\r\n    }\r\n  }\r\n  \r\n  stop()\r\n  {\r\n    this.pause();\r\n    super.seekTo(0);\r\n  }\r\n\r\n  // Override parent because SoundCloud seekTo() needs milliseconds instead of just seconds\r\n  seekTo(positionSeconds)\r\n  {\r\n    super.seekTo(positionSeconds * 1000);\r\n  }\r\n  \r\n  getVolume(callback)\r\n  {\r\n    this.embeddedPlayer.getVolume(volume => callback(volume));\r\n  }\r\n\r\n  // Override parent setVolume() because we use it for mute() as well \r\n  setVolume(volume)\r\n  {\r\n    if (volume !== 0)\r\n      this.volume = volume;\r\n\r\n    if ((this.muted === false) || (volume === 0))\r\n      super.setVolume(volume);\r\n  }\r\n\r\n  mute(setMute)\r\n  {\r\n    this.muted = setMute ? true : false;\r\n\r\n    if (setMute)\r\n      this.setVolume(0);\r\n    else\r\n      this.setVolume(this.volume);\r\n  }\r\n\r\n  getPosition(callback)\r\n  {\r\n    this.embeddedPlayer.getPosition(positionMilliseconds => callback(positionMilliseconds, this.duration));\r\n  }\r\n}\r\n\r\n\r\n// ************************************************************************************************\r\n// Playlist child class\r\n// ************************************************************************************************\r\n\r\nexport class Playlist extends MediaPlayer\r\n{\r\n  constructor(embeddedPlayer)\r\n  {\r\n    super(null, null, embeddedPlayer);\r\n    this.trackType    = TRACK_TYPE.YOUTUBE;\r\n    this.numTracks    = 3;\r\n    this.currentTrack = 2;\r\n    this.playerState  = -1; // YT.PlayerState.UNSTARTED\r\n  }\r\n\r\n  get embedded()        { return this.embeddedPlayer; }\r\n  getNumTracks()        { return this.numTracks;      }\r\n  getCurrentTrack()     { return this.currentTrack;   }\r\n  setPlayerState(state) { this.playerState = state;   }\r\n\r\n  play(onErrorCallback)\r\n  {\r\n    //YT.PlayerState.CUED === 5\r\n    if ((this.playerState === 5) && (this.embeddedPlayer.getDuration() === 0))\r\n    {\r\n      onErrorCallback({ data: 'Unable to play track -- No YouTube API error given!' });\r\n      this.playerState = -1; // YT.PlayerState.UNSTARTED\r\n    }\r\n    else\r\n    {\r\n      this.embeddedPlayer.playVideo();\r\n    }\r\n  }\r\n\r\n  setThumbnail(videoId)\r\n  {\r\n    super.setThumbnail(getYouTubeImgUrl(videoId));\r\n  }\r\n\r\n  getTrackData()\r\n  {\r\n    return {\r\n      currentTrack: this.getCurrentTrack(),\r\n      numTracks:    this.getNumTracks(),\r\n      artist:       this.getArtist(),\r\n      title:        this.getTitle(),\r\n      duration:     this.getDuration(),\r\n      thumbnail:    { src: this.getThumbnailSrc(), class: this.getThumbnailClass() },\r\n    };\r\n  }\r\n}\r\n\r\n\r\n// ************************************************************************************************\r\n// MediaPlayer class support functions\r\n// ************************************************************************************************\r\n\r\n// Default / fallback track thumbnail object\r\nconst defThumbnailObj = { src: '/wp-content/themes/ultrafunk/inc/img/photo_filled_grey.png', class: 'type-default', uid: '' };\r\n\r\n// https://webapps.stackexchange.com/a/101153\r\nexport const youTubeVideoIdRegEx = /[0-9A-Za-z_-]{10}[048AEIMQUYcgkosw]/;\r\n\r\nexport function getYouTubeImgUrl(trackSourceUrl)\r\n{\r\n  const youTubeVideoId = trackSourceUrl.match(youTubeVideoIdRegEx);\r\n\r\n  if (youTubeVideoId !== null)\r\n    return { src: `https://img.youtube.com/vi/${youTubeVideoId[0]}/default.jpg`, class: 'type-youtube', uid: youTubeVideoId[0] };\r\n\r\n  return defThumbnailObj;\r\n}\r\n\r\nfunction getSoundCloudImgUrl(soundObject)\r\n{\r\n  const thumbnailSrc = (soundObject.artwork_url !== null)\r\n                         ? soundObject.artwork_url\r\n                         : soundObject.user.avatar_url;\r\n\r\n  if (thumbnailSrc)\r\n    return { src: thumbnailSrc, class: 'type-soundcloud', uid: '' };\r\n\r\n  return defThumbnailObj;\r\n}\r\n", "//\r\n// Shared utility functions\r\n//\r\n// https://ultrafunk.com\r\n//\r\n\r\n\r\nimport * as debugLogger from './debuglogger.js';\r\nimport { settings }     from './session-data.js';\r\nimport { PREF_PLAYER }  from './settings/settings.js';\r\nimport { showSnackbar } from './snackbar.js';\r\n\r\nimport {\r\n  TRACK_TYPE,\r\n  getYouTubeImgUrl,\r\n} from '../playback/mediaplayers.js';\r\n\r\n\r\n/*************************************************************************************************/\r\n\r\n\r\nconst debug = debugLogger.newInstance('utils');\r\n\r\nexport const SITE_URL = debug.isDebug() ? 'https://wordpress.ultrafunk.com'      : 'https://ultrafunk.com';\r\nconst SITE_URL_LIST   = debug.isDebug() ? 'https://wordpress.ultrafunk.com/list' : 'https://ultrafunk.com/list';\r\n\r\nconst validUrlRegEx = debug.isDebug()\r\n                        ? /^https:\\/\\/wordpress\\.ultrafunk\\.com[/?&=%A-Za-z0-9\\-_.~+]*$/\r\n                        : /^https:\\/\\/ultrafunk\\.com[/?&=%A-Za-z0-9\\-_.~+]*$/;\r\n\r\nconst DOMParserInstance = new DOMParser();\r\n\r\nexport const MATCH = {\r\n  SITE_MIN_WIDTH_WIDE:   1,\r\n  SITE_MAX_WIDTH:        2,\r\n  SITE_MAX_WIDTH_MOBILE: 3,\r\n};\r\n\r\nconst siteMinWidthWide   = window.matchMedia(`(min-width: ${getCssPropString('--site-min-width-wide')})`);\r\nconst siteMaxWidth       = window.matchMedia(`(max-width: ${getCssPropString('--site-max-width')})`);\r\nconst siteMaxWidthMobile = window.matchMedia(`(max-width: ${getCssPropString('--site-max-width-mobile')})`);\r\n\r\n\r\n// ************************************************************************************************\r\n// Misc. shared utility functions\r\n// ************************************************************************************************\r\n\r\nexport function addListener(selectors, type, listener)\r\n{\r\n  document.querySelector(selectors)?.addEventListener(type, listener);\r\n}\r\n\r\n// Plain JS function equivalent to jQuery(selectors).eventX();\r\n// Adds event listeners of 'type' to all matching selectors \r\nexport function addListenerAll(selectors, type, listener)\r\n{\r\n  const elementList = document.querySelectorAll(selectors);\r\n  elementList.forEach(element => element.addEventListener(type, listener));\r\n}\r\n\r\nexport function getCssPropString(prop, element = document.documentElement)\r\n{\r\n  let string = getComputedStyle(element).getPropertyValue(prop);\r\n\r\n  if (string.length !== 0)\r\n    string = string.replace(/'|\"/g, '').trim();\r\n  else\r\n    debug.error(`getCssPropString(${prop}): Returned CSS property string is empty`);\r\n\r\n  return string;\r\n}\r\n\r\nexport function getCssPropValue(prop, element = document.documentElement)\r\n{\r\n  const string = getCssPropString(prop, element);\r\n  let value    = NaN;\r\n\r\n  if (string.length !== 0)\r\n    value = parseInt(string);\r\n\r\n  if (isNaN(value))\r\n    debug.error(`getCssPropValue(${prop}): Returned CSS property value is NaN`);\r\n\r\n  return value;\r\n}\r\n\r\n// Match against live CSS media queries defined in style.css\r\nexport function matchesMedia(matchMedia)\r\n{\r\n  switch (matchMedia)\r\n  {\r\n    case MATCH.SITE_MIN_WIDTH_WIDE:\r\n      return siteMinWidthWide.matches;\r\n      \r\n    case MATCH.SITE_MAX_WIDTH:\r\n      return siteMaxWidth.matches;\r\n\r\n    case MATCH.SITE_MAX_WIDTH_MOBILE:\r\n      return siteMaxWidthMobile.matches;\r\n  }\r\n\r\n  return false;\r\n}\r\n\r\nexport function replaceClass(element, removeClass, addClass)\r\n{\r\n  element.classList.remove(removeClass);\r\n  element.classList.add(addClass);\r\n}\r\n\r\nexport function getTimeString(seconds, includeHours = false)\r\n{\r\n  if (Number.isInteger(seconds))\r\n  {\r\n    const timeString = new Date(seconds * 1000).toISOString();\r\n\r\n    return ((seconds > 3600) || includeHours)\r\n      ? timeString.slice(11, 19)\r\n      : timeString.slice(14, 19);\r\n  }\r\n  else\r\n  {\r\n    return includeHours ? '00:00:00' : '00:00';\r\n  }\r\n}\r\n\r\n\r\n// ************************************************************************************************\r\n// https://github.com/janl/mustache.js/blob/master/mustache.js#L59\r\n// ************************************************************************************************\r\n\r\nconst entityMap = {\r\n  '&': '&amp;',\r\n  '<': '&lt;',\r\n  '>': '&gt;',\r\n  '\"': '&quot;',\r\n  \"'\": '&#39;',\r\n  '`': '&#x60;',\r\n  '=': '&#x3D;',\r\n  '/': '&#x2F;',\r\n};\r\n\r\nexport function escHtml(string)\r\n{\r\n  return String(string).replace(/[&<>\"'`=/]/g, (s) => entityMap[s]);\r\n}\r\n\r\nexport function escAttribute(element, attribute)\r\n{\r\n  const value = element.getAttribute(attribute);\r\n\r\n  if (value !== null)\r\n    return escHtml(value);\r\n\r\n  return value;\r\n}\r\n\r\n//\r\n// ToDo: escHtml() + stripHtml()\r\n// Replace with DOMPurify or the HTML Sanitizer API: https://github.com/WICG/sanitizer-api\r\n// Enhance / fix with: https://developer.mozilla.org/en-US/docs/Web/API/Trusted_Types_API\r\n//                     https://github.com/w3c/webappsec-trusted-types\r\n//\r\nexport function stripHtml(string)\r\n{\r\n  const firstPass  = DOMParserInstance.parseFromString(string, 'text/html');\r\n  const secondPass = DOMParserInstance.parseFromString(firstPass.body.textContent, 'text/html');\r\n\r\n//debug.log(`stripHtml(DOMParser): ${secondPass.body.textContent}`);\r\n\r\n  return secondPass.body.textContent;\r\n}\r\n\r\nexport function stripAttribute(element, attribute)\r\n{\r\n  const value = element.getAttribute(attribute);\r\n\r\n  if (value !== null)\r\n    return stripHtml(value);\r\n  \r\n  return value;\r\n}\r\n\r\n\r\n// ************************************************************************************************\r\n// \r\n// ************************************************************************************************\r\n\r\nexport function navToUrl(destUrl)\r\n{\r\n  if (destUrl && (destUrl.match(validUrlRegEx) !== null))\r\n  {\r\n    debug.log(`navToUrl() - Valid destUrl: ${destUrl}`);\r\n    window.location.href = destUrl;\r\n  }\r\n  else if (destUrl !== null)\r\n  {\r\n    debug.error(`navToUrl() - Invalid destUrl: ${destUrl}`);\r\n    showSnackbar('Error navigating to URL!', 0, 'Reload', () => location.reload());\r\n  }\r\n}\r\n\r\nexport function getListPlayerUrl(destUrl)\r\n{\r\n  return destUrl.replace(SITE_URL, SITE_URL_LIST);\r\n}\r\n\r\nexport function getGalleryPlayerUrl(destUrl)\r\n{\r\n  return destUrl.replace(SITE_URL_LIST, SITE_URL);  \r\n}\r\n\r\nexport function getPrefPlayerUrl(destUrl)\r\n{\r\n  if (destUrl)\r\n  {\r\n    if (settings.playback.preferredPlayer === PREF_PLAYER.LIST)\r\n    {\r\n      if (destUrl.startsWith(SITE_URL_LIST) === false)\r\n        return getListPlayerUrl(destUrl);\r\n    }\r\n    else if (settings.playback.preferredPlayer === PREF_PLAYER.GALLERY)\r\n    {\r\n      if (destUrl.startsWith(SITE_URL_LIST) === true)\r\n        return getGalleryPlayerUrl(destUrl);\r\n    }\r\n  }\r\n\r\n  return destUrl;\r\n}\r\n\r\nexport function getThumbnailData(metaData)\r\n{\r\n  if (metaData.track_source_type === TRACK_TYPE.YOUTUBE)\r\n    return getYouTubeImgUrl(metaData.track_source_data);\r\n\r\n  return { src: '/wp-content/themes/ultrafunk/inc/img/sc_thumbnail_placeholder.png', class: 'type-soundcloud', uid: '' };\r\n}\r\n\r\n\r\n// ************************************************************************************************\r\n// \r\n// ************************************************************************************************\r\n\r\nexport const FETCH_ERROR_TYPE = {\r\n  UNKNOWN: 0,\r\n  NETWORK: 1,\r\n};\r\n\r\nexport async function fetchRest(endpoint, query, returnStatus = false, path = '/wp-json/wp/v2/')\r\n{\r\n  debug.log(`fetchRest(): ${path}${endpoint}?${query}`);\r\n\r\n  return fetch(`${path}${endpoint}?${query}`)\r\n  .then(async (response) => \r\n  {\r\n    if (!response.ok)\r\n    {\r\n      debug.warn(response);\r\n\r\n      if (returnStatus)\r\n        return { status: { code: response.status, details: await response.json() }};\r\n\r\n      return null;\r\n    }\r\n\r\n    if (returnStatus)\r\n      return { status: { code: response.status }, data: await response.json() };\r\n    \r\n    return response.json();\r\n  })\r\n  .catch(reason =>\r\n  {\r\n    debug.error(reason);\r\n\r\n    if (returnStatus)\r\n    {\r\n      const errorType = (reason instanceof TypeError) ? FETCH_ERROR_TYPE.NETWORK : FETCH_ERROR_TYPE.UNKNOWN;\r\n      return { status: { code: 0, type: errorType, message: reason.message }};\r\n    }\r\n\r\n    return null;\r\n  });\r\n}\r\n", "//\r\n// Snackbar UI module\r\n//\r\n// https://ultrafunk.com\r\n//\r\n\r\n\r\nimport * as debugLogger        from './debuglogger.js';\r\nimport { MATCH, matchesMedia } from './utils.js';\r\n\r\n\r\n/*************************************************************************************************/\r\n\r\n\r\nconst debug = debugLogger.newInstance('snackbar');\r\n\r\nconst m = {\r\n  snackbarId:    0,\r\n  actionClick:   null,\r\n  afterClose:    null,\r\n  showTimeoutId: -1,\r\n};\r\n\r\nconst config = { id: 'snackbar' };\r\n\r\nconst template = /*html*/ `\r\n  <div id=\"${config.id}\">\r\n    <div class=\"${config.id}-container\">\r\n      <div class=\"${config.id}-message\"></div>\r\n      <div class=\"${config.id}-action-text\"></div>\r\n      <div class=\"${config.id}-close-icon\"><span class=\"material-icons\" title=\"Dismiss\">close</span></div>\r\n    </div>\r\n  </div>\r\n`;\r\n\r\nconst elements = {\r\n  snackbar:   null,\r\n  actionText: null,\r\n  closeIcon:  null,\r\n};\r\n\r\n\r\n// ************************************************************************************************\r\n// \r\n// ************************************************************************************************\r\n\r\nexport function showSnackbar(\r\n  message,\r\n  timeout = 5,\r\n  actionText = null,\r\n  actionClickCallback = null,\r\n  afterCloseCallback = () => {}\r\n)\r\n{\r\n  debug.log(`showSnackbar(): ${message} (${timeout} sec.)`);\r\n\r\n  init();\r\n  reset(false);\r\n\r\n  elements.snackbar.querySelector(`.${config.id}-message`).innerHTML = message;\r\n  elements.snackbar.classList.add('show');\r\n  elements.actionText.style.display = 'none';\r\n  m.afterClose = afterCloseCallback;\r\n\r\n  if ((actionText !== null) && (actionClickCallback !== null))\r\n  {\r\n    m.actionClick = actionClickCallback;\r\n    elements.actionText.style.display = 'block';\r\n    elements.actionText.textContent   = actionText;\r\n    elements.actionText.addEventListener('click', actionTextClick);\r\n  }\r\n  else\r\n  {\r\n    // Fix edge case when actionText is hidden...\r\n    if (matchesMedia(MATCH.SITE_MAX_WIDTH_MOBILE))\r\n      elements.closeIcon.style.paddingLeft = '10px';\r\n    else\r\n      elements.closeIcon.style.paddingLeft = '20px';\r\n  }\r\n\r\n  if (timeout !== 0)\r\n    m.showTimeoutId = setTimeout(() => elements.snackbar.classList.add('hide'), (timeout * 1000));\r\n  \r\n  return ++m.snackbarId;\r\n}\r\n\r\nexport function dismissSnackbar(dismissId = 0)\r\n{\r\n  if (isShowing())\r\n  {\r\n    if ((m.snackbarId === 0) || (m.snackbarId === dismissId))\r\n      elements.snackbar.classList.add('hide');\r\n  }\r\n}\r\n\r\n\r\n// ************************************************************************************************\r\n// \r\n// ************************************************************************************************\r\n\r\nfunction init()\r\n{\r\n  if (elements.snackbar === null)\r\n  {\r\n    document.body.insertAdjacentHTML('beforeend', template);\r\n\r\n    elements.snackbar   = document.getElementById(config.id);\r\n    elements.actionText = elements.snackbar.querySelector(`.${config.id}-action-text`);\r\n    elements.closeIcon  = elements.snackbar.querySelector(`.${config.id}-close-icon`);\r\n    \r\n    elements.snackbar.addEventListener('animationend', () =>\r\n    {\r\n      if (elements.snackbar.classList.contains('hide'))\r\n      {\r\n        reset(true);\r\n        m.afterClose();\r\n      }\r\n    });\r\n\r\n    elements.closeIcon.addEventListener('click', () =>\r\n    {\r\n      reset(true);\r\n      m.afterClose();\r\n    });\r\n  }\r\n}\r\n\r\nfunction actionTextClick()\r\n{\r\n  reset(true);\r\n  m.actionClick();\r\n}\r\n\r\nfunction isShowing()\r\n{\r\n  return ((elements.snackbar !== null)               &&\r\n          (elements.snackbar.classList.length === 1) &&\r\n           elements.snackbar.classList.contains('show'));\r\n}\r\n\r\nfunction reset(hideSnackbar = false)\r\n{\r\n  if (m.showTimeoutId !== -1)\r\n  {\r\n    clearTimeout(m.showTimeoutId);\r\n    m.showTimeoutId = -1;\r\n  }\r\n\r\n  if (elements.actionText !== null)\r\n    elements.actionText.removeEventListener('click', actionTextClick);\r\n\r\n  if (hideSnackbar)\r\n    elements.snackbar.className = '';\r\n}\r\n", "//\r\n// HTML Element clicked parent class\r\n//\r\n// https://ultrafunk.com\r\n//\r\n\r\n\r\nimport {\r\n  addListener,\r\n  addListenerAll,\r\n} from \"./utils.js\";\r\n\r\n\r\n/*************************************************************************************************/\r\n\r\n\r\nexport default class ElementClick\r\n{\r\n  constructor(selectors, addToAllMatching = false)\r\n  {\r\n    if (addToAllMatching)\r\n      addListenerAll(selectors, 'click', (event) => this.clickHandler(event));\r\n    else\r\n      addListener(selectors, 'click', (event) => this.clickHandler(event));\r\n    \r\n    this.event   = null;\r\n    this.element = null;\r\n  }\r\n\r\n  clickHandler(event)\r\n  {\r\n    this.event = event;\r\n    this.elementClicked();\r\n  }\r\n\r\n  clicked(selector)\r\n  {\r\n    this.element = this.event.target.closest(selector);\r\n\r\n    if (this.element !== null)\r\n    {\r\n      this.event.stopImmediatePropagation();\r\n      return true;\r\n    }\r\n    \r\n    return false;\r\n  }\r\n\r\n  closest(selector)\r\n  {\r\n    return this.element.closest(selector);\r\n  }\r\n\r\n  querySelector(selector)\r\n  {\r\n    return this.element.querySelector(selector);\r\n  }\r\n}\r\n", "//\n// Fetch & play next single (standalone) track without page reload SPA style...\n//\n// https://ultrafunk.com\n//\n\n\nimport * as debugLogger from '../../shared/debuglogger.js';\nimport { KEY }          from '../../shared/storage.js';\nimport { TRACK_TYPE }   from '../mediaplayers.js';\nimport { showSnackbar } from '../../shared/snackbar.js';\n\nimport {\n  response,\n  settings,\n} from '../../shared/session-data.js';\n\nimport {\n  fetchRest,\n  getThumbnailData,\n} from '../../shared/utils.js';\n\n\n/*************************************************************************************************/\n\n\nconst debug = debugLogger.newInstance('single-track-fetch');\n\nconst m = {\n  cueOrPlayTrackById: null,\n  startTrackDateTime: null,\n  loadTracksDateTime: null,\n  isNextTrackLoading: false,\n};\n\n\n// ************************************************************************************************\n// Exports\n// ************************************************************************************************\n\nexport function isSingleTrackFetch()\n{\n  return (document.body.matches('.single.track') && settings.gallery.fetchNextSingleTrack);\n}\n\nexport function isNextSingleTrackLoading()\n{\n  return m.isNextTrackLoading;\n}\n\nexport function singleTrackFetchReady(cueOrPlayTrackByIdCallback)\n{\n  if (isSingleTrackFetch())\n  {\n    debug.log('ready()');\n\n    m.cueOrPlayTrackById = cueOrPlayTrackByIdCallback;\n    m.startTrackDateTime = document.querySelector('single-track').getAttribute('data-track-date-time');\n\n    window.addEventListener('popstate', (event) => onPopState(event));\n  }\n}\n\nexport async function playNextSingleTrack(playTrack = false)\n{\n  if (isSingleTrackFetch())\n  {\n    m.isNextTrackLoading = true;\n    const restResponse   = await fetchTracks(m.loadTracksDateTime);\n\n    if ((restResponse !== null) && (restResponse.status.code === 200) && (restResponse.data.length > 1))\n    {\n      m.loadTracksDateTime = restResponse.data[0].date;\n      const currentTrack   = restResponse.data[1];\n  \n      debug.log(`playNextSingleTrack() - playTrack: ${playTrack} - trackType: ${debug.getKeyForValue(TRACK_TYPE, currentTrack.meta.track_source_type)} => ${getTrackTitle(currentTrack.meta)}`);\n  \n      if (currentTrack.meta.track_source_type === TRACK_TYPE.YOUTUBE)\n      {\n        updatePlayerAndPage(restResponse.data, playTrack, true);\n      }\n      else\n      {\n        showSnackbar('SoundCloud track, skipping to next', 5, 'Play', () => \n        {\n          sessionStorage.setItem(KEY.UF_AUTOPLAY, JSON.stringify({ autoplay: true, trackId: null, position: 0 }));\n          window.location.href = currentTrack.link;\n        },\n        () => playNextSingleTrack(playTrack));\n      }\n    }\n    else\n    {\n      if (restResponse.status.code !== 200)\n        showSnackbar('Failed to fetch track data!', 10, 'Retry', () => playNextSingleTrack(playTrack));\n    }\n  }\n\n  m.isNextTrackLoading = false;\n}\n\n\n// ************************************************************************************************\n// Support functions\n// ************************************************************************************************\n\nfunction fetchTracks(tracksDateTime)\n{\n  let beforeTrackDateTime = tracksDateTime;\n\n  if (tracksDateTime === null)\n    beforeTrackDateTime = (m.startTrackDateTime !== '') ? m.startTrackDateTime : '3000-01-01T00:00:01'; // Before the year 3000 should be enough for a while...\n\n  if (beforeTrackDateTime !== null)\n    return fetchRest('tracks', `before=${beforeTrackDateTime}&per_page=3&_fields=id,date,link,meta,artists_links,channels_links`, true);\n\n  return null;\n}\n\nfunction onPopState(event)\n{\n  if (event.state === null)\n  {\n    location.reload();\n  }\n  else\n  {\n    // Set load next track DateTime to the right value for this page\n    m.loadTracksDateTime = event.state[0].date;\n    updatePlayerAndPage(event.state, false, false);\n  }\n}\n\nfunction getTrackTitle(titleData)\n{\n  return `${titleData.track_artist} - ${titleData.track_title}`;\n}\n\nfunction updatePlayerAndPage(trackData, playTrack = false, pushState = true)\n{\n  const thumbnailData = getThumbnailData(trackData[1].meta);\n\n  m.cueOrPlayTrackById(trackData[1].meta, thumbnailData, playTrack);\n  updatePage(trackData, thumbnailData, pushState);\n}\n\nfunction getTrackNavHtml(isNavPrev, navUrl, trackMeta)\n{\n  const trackArtistTitle  = `<b>${trackMeta.track_artist}</b><br>${trackMeta.track_title}`;\n  const prevNextThumbnail = getThumbnailData(trackMeta);\n  const prevNextThumbHtml = `<div class=\"${isNavPrev ? 'prev' : 'next'}-track-nav-thumbnail ${prevNextThumbnail.class}\"><img src=\"${prevNextThumbnail.src}\"></div>`;\n  \n  return /*html*/ `\n    <div class=\"${isNavPrev ? 'nav-previous' : 'nav-next'}\">\n      <a href=\"${navUrl}\" rel=\"${isNavPrev ? 'prev' : 'next'}\" title=\"${isNavPrev ? 'Go to Previous track' : 'Go to Next track'}\">\n        ${isNavPrev ? '<div class=\"prev-track-arrow\">&#10094</div>' : ''}\n        ${isNavPrev ? prevNextThumbHtml : ''}\n        <div class=\"${isNavPrev ? 'prev-track-artist-title' : 'next-track-artist-title'}\">${trackArtistTitle}</div>\n        ${!isNavPrev ? prevNextThumbHtml : ''}\n        ${!isNavPrev ? '<div class=\"next-track-arrow\">&#10095</div>' : ''}\n      </a>\n    </div>`;\n}\n\n\n// ************************************************************************************************\n// Update DOM functions\n// ************************************************************************************************\n\nfunction updatePage(trackData, thumbnailData, pushState = true)\n{\n  response.prevPage = trackData[0].link;\n  response.nextPage = (trackData.length === 3) ? trackData[2].link : null;\n\n  updateSiteNavLinks(document.querySelectorAll('span.navbar-arrow-back'), response.prevPage);\n  updateSiteNavLinks(document.querySelectorAll('span.navbar-arrow-fwd'), response.nextPage);\n  updateTrackNavLinks(document.querySelector('div.nav-links'), trackData);\n  updateTrackHeader(document.querySelector('header.track-header'), trackData[1]);\n  updateTrackAttributes(document.querySelector('single-track'), trackData[1], thumbnailData);\n\n  if (pushState)\n    history.pushState(trackData, '', trackData[1].link);\n\n  document.title = getTrackTitle(trackData[1].meta);\n}\n\nfunction updateSiteNavLinks(elements, url)\n{\n  elements?.forEach(element => { element.closest('a').href = (url !== null) ? url : '#'; });\n}\n\nfunction updateTrackNavLinks(element, trackData)\n{\n  let trackNavHtml = getTrackNavHtml(true, response.prevPage, trackData[0].meta);\n  \n  if (trackData.length === 3)\n    trackNavHtml += getTrackNavHtml(false, response.nextPage, trackData[2].meta);\n\n  element.innerHTML = trackNavHtml;\n}\n\nfunction updateTrackHeader(element, trackData)\n{\n  element.querySelector('h2.track-title').textContent          = getTrackTitle(trackData.meta);\n  element.querySelector('h2.track-title.type-split').innerHTML = `${trackData.meta.track_artist}<br><span class=\"light-text\">${trackData.meta.track_title}</span>`;\n  element.querySelector('div.track-meta-artists  .term-links').innerHTML = trackData.artists_links;\n  element.querySelector('div.track-meta-channels .term-links').innerHTML = trackData.channels_links;\n}\n\nfunction updateTrackAttributes(element, trackData, thumbnailData)\n{\n  const attributes = {\n    'track-type':          trackData.meta.track_source_type,\n    'track-artist':        trackData.meta.track_artist,\n    'track-title':         trackData.meta.track_title,\n    'track-duration':      trackData.meta.track_duration,\n    'track-url':           trackData.link,\n    'track-thumbnail-url': thumbnailData.src,\n    'track-source-uid':    thumbnailData.uid,\n  };\n\n  Object.keys(attributes).forEach(key => element.setAttribute(`data-${key}`, attributes[key]));\n}\n", "//\r\n// ElementToggle UI / Proxy base class\r\n//\r\n// https://ultrafunk.com\r\n//\r\n\r\n\r\nimport { getCssPropString } from \"./utils.js\";\r\n\r\n\r\n/*************************************************************************************************/\r\n\r\n\r\nexport default class ElementToggle\r\n{\r\n  constructor(elementId, updateOnConstruct = true)\r\n  {\r\n    this.element      = document.getElementById(elementId);\r\n    this.valueElement = this.element.querySelector('span.value');\r\n    this.toggleTarget = this.toggle;\r\n    this.toggle       = this.toggleProxy;\r\n    this.updateTarget = this.update;\r\n    this.update       = this.updateProxy;\r\n\r\n    this.element.addEventListener('click', (event) =>\r\n    {\r\n      event?.preventDefault();\r\n      this.toggle(event);\r\n    });\r\n    \r\n    if (updateOnConstruct)\r\n      this.update();\r\n  }\r\n\r\n  get classList()  { return this.element.classList;         }\r\n  set value(value) { this.valueElement.textContent = value; }\r\n\r\n  isEnabled()            { return (this.element.classList.contains('disabled') === false);       }\r\n  pointerEventsEnabled() { return (getCssPropString('pointer-events', this.element) !== 'none'); }\r\n\r\n  // Abstract method to be overriden in child class if needed\r\n  toggle() {}\r\n\r\n  // Proxy for overridden child class method\r\n  toggleProxy(event)\r\n  {\r\n    if (this.isEnabled() && this.pointerEventsEnabled())\r\n    {\r\n      this.toggleTarget(event);\r\n      this.updateTarget(event);\r\n    }\r\n  }\r\n\r\n  // Abstract method to be overriden in child class if needed\r\n  update() {}\r\n\r\n  // Proxy for overridden child class method\r\n  updateProxy()\r\n  {\r\n    this.updateTarget();\r\n  }\r\n}\r\n", "//\r\n// Playback events module\r\n//\r\n// https://ultrafunk.com\r\n//\r\n\r\n\r\nimport * as debugLogger          from '../shared/debuglogger.js';\r\nimport { updateProgressPercent } from './playback-controls.js';\r\n\r\n\r\n/*************************************************************************************************/\r\n\r\n\r\nconst debug = debugLogger.newInstance('playback-events');\r\nexport let hasPlaybackStarted = false;\r\n\r\nexport const EVENT = {\r\n  PLAYBACK_LOADING:     'playbackLoading',\r\n  PLAYBACK_READY:       'playbackReady',\r\n  MEDIA_LOADING:        'mediaLoading',\r\n  MEDIA_PLAYING:        'mediaPlaying',\r\n  MEDIA_PAUSED:         'mediaPaused',\r\n  MEDIA_ENDED:          'mediaEnded',\r\n  MEDIA_CUE_NEXT:       'mediaCueNext',\r\n//MEDIA_CUED:           'mediaCued',\r\n  MEDIA_TIME_REMAINING: 'mediaTimeRemaining',\r\n  MEDIA_UNAVAILABLE:    'mediaUnavailable',\r\n  CONTINUE_AUTOPLAY:    'continueAutoplay',\r\n  RESUME_AUTOPLAY:      'resumeAutoplay',\r\n  AUTOPLAY_BLOCKED:     'autoplayBlocked',\r\n  PLAYBACK_BLOCKED:     'playbackBlocked',\r\n};\r\n\r\nconst eventListeners = {\r\n  [EVENT.PLAYBACK_LOADING]:     [ (event) => updateProgressPercent(event.data.loadingPercent) ],\r\n  [EVENT.PLAYBACK_READY]:       [ playbackReady ],\r\n  [EVENT.MEDIA_LOADING]:        [],\r\n  [EVENT.MEDIA_PLAYING]:        [ () => (hasPlaybackStarted = true) ],\r\n  [EVENT.MEDIA_PAUSED]:         [],\r\n  [EVENT.MEDIA_ENDED]:          [],\r\n  [EVENT.MEDIA_CUE_NEXT]:       [ () => (hasPlaybackStarted = false) ],\r\n//[EVENT.MEDIA_CUED]:           [],\r\n  [EVENT.MEDIA_TIME_REMAINING]: [],\r\n  [EVENT.MEDIA_UNAVAILABLE]:    [],\r\n  [EVENT.CONTINUE_AUTOPLAY]:    [],\r\n  [EVENT.RESUME_AUTOPLAY]:      [],\r\n  [EVENT.AUTOPLAY_BLOCKED]:     [],\r\n  [EVENT.PLAYBACK_BLOCKED]:     [],\r\n};\r\n\r\n\r\n// ************************************************************************************************\r\n// \r\n// ************************************************************************************************\r\n\r\nexport function addListener(playbackEvent, playbackEventListener)\r\n{\r\n  if (playbackEvent in eventListeners)\r\n    eventListeners[playbackEvent].push(playbackEventListener);\r\n}\r\n\r\nexport function dispatch(playbackEvent, playbackEventData = null, playbackEventCallback = null)\r\n{\r\n  eventListeners[playbackEvent].forEach(eventListener =>\r\n  {\r\n    eventListener({\r\n      event:    playbackEvent,\r\n      data:     playbackEventData,\r\n      callback: playbackEventCallback,\r\n    });\r\n  });\r\n}\r\n\r\n\r\n// ************************************************************************************************\r\n// Default event listeners\r\n// ************************************************************************************************\r\n\r\nfunction playbackReady(playbackEvent)\r\n{\r\n  debug.log(playbackEvent);\r\n\r\n  if (playbackEvent?.data.resetProgressBar)\r\n    updateProgressPercent(0);\r\n}\r\n", "//\r\n// HTMLElement convenience wrapper objects\r\n//\r\n// https://ultrafunk.com\r\n//\r\n\r\n\r\nimport { replaceClass } from \"../shared/utils.js\";\r\n\r\n\r\n/*************************************************************************************************/\r\n\r\n\r\nexport const STATE = {\r\n  UNKNOWN:  { ID:  0, CLASS: 'state-unknown'  },\r\n  DISABLED: { ID: 10, CLASS: 'state-disabled' },\r\n  ENABLED:  { ID: 20, CLASS: 'state-enabled'  },\r\n  HIDDEN:   { ID: 30, CLASS: 'state-hidden'   },\r\n  PLAYING:  { ID: 40, CLASS: 'state-playing'  },\r\n  PAUSED:   { ID: 50, CLASS: 'state-paused'   },\r\n  LOADING:  { ID: 60, CLASS: 'state-loading'  },\r\n};\r\n\r\n\r\n// ************************************************************************************************\r\n//\r\n// ************************************************************************************************\r\n\r\nexport const ElementWrapper = function(elmentSelector, parentElement = document, initialState = STATE.DISABLED)\r\n{\r\n  const element   = parentElement.querySelector(elmentSelector);\r\n  let   state     = initialState;\r\n  const classList = element.classList;\r\n\r\n  return {\r\n    get element() { return element;       },\r\n    get state()   { return state;         },\r\n    get style()   { return element.style; },\r\n\r\n    set elementTitle(title) { element.title = title; },\r\n\r\n    getElement(selector)         { return element.querySelector(selector);    },\r\n    addListener(event, listener) { element.addEventListener(event, listener); },\r\n\r\n    addClass(...cssClass)     { classList.add(...cssClass);         },\r\n    removeClass(...cssClass)  { classList.remove(...cssClass);      },\r\n    replaceClass(remove, add) { replaceClass(element, remove, add); },\r\n    toggleClass(cssClass)     { classList.toggle(cssClass);         },\r\n\r\n    getAttribute(attribute)        { return element.getAttribute(attribute); },\r\n    setAttribute(attribute, value) { element.setAttribute(attribute, value); },\r\n\r\n    setState,\r\n  };\r\n\r\n  function setState(newState = STATE.DISABLED)\r\n  {\r\n    // Only update classList and state if they have actually changed...\r\n    if (state.ID !== newState.ID)\r\n    {\r\n      classList.remove(state.CLASS);\r\n      classList.add(newState.CLASS);\r\n      state = newState;\r\n\r\n      return true;\r\n    }\r\n\r\n    return false;\r\n  }\r\n};\r\n\r\nexport const ElementsWrapper = function(elmentsSelector, parentElement = document)\r\n{\r\n  const elements = parentElement.querySelectorAll(elmentsSelector);\r\n\r\n  return {\r\n    get length()     { return elements.length;    },\r\n    forEach(...args) { elements.forEach(...args); },\r\n  };\r\n};\r\n", "//\r\n// Playback UI controls\r\n//\r\n// https://ultrafunk.com\r\n//\r\n\r\n\r\nimport * as debugLogger        from '../shared/debuglogger.js';\r\nimport { settings }            from '../shared/session-data.js';\r\nimport { EVENT, addListener }  from './playback-events.js';\r\nimport { addSettingsObserver } from '../shared/storage.js';\r\n\r\nimport {\r\n  playerType as playerTypeToggle\r\n} from './footer-toggles.js';\r\n\r\nimport {\r\n  STATE,\r\n  ElementWrapper,\r\n} from './element-wrappers.js';\r\n\r\nimport {\r\n  MATCH,\r\n  matchesMedia,\r\n  getTimeString,\r\n} from '../shared/utils.js';\r\n\r\n\r\n/*************************************************************************************************/\r\n\r\n\r\nconst debug = debugLogger.newInstance('playback-controls');\r\nconst m     = { players: {} };\r\nconst ctrl  = {};\r\n\r\n\r\n// ************************************************************************************************\r\n// Set user settings controlled CSS as early as possible before init() call\r\n// ************************************************************************************************\r\n\r\nexport function setPlaybackControlsCss()\r\n{\r\n  ctrl.prevTrack = new ElementWrapper('.playback-prev-control');\r\n  ctrl.playPause = new ElementWrapper('.playback-play-pause-control');\r\n\r\n  if (matchesMedia(MATCH.SITE_MAX_WIDTH_MOBILE))\r\n  {\r\n    debug.log('setPlaybackControlsCss(): MATCH.SITE_MAX_WIDTH_MOBILE');\r\n\r\n    if (settings.mobile.showPrevTrackButton)\r\n      ctrl.prevTrack.addClass('show-on-mobile');\r\n\r\n    if (!settings.mobile.showPrevTrackButton && !settings.mobile.showTrackTimes)\r\n      ctrl.playPause.addClass('mobile-margin-10px');\r\n    else if (settings.mobile.showTrackTimes && !settings.mobile.showPrevTrackButton)\r\n      ctrl.playPause.addClass('mobile-margin-6px');\r\n    else if (settings.mobile.showPrevTrackButton && !settings.mobile.showTrackTimes)\r\n      ctrl.prevTrack.addClass('mobile-margin-3px');\r\n  }\r\n}\r\n\r\n\r\n// ************************************************************************************************\r\n// Init and make ready all controls\r\n// ************************************************************************************************\r\n\r\nexport function init(mediaPlayers, seekClickCallback)\r\n{\r\n  debug.log('init()');\r\n\r\n  m.players = mediaPlayers;\r\n\r\n  const playbackProgress = document.getElementById('progress-controls');\r\n\r\n  if (playbackProgress !== null)\r\n  {\r\n    ctrl.progressSeek = new ElementWrapper('.progress-seek-control', playbackProgress);\r\n    ctrl.progressSeek.clickCallback = seekClickCallback;\r\n    ctrl.progressBar  = new ElementWrapper('.progress-bar-control', playbackProgress);\r\n  }\r\n  else\r\n  {\r\n    debug.error('init(): Unable to getElementById() for #progress-controls');\r\n  }\r\n\r\n  const playbackControls = document.getElementById('playback-controls');\r\n\r\n  if (playbackControls !== null)\r\n  {\r\n    ctrl.details        = new ElementWrapper('.playback-details-control', playbackControls);\r\n    ctrl.details.artist = ctrl.details.getElement('.playback-details-artist');\r\n    ctrl.details.title  = ctrl.details.getElement('.playback-details-title');\r\n    \r\n    ctrl.thumbnail     = new ElementWrapper('.playback-thumbnail-control', playbackControls);\r\n    ctrl.thumbnail.img = ctrl.thumbnail.getElement('img');\r\n    \r\n    ctrl.timer                 = new ElementWrapper('.playback-timer-control', playbackControls);\r\n    ctrl.timer.position        = ctrl.timer.getElement('.playback-timer-position');\r\n    ctrl.timer.duration        = ctrl.timer.getElement('.playback-timer-duration');\r\n    ctrl.timer.positionSeconds = -1; // Make sure initial value is set + shown when track plays\r\n    ctrl.timer.durationSeconds = -1; // Make sure initial value is set + shown when track plays\r\n      \r\n    ctrl.playerType = new ElementWrapper('.playback-player-type-control', playbackControls);\r\n\r\n    ctrl.playPause.icon = ctrl.playPause.getElement('span.material-icons');\r\n    \r\n    ctrl.nextTrack = new ElementWrapper('.playback-next-control', playbackControls);\r\n    \r\n    ctrl.repeat      = new ElementWrapper('.playback-repeat-control', playbackControls);\r\n    ctrl.repeat.icon = ctrl.repeat.getElement('span.material-icons');\r\n    \r\n    ctrl.shuffle = new ElementWrapper('.playback-shuffle-control', playbackControls);\r\n    \r\n    ctrl.mute      = new ElementWrapper('.playback-mute-control', playbackControls);\r\n    ctrl.mute.icon = ctrl.mute.getElement('span.material-icons');\r\n  }\r\n  else\r\n  {\r\n    debug.error('init(): Unable to getElementById() for #playback-controls');\r\n  }\r\n}\r\n\r\nexport function ready(prevClickCallback, playPauseClickCallback, nextClickCallback, muteClickCallback)\r\n{\r\n  debug.log('ready()');\r\n\r\n  ctrl.progressSeek.setState(STATE.ENABLED);\r\n  ctrl.progressSeek.addListener('click', progressSeekClick);\r\n  ctrl.progressBar.setState(STATE.ENABLED);\r\n  \r\n  ctrl.details.setState(STATE.HIDDEN);\r\n  ctrl.thumbnail.setState(STATE.HIDDEN);\r\n  ctrl.timer.setState(STATE.HIDDEN);\r\n\r\n  if (settings.mobile.showTrackThumbnail)\r\n    ctrl.thumbnail.addClass('show-on-mobile');\r\n\r\n  if (settings.mobile.showTrackTimes)\r\n    ctrl.timer.addClass('show-on-mobile');\r\n\r\n  ctrl.playerType.setState(STATE.ENABLED);\r\n  ctrl.playerType.addListener('click', () => playerTypeToggle.toggle());\r\n\r\n  ctrl.prevTrack.setState((m.players.getCurrentTrack() > 1) ? STATE.ENABLED : STATE.DISABLED);\r\n  ctrl.prevTrack.addListener('click', prevClickCallback);\r\n\r\n  ctrl.playPause.setState(STATE.PAUSED);\r\n  ctrl.playPause.addListener('click', playPauseClickCallback);\r\n\r\n  ctrl.nextTrack.setState((m.players.getNumTracks() > 1) ? STATE.ENABLED : STATE.DISABLED);\r\n  ctrl.nextTrack.addListener('click', () => nextClickCallback());\r\n\r\n  ctrl.repeat.setState(STATE.ENABLED);\r\n  ctrl.repeat.addListener('click', toggleRepeat);\r\n\r\n  ctrl.shuffle.setState(STATE.ENABLED);\r\n\r\n  ctrl.mute.setState(STATE.ENABLED);\r\n  ctrl.mute.addListener('click', () => muteClickCallback());\r\n  updateMuteState();\r\n\r\n  addSettingsObserver('autoplay',   updateAutoplayState);\r\n  addSettingsObserver('masterMute', updateMuteState);\r\n\r\n  addListener(EVENT.MEDIA_LOADING,     setLoadState);\r\n  addListener(EVENT.MEDIA_PLAYING,     setPlayState);\r\n  addListener(EVENT.MEDIA_PAUSED ,     setPauseState);\r\n  addListener(EVENT.MEDIA_ENDED,       setMediaEndState);\r\n  addListener(EVENT.MEDIA_CUE_NEXT,    () => updateProgressPercent(0));\r\n  addListener(EVENT.AUTOPLAY_BLOCKED,  setPauseState);\r\n  addListener(EVENT.PLAYBACK_BLOCKED,  setPauseState);\r\n  addListener(EVENT.MEDIA_UNAVAILABLE, setPauseState);\r\n}\r\n\r\n\r\n// ************************************************************************************************\r\n// Progress bar and position seek\r\n// ************************************************************************************************\r\n\r\nexport function updateProgressPercent(progressPercent)\r\n{\r\n  updateProgressBar(progressPercent / 100);\r\n}\r\n\r\nfunction updateProgressBar(scaleX)\r\n{\r\n  ctrl.progressBar.style.transform = `scaleX(${scaleX})`;\r\n}\r\n\r\nexport function updateTimerAndProgress(positionMilliseconds, positionSeconds, durationSeconds)\r\n{\r\n  setTimer(positionSeconds, durationSeconds);\r\n\r\n  // Prevent division by zero\r\n  if (durationSeconds === 0)\r\n    updateProgressBar(0);\r\n  else\r\n    updateProgressBar(positionMilliseconds / (durationSeconds * 1000));\r\n}\r\n\r\nfunction progressSeekClick(event)\r\n{\r\n  if (ctrl.timer.durationSeconds > 0)\r\n  {\r\n    let progressPercent = ((event.clientX / document.documentElement.clientWidth) * 100);\r\n    let seekPosSeconds  = Math.round((ctrl.timer.durationSeconds * progressPercent) / 100);\r\n\r\n    if (!settings.mobile.showPrevTrackButton      &&\r\n        matchesMedia(MATCH.SITE_MAX_WIDTH_MOBILE) &&\r\n        (progressPercent <= 20))\r\n    {\r\n      ctrl.progressSeek.clickCallback(0);\r\n      progressPercent = 0;\r\n      seekPosSeconds  = 0;\r\n    }\r\n    else\r\n    {\r\n      ctrl.progressSeek.clickCallback(seekPosSeconds);\r\n    }\r\n\r\n    if (isPlaying() === false)\r\n    {\r\n      updateProgressPercent(progressPercent);\r\n      setTimer(seekPosSeconds, ctrl.timer.durationSeconds);\r\n    }\r\n  }\r\n}\r\n\r\n\r\n// ************************************************************************************************\r\n// Details (Artist + Title) and track timer\r\n// ************************************************************************************************\r\n\r\nfunction setDetails(trackData)\r\n{\r\n  if (ctrl.details.state.ID === STATE.HIDDEN.ID)\r\n  {\r\n    ctrl.details.setState(STATE.ENABLED);\r\n    ctrl.thumbnail.setState(STATE.ENABLED);\r\n    ctrl.timer.setState(STATE.ENABLED);\r\n    clearTimer(trackData);\r\n  }\r\n\r\n  ctrl.details.artist.textContent = trackData.artist || ''; // Artist will contain the post title if all else fails\r\n  ctrl.details.title.textContent  = trackData.title  || '';\r\n  \r\n  setThumbnail(trackData.thumbnail);\r\n  setTimerDisplayHoursMinutes(trackData.duration);\r\n  setTimer((isPlaying() ? ctrl.timer.positionSeconds : 0), trackData.duration);\r\n}\r\n\r\nfunction setThumbnail(thumbnail)\r\n{\r\n  // Don't set thumbnail again if the image source / URL is unchanged\r\n  if (thumbnail.src !== ctrl.thumbnail.img.src)\r\n  {\r\n    ctrl.thumbnail.removeClass('type-default', 'type-youtube', 'type-soundcloud');\r\n    ctrl.thumbnail.addClass('loading', thumbnail.class);\r\n    ctrl.thumbnail.img.src = thumbnail.src;\r\n    ctrl.thumbnail.img.decode().then(() => ctrl.thumbnail.removeClass('loading'));\r\n  }\r\n}\r\n\r\nfunction setTimerDisplayHoursMinutes(durationSeconds)\r\n{\r\n  (durationSeconds > 3600)\r\n    ? ctrl.timer.replaceClass('display-minutes', 'display-hours')\r\n    : ctrl.timer.replaceClass('display-hours', 'display-minutes');\r\n}\r\n\r\nfunction setTimer(positionSeconds, durationSeconds)\r\n{\r\n  if (ctrl.timer.positionSeconds !== positionSeconds)\r\n  {\r\n    ctrl.timer.positionSeconds = positionSeconds;\r\n\r\n    if (settings.playback.autoplay === false)\r\n      positionSeconds = (durationSeconds - positionSeconds);\r\n    \r\n    ctrl.timer.position.textContent = getTimeString(positionSeconds, (durationSeconds > 3600));\r\n  }\r\n\r\n  if (ctrl.timer.durationSeconds !== durationSeconds)\r\n  {\r\n    ctrl.timer.durationSeconds      = durationSeconds;\r\n    ctrl.timer.duration.textContent = getTimeString(durationSeconds, (durationSeconds > 3600));\r\n  }\r\n}\r\n\r\nfunction clearTimer(trackData)\r\n{\r\n  ctrl.timer.position.textContent = settings.playback.autoplay\r\n    ? (trackData.duration > 3600) ? '00:00:00' : '00:00'\r\n    : getTimeString(trackData.duration, (trackData.duration > 3600));\r\n\r\n  ctrl.timer.duration.textContent = (trackData.duration > 3600) ? '00:00:00' : '00:00';\r\n  ctrl.timer.positionSeconds = -1;\r\n  ctrl.timer.durationSeconds = -1;\r\n}\r\n\r\n\r\n// ************************************************************************************************\r\n// Playback controls (prev, play/pause and next)\r\n// ************************************************************************************************\r\n\r\nexport function isPlaying()\r\n{\r\n  // ToDo: This might not be the best place to save / check playback state...?\r\n  return ((ctrl.playPause.state.ID === STATE.PLAYING.ID) ? true : false);    \r\n}\r\n\r\nfunction setLoadState()\r\n{\r\n  if (ctrl.thumbnail.state.ID === STATE.ENABLED.ID)\r\n    ctrl.thumbnail.addClass(STATE.LOADING.CLASS);\r\n}\r\n\r\nfunction setMediaEndState()\r\n{\r\n  updateProgressBar(0);\r\n  setTimer(0, m.players.getTrackData().duration);\r\n}\r\n\r\nexport function setPlayState()\r\n{\r\n  ctrl.thumbnail.removeClass(STATE.LOADING.CLASS);\r\n  ctrl.playPause.setState(STATE.PLAYING);\r\n  ctrl.playPause.icon.textContent = 'pause_circle_filled';\r\n  ctrl.prevTrack.setState(STATE.ENABLED);\r\n  \r\n  setDetails(m.players.getTrackData());\r\n}\r\n\r\nexport function setPauseState()\r\n{\r\n  ctrl.thumbnail.removeClass(STATE.LOADING.CLASS);\r\n  ctrl.playPause.setState(STATE.PAUSED);\r\n  ctrl.playPause.icon.textContent = 'play_circle_filled';\r\n}\r\n\r\nexport function blinkPlayPause(toggleBlink)\r\n{\r\n  if (toggleBlink)\r\n    ctrl.playPause.toggleClass('time-remaining-warning');\r\n  else\r\n    ctrl.playPause.removeClass('time-remaining-warning');\r\n}\r\n\r\nexport function getSetTrackData()\r\n{\r\n  const trackData = m.players.getTrackData();\r\n\r\n  clearTimer(trackData);\r\n  setDetails(trackData);\r\n\r\n  return trackData;\r\n}\r\n\r\nexport function updatePrevState()\r\n{\r\n  const trackData = getSetTrackData();\r\n  \r\n  if ((isPlaying() === false) && (trackData.currentTrack <= 1))\r\n    ctrl.prevTrack.setState(STATE.DISABLED);\r\n  \r\n  if (trackData.currentTrack < trackData.numTracks)\r\n    ctrl.nextTrack.setState(STATE.ENABLED);\r\n}\r\n\r\nexport function updateNextState()\r\n{\r\n  const trackData = getSetTrackData();\r\n\r\n  ctrl.prevTrack.setState(STATE.ENABLED);\r\n  \r\n  if (trackData.currentTrack >= trackData.numTracks)\r\n    ctrl.nextTrack.setState(STATE.DISABLED);\r\n}\r\n\r\n\r\n// ************************************************************************************************\r\n// Repeat control\r\n// ************************************************************************************************\r\n\r\nexport const REPEAT = { OFF: 0, ALL: 1, ONE: 2 };\r\n\r\nconst repeatModes = [\r\n  { title: 'Repeat Off', icon: 'repeat'     },\r\n  { title: 'Repeat All', icon: 'repeat'     },\r\n  { title: 'Repeat One', icon: 'repeat_one' },\r\n];\r\n\r\nexport function getRepeatMode()\r\n{\r\n  return parseInt(ctrl.repeat.getAttribute('data-repeat-mode'));\r\n}\r\n\r\nexport function toggleRepeat()\r\n{\r\n  const index = ((getRepeatMode() + 1) < repeatModes.length)\r\n                  ? (getRepeatMode() + 1)\r\n                  : 0;\r\n\r\n  ctrl.repeat.setAttribute('data-repeat-mode', index);\r\n  ctrl.repeat.elementTitle     = `${repeatModes[index].title} (r)`;\r\n  ctrl.repeat.icon.textContent = repeatModes[index].icon;\r\n\r\n  return repeatModes[index];\r\n}\r\n\r\n\r\n// ************************************************************************************************\r\n// Set Mute control and Autoplay states\r\n// ************************************************************************************************\r\n\r\nfunction updateMuteState()\r\n{\r\n  ctrl.mute.icon.textContent = settings.playback.masterMute ? 'volume_off' : 'volume_up';\r\n}\r\n\r\nfunction updateAutoplayState()\r\n{\r\n  const position = ctrl.timer.positionSeconds;\r\n  const duration = ctrl.timer.durationSeconds;\r\n\r\n  if ((isPlaying() === false) && (position !== -1) && ((duration !== -1)))\r\n  {\r\n    ctrl.timer.position.textContent = settings.playback.autoplay\r\n      ? getTimeString(position, (duration > 3600))\r\n      : getTimeString((duration - position), (duration > 3600));\r\n\r\n    ctrl.timer.duration.textContent = getTimeString(duration, (duration > 3600));\r\n  }\r\n}\r\n", "//\r\n// List player track template functions\r\n//\r\n// https://ultrafunk.com\r\n//\r\n\r\n\r\nimport * as debugLogger from '../../shared/debuglogger.js';\r\nimport { TRACK_TYPE }   from '../mediaplayers.js';\r\n\r\nimport {\r\n  getTimeString,\r\n  getListPlayerUrl,\r\n  getThumbnailData,\r\n  escHtml,\r\n} from '../../shared/utils.js';\r\n\r\n\r\n/*************************************************************************************************/\r\n\r\n\r\nconst debug = debugLogger.newInstance('list-track-templates');\r\n\r\n\r\n// ************************************************************************************************\r\n// \r\n// ************************************************************************************************\r\n\r\nexport function getPageSeparatorHtml(responseData, loadingPage)\r\n{\r\n  const pageUrl = responseData.nextPage.replace(/\\/page\\/(?!0)\\d{1,6}\\//i, `/page/${loadingPage}/`);\r\n\r\n  return /*html*/ `\r\n    <div id=\"tracklist-page-${loadingPage}\" class=\"tracklist-page-separator\" data-page-number=\"${loadingPage}\">\r\n      <span class=\"material-icons arrow-down-button\" title=\"Scroll to next page\">arrow_downward</span>\r\n      <a href=\"${pageUrl}\" title=\"Go to page ${loadingPage}\">Page ${loadingPage} &#9660;</a>\r\n      <span class=\"material-icons arrow-up-button\" title=\"Scroll to previous page\">arrow_upward</span>\r\n    </div>`;\r\n}\r\n\r\nexport function getTrackEntryHtml(track)\r\n{\r\n  const isYouTubeTrack = (track.meta.track_source_type === TRACK_TYPE.YOUTUBE);\r\n  const thumbnailData  = getThumbnailData(track.meta);\r\n  const trackArtist    = escHtml(track.meta.track_artist);\r\n  const trackTitle     = escHtml(track.meta.track_title);\r\n  const trackDuration  = parseInt(track.meta.track_duration);\r\n\r\n  const youTubeTrackThumbnailUrl = debug.isDebug()\r\n                                     ? \"/wp-content/themes/ultrafunk/inc/img/yt_thumbnail_placeholder.png\"\r\n                                     : thumbnailData.src;\r\n\r\n  const trackThumbnailUrl = isYouTubeTrack\r\n                              ? youTubeTrackThumbnailUrl\r\n                              : '/wp-content/themes/ultrafunk/inc/img/sc_thumbnail_placeholder.png';\r\n\r\n  const trackArtistTitle = isYouTubeTrack\r\n                             ? `<span><b>${trackArtist}</b></span><br><span>${trackTitle}</span>`\r\n                             : `<a href=\"${track.link}\"><span><b>${trackArtist}</b></span><br><span>${trackTitle}</span></a>`;\r\n  \r\n  const trackPlayNext = isYouTubeTrack\r\n                          ? `<div class=\"play-next-button\" title=\"Play Next\"><span class=\"material-icons\">playlist_play</span></div>`\r\n                          : '';\r\n\r\n  return /*html*/ `\r\n    <div id=\"${track.uid}\" class=\"track-entry ${thumbnailData.class}\"\r\n      data-track-type=\"${track.meta.track_source_type}\"\r\n      data-track-id=\"track-${track.id}\"\r\n      data-track-artist=\"${trackArtist}\"\r\n      data-track-title=\"${trackTitle}\"\r\n      data-track-duration=\"${trackDuration}\"\r\n      data-track-url=\"${track.link}\"\r\n      data-track-thumbnail-url=\"${trackThumbnailUrl}\"\r\n      data-track-source-uid =\"${thumbnailData.uid}\"\r\n      >\r\n      <div class=\"track-artists-links\" data-track-artist-ids=\"${track.artists.toString()}\"></div>\r\n      <div class=\"track-channels-links\" data-track-channel-ids=\"${track.channels.toString()}\"></div>\r\n      <div class=\"track-details\">\r\n        <div class=\"thumbnail\" ${isYouTubeTrack ? 'title=\"Play Track\"' : 'title=\"SoundCloud Track\"'}>\r\n          <div class=\"thumbnail-overlay\"><div class=\"spinner\"></div></div>\r\n          <img src=\"${trackThumbnailUrl}\" alt=\"\">\r\n        </div>\r\n        <div class=\"artist-title text-nowrap-ellipsis\" ${(isYouTubeTrack === false) ? 'title=\"Link: Play SoundCloud track\"' : ''}>\r\n          ${trackArtistTitle}\r\n        </div>\r\n      </div>\r\n      <div class=\"track-actions\">\r\n        <div class=\"track-message\"></div>\r\n        <div class=\"track-action-buttons\">\r\n          <div class=\"remove-button\" title=\"Remove Track from List\"><span class=\"material-icons\">clear</span></div>\r\n          ${trackPlayNext}\r\n          <div class=\"share-play-button\" title=\"Share Track / Play On\"><span class=\"material-icons\">share</span></div>\r\n          <div class=\"details-button\" title=\"Track Details\"><span class=\"material-icons-outlined\">info</span></div>\r\n        </div>\r\n        <div class=\"track-actions-toggle\" title=\"Show / Hide track actions\"><span class=\"material-icons\">more_horiz</span></div>\r\n      </div>\r\n      <div class=\"track-duration text-nowrap-ellipsis\">${(isYouTubeTrack ? getTimeString(trackDuration) : 'N / A')}</div>\r\n    </div>`;\r\n}\r\n\r\nexport function setTrackMeta(\r\n  trackData,\r\n  trackLinksSelector,\r\n  linkIdsAttribute,\r\n  linksMap,\r\n  isChannels = false\r\n)\r\n{\r\n  trackData.forEach(track =>\r\n  {\r\n    const linksElement = document.getElementById(track.uid).querySelector(trackLinksSelector);\r\n    const linkIds      = linksElement.getAttribute(linkIdsAttribute)?.split(',');\r\n    let   linksHtml    = '';\r\n    let   isVideo      = false;\r\n\r\n    linkIds?.forEach(linkId =>\r\n    {\r\n      const mapKey    = parseInt(linkId);\r\n      const linkClass = (track.meta.track_artist_id === mapKey) ? 'primary' : 'secondary';\r\n      linksHtml      +=`<a class=\"${linkClass}\" href=\"${getListPlayerUrl(linksMap.get(mapKey).link)}\">${linksMap.get(mapKey).name}</a>`;\r\n\r\n      if (isChannels && (linksMap.get(mapKey).name === 'Video'))\r\n        isVideo = true;\r\n    });\r\n\r\n    document.getElementById(track.uid).classList.add(isVideo ? 'is-video' : 'is-audio');\r\n    linksElement.insertAdjacentHTML('afterbegin', linksHtml);\r\n  });\r\n}\r\n", "//\r\n// List player tracks REST data fetch and caching\r\n//\r\n// https://ultrafunk.com\r\n//\r\n\r\n\r\nimport * as debugLogger from '../../shared/debuglogger.js';\r\nimport { fetchRest }    from '../../shared/utils.js';\r\n\r\nimport {\r\n  response as responseData\r\n} from '../../shared/session-data.js';\r\n\r\nimport {\r\n  getPageSeparatorHtml,\r\n  getTrackEntryHtml,\r\n  setTrackMeta,\r\n} from './list-track-templates.js';\r\n\r\n\r\n/*************************************************************************************************/\r\n\r\n\r\nconst debug = debugLogger.newInstance('list-tracks-rest');\r\n\r\nconst m = {\r\n  artistsCache:  new Map(),\r\n  channelsCache: new Map(),\r\n};\r\n\r\n\r\n// ************************************************************************************************\r\n// \r\n// ************************************************************************************************\r\n\r\nexport async function loadTracks(termType, termId)\r\n{\r\n  const loadingPage = parseInt(responseData.currentPage + 1);\r\n  const trackData   = await fetchTracks(termType, termId, loadingPage, parseInt(responseData.listPerPage));\r\n\r\n  if (trackData !== null)\r\n  {\r\n    const artistIds  = new Set();\r\n    const channelIds = new Set();\r\n    let tracksHtml   = getPageSeparatorHtml(responseData, loadingPage);\r\n\r\n    trackData.forEach((track, index) =>\r\n    {\r\n      track.artists.forEach(key => (m.artistsCache.has(key) === false) && artistIds.add(key));\r\n      track.channels.forEach(key => (m.channelsCache.has(key) === false) && channelIds.add(key));\r\n      track.uid = (Date.now() + index);\r\n      tracksHtml += getTrackEntryHtml(track);\r\n    });\r\n\r\n    document.getElementById('tracklist-load-more').insertAdjacentHTML('beforebegin', tracksHtml);\r\n  \r\n    debug.log(`Fetching: ${artistIds.size} artists (cached: ${m.artistsCache.size}) - Fetching: ${channelIds.size} channels (cached: ${m.channelsCache.size})`);\r\n\r\n    let artistsPromise  = null;\r\n    let channelsPromise = null;\r\n    \r\n    if (artistIds.size > 0)\r\n      artistsPromise = fetchTerms('artists',  [...artistIds], 100);\r\n  \r\n    if (channelIds.size > 0)\r\n      channelsPromise = fetchTerms('channels', [...channelIds], 100);\r\n\r\n    const [artistsData, channelsData] = await Promise.all([artistsPromise, channelsPromise]);\r\n\r\n    if (artistsData !== null)\r\n      artistsData.forEach(entry => m.artistsCache.set(entry.id, { name: entry.name, link: entry.link }));\r\n\r\n    if (channelsData !== null)\r\n      channelsData.forEach(entry => m.channelsCache.set(entry.id, { name: entry.name, link: entry.link }));\r\n\r\n    setTrackMeta(trackData, '.track-artists-links',  'data-track-artist-ids',  m.artistsCache,  false);\r\n    setTrackMeta(trackData, '.track-channels-links', 'data-track-channel-ids', m.channelsCache, true);\r\n\r\n    return true;\r\n  }\r\n\r\n  return false;\r\n}\r\n\r\n\r\n// ************************************************************************************************\r\n// Fetch tracks + terms\r\n// ************************************************************************************************\r\n\r\nfunction fetchTracks(termType = '', termId = '', page = 1, tracksPerPage = 25)\r\n{\r\n  debug.log(`fetchTracks() - termType: ${(termType.length === 0) ? 'N/A' : termType} - termId: ${(termId.length === 0) ? 'N/A' : termId} - page: ${page} - tracksPerPage: ${tracksPerPage}`);\r\n\r\n  let params       = '';\r\n  const pagination = `page=${page}&per_page=${tracksPerPage}`;\r\n  const fields     = '&_fields=id,link,artists,channels,meta';\r\n  \r\n  if (responseData.params.channel || responseData.params.artist)\r\n    params = getTermQueryParams(termType, termId);\r\n  else if (responseData.params.shuffle)\r\n    params = getShuffleQueryParams();\r\n  else if (responseData.params.search)\r\n    params = getSearchQueryParams();\r\n\r\n  return fetchRest('tracks', `${params}${pagination}${fields}`);\r\n}\r\n\r\nfunction fetchTerms(termType, termIds, maxItems = 50)\r\n{\r\n  return fetchRest(termType, `include=${termIds}&per_page=${maxItems}&_fields=id,link,name`);\r\n}\r\n\r\nfunction getTermQueryParams(termType, termId)\r\n{\r\n  if ((termType.length !== 0) && (termId.length !== 0))\r\n    return `${termType}=${parseInt(termId)}&`;\r\n\r\n  return '';\r\n}\r\n\r\nfunction getShuffleQueryParams()\r\n{\r\n  let shuffleParams = `shuffle=true&shuffle_type=${responseData.params.shuffle_type}&`;\r\n\r\n  if (responseData.params.shuffle_slug !== null)\r\n    shuffleParams += `shuffle_slug=${responseData.params.shuffle_slug}&`;\r\n\r\n  return shuffleParams;\r\n}\r\n\r\n//\r\n// ToDo: wpessid=4021;\r\n//\r\nfunction getSearchQueryParams()\r\n{\r\n  let searchString   = '';\r\n  const searchParams = new URLSearchParams(window.location.search);\r\n\r\n  if (searchParams.has('s'))\r\n  {\r\n    searchString = encodeURIComponent(searchParams.get('s'));\r\n  //Search string \"R&B\" needs special handling to match \"R&amp;B\"\r\n    searchString = searchString.replace(/r%26b/i, 'r%26amp;b');\r\n  }\r\n\r\n  return `search=${searchString}&orderby=relevance&wpessid=true&`;\r\n}\r\n", "//\r\n// List-player controls module\r\n//\r\n// https://ultrafunk.com\r\n//\r\n\r\n\r\nimport * as debugLogger       from '../../shared/debuglogger.js';\r\nimport * as upNextModal       from './up-next-modal.js';\r\nimport * as playbackEvents    from '../playback-events.js';\r\nimport ElementClick           from '../../shared/element-click.js';\r\nimport { STATE }              from '../element-wrappers.js';\r\nimport { TRACK_TYPE }         from '../mediaplayers.js';\r\nimport { loadTracks }         from './list-tracks-rest.js';\r\nimport { showSnackbar }       from '../../shared/snackbar.js';\r\nimport { response, settings } from '../../shared/session-data.js';\r\n\r\nimport {\r\n  replaceClass,\r\n  stripAttribute,\r\n} from '../../shared/utils.js';\r\n\r\n\r\n/*************************************************************************************************/\r\n\r\n\r\nconst debug = debugLogger.newInstance('list-controls');\r\n\r\nconst m = {\r\n  tracklist:         null,\r\n  tracklistObserver: null,\r\n  tracklistLoadMore: null,\r\n  player:            null,\r\n  trackElement:      null,\r\n  currentState:      STATE.UNKNOWN,\r\n  prevActionButtons: null,\r\n  playerWrapper:     null,\r\n  uiElements:        null,\r\n};\r\n\r\n\r\n// ************************************************************************************************\r\n//\r\n// ************************************************************************************************\r\n\r\nexport function init(setCurrentTrackCallback)\r\n{\r\n  debug.log('init()');\r\n\r\n  upNextModal.init(setCurrentTrackCallback);\r\n\r\n  m.tracklist         = document.getElementById('tracklist');\r\n  m.tracklistObserver = new IntersectionObserver(observerCallback, { root: m.tracklist });\r\n  m.playerWrapper     = document.querySelector('.wp-block-embed__wrapper');\r\n  m.uiElements        = new UiElements('#tracklist', setCurrentTrackCallback);\r\n}\r\n\r\nexport function ready(player)\r\n{\r\n  m.player = player;\r\n  m.trackElement.classList.add('current');\r\n\r\n  playbackEvents.addListener(playbackEvents.EVENT.MEDIA_LOADING,  () => setCurrentTrackState(STATE.LOADING));\r\n  playbackEvents.addListener(playbackEvents.EVENT.MEDIA_PLAYING,  () => setCurrentTrackState(STATE.PLAYING));\r\n  playbackEvents.addListener(playbackEvents.EVENT.MEDIA_CUE_NEXT, (event) => setNextTrackState(event.data.nextTrackId, event.data.isPointerClick));\r\n\r\n  if (settings.list.showLoadMoreTracks)\r\n    initLoadMoreTracks();\r\n}\r\n\r\nfunction observerCallback(entries)\r\n{\r\n  m.tracklistObserver.unobserve(m.trackElement);\r\n\r\n  if ((Math.ceil(entries[0].intersectionRatio * 100) / 100) !== 1)\r\n    m.tracklist.scrollTop = (m.trackElement.offsetTop - m.tracklist.offsetHeight) + m.trackElement.offsetHeight;    \r\n}\r\n\r\n\r\n// ************************************************************************************************\r\n//\r\n// ************************************************************************************************\r\n\r\nexport function queryTrack(selectors)\r\n{\r\n  return m.tracklist.querySelector(selectors);\r\n}\r\n\r\nexport function queryTrackAll(selectors)\r\n{\r\n  return m.tracklist.querySelectorAll(selectors);\r\n}\r\n\r\nexport function queryTrackId(id)\r\n{\r\n  return document.getElementById(id);\r\n}\r\n\r\nexport function getCurrentTrackElement()\r\n{\r\n  return m.trackElement;\r\n}\r\n\r\nexport function getTrackType(element)\r\n{\r\n  const trackType = element.getAttribute('data-track-type');\r\n\r\n  if (trackType !== null)\r\n    return parseInt(trackType);\r\n  \r\n  return TRACK_TYPE.NONE;\r\n}\r\n\r\nexport function getPrevPlayableId()\r\n{\r\n  let destElement = (m.trackElement !== null)\r\n                      ? m.trackElement.previousElementSibling\r\n                      : null;\r\n\r\n  while ((destElement !== null) && (getTrackType(destElement) !== TRACK_TYPE.YOUTUBE))\r\n    destElement = destElement.previousElementSibling;\r\n\r\n  return ((destElement !== null) ? destElement.id : null);\r\n}\r\n\r\nexport function getNextPlayableId(startElement = m.trackElement)\r\n{\r\n  let destElement = (startElement !== null)\r\n                      ? startElement.nextElementSibling\r\n                      : queryTrack('div.track-entry');\r\n\r\n  while ((destElement !== null) && (getTrackType(destElement) !== TRACK_TYPE.YOUTUBE))\r\n    destElement = destElement.nextElementSibling;\r\n  \r\n  return ((destElement !== null) ? destElement.id : null);\r\n}\r\n\r\nexport function setCuedTrack(trackId)\r\n{\r\n  m.trackElement = queryTrackId(trackId);\r\n  m.tracklistObserver.observe(m.trackElement);\r\n}\r\n\r\n\r\n// ************************************************************************************************\r\n//\r\n// ************************************************************************************************\r\n\r\nclass UiElements extends ElementClick\r\n{\r\n  constructor(selectors, setCurrentTrackCallback)\r\n  {\r\n    super(selectors);\r\n    this.setCurrentTrack = setCurrentTrackCallback;\r\n  }\r\n\r\n  elementClicked()\r\n  {\r\n    if (this.clicked('div.thumbnail'))\r\n      return this.setCurrentTrack(this.closest('div.track-entry').id, true, true);\r\n  \r\n    if (this.clicked('div.track-actions-toggle'))\r\n      return trackActionsClick(this.closest('div.track-entry'));\r\n  \r\n    if (this.clicked('div.remove-button'))\r\n      return removeClick(this.closest('div.track-entry'));\r\n  \r\n    if (this.clicked('div.play-next-button'))\r\n      return playNextClick(this.closest('div.track-entry'));\r\n  \r\n    if (this.clicked('span.arrow-up-button'))\r\n      return arrowUpDownClick(this.closest('div.tracklist-page-separator'), true);\r\n  \r\n    if (this.clicked('span.arrow-down-button'))\r\n      return arrowUpDownClick(this.closest('div.tracklist-page-separator'), false);      \r\n  }\r\n}\r\n\r\nfunction trackActionsClick(element)\r\n{\r\n  const trackActionButtons = element.querySelector('.track-action-buttons');\r\n\r\n  if ((m.prevActionButtons !== null) && (m.prevActionButtons !== trackActionButtons))\r\n    m.prevActionButtons.style.display = '';\r\n\r\n  if (trackActionButtons.style.display === '')\r\n    trackActionButtons.style.display = 'flex';\r\n  else\r\n    trackActionButtons.style.display = '';\r\n\r\n  m.prevActionButtons = trackActionButtons;\r\n}\r\n\r\nfunction playNextClick(trackElement)\r\n{\r\n  if (m.trackElement !== null)\r\n  {\r\n    const nextTrackElement = trackElement.cloneNode(true);\r\n    \r\n    clearTrackState(nextTrackElement);\r\n    nextTrackElement.id = Date.now();\r\n\r\n    if (settings.list.moveTrackOnPlayNext && (trackElement !== m.trackElement))\r\n      removeClick(trackElement, false, () => addTrack(nextTrackElement, m.trackElement, 'afterend'));\r\n    else\r\n      addTrack(nextTrackElement, m.trackElement, 'afterend'); \r\n\r\n    showSnackbar('Track will play next', 3);\r\n  }\r\n  else\r\n  {\r\n    showSnackbar('Unable to cue track', 3);\r\n  }\r\n}\r\n\r\nfunction removeClick(trackElement, allowUndo = true, animationEndCallback = () => {})\r\n{\r\n  if (trackElement !== m.trackElement)\r\n  {\r\n    const undoRemoveElement = trackElement.cloneNode(true);\r\n    const undoPrevElement   = trackElement.previousElementSibling;\r\n\r\n    trackElement.addEventListener('animationend', () =>\r\n    {\r\n      trackElement.remove();\r\n      animationEndCallback();\r\n    });\r\n    \r\n    trackElement.classList.add('removing');\r\n\r\n    if (allowUndo)\r\n    {\r\n      showSnackbar('Track removed', 4, 'undo', () =>\r\n      {\r\n        addTrack(undoRemoveElement,\r\n                ((undoPrevElement === null) ? m.tracklist  : undoPrevElement),\r\n                ((undoPrevElement === null) ? 'afterbegin' : 'afterend'));\r\n      });\r\n    }\r\n  }\r\n}\r\n\r\nfunction addTrack(trackElement, targetElement, insertPosition)\r\n{\r\n  trackElement.classList.add('adding');\r\n  trackElement.querySelector('.track-action-buttons').style.display = '';\r\n  trackElement.addEventListener('animationend', () => trackElement.classList.remove('adding'));\r\n  targetElement.insertAdjacentElement(insertPosition, trackElement);\r\n}\r\n\r\nfunction arrowUpDownClick(targetElement, isArrowUpClick)\r\n{\r\n  const pageNumber  = parseInt(targetElement.getAttribute('data-page-number'));\r\n  const gotoPageNum = isArrowUpClick ? (pageNumber - 1) : (pageNumber + 1);\r\n  let gotoElement   = document.getElementById(`tracklist-page-${gotoPageNum}`);\r\n  let blockOption   = 'center';\r\n\r\n  if (gotoElement === null)\r\n  {\r\n    gotoElement = isArrowUpClick ? m.tracklist.firstElementChild : m.tracklist.lastElementChild;\r\n    blockOption = isArrowUpClick ? 'end' : ((window.innerWidth > 1350) ? 'nearest' : 'center');\r\n\r\n    if ((isArrowUpClick === false) && (gotoPageNum > response.maxPages))\r\n      gotoElement = gotoElement?.previousElementSibling;\r\n  }\r\n\r\n  gotoElement?.scrollIntoView({ behavior: (settings.site.smoothScrolling ? 'smooth' : 'auto'), block: blockOption });\r\n}\r\n\r\n\r\n// ************************************************************************************************\r\n//\r\n// ************************************************************************************************\r\n\r\nfunction initLoadMoreTracks()\r\n{\r\n  if (response.params.all     ||\r\n      response.params.channel ||\r\n      response.params.artist  ||\r\n      response.params.shuffle ||\r\n      response.params.search)\r\n  {\r\n    if ((response.nextPage !== null) && (response.currentPage < response.maxPages))\r\n    {\r\n      m.tracklistLoadMore = document.getElementById('tracklist-load-more');\r\n      m.tracklistLoadMore.querySelector('.load-more-title span').textContent = ` ( ${response.currentPage + 1} / ${response.maxPages} )`;\r\n      m.tracklistLoadMore.style.display = 'block';\r\n      m.tracklistLoadMore.addEventListener('click', loadMoreTracks);\r\n    }\r\n  }\r\n}\r\n\r\nexport async function loadMoreTracks()\r\n{\r\n  let tracksLoaded = false;\r\n  \r\n  if ((response.currentPage + 1) <= response.maxPages)\r\n  {\r\n    setIsLoadingTracks(true);\r\n    tracksLoaded = await loadTracks(stripAttribute(m.tracklist, 'data-term-type'), stripAttribute(m.tracklist, 'data-term-id'));\r\n    setIsLoadingTracks(false);\r\n\r\n    if (tracksLoaded)\r\n    {\r\n      response.currentPage++;\r\n      m.tracklistLoadMore.querySelector('.load-more-title span').textContent = ` ( ${response.currentPage + 1} / ${response.maxPages} )`;\r\n    }\r\n    else\r\n    {\r\n      showSnackbar('Load more tracks failed!', 10, 'Retry', () => loadMoreTracks());\r\n    }\r\n  }\r\n  \r\n  if (response.currentPage >= response.maxPages)\r\n    m.tracklistLoadMore.style.display = 'none';\r\n\r\n  return tracksLoaded;\r\n}\r\n\r\nfunction setIsLoadingTracks(isLoadingTracks)\r\n{\r\n  m.tracklistLoadMore.style.pointerEvents                              = isLoadingTracks ? 'none'  : 'unset';\r\n  m.tracklistLoadMore.querySelector('.load-more-title').style.display  = isLoadingTracks ? 'none'  : 'block';\r\n  m.tracklistLoadMore.querySelector('.load-more-loader').style.display = isLoadingTracks ? 'block' : 'none';\r\n}\r\n\r\n\r\n// ************************************************************************************************\r\n//\r\n// ************************************************************************************************\r\n\r\nfunction clearTrackState(element)\r\n{\r\n  element.classList.remove('current', STATE.LOADING.CLASS, STATE.PLAYING.CLASS, STATE.PAUSED.CLASS);\r\n}\r\n\r\nexport function setCurrentTrackState(newState)\r\n{\r\n  if (m.currentState.ID !== newState.ID)\r\n  {\r\n    m.currentState = newState;\r\n\r\n    if (newState.ID === STATE.LOADING.ID)\r\n    {\r\n      m.trackElement.classList.remove(STATE.PAUSED.CLASS, STATE.PLAYING.CLASS);\r\n      m.trackElement.classList.add(STATE.LOADING.CLASS);\r\n    }\r\n    else\r\n    {\r\n      m.trackElement.classList.remove(STATE.LOADING.CLASS);\r\n    \r\n      if (newState.ID === STATE.PLAYING.ID)\r\n        replaceClass(m.trackElement, STATE.PAUSED.CLASS, STATE.PLAYING.CLASS);\r\n      else\r\n        replaceClass(m.trackElement, STATE.PLAYING.CLASS, STATE.PAUSED.CLASS);\r\n\r\n      upNextModal.updateUpNextModal((newState.ID === STATE.PLAYING.ID) ? true : false);\r\n    }\r\n  }\r\n}\r\n\r\nfunction setPlayerAspectRatio()\r\n{\r\n  if (m.trackElement.classList.contains('is-video'))\r\n    m.playerWrapper.classList.replace('aspect-ratio-1_1', 'aspect-ratio-16_9');\r\n  else\r\n    m.playerWrapper.classList.replace('aspect-ratio-16_9', 'aspect-ratio-1_1');\r\n}\r\n\r\nexport function setNextTrackState(nextTrackId, isPointerClick)\r\n{\r\n  clearTrackState(m.trackElement);\r\n\r\n  m.trackElement = queryTrackId(nextTrackId);\r\n\r\n  if (isPointerClick === false)\r\n    m.tracklistObserver.observe(m.trackElement);\r\n\r\n  m.trackElement.classList.add('current');\r\n}\r\n\r\nexport function setTrackMessage(message)\r\n{\r\n  m.trackElement.querySelector('.track-message').textContent   = message;\r\n  m.trackElement.querySelector('.track-message').style.display = 'block';\r\n}\r\n\r\nexport function updateTrackDetails()\r\n{\r\n  const sourceUid = m.trackElement.getAttribute('data-track-source-uid');\r\n  \r\n  m.player.setArtistTitle(m.trackElement.getAttribute('data-track-artist'), m.trackElement.getAttribute('data-track-title'));\r\n  m.player.setDuration(parseInt(m.trackElement.getAttribute('data-track-duration')));\r\n  m.player.setThumbnail(sourceUid);\r\n  setPlayerAspectRatio();\r\n\r\n  return sourceUid;\r\n}\r\n", "//\r\n// Modal dialog template functions\r\n//\r\n// https://ultrafunk.com\r\n//\r\n\r\n\r\nimport { TRACK_TYPE } from '../playback/mediaplayers.js';\r\n\r\n\r\n/*************************************************************************************************/\r\n\r\n\r\nexport const config = { id: 'modal-dialog' };\r\n\r\n\r\n// ************************************************************************************************\r\n//\r\n// ************************************************************************************************\r\n\r\nexport function getTemplateHtml()\r\n{\r\n  return /*html*/ `\r\n    <div id=\"${config.id}-overlay\" tabindex=\"-1\">\r\n      <div id=\"${config.id}-container\">\r\n        <div class=\"${config.id}-header\">\r\n          <div class=\"${config.id}-title\"></div>\r\n          <div class=\"${config.id}-close-icon\"><span class=\"material-icons\" title=\"Dismiss (esc)\">close</span></div>\r\n        </div>\r\n        <div class=\"${config.id}-body\"></div>\r\n        <div class=\"${config.id}-footer\"><div class=\"modal-dialog-close-button\" title=\"Dismiss (esc)\">Close</div></div>\r\n      </div>\r\n    </div>`;\r\n}\r\n\r\nexport function getSingleChoiceListHtml(singleChoiceList)\r\n{\r\n  let html = '';\r\n\r\n  singleChoiceList.forEach((entry, index) =>\r\n  {\r\n    const entryClass   = entry.class ? `modal-${entry.class}`                                       : 'modal-icon-text';\r\n    const entryTitle   = entry.title ? entry.title                                                  : '';\r\n    const entryIcon    = entry.icon  ? `<span class=\"material-icons\">${entry.icon}</span>`          : '';\r\n    const entryContent = entry.icon  ? `<span class=\"text-nowrap-ellipsis\">${entry.content}</span>` : entry.content;\r\n    entry.uid          = `modal-item-${index + 1}`;\r\n  \r\n    if (entry.clickId)\r\n      html += `<div id=\"${entry.uid}\" data-click-id=\"${entry.clickId}\" class=\"modal-click-item ${entryClass}\" title=\"${entryTitle}\">${entryIcon}${entryContent}</div>`;\r\n    else\r\n      html += `<div class=\"${entryClass}\" title=\"${entryTitle}\">${entryIcon}${entryContent}</div>`;\r\n  });\r\n\r\n  return html;\r\n}\r\n\r\nexport function getModalTrackHtml(element, trackArtist, trackTitle)\r\n{\r\n  const trackTypeClass = (parseInt(element.getAttribute('data-track-type')) === TRACK_TYPE.YOUTUBE) ? 'type-youtube' : 'type-soundcloud';\r\n\r\n  return /*html*/ `\r\n    <div class=\"modal-track\">\r\n      <div class=\"modal-track-thumbnail ${trackTypeClass}\">\r\n        <img src=\"${encodeURI(element.getAttribute('data-track-thumbnail-url'))}\">\r\n      </div>\r\n      <div class=\"modal-track-artist-title\">\r\n        <span><b>${trackArtist}</b></span><br>\r\n        <span class=\"light-text\">${trackTitle}</span>\r\n      </div>\r\n    </div>`;\r\n}\r\n", "//\r\n// Modal dialog UI module\r\n//\r\n// https://ultrafunk.com\r\n//\r\n\r\n\r\nimport * as debugLogger from './debuglogger.js';\r\nimport { settings }     from './session-data.js';\r\n\r\nimport {\r\n  config,\r\n  getTemplateHtml,\r\n  getSingleChoiceListHtml,\r\n} from './modal-templates.js';\r\n\r\n\r\n/*************************************************************************************************/\r\n\r\n\r\nconst debug = debugLogger.newInstance('modal');\r\n\r\nconst m = {\r\n  onEntryClicked:   null,\r\n  onClickClose:     null,\r\n  modalId:          0,\r\n  isOverflowY:      false,\r\n  ignoreTouchMove:  false,\r\n  isTouchDraggable: false,\r\n};\r\n\r\nconst elements = {\r\n  overlay:   null,\r\n  container: null,\r\n  body:      null,\r\n};\r\n\r\n\r\n// ************************************************************************************************\r\n//\r\n// ************************************************************************************************\r\n\r\nexport function showModal(\r\n  modalTitle = 'Modal Title',\r\n  modalBody  = 'Modal Body',\r\n  modalType  = null,\r\n  onEntryClickedCallback = () => {},\r\n  onClickCloseCallback = () => true\r\n)\r\n{\r\n  init();\r\n  \r\n  if (Array.isArray(modalBody) && (modalBody.length > 0))\r\n    setSingleChoiceList(modalBody);\r\n  else\r\n    elements.body.innerHTML = modalBody;  \r\n\r\n  m.onEntryClicked = onEntryClickedCallback;\r\n  m.onClickClose   = onClickCloseCallback;\r\n\r\n  elements.container.classList = `modal-type-${(modalType !== null) ? modalType : 'default'}`;\r\n  elements.container.querySelector(`.${config.id}-title`).innerHTML = modalTitle;\r\n\r\n  elements.overlay.style.backgroundColor = `rgba(0, 0, 0, ${Math.round(10 * (settings.site.modalOverlayOpacity / 100)) / 10})`;\r\n  elements.overlay.classList.add('show');\r\n  elements.overlay.addEventListener('keydown', keyDown);\r\n  elements.overlay.focus();\r\n\r\n  disablePageScrolling(true);\r\n\r\n  m.modalId++;\r\n\r\n  debug.log(`showModal() - modalId: ${m.modalId} - modalType: ${(modalType !== null) ? modalType : 'default'} - modalTitle: ${modalTitle}`);\r\n\r\n  return `${config.id}-container`;\r\n}\r\n\r\nexport function isShowingModal(showingModalId = -1)\r\n{\r\n  return ((showingModalId === m.modalId) && (elements.container !== null) && (elements.overlay.classList.contains('show')));\r\n}\r\n\r\nexport function closeModal()\r\n{\r\n  document.body.removeEventListener('touchmove', touchMove, { passive: false });\r\n  document.body.removeEventListener('touchstart', touchStart);\r\n  elements.overlay.removeEventListener('keydown', keyDown);\r\n  elements.overlay.classList.replace('show', 'hide');\r\n}\r\n\r\nexport function getModalId()\r\n{\r\n  return m.modalId;\r\n}\r\n\r\nexport function getModalEntry(entryNum)\r\n{\r\n  return document.getElementById(`modal-item-${entryNum}`);\r\n}\r\n\r\nexport function updateModalTitle(updateModalId, updateTitle)\r\n{\r\n  if (updateModalId === m.modalId)\r\n    elements.container.querySelector(`.${config.id}-title`).innerHTML = updateTitle;\r\n}\r\n\r\nexport function updateModalBody(updateModalId, updateSingleChoiceList)\r\n{\r\n  if (updateModalId === m.modalId)\r\n    setSingleChoiceList(updateSingleChoiceList);\r\n}\r\n\r\n\r\n// ************************************************************************************************\r\n//\r\n// ************************************************************************************************\r\n\r\nfunction init()\r\n{\r\n  if (elements.container === null)\r\n  {\r\n    document.body.insertAdjacentHTML('beforeend', getTemplateHtml());\r\n    \r\n    elements.overlay   = document.getElementById(`${config.id}-overlay`);\r\n    elements.container = document.getElementById(`${config.id}-container`);\r\n    elements.body      = elements.overlay.querySelector(`.${config.id}-body`);\r\n\r\n    elements.overlay.addEventListener('click', (event) =>\r\n    {\r\n      if (event.target === elements.overlay)\r\n        closeModal();\r\n    });\r\n\r\n    elements.overlay.addEventListener('animationend', () =>\r\n    {\r\n      if (elements.overlay.classList.contains('hide'))\r\n      {\r\n        elements.overlay.className = '';\r\n        disablePageScrolling(false);\r\n      }\r\n    });\r\n\r\n    elements.overlay.querySelector(`.${config.id}-close-icon`).addEventListener('click', closeModal);\r\n    elements.overlay.querySelector(`.${config.id}-close-button`).addEventListener('click', closeModal);\r\n  }\r\n}\r\n\r\nfunction setSingleChoiceList(singleChoiceList)\r\n{\r\n  elements.body.innerHTML = getSingleChoiceListHtml(singleChoiceList);\r\n  \r\n  singleChoiceList.forEach(entry =>\r\n  {\r\n    if (entry.clickId)\r\n      elements.body.querySelector(`#${entry.uid}`).addEventListener('click', singleChoiceListClick);\r\n  });\r\n}\r\n\r\nfunction singleChoiceListClick(event)\r\n{\r\n  if (m.onClickClose(event) === true)\r\n  {\r\n    closeModal();\r\n    setTimeout(() => m.onEntryClicked(this.getAttribute('data-click-id'), event), 150);\r\n  }\r\n}\r\n\r\nfunction keyDown(event)\r\n{\r\n  event.stopPropagation();\r\n\r\n  if (event.key === 'Escape')\r\n    closeModal();\r\n}\r\n\r\nfunction disablePageScrolling(disableScrolling)\r\n{\r\n  const scrollbarWidth = window.innerWidth - document.documentElement.clientWidth;\r\n  \r\n  document.documentElement.style.overflowY                  = disableScrolling ? 'hidden'              : '';\r\n  document.documentElement.style.paddingRight               = disableScrolling ? `${scrollbarWidth}px` : '';\r\n  document.getElementById('site-header').style.paddingRight = disableScrolling ? `${scrollbarWidth}px` : '';\r\n\r\n  if (disableScrolling && ('ontouchstart' in window))\r\n  {\r\n    document.body.addEventListener('touchstart', touchStart);\r\n    document.body.addEventListener('touchmove',  touchMove, { passive: false });\r\n  }\r\n}\r\n\r\nfunction touchStart(event)\r\n{\r\n  m.isOverflowY      = (elements.container.scrollHeight > elements.container.clientHeight);\r\n  m.ignoreTouchMove  = (true   === event.target.classList.contains('modal-ignore-touchmove'));\r\n  m.isTouchDraggable = ('true' === event.target.closest('.modal-draggable-entry')?.getAttribute('draggable'));\r\n}\r\n\r\nfunction touchMove(event)\r\n{\r\n  if (m.isOverflowY)\r\n    return;\r\n\r\n  if ((m.isTouchDraggable === false) || m.ignoreTouchMove)\r\n    event.preventDefault();\r\n}\r\n", "//\r\n// List-player Up Next modal module\r\n//\r\n// https://ultrafunk.com\r\n//\r\n\r\n\r\nimport * as debugLogger from '../../shared/debuglogger.js';\r\nimport { autoplay }     from '../footer-toggles.js';\r\nimport { settings }     from '../../shared/session-data.js';\r\nimport { isPlaying }    from '../playback-controls.js';\r\nimport { TRACK_TYPE }   from '../mediaplayers.js';\r\nimport { showSnackbar } from '../../shared/snackbar.js';\r\n\r\nimport {\r\n  addListener,\r\n  escAttribute,\r\n  getTimeString,\r\n} from '../../shared/utils.js';\r\n\r\nimport {\r\n  queryTrackId,\r\n  getNextPlayableId,\r\n  getCurrentTrackElement,\r\n} from './list-controls.js';\r\n\r\nimport {\r\n  showModal,\r\n  isShowingModal,\r\n  getModalId,\r\n  getModalEntry,\r\n  updateModalTitle,\r\n  updateModalBody,\r\n} from '../../shared/modal.js';\r\n\r\n\r\n/*************************************************************************************************/\r\n\r\n\r\nconst debug = debugLogger.newInstance('up-next-modal');\r\n\r\nconst m = {\r\n  setCurrentTrack: null,\r\n  modalDialogId:   null,\r\n  upNextModalId:   0,\r\n  dragStartY:      0,\r\n  dragEntryId:     null,\r\n};\r\n\r\n\r\n// ************************************************************************************************\r\n//\r\n// ************************************************************************************************\r\n\r\nexport function init(setCurrentTrackCallback)\r\n{\r\n  m.setCurrentTrack = setCurrentTrackCallback;\r\n}\r\n\r\nfunction loadDragDropTouch()\r\n{\r\n  if (('ontouchstart' in window) && (document.getElementById('drag-drop-touch') === null))\r\n  {\r\n    debug.log('Loading drag-drop-touch.js...');\r\n\r\n    const tag = document.createElement('script');\r\n    tag.type  = 'text/javascript';\r\n    tag.id    = 'drag-drop-touch';\r\n    tag.src   = debug.isDebug()\r\n                  ? 'https://wordpress.ultrafunk.com/wp-content/themes/ultrafunk/inc/js/drag-drop-touch.js?ver=1.44.19'\r\n                  : 'https://ultrafunk.com/wp-content/themes/ultrafunk/inc/js/drag-drop-touch.min.js?ver=1.44.19';\r\n    const firstScriptTag = document.getElementsByTagName('script')[0];\r\n    firstScriptTag.parentNode.insertBefore(tag, firstScriptTag);\r\n  }\r\n}\r\n\r\n\r\n// ************************************************************************************************\r\n//\r\n// ************************************************************************************************\r\n\r\nexport function showUpNextModal()\r\n{\r\n  // Only load this dependency IF we actually need it...\r\n  loadDragDropTouch();\r\n\r\n  const modalEntries = getEntries(isPlaying());\r\n\r\n  if (modalEntries.length > 2)\r\n  {\r\n    m.modalDialogId = showModal(getTitle(isPlaying()), modalEntries, 'tracklist', (clickedId) =>\r\n    {\r\n      const nextTrackId = modalEntries.find(item => (item.clickId === clickedId)).clickId;\r\n\r\n      if ((nextTrackId === getCurrentTrackElement().id) && isPlaying())\r\n        getCurrentTrackElement().scrollIntoView({ behavior: (settings.site.smoothScrolling ? 'smooth' : 'auto'), block: 'center' });\r\n      else\r\n        m.setCurrentTrack(nextTrackId, true, false);\r\n    },\r\n    (event) => \r\n    {\r\n      if (event.target.closest('#modal-item-1'))\r\n        return true;\r\n      else if (event.target.classList.contains('modal-track-thumbnail'))\r\n        return true;\r\n\r\n      return false;\r\n    });\r\n\r\n    m.upNextModalId = getModalId();\r\n\r\n    addTitleListener();\r\n    addDragDropListeners();\r\n  }\r\n  else\r\n  {\r\n    showSnackbar('No more tracks to play!', 5);\r\n  }\r\n}\r\n\r\nexport function updateUpNextModal(isPlayingTrack)\r\n{\r\n  if (isShowingModal(m.upNextModalId))\r\n  {\r\n    updateModalTitle(m.upNextModalId, getTitle(isPlayingTrack));\r\n    addTitleListener();\r\n  \r\n    const modalEntry = getModalEntry(1);\r\n  \r\n    if (modalEntry.getAttribute('data-click-id') === getCurrentTrackElement().id)\r\n    {\r\n      modalEntry.classList.remove('playing-track', 'cued-track');\r\n      modalEntry.classList.add(`${isPlayingTrack ? 'playing-track' : 'cued-track'}`);\r\n      modalEntry.title = `${isPlayingTrack ? 'Go To Track' : 'Play Track'}`;\r\n    }\r\n    else\r\n    {\r\n      updateModalBody(m.upNextModalId, getEntries(isPlayingTrack));\r\n      addDragDropListeners();\r\n    }\r\n  }\r\n}\r\n\r\nfunction getTitle(isPlayingTrack)\r\n{\r\n  return /*html*/ `${isPlayingTrack ? 'Playing' : 'Cued'}\r\n            <span class=\"light-text lowercase-text toggle-element\" title=\"Toggle Autoplay\">\r\n            Autoplay is <b>${settings.playback.autoplay ? 'On' : 'Off'}</b></span>`;\r\n}\r\n\r\nfunction getEntries(isPlayingTrack)\r\n{\r\n  const modalEntries = [];\r\n  let trackElement   = getCurrentTrackElement();\r\n\r\n  modalEntries.push({\r\n    clickId: trackElement.id,\r\n    class:   `tracklist-entry ${isPlayingTrack ? 'playing-track' : 'cued-track'}`,\r\n    title:   `${isPlayingTrack ? 'Go To Track' : 'Play Track'}`,\r\n    content: getUpNextTrackHtml(trackElement, 'data-track-artist', 'data-track-title'),\r\n  });\r\n\r\n  modalEntries.push({ class: 'header-entry', content: 'Up Next' });\r\n\r\n  for (let i = 0; i < 10; i++)\r\n  {\r\n    trackElement = queryTrackId(getNextPlayableId(trackElement));\r\n\r\n    if (trackElement === null)\r\n      break;\r\n\r\n    modalEntries.push({\r\n      clickId: trackElement.id,\r\n      class:   'tracklist-entry',\r\n      content: getUpNextTrackHtml(trackElement, 'data-track-artist', 'data-track-title', true),\r\n    });\r\n  }\r\n\r\n  return modalEntries;\r\n}\r\n\r\nfunction addTitleListener()\r\n{\r\n  addListener(`#${m.modalDialogId} .modal-dialog-title span`, 'click', (event) => \r\n  {\r\n    autoplay.toggle();\r\n    event.target.closest('span').innerHTML = `Autoplay is <b>${settings.playback.autoplay ? 'On' : 'Off'}</b>`;\r\n  });\r\n}\r\n\r\n\r\n// ************************************************************************************************\r\n//\r\n// ************************************************************************************************\r\n\r\nfunction addDragDropListeners()\r\n{\r\n  document.querySelectorAll('.modal-tracklist-entry')?.forEach((element) =>\r\n  {\r\n    if (element.id !== 'modal-item-1')\r\n    {\r\n      element.addEventListener('mousedown', mouseDown);\r\n      element.addEventListener('dragstart', dragStart);\r\n      element.addEventListener('dragover',  dragOver);\r\n      element.addEventListener('drop',      dragDrop);\r\n    }\r\n  });\r\n}\r\n\r\n// Disable drag & drop for track play button (modal-track-thumbnail)\r\nfunction mouseDown(event)\r\n{\r\n  if (event.target.classList.contains('modal-track-thumbnail'))\r\n    event.preventDefault();\r\n}\r\n\r\nfunction dragStart(event)\r\n{\r\n  m.dragStartY  = event.clientY;\r\n  m.dragEntryId = event.target.closest('div.modal-tracklist-entry').id;\r\n  event.dataTransfer.effectAllowed = 'move';\r\n}\r\n\r\nfunction dragOver(event)\r\n{\r\n  event.preventDefault();\r\n  event.dataTransfer.dropEffect = 'move';\r\n  return false;\r\n}\r\n\r\nfunction dragDrop(event)\r\n{\r\n  event.preventDefault();\r\n\r\n  const insertPos = (event.clientY  > m.dragStartY) ? 'afterend' : 'beforebegin';\r\n  \r\n  // Modal tracks drag & drop reorder\r\n  const modalDragSource = document.getElementById(m.dragEntryId);\r\n  const modalDropTarget = event.target.closest('div.modal-tracklist-entry');\r\n  modalDropTarget.insertAdjacentElement(insertPos, modalDragSource);\r\n\r\n  // List player tracks drag & drop reorder = sync track lists\r\n  const listTrackSource = document.getElementById(modalDragSource.getAttribute('data-click-id'));\r\n  const listTrackTarget = document.getElementById(modalDropTarget.getAttribute('data-click-id'));\r\n  listTrackTarget.insertAdjacentElement(insertPos, listTrackSource);\r\n\r\n  return false;\r\n}\r\n\r\n\r\n// ************************************************************************************************\r\n//\r\n// ************************************************************************************************\r\n\r\nfunction getUpNextTrackHtml(element, trackArtistAttr, trackTitleAttr, isDraggable = false)\r\n{\r\n  const trackTypeClass = (parseInt(element.getAttribute('data-track-type')) === TRACK_TYPE.YOUTUBE) ? 'type-youtube' : 'type-soundcloud';\r\n\r\n  return /*html*/ `\r\n    <div class=\"modal-track ${isDraggable ? 'modal-draggable-entry' : ''}\" ${isDraggable ? 'draggable=\"true\"' : ''}>\r\n      <div class=\"modal-track-thumbnail modal-ignore-touchmove ${trackTypeClass}\" ${isDraggable ? 'title=\"Click to Play Track\"' : ''}>\r\n        <img src=\"${encodeURI(element.getAttribute('data-track-thumbnail-url'))}\">\r\n      </div>\r\n      <div class=\"modal-track-artist-title text-nowrap-ellipsis\" ${isDraggable ? 'title=\"Drag to Move Track\"' : ''}>\r\n        <span><b>${escAttribute(element, trackArtistAttr)}</b></span><br>\r\n        <span class=\"light-text\">${escAttribute(element, trackTitleAttr)}</span>\r\n      </div>\r\n      <div class=\"modal-track-duration text-nowrap-ellipsis\" ${isDraggable ? 'title=\"Drag to Move Track\"' : ''}>\r\n        ${getTimeString(parseInt(element.getAttribute('data-track-duration')))}\r\n      </div>\r\n      ${isDraggable ? getModalTrackButtons() : ''}\r\n    </div>`;\r\n}\r\n\r\nfunction getModalTrackButtons()\r\n{\r\n  return /*html*/ `\r\n    <div class=\"modal-track-buttons\">\r\n      <div class=\"drag-drop-button\" title=\"Drag to Move Track\"><span class=\"material-icons\">drag_handle</span></div>\r\n    </div>`;\r\n}\r\n", "//\r\n// Shared gallery and list-player functionality\r\n//\r\n// https://ultrafunk.com\r\n//\r\n\r\n\r\nimport * as debugLogger       from '../shared/debuglogger.js';\r\nimport { KEY, setCookie }     from '../shared/storage.js';\r\nimport { showUpNextModal }    from './list/up-next-modal.js';\r\nimport { response, settings } from '../shared/session-data.js';\r\n\r\nimport {\r\n  getCssPropValue,\r\n  getPrefPlayerUrl,\r\n  navToUrl,\r\n} from '../shared/utils.js';\r\n\r\n\r\n/*************************************************************************************************/\r\n\r\n\r\nconst debug = debugLogger.newInstance('shared-gallery-list');\r\n\r\nexport const PLAYER_TYPE = {\r\n  NONE:    0,\r\n  GALLERY: 1,\r\n  LIST:    2,\r\n};\r\n\r\nconst isPlayer = {\r\n  gallery: false,\r\n  list:    false,\r\n};\r\n\r\n\r\n// ************************************************************************************************\r\n//\r\n// ************************************************************************************************\r\n\r\nexport function hasGalleryPlayer()\r\n{\r\n  isPlayer.gallery = (document.body.getAttribute('data-player-type') === 'gallery');\r\n  return isPlayer.gallery;\r\n}\r\n\r\nexport function hasListPlayer()\r\n{\r\n  isPlayer.list = (document.body.getAttribute('data-player-type') === 'list');\r\n  return isPlayer.list;\r\n}\r\n\r\nexport function noPlayback()\r\n{\r\n  return ((isPlayer.gallery === false) && (isPlayer.list === false));\r\n}\r\n\r\nexport function isGalleryPlayer() { return isPlayer.gallery; }\r\nexport function isListPlayer()    { return isPlayer.list;    }\r\n\r\nexport function shuffleClickNavTo(event)\r\n{\r\n  event?.preventDefault();\r\n  setCookie(KEY.UF_RESHUFFLE, 'true');\r\n  navToUrl(getPrefPlayerUrl(response.shufflePath));\r\n}\r\n\r\nexport function autoplayNavTo(destUrl, continueAutoplay = false)\r\n{\r\n  debug.log(`autoplayNavTo(): ${destUrl} - continueAutoplay: ${continueAutoplay}`);\r\n  \r\n  if (destUrl)\r\n  {\r\n    sessionStorage.setItem(KEY.UF_AUTOPLAY, JSON.stringify({ autoplay: continueAutoplay, trackId: null, position: 0 }));\r\n    navToUrl(destUrl);\r\n  }\r\n}\r\n\r\n\r\n// ************************************************************************************************\r\n//\r\n// ************************************************************************************************\r\n\r\nexport function playerScrollTo(trackId = 0)\r\n{\r\n  isListPlayer() ? listPlayerScrollTo(trackId) : galleryPlayerScrollTo(trackId);\r\n}\r\n\r\nfunction scrollToYPos(element, destYPos)\r\n{\r\n  element.scroll(\r\n  {\r\n    top:      destYPos,\r\n    left:     0,\r\n    behavior: (settings.site.smoothScrolling ? 'smooth' : 'auto'),\r\n  });\r\n}\r\n\r\n\r\n// ************************************************************************************************\r\n//\r\n// ************************************************************************************************\r\n\r\nfunction listPlayerScrollTo(trackId = 0)\r\n{\r\n  if (trackId === 0)\r\n  {\r\n    let scrollDestPos = 0;\r\n\r\n    if ((window.pageYOffset === 0) || (Math.round(window.pageYOffset) <= 1))\r\n      scrollDestPos = getCssPropValue('--site-header-height') - getCssPropValue('--site-header-height-down');\r\n  \r\n    scrollToYPos(window, scrollDestPos);\r\n  }\r\n  else\r\n  {\r\n    if (settings.list.showUpNextModal)\r\n    {\r\n      showUpNextModal();\r\n    }\r\n    else\r\n    {\r\n      const trackElement = document.getElementById('tracklist').querySelector(`[data-track-id=\"${trackId}\"]`);\r\n      trackElement.scrollIntoView({ behavior: (settings.site.smoothScrolling ? 'smooth' : 'auto'), block: 'center' });\r\n    }\r\n  }\r\n}\r\n\r\nfunction galleryPlayerScrollTo(trackId)\r\n{\r\n  if (settings.gallery.autoScroll)\r\n  {\r\n    // Actual functional 'offsetTop' calculation: https://stackoverflow.com/a/52477551\r\n    const offsetTop    = Math.round(window.scrollY + document.getElementById(trackId).getBoundingClientRect().top);\r\n    const scrollTop    = Math.round(window.pageYOffset); // Don't want float results that can cause jitter\r\n    let   headerHeight = getScrollHeaderHeight(offsetTop > scrollTop);\r\n\r\n    // If we get obscured by the sticky header menu, recalculate headerHeight to account for that\r\n    if ((scrollTop + headerHeight + getContentMarginTop()) > offsetTop)\r\n      headerHeight = getScrollHeaderHeight(false);\r\n\r\n    scrollToYPos(window, (offsetTop - (headerHeight + getContentMarginTop())));\r\n  }\r\n\r\n  function getScrollHeaderHeight(isScrollDown)\r\n  {\r\n    return (isScrollDown\r\n             ? getCssPropValue('--site-header-height-down')\r\n             : getCssPropValue('--site-header-height-up'));\r\n  }\r\n  \r\n  function getContentMarginTop()\r\n  {\r\n    // -1 because of fractional pixels on HiDPI displays (iframe bottom 1 px would show on top)\r\n    return (getCssPropValue('--site-content-margin-top', document.body) - 1);\r\n  }\r\n}\r\n\r\n\r\n// ************************************************************************************************\r\n//\r\n// ************************************************************************************************\r\n\r\nexport function playerOnKeyScroll(event)\r\n{\r\n  if (isListPlayer() && (event.shiftKey === true) && (window.innerWidth > 1350))\r\n  {\r\n    const tracklist = document.getElementById('tracklist');\r\n\r\n    event.preventDefault();\r\n\r\n    if ((event.key === 'PageUp') || (event.key === 'PageDown'))\r\n    {\r\n      const scrollByPx = tracklist.offsetHeight - ((tracklist.offsetHeight * 10)  / 100);\r\n\r\n      tracklist.scrollBy(\r\n      {\r\n        top:      (event.key === 'PageUp') ? -scrollByPx : scrollByPx,\r\n        left:     0,\r\n        behavior: (settings.site.smoothScrolling ? 'smooth' : 'auto'),\r\n      });\r\n    }\r\n    else if ((event.key === 'Home') || (event.key === 'End'))\r\n    {\r\n      scrollToYPos(tracklist, ((event.key === 'Home') ? 0 : tracklist.scrollHeight));\r\n    }\r\n  }\r\n}\r\n\r\n\r\n// ************************************************************************************************\r\n// Fullscreen Element enter / exit / toggle closure\r\n// ************************************************************************************************\r\n\r\nconst fullscreenElementClosure = (() =>\r\n{\r\n  const fseEvent = new Event('fullscreenElement');\r\n  let fseTarget  = null;\r\n\r\n  return {\r\n    init,\r\n    enter,\r\n    exit,        \r\n    toggle,\r\n  };\r\n\r\n  function init()\r\n  {\r\n    document.addEventListener('fullscreenchange',       fullscreenChange);\r\n    document.addEventListener('webkitfullscreenchange', fullscreenChange);\r\n  }\r\n\r\n  function fullscreenChange()\r\n  {\r\n    fseTarget = (document.fullscreenElement !== null)\r\n                  ? document.fullscreenElement.id\r\n                  : null;\r\n    \r\n    fseEvent.fullscreenTarget = fseTarget;\r\n    document.dispatchEvent(fseEvent);\r\n  }\r\n\r\n  function enter(element)\r\n  {\r\n    element.requestFullscreen();\r\n  }\r\n  \r\n  function exit()\r\n  {\r\n    if (fseTarget !== null)\r\n    {\r\n      document.exitFullscreen();\r\n      fseTarget = null;\r\n    }\r\n  }\r\n\r\n  function toggle(element)\r\n  {\r\n    if (fseTarget === null)\r\n      enter(element);\r\n    else\r\n      exit();\r\n  }\r\n});\r\n\r\nexport const fullscreenElement = fullscreenElementClosure();\r\n\r\n\r\n// ************************************************************************************************\r\n// Allow / Deny keyboard shortcuts event handling closure\r\n// ************************************************************************************************\r\n\r\nconst keyboardShortcutsClosure = (() =>\r\n{\r\n  let allow = false;\r\n\r\n  return {\r\n    allow() { return allow; },\r\n    init,\r\n  };\r\n\r\n  function init()\r\n  {\r\n    allow = settings.playback.keyboardShortcuts;\r\n    \r\n    document.addEventListener('allowKeyboardShortcuts', () =>\r\n    {\r\n      if (settings.playback.keyboardShortcuts)\r\n        allow = true;\r\n    });\r\n    \r\n    document.addEventListener('denyKeyboardShortcuts', () =>\r\n    {\r\n      if (settings.playback.keyboardShortcuts)\r\n        allow = false;\r\n    });\r\n  }\r\n});\r\n\r\nexport const keyboardShortcuts = keyboardShortcutsClosure();\r\n", "//\r\n// Interaction footer toggle controls\r\n//\r\n// https://ultrafunk.com\r\n//\r\n\r\n\r\nimport ElementToggle          from '../shared/element-toggle.js';\r\nimport { showSnackbar }       from '../shared/snackbar.js';\r\nimport { response, settings } from '../shared/session-data.js';\r\n\r\nimport {\r\n  replaceClass,\r\n  getPrefPlayerUrl,\r\n  navToUrl,\r\n} from '../shared/utils.js';\r\n\r\nimport {\r\n  PLAYER_TYPE,\r\n  isListPlayer,\r\n} from './shared-gallery-list.js';\r\n\r\nimport {\r\n  KEY,\r\n  YEAR_IN_SECONDS,\r\n  setCookie,\r\n} from '../shared/storage.js';\r\n\r\n\r\n/*************************************************************************************************/\r\n\r\n\r\nexport let playerType = null;\r\nexport let crossfade  = null;\r\nexport let autoplay   = null;\r\n\r\n\r\n// ************************************************************************************************\r\n//\r\n// ************************************************************************************************\r\n\r\nexport function init(getPlayerStatus)\r\n{\r\n  playerType = new PlayerTypeToggle('footer-player-type-toggle', getPlayerStatus);\r\n\r\n  // Init crossfade before autoplay because autoplay can disable crossfade in update()\r\n  crossfade = new CrossfadeToggle('footer-crossfade-toggle');\r\n  autoplay  = new AutoplayToggle('footer-autoplay-toggle');\r\n}\r\n\r\n\r\n// ************************************************************************************************\r\n// Footer player type toggle: Gallery or List\r\n// ************************************************************************************************\r\n\r\nclass PlayerTypeToggle extends ElementToggle\r\n{\r\n  constructor(elementId, getPlayerStatus)\r\n  {\r\n    super(elementId);\r\n    this.getPlayerStatus = getPlayerStatus;\r\n  }\r\n  \r\n  toggle()\r\n  {\r\n    const destData = this.getDestData();\r\n  \r\n    settings.playback.preferredPlayer = isListPlayer() ? PLAYER_TYPE.GALLERY : PLAYER_TYPE.LIST;\r\n    setCookie(KEY.UF_PREFERRED_PLAYER, `${isListPlayer() ? PLAYER_TYPE.GALLERY : PLAYER_TYPE.LIST}`, (YEAR_IN_SECONDS * 5));\r\n    sessionStorage.setItem(KEY.UF_AUTOPLAY, JSON.stringify(destData.trackData));\r\n\r\n    navToUrl(getPrefPlayerUrl(this.getDestUrl(destData)));\r\n  }\r\n\r\n  update()\r\n  {\r\n    this.value = (settings.playback.preferredPlayer === PLAYER_TYPE.LIST) ? 'List' : 'Gallery';\r\n  }\r\n\r\n  getDestUrl(destData)\r\n  {\r\n    const isPagedRegEx = /\\/page\\/(?!0)\\d{1,6}/;\r\n    const sourceUrl    = window.location.href;\r\n    let destUrl        = null;\r\n\r\n    // Add destination pagination or remove pagination if needed\r\n    if ((destData.pageNum > 1) && (sourceUrl.match(isPagedRegEx) !== null))\r\n    {\r\n      destUrl = sourceUrl.replace(isPagedRegEx, `/page/${destData.pageNum}`);\r\n    }\r\n    else if (destData.pageNum > 1)\r\n    {\r\n      const url = new URL(decodeURIComponent(sourceUrl));\r\n      destUrl   = `${url.origin}${url.pathname}page/${destData.pageNum}/${url.search}`;\r\n    }\r\n    else\r\n    {\r\n      destUrl = sourceUrl.replace(isPagedRegEx, '');\r\n    }\r\n\r\n    return destUrl;\r\n  }\r\n  \r\n  getDestData()\r\n  {\r\n    const urlParts          = window.location.href.split('/');\r\n    const pageIndex         = urlParts.findIndex(part => (part.toLowerCase() === 'page'));\r\n    const currentPage       = (pageIndex !== -1)\r\n                                ? parseInt(urlParts[pageIndex + 1])\r\n                                : 1;\r\n    const trackData         = this.getPlayerStatus();\r\n    const tracksPerPageFrom = isListPlayer() ? response.listPerPage    : response.galleryPerPage;\r\n    const tracksPerPageTo   = isListPlayer() ? response.galleryPerPage : response.listPerPage;\r\n    const trackOffset       = trackData.currentTrack + ((currentPage - 1) * tracksPerPageFrom);\r\n  \r\n    return {\r\n      pageNum: Math.ceil(trackOffset / tracksPerPageTo),\r\n      trackData: {\r\n        autoplay: trackData?.isPlaying,\r\n        trackId:  trackData?.trackId,\r\n        position: trackData?.position,\r\n      }\r\n    };\r\n  }\r\n}\r\n\r\n\r\n// ************************************************************************************************\r\n// Footer autoplay and crossfade toggles\r\n// ************************************************************************************************\r\n\r\nclass AutoplayToggle extends ElementToggle\r\n{\r\n  toggle()\r\n  {\r\n    settings.playback.autoplay = (settings.playback.autoplay === true) ? false : true;\r\n    \r\n    showSnackbar(settings.playback.autoplay\r\n      ? 'Autoplay enabled (<b>Shift</b> + <b>A</b> to disable)'\r\n      : 'Autoplay disabled (<b>Shift</b> + <b>A</b> to enable)', 5);\r\n  }\r\n\r\n  update()\r\n  {\r\n    this.value = settings.playback.autoplay ? 'ON' : 'OFF';\r\n    \r\n    settings.playback.autoplay\r\n      ? replaceClass(document.body, 'autoplay-off', 'autoplay-on')\r\n      : replaceClass(document.body, 'autoplay-on', 'autoplay-off');\r\n    \r\n    settings.playback.autoplay\r\n      ? crossfade?.classList.remove('disabled')\r\n      : crossfade?.classList.add('disabled');\r\n  }\r\n}\r\n\r\nclass CrossfadeToggle extends ElementToggle\r\n{\r\n  toggle()\r\n  {\r\n    settings.gallery.autoCrossfade = (settings.gallery.autoCrossfade === true) ? false : true;\r\n    \r\n    showSnackbar(settings.gallery.autoCrossfade\r\n      ? 'Auto Crossfade enabled (<b>x</b> to disable)'\r\n      : 'Auto Crossfade disabled (<b>x</b> to enable)', 5);\r\n  }\r\n\r\n  update()\r\n  {\r\n    this.value = settings.gallery.autoCrossfade ? 'ON' : 'OFF';\r\n  }\r\n}\r\n"],
  "mappings": "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",
  "names": ["executionStart", "executionStop", "DebugLog", "moduleName", "padString", "data", "ProdBuild", "DebugLog", "newInstance", "moduleName", "padString", "string", "maxLength", "padChar", "logErrorOnServer", "errorCategory", "errorData", "eventAction", "measureStartupExecutionTime", "executionStart", "logCss", "logStartupExecutionTime", "executionStop", "PREF_PLAYER", "galleryPerPageValues", "i", "galleryPerPageValueStrings", "settingsSchema", "defaultSettings", "presetsSchema", "presetList", "debug", "newInstance", "validateSettings", "settings", "schema", "invalidCount", "validateRecursive", "settingsObject", "schemaObject", "key", "isEntryInvalid", "schemaEntry", "settingValue", "entryKey", "debug", "newInstance", "observers", "KEY", "DEPRECATED_KEYS", "YEAR_IN_SECONDS", "isAvailable", "storageType", "storage", "test", "exception", "setCookie", "keyName", "keyValue", "maxAge", "path", "deleteCookie", "setValue", "keyName", "keyValue", "exception", "debug", "readJson", "defaultValue", "setDefault", "parsedKeyValue", "writeJson", "keyData", "mergeSettings", "oldSettings", "newSettings", "settingsKey", "mergedSettings", "mergeDeep", "cleanDeep", "destination", "key", "cleanupOldData", "skipOldDataCheck", "DEPRECATED_KEYS", "deleteCookie", "validateSettings", "settingsObject", "defaultSettings", "settingsSchema", "readWriteSettingsProxy", "parsedJson", "onSettingsChange", "handler", "target", "property", "receiver", "value", "newValue", "oldValue", "callSettingsObservers", "addSettingsObserver", "observer", "observers", "debug", "newInstance", "response", "settings", "getSessionData", "readSettings", "readWriteSettingsProxy", "KEY", "defaultSettings", "debug", "newInstance", "VOLUME", "TYPE", "CURVE", "STATE", "config", "crossfadeClosure", "galleryPlayers", "players", "fadeState", "intervalId", "fadeOutPlayer", "fadeInPlayer", "fadeLength", "fadeStartVolume", "fadeType", "TYPE", "fadePreset", "fadeStartTime", "init", "start", "stop", "mute", "crossfadeType", "crossfadePreset", "fadeInUid", "set", "debug", "settings", "positionMilliseconds", "updateInterval", "timeRemaining", "fadeRemaining", "equalPowerFade", "linearFade", "setMute", "position", "fadePosition", "volume", "fadeVolume", "VOLUME", "fadeOutVolume", "fadeInVolume", "debug", "newInstance", "TRACK_TYPE", "MediaPlayer", "trackId", "iframeId", "embeddedPlayer", "isPlayable", "duration", "artist", "title", "position", "volume", "thumbnail", "YouTube", "videoId", "getYouTubeImgUrl", "id", "onErrorCallback", "callback", "setMute", "SoundCloud", "iframeSrc", "VOLUME", "trackUrl", "trackUrlParts", "tracksString", "i", "trackThumbnailUrlElement", "soundObject", "getSoundCloudImgUrl", "positionSeconds", "positionMilliseconds", "Playlist", "state", "defThumbnailObj", "youTubeVideoIdRegEx", "trackSourceUrl", "youTubeVideoId", "thumbnailSrc", "debug", "newInstance", "SITE_URL", "SITE_URL_LIST", "validUrlRegEx", "DOMParserInstance", "MATCH", "siteMinWidthWide", "getCssPropString", "siteMaxWidth", "siteMaxWidthMobile", "addListener", "selectors", "type", "listener", "addListenerAll", "element", "prop", "string", "getCssPropValue", "value", "matchesMedia", "matchMedia", "replaceClass", "removeClass", "addClass", "getTimeString", "seconds", "includeHours", "timeString", "entityMap", "escHtml", "s", "escAttribute", "attribute", "stripHtml", "firstPass", "stripAttribute", "navToUrl", "destUrl", "showSnackbar", "getListPlayerUrl", "getGalleryPlayerUrl", "getPrefPlayerUrl", "settings", "PREF_PLAYER", "getThumbnailData", "metaData", "TRACK_TYPE", "getYouTubeImgUrl", "FETCH_ERROR_TYPE", "fetchRest", "endpoint", "query", "returnStatus", "path", "response", "reason", "errorType", "debug", "newInstance", "m", "config", "template", "elements", "showSnackbar", "message", "timeout", "actionText", "actionClickCallback", "afterCloseCallback", "init", "reset", "actionTextClick", "matchesMedia", "MATCH", "dismissSnackbar", "dismissId", "isShowing", "hideSnackbar", "ElementClick", "selectors", "addToAllMatching", "addListenerAll", "event", "addListener", "selector", "debug", "newInstance", "m", "isSingleTrackFetch", "settings", "isNextSingleTrackLoading", "singleTrackFetchReady", "cueOrPlayTrackByIdCallback", "event", "onPopState", "playNextSingleTrack", "playTrack", "restResponse", "fetchTracks", "currentTrack", "TRACK_TYPE", "getTrackTitle", "updatePlayerAndPage", "showSnackbar", "KEY", "tracksDateTime", "beforeTrackDateTime", "fetchRest", "titleData", "trackData", "pushState", "thumbnailData", "getThumbnailData", "updatePage", "getTrackNavHtml", "isNavPrev", "navUrl", "trackMeta", "trackArtistTitle", "prevNextThumbnail", "prevNextThumbHtml", "response", "updateSiteNavLinks", "updateTrackNavLinks", "updateTrackHeader", "updateTrackAttributes", "elements", "url", "element", "trackNavHtml", "attributes", "key", "ElementToggle", "elementId", "updateOnConstruct", "event", "value", "getCssPropString", "debug", "newInstance", "hasPlaybackStarted", "EVENT", "eventListeners", "event", "updateProgressPercent", "playbackReady", "addListener", "playbackEvent", "playbackEventListener", "dispatch", "playbackEventData", "playbackEventCallback", "eventListener", "STATE", "ElementWrapper", "elmentSelector", "parentElement", "initialState", "element", "state", "classList", "title", "selector", "event", "listener", "cssClass", "remove", "add", "replaceClass", "attribute", "value", "setState", "newState", "ElementsWrapper", "elmentsSelector", "elements", "args", "debug", "newInstance", "m", "ctrl", "setPlaybackControlsCss", "ElementWrapper", "matchesMedia", "MATCH", "settings", "init", "mediaPlayers", "seekClickCallback", "playbackProgress", "playbackControls", "ready", "prevClickCallback", "playPauseClickCallback", "nextClickCallback", "muteClickCallback", "STATE", "progressSeekClick", "playerType", "toggleRepeat", "updateMuteState", "addSettingsObserver", "updateAutoplayState", "addListener", "EVENT", "setLoadState", "setPlayState", "setPauseState", "setMediaEndState", "updateProgressPercent", "progressPercent", "updateProgressBar", "scaleX", "updateTimerAndProgress", "positionMilliseconds", "positionSeconds", "durationSeconds", "setTimer", "event", "seekPosSeconds", "isPlaying", "setDetails", "trackData", "clearTimer", "setThumbnail", "setTimerDisplayHoursMinutes", "thumbnail", "getTimeString", "blinkPlayPause", "toggleBlink", "getSetTrackData", "updatePrevState", "updateNextState", "REPEAT", "repeatModes", "getRepeatMode", "index", "position", "duration", "debug", "newInstance", "getPageSeparatorHtml", "responseData", "loadingPage", "pageUrl", "getTrackEntryHtml", "track", "isYouTubeTrack", "TRACK_TYPE", "thumbnailData", "getThumbnailData", "trackArtist", "escHtml", "trackTitle", "trackDuration", "youTubeTrackThumbnailUrl", "trackThumbnailUrl", "trackArtistTitle", "trackPlayNext", "getTimeString", "setTrackMeta", "trackData", "trackLinksSelector", "linkIdsAttribute", "linksMap", "isChannels", "linksElement", "linkIds", "linksHtml", "isVideo", "linkId", "mapKey", "getListPlayerUrl", "debug", "newInstance", "m", "loadTracks", "termType", "termId", "loadingPage", "response", "trackData", "fetchTracks", "artistIds", "channelIds", "tracksHtml", "getPageSeparatorHtml", "track", "index", "key", "getTrackEntryHtml", "artistsPromise", "channelsPromise", "fetchTerms", "artistsData", "channelsData", "entry", "setTrackMeta", "page", "tracksPerPage", "params", "pagination", "fields", "getTermQueryParams", "getShuffleQueryParams", "getSearchQueryParams", "fetchRest", "termIds", "maxItems", "shuffleParams", "searchString", "searchParams", "debug", "newInstance", "m", "STATE", "init", "setCurrentTrackCallback", "observerCallback", "UiElements", "ready", "player", "addListener", "EVENT", "setCurrentTrackState", "event", "setNextTrackState", "settings", "initLoadMoreTracks", "entries", "queryTrack", "selectors", "queryTrackAll", "queryTrackId", "id", "getCurrentTrackElement", "getTrackType", "element", "trackType", "TRACK_TYPE", "getPrevPlayableId", "destElement", "getNextPlayableId", "startElement", "setCuedTrack", "trackId", "ElementClick", "trackActionsClick", "removeClick", "playNextClick", "arrowUpDownClick", "trackActionButtons", "trackElement", "nextTrackElement", "clearTrackState", "addTrack", "showSnackbar", "allowUndo", "animationEndCallback", "undoRemoveElement", "undoPrevElement", "targetElement", "insertPosition", "isArrowUpClick", "pageNumber", "gotoPageNum", "gotoElement", "blockOption", "response", "loadMoreTracks", "tracksLoaded", "setIsLoadingTracks", "loadTracks", "stripAttribute", "isLoadingTracks", "newState", "replaceClass", "updateUpNextModal", "setPlayerAspectRatio", "nextTrackId", "isPointerClick", "setTrackMessage", "message", "updateTrackDetails", "sourceUid", "config", "getTemplateHtml", "getSingleChoiceListHtml", "singleChoiceList", "html", "entry", "index", "entryClass", "entryTitle", "entryIcon", "entryContent", "getModalTrackHtml", "element", "trackArtist", "trackTitle", "TRACK_TYPE", "debug", "newInstance", "m", "elements", "showModal", "modalTitle", "modalBody", "modalType", "onEntryClickedCallback", "onClickCloseCallback", "init", "setSingleChoiceList", "config", "settings", "keyDown", "disablePageScrolling", "isShowingModal", "showingModalId", "closeModal", "touchMove", "touchStart", "getModalId", "getModalEntry", "entryNum", "updateModalTitle", "updateModalId", "updateTitle", "updateModalBody", "updateSingleChoiceList", "getTemplateHtml", "event", "singleChoiceList", "getSingleChoiceListHtml", "entry", "singleChoiceListClick", "disableScrolling", "scrollbarWidth", "debug", "newInstance", "m", "init", "setCurrentTrackCallback", "loadDragDropTouch", "tag", "firstScriptTag", "showUpNextModal", "modalEntries", "getEntries", "isPlaying", "showModal", "getTitle", "clickedId", "nextTrackId", "item", "getCurrentTrackElement", "settings", "event", "getModalId", "addTitleListener", "addDragDropListeners", "showSnackbar", "updateUpNextModal", "isPlayingTrack", "isShowingModal", "updateModalTitle", "modalEntry", "getModalEntry", "updateModalBody", "trackElement", "getUpNextTrackHtml", "i", "queryTrackId", "getNextPlayableId", "addListener", "autoplay", "element", "mouseDown", "dragStart", "dragOver", "dragDrop", "insertPos", "modalDragSource", "modalDropTarget", "listTrackSource", "trackArtistAttr", "trackTitleAttr", "isDraggable", "trackTypeClass", "TRACK_TYPE", "escAttribute", "getTimeString", "getModalTrackButtons", "debug", "newInstance", "PLAYER_TYPE", "isPlayer", "hasGalleryPlayer", "hasListPlayer", "noPlayback", "isGalleryPlayer", "isListPlayer", "shuffleClickNavTo", "event", "setCookie", "KEY", "navToUrl", "getPrefPlayerUrl", "response", "autoplayNavTo", "destUrl", "continueAutoplay", "playerScrollTo", "trackId", "listPlayerScrollTo", "galleryPlayerScrollTo", "scrollToYPos", "element", "destYPos", "settings", "scrollDestPos", "getCssPropValue", "showUpNextModal", "offsetTop", "scrollTop", "headerHeight", "getScrollHeaderHeight", "getContentMarginTop", "isScrollDown", "playerOnKeyScroll", "tracklist", "scrollByPx", "fullscreenElementClosure", "fseEvent", "fseTarget", "init", "enter", "exit", "toggle", "fullscreenChange", "fullscreenElement", "keyboardShortcutsClosure", "allow", "keyboardShortcuts", "playerType", "crossfade", "autoplay", "init", "getPlayerStatus", "PlayerTypeToggle", "CrossfadeToggle", "AutoplayToggle", "ElementToggle", "elementId", "destData", "settings", "isListPlayer", "PLAYER_TYPE", "setCookie", "KEY", "YEAR_IN_SECONDS", "navToUrl", "getPrefPlayerUrl", "isPagedRegEx", "sourceUrl", "destUrl", "url", "urlParts", "pageIndex", "part", "currentPage", "trackData", "tracksPerPageFrom", "response", "tracksPerPageTo", "trackOffset", "showSnackbar", "replaceClass"]
}
