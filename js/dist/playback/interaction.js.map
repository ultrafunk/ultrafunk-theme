{
  "version": 3,
  "sources": ["../../src/playback/eventlogger.js", "../../src/playback/gallery/gallery-playback.js", "../../src/playback/gallery/gallery-playback-timer.js", "../../src/playback/gallery/embedded-players.js", "../../src/playback/gallery/gallery-events.js", "../../src/playback/gallery/crossfade-controls.js", "../../src/playback/gallery/gallery-players.js", "../../src/playback/list/list-playback.js", "../../src/playback/list/list-playback-timer.js", "../../src/playback/screen-wakelock.js", "../../src/playback/interaction.js"],
  "sourcesContent": ["//\r\n// Event logging and matching\r\n//\r\n// https://ultrafunk.com\r\n//\r\n\r\n\r\nimport * as debugLogger from '../shared/debuglogger.js';\r\n\r\n\r\nexport {\r\n  SOURCE,\r\n  EVENT,\r\n  Interaction,\r\n  Playback,\r\n};\r\n\r\n\r\n/*************************************************************************************************/\r\n\r\n\r\nconst debug = debugLogger.newInstance('eventlogger');\r\n\r\nconst SOURCE = {\r\n// Default source\r\n  UNKNOWN: 1000,\r\n// interaction.js event sources\r\n  KEYBOARD: 100,\r\n  MOUSE:    110,\r\n// Playback event sources\r\n  YOUTUBE:    1,\r\n  SOUNDCLOUD: 2,\r\n  ULTRAFUNK:  50,\r\n};\r\n\r\nconst EVENT = {\r\n// Default event\r\n  UNKNOWN:         -2000,\r\n// interaction.js event types\r\n  KEY_ARROW_LEFT:  180,\r\n  KEY_ARROW_RIGHT: 181,\r\n  MOUSE_CLICK:     182,\r\n// Playback event types\r\n  STATE_ERROR:     -5,\r\n  STATE_UNSTARTED: -1, // YT.PlayerState.UNSTARTED\r\n  STATE_ENDED:     0,  // YT.PlayerState.ENDED\r\n  STATE_PLAYING:   1,  // YT.PlayerState.PLAYING\r\n  STATE_PAUSED:    2,  // YT.PlayerState.PAUSED\r\n  STATE_BUFFERING: 3,  // YT.PlayerState.BUFFERING\r\n  STATE_CUED:      5,  // YT.PlayerState.CUED\r\n  RESUME_AUTOPLAY: 50,\r\n  PLAYER_ERROR:    60,\r\n  CROSSFADE_START: 70,\r\n};\r\n\r\nconst entry = {\r\n  eventSource: SOURCE.UNKNOWN,\r\n  eventType:   EVENT.UNKNOWN,\r\n  uId:         null,\r\n  timeStamp:   0,\r\n};\r\n\r\n\r\n// ************************************************************************************************\r\n// EventLog parent class\r\n// ************************************************************************************************\r\n\r\nclass EventLog\r\n{\r\n  constructor(maxEntries = 10)\r\n  {\r\n    this.log        = [];\r\n    this.maxEntries = maxEntries;\r\n    this.lastPos    = 0;\r\n    this.matchCount = 0;\r\n  }\r\n  \r\n  add(eventSource, eventType, uId, timeStamp = Date.now())\r\n  {\r\n    const logEntry = Object.create(entry);\r\n\r\n    logEntry.eventSource = eventSource;\r\n    logEntry.eventType   = eventType;\r\n    logEntry.uId         = uId;\r\n    logEntry.timeStamp   = timeStamp;\r\n    \r\n    // Simple and inefficient, but good enough...\r\n    if (this.log.length < this.maxEntries)\r\n    {\r\n      this.log.push(logEntry);\r\n    }\r\n    else\r\n    {\r\n      this.log.shift();\r\n      this.log.push(logEntry);\r\n    }\r\n  }\r\n  \r\n  clear()\r\n  {\r\n    this.log = [];\r\n  }\r\n\r\n  initMatch()\r\n  {\r\n    this.lastPos    = this.log.length - 1;\r\n    this.matchCount = 0;\r\n  }\r\n\r\n  matchesEvent(index, eventSource, eventType, uId = null)\r\n  {\r\n    if ((this.log[this.lastPos - index].eventSource === eventSource) &&\r\n        (this.log[this.lastPos - index].eventType   === eventType)   &&\r\n        (this.log[this.lastPos - index].uId         === uId))\r\n    {\r\n      this.matchCount++;\r\n    }\r\n  }\r\n  \r\n  matchesDelta(elements, delta)\r\n  {\r\n    if ((this.log[this.lastPos].timeStamp - this.log[this.lastPos - elements].timeStamp) <= delta)\r\n      this.matchCount++;\r\n  }\r\n\r\n  isPatternMatch(matchCount, event)\r\n  {\r\n    if (this.matchCount === matchCount)\r\n    {\r\n      debug.log(`MATCH for: ${event}`);\r\n      debug.logEventLog(this.log, SOURCE, EVENT);\r\n      \r\n      return true;\r\n    }\r\n\r\n    return false;\r\n  }\r\n}\r\n\r\n\r\n// ************************************************************************************************\r\n// Interaction child class\r\n// ************************************************************************************************\r\n\r\nclass Interaction extends EventLog\r\n{\r\n  constructor(maxEntries) { super(maxEntries); }\r\n\r\n  doubleClicked(eventSource, eventType, deltaTime)\r\n  {\r\n    this.initMatch();\r\n\r\n    if (this.lastPos >= 1)\r\n    {\r\n      this.matchesEvent(1, eventSource, eventType);\r\n      this.matchesEvent(0, eventSource, eventType);\r\n      this.matchesDelta(1, deltaTime);\r\n    }\r\n\r\n    return this.isPatternMatch(3, `${debug.getObjectKeyForValue(SOURCE, eventSource)} Double Clicked`);\r\n  }\r\n}\r\n\r\n\r\n// ************************************************************************************************\r\n// Playback child class\r\n// ************************************************************************************************\r\n\r\nclass Playback extends EventLog\r\n{\r\n  constructor(maxEntries) { super(maxEntries); }\r\n\r\n  ytAutoplayBlocked(uId, deltaTime)\r\n  {\r\n    this.initMatch();\r\n    \r\n    if (this.lastPos >= 3)\r\n    {\r\n      this.matchesEvent(3, SOURCE.ULTRAFUNK, EVENT.RESUME_AUTOPLAY, null);\r\n      this.matchesEvent(2, SOURCE.YOUTUBE,   EVENT.STATE_UNSTARTED, uId);\r\n      this.matchesEvent(1, SOURCE.YOUTUBE,   EVENT.STATE_BUFFERING, uId);\r\n      this.matchesEvent(0, SOURCE.YOUTUBE,   EVENT.STATE_UNSTARTED, uId);\r\n      this.matchesDelta(3, deltaTime);\r\n    }\r\n    \r\n    return this.isPatternMatch(5, 'YouTube Autoplay Blocked');\r\n  }\r\n  \r\n  scAutoplayBlocked(uId, deltaTime)\r\n  {\r\n    this.initMatch();\r\n    \r\n    if (this.lastPos >= 3)\r\n    {\r\n      this.matchesEvent(3, SOURCE.ULTRAFUNK,  EVENT.RESUME_AUTOPLAY, null);\r\n      this.matchesEvent(2, SOURCE.SOUNDCLOUD, EVENT.STATE_PLAYING,   uId);\r\n      this.matchesEvent(1, SOURCE.SOUNDCLOUD, EVENT.STATE_PAUSED,    uId);\r\n      this.matchesEvent(0, SOURCE.SOUNDCLOUD, EVENT.STATE_PAUSED,    uId);\r\n      this.matchesDelta(3, deltaTime);\r\n    }\r\n    \r\n    return this.isPatternMatch(5, 'SoundCloud Autoplay Blocked');\r\n  }\r\n\r\n  scWidgetPlayBlocked(uId, deltaTime)\r\n  {\r\n    this.initMatch();\r\n    \r\n    if (this.lastPos >= 2)\r\n    {\r\n      this.matchesEvent(2, SOURCE.SOUNDCLOUD, EVENT.STATE_PLAYING, uId);\r\n      this.matchesEvent(1, SOURCE.SOUNDCLOUD, EVENT.STATE_PAUSED,  uId);\r\n      this.matchesEvent(0, SOURCE.SOUNDCLOUD, EVENT.STATE_PAUSED,  uId);\r\n      this.matchesDelta(2, deltaTime);\r\n    }\r\n    \r\n    return this.isPatternMatch(4, 'SoundCloud WidgetPlay Blocked');\r\n  }\r\n\r\n  scPlayDoubleTrigger(uId, deltaTime)\r\n  {\r\n    this.initMatch();\r\n\r\n    if (this.lastPos >= 2)\r\n    {\r\n      this.matchesEvent(2, SOURCE.ULTRAFUNK,  EVENT.CROSSFADE_START, null);\r\n      this.matchesEvent(1, SOURCE.SOUNDCLOUD, EVENT.STATE_PLAYING,   uId);\r\n      this.matchesEvent(0, SOURCE.SOUNDCLOUD, EVENT.STATE_PLAYING,   uId);\r\n      this.matchesDelta(1, deltaTime);\r\n    }\r\n\r\n    return this.isPatternMatch(4, 'SoundCloud Play Double Trigger');\r\n  }\r\n}\r\n", "//\r\n// Gallery playback module\r\n//\r\n// https://ultrafunk.com\r\n//\r\n\r\n\r\nimport * as debugLogger       from '../../shared/debuglogger.js';\r\nimport * as eventLogger       from '../eventlogger.js';\r\nimport * as embeddedPlayers   from './embedded-players.js';\r\nimport * as playbackEvents    from '../playback-events.js';\r\nimport * as galleryEvents     from './gallery-events.js';\r\nimport * as playbackControls  from '../playback-controls.js';\r\nimport * as crossfadeControls from './crossfade-controls.js';\r\nimport { playbackTimer }      from './gallery-playback-timer.js';\r\nimport { galleryPlayers }     from './gallery-players.js';\r\nimport { CROSSFADE_TYPE }     from './crossfade.js';\r\nimport { settings }           from '../../shared/session-data.js';\r\n\r\n\r\nexport {\r\n  init,\r\n  togglePlayPause,\r\n  prevTrack,\r\n  nextTrack,\r\n  toggleMute,\r\n  getStatus,\r\n};\r\n\r\n\r\n/*************************************************************************************************/\r\n\r\n\r\nconst debug = debugLogger.newInstance('gallery-playback');\r\n\r\nconst m = {\r\n  eventLog: null,\r\n  players:  {},\r\n};\r\n\r\nconst config = {\r\n  minCrossfadeToTime: 5,   // Shortest allowed track to track fade time\r\n  maxBufferingDelay:  3,   // VERY rough estimate of \"max\" network buffering delay in seconds\r\n};\r\n\r\n\r\n// ************************************************************************************************\r\n// Init\r\n// ************************************************************************************************\r\n\r\nfunction init()\r\n{\r\n  debug.log('init()');\r\n\r\n  m.eventLog = embeddedPlayers.eventLog;\r\n\r\n  galleryEvents.init();\r\n  \r\n  m.players = galleryPlayers();\r\n  m.players.init(playTrack);\r\n\r\n  playbackControls.init(m.players, seekClick);\r\n  crossfadeControls.init(m.players, crossfadeToClick);\r\n  playbackTimer.init(m.players, getStatus, crossfadeInit);\r\n  embeddedPlayers.init(m.players, playbackState, embeddedEventHandler);\r\n}\r\n\r\n\r\n// ************************************************************************************************\r\n// Playback controls click handlers + state\r\n// ************************************************************************************************\r\n\r\nfunction togglePlayPause()\r\n{\r\n  if (playbackControls.isPlaying())\r\n  {\r\n    playbackControls.setPauseState();\r\n    m.players.current.pause();\r\n  }\r\n  else\r\n  {\r\n    playbackControls.setPlayState();\r\n    m.players.current.play(embeddedPlayers.onPlayerError);\r\n  }\r\n}\r\n\r\nfunction prevTrack()\r\n{\r\n  debug.log(`prevTrack() - prevTrack: ${m.players.getCurrentTrack() - 1} - numTracks: ${m.players.getNumTracks()}`);\r\n\r\n  if (m.players.getCurrentTrack() > 0)\r\n  {\r\n    m.players.current.getPosition((positionMilliseconds) =>\r\n    {\r\n      if (positionMilliseconds > 5000)\r\n      {\r\n        m.players.current.seekTo(0);\r\n        playbackTimer.updateCallback(0);\r\n      }\r\n      else\r\n      {\r\n        if (m.players.getCurrentTrack() > 1)\r\n          m.players.stop();\r\n        \r\n        if (m.players.prevTrack(playbackControls.isPlaying()))\r\n          playbackControls.updatePrevState();\r\n      }\r\n    });\r\n  }\r\n}\r\n\r\nfunction nextTrack(isMediaEnded = false)\r\n{\r\n  const isLastTrack = ((m.players.getCurrentTrack() + 1) > m.players.getNumTracks());\r\n\r\n  debug.log(`nextTrack() - isMediaEnded: ${isMediaEnded} - isLastTrack: ${isLastTrack} - autoplay: ${settings.playback.autoplay}`);\r\n\r\n  if (repeatPlayback(isMediaEnded, isLastTrack))\r\n    return;\r\n\r\n  if (isLastTrack === false)\r\n  {\r\n    m.players.stop();\r\n    \r\n    if (isMediaEnded && (settings.playback.autoplay === false))\r\n    {\r\n      playbackControls.setPauseState();\r\n    }\r\n    else\r\n    {\r\n      if (m.players.nextTrack(playbackControls.isPlaying()))\r\n        playbackControls.updateNextState();\r\n    }\r\n  }\r\n  else if (isMediaEnded)\r\n  {\r\n    playbackControls.setPauseState();\r\n    \r\n    if (settings.playback.autoplay)\r\n      playbackEvents.dispatch(playbackEvents.EVENT.CONTINUE_AUTOPLAY);\r\n    else\r\n      m.players.stop();\r\n  }\r\n}\r\n\r\nfunction repeatPlayback(isMediaEnded, isLastTrack)\r\n{\r\n  if (isMediaEnded && settings.playback.autoplay)\r\n  {\r\n    const repeatMode = playbackControls.getRepeatMode();\r\n\r\n    debug.log(`repeatPlayback(): ${debug.getObjectKeyForValue(playbackControls.REPEAT, repeatMode)}`);\r\n\r\n    if (repeatMode === playbackControls.REPEAT.ONE)\r\n    {\r\n      m.players.current.seekTo(0);\r\n      m.players.current.play();\r\n      return true;\r\n    }\r\n    else if (isLastTrack && (repeatMode === playbackControls.REPEAT.ALL))\r\n    {\r\n      m.players.stop();\r\n      m.players.setPlayerIndex(0);\r\n      playTrack(true);\r\n      return true;\r\n    }\r\n  }\r\n\r\n  return false;\r\n}\r\n\r\nfunction seekClick(positionSeconds)\r\n{\r\n  m.players.current.seekTo(positionSeconds);\r\n}\r\n\r\nfunction toggleMute()\r\n{\r\n  settings.playback.masterMute = (settings.playback.masterMute === true) ? false : true;\r\n  m.players.mute();\r\n}\r\n  \r\nfunction cueTrack(iframeId, scrollToMedia = true)\r\n{\r\n  debug.log(`cueTrack(): ${iframeId}`);\r\n\r\n  m.players.setPlayerIndex(m.players.indexMap.get(iframeId));\r\n  playbackEvents.dispatch(playbackEvents.EVENT.MEDIA_SHOW, { scrollToMedia: scrollToMedia, trackId: m.players.current.getTrackId() });\r\n  playbackControls.updateNextState();\r\n}\r\n\r\nfunction playTrack(playMedia, scrollToMedia = true)\r\n{\r\n  playbackEvents.dispatch(playbackEvents.EVENT.MEDIA_SHOW, { scrollToMedia: scrollToMedia, trackId: m.players.current.getTrackId() });\r\n  \r\n  if (playMedia)\r\n    m.players.current.play(embeddedPlayers.onPlayerError);\r\n}\r\n\r\nfunction skipToTrack(trackNum, playMedia = true)\r\n{\r\n  debug.log(`skipToTrack(): ${trackNum} - ${playMedia}`);\r\n\r\n  if ((playMedia === true) && (playbackControls.isPlaying() === false))\r\n  {\r\n    // Reset eventlog to enable check for autoplay block\r\n    m.eventLog.clear();\r\n    m.eventLog.add(eventLogger.SOURCE.ULTRAFUNK, eventLogger.EVENT.RESUME_AUTOPLAY, null);\r\n    \r\n    if (m.players.jumpToTrack(trackNum, playMedia))\r\n      playbackControls.updateNextState();\r\n  }\r\n}\r\n\r\nfunction resumeAutoplay(autoplayData, iframeId = null)\r\n{\r\n  debug.log(`resumeAutoplay(): ${autoplayData.autoplay}${(iframeId !== null) ? (' - ' + iframeId) : '' }`);\r\n\r\n  if (iframeId !== null)\r\n  {\r\n    if (autoplayData.autoplay)\r\n      skipToTrack(m.players.trackFromUid(iframeId), true);\r\n    else\r\n      cueTrack(iframeId);\r\n  }\r\n  else if (autoplayData.autoplay)\r\n  {\r\n    m.eventLog.add(eventLogger.SOURCE.ULTRAFUNK, eventLogger.EVENT.RESUME_AUTOPLAY, null);\r\n    togglePlayPause();\r\n  }\r\n}\r\n\r\nfunction getStatus()\r\n{\r\n  return {\r\n    isPlaying:    playbackControls.isPlaying(),\r\n    currentTrack: m.players.getCurrentTrack(),\r\n    position:     0,\r\n    numTracks:    m.players.getNumTracks(),\r\n    trackId:      m.players.current.getTrackId(),\r\n    iframeId:     m.players.current.getIframeId(),\r\n  };\r\n}\r\n\r\n\r\n// ************************************************************************************************\r\n// Track to Track crossfade click handler + crossfade init helper functions\r\n// ************************************************************************************************\r\n\r\nfunction crossfadeToClick(fadeInUid, crossfadePreset)\r\n{\r\n  if ((m.players.isCurrent(fadeInUid) === false) && (m.players.current.getDuration() > 0))\r\n  {\r\n    debug.log(`crossfadeToClick():\r\n      fadeOut: ${m.players.current.getArtist()} - \"${m.players.current.getTitle()}\" (${m.players.current.getUid()})\r\n      fadeIn.: ${m.players.playerFromUid(fadeInUid).getArtist()} - \"${m.players.playerFromUid(fadeInUid).getTitle()}\" (${fadeInUid})`);\r\n\r\n    if ((settings.playback.masterMute === false) && (settings.playback.autoplay === false))\r\n    {\r\n      m.players.current.getPosition((positionMilliseconds) =>\r\n      {\r\n        const timeRemaining = m.players.current.getDuration() - (positionMilliseconds / 1000);\r\n\r\n        if (timeRemaining >= (config.minCrossfadeToTime + config.maxBufferingDelay))\r\n          crossfadeInit(CROSSFADE_TYPE.TRACK, crossfadePreset, fadeInUid);\r\n      });\r\n    }\r\n  }\r\n}\r\n\r\nfunction crossfadeInit(crossfadeType, crossfadePreset, crossfadeInUid = null)\r\n{\r\n  m.eventLog.add(eventLogger.SOURCE.ULTRAFUNK, eventLogger.EVENT.CROSSFADE_START, null);\r\n\r\n  const playersIndex = m.players.crossfade.init(crossfadeType, crossfadePreset, crossfadeInUid);\r\n\r\n  if (playersIndex !== null)\r\n    playbackState.syncControls(playersIndex.fadeOutPlayer, playersIndex.fadeInPlayer);\r\n}\r\n\r\n\r\n// ************************************************************************************************\r\n// Embedded players event handler proxy for playbackEvents.dispatch()\r\n// ************************************************************************************************\r\n\r\nfunction embeddedEventHandler(embeddedEvent, embeddedEventData = null)\r\n{\r\n  debug.log(`embeddedEventHandler() - event: ${debug.getObjectKeyForValue(playbackEvents.EVENT, embeddedEvent)}`);\r\n  if (embeddedEventData !== null) debug.log(embeddedEventData);\r\n\r\n  switch(embeddedEvent)\r\n  {\r\n    case playbackEvents.EVENT.MEDIA_ENDED:\r\n      nextTrack(true);\r\n      break;\r\n\r\n    case playbackEvents.EVENT.READY:\r\n      playbackControls.ready(prevTrack, togglePlayPause, nextTrack, toggleMute);\r\n      playbackEvents.dispatch(playbackEvents.EVENT.READY, embeddedEventData);\r\n      playbackEvents.dispatch(playbackEvents.EVENT.RESUME_AUTOPLAY, null, { 'resumeAutoplay': resumeAutoplay });\r\n      break;\r\n\r\n    case playbackEvents.EVENT.AUTOPLAY_BLOCKED:\r\n      playbackEvents.dispatch(playbackEvents.EVENT.AUTOPLAY_BLOCKED, null, { 'togglePlayPause': togglePlayPause });\r\n      break;\r\n\r\n    case playbackEvents.EVENT.PLAYBACK_BLOCKED:\r\n    case playbackEvents.EVENT.MEDIA_UNAVAILABLE:\r\n      playbackEvents.dispatch(embeddedEvent, embeddedEventData, { 'skipToTrack': skipToTrack });\r\n      break;\r\n  }\r\n}\r\n\r\n\r\n// ************************************************************************************************\r\n// Playback controls and embedded players state sync module\r\n// ************************************************************************************************\r\n\r\nconst playbackState = (() =>\r\n{\r\n  const STATE = {\r\n    PLAY:  1,\r\n    PAUSE: 2,\r\n  };\r\n  \r\n  const syncAll = function syncAllRecursive(nextPlayerUid, syncState)\r\n  {\r\n    debug.log(`playbackState.syncAll() - previousTrack: ${m.players.getPlayerIndex() + 1} - nextTrack: ${m.players.indexMap.get(nextPlayerUid) + 1} - syncState: ${debug.getObjectKeyForValue(STATE, syncState)}`);\r\n    \r\n    if (m.players.isCurrent(nextPlayerUid))\r\n    {\r\n      if (syncState === STATE.PLAY)\r\n      {\r\n        playbackEvents.dispatch(playbackEvents.EVENT.MEDIA_PLAYING, getStatus());\r\n      }\r\n      else if (syncState === STATE.PAUSE)\r\n      {\r\n        playbackEvents.dispatch(playbackEvents.EVENT.MEDIA_PAUSED, getStatus());\r\n      }\r\n    }\r\n    else\r\n    {\r\n      const prevPlayerIndex = m.players.getPlayerIndex();\r\n      const nextPlayerIndex = m.players.indexMap.get(nextPlayerUid);\r\n      \r\n      m.players.stop();\r\n      m.players.setPlayerIndex(nextPlayerIndex);\r\n      \r\n      syncControls(prevPlayerIndex, nextPlayerIndex);\r\n      syncAllRecursive(nextPlayerUid, syncState);\r\n    }\r\n  };\r\n\r\n  function syncControls(prevPlayerIndex, nextPlayerIndex)\r\n  {\r\n    if (nextPlayerIndex > prevPlayerIndex)\r\n      playbackControls.updateNextState();\r\n    else\r\n      playbackControls.updatePrevState();\r\n  }\r\n\r\n  return {\r\n    STATE,\r\n    syncAll,\r\n    syncControls,\r\n  };\r\n})();\r\n", "//\r\n// Gallery player playback timer module\r\n//\r\n// https://ultrafunk.com\r\n//\r\n\r\n\r\nimport * as playbackControls from '../playback-controls.js';\r\nimport * as playbackEvents   from '../playback-events.js';\r\nimport { CROSSFADE_TYPE }    from './crossfade.js';\r\nimport { settings }          from '../../shared/session-data.js';\r\n\r\n\r\nexport { playbackTimer };\r\n\r\n\r\n/*************************************************************************************************/\r\n\r\n\r\nconst config = {\r\n  updateTimerInterval: 250, // Milliseconds between each timer event\r\n  maxBufferingDelay:   3,   // VERY rough estimate of \"max\" network buffering delay in seconds\r\n};\r\n\r\n\r\n// ************************************************************************************************\r\n// Playback timer and event handling module\r\n// ************************************************************************************************\r\n\r\nconst playbackTimer = (() =>\r\n{\r\n  let intervalId     = -1;\r\n  let lastPosSeconds = 0;\r\n  let isVisible      = true;\r\n  let players        = null;\r\n  let getStatus      = null;\r\n  let crossfadeInit  = null;\r\n\r\n  return {\r\n    init,\r\n    start,\r\n    stop,\r\n    updateCallback,\r\n  };\r\n\r\n  function init(galleryPlayers, galleryGetStatus, galleryCrossfadeInit)\r\n  {\r\n    players       = galleryPlayers;\r\n    getStatus     = galleryGetStatus;\r\n    crossfadeInit = galleryCrossfadeInit;\r\n\r\n    document.addEventListener('visibilitychange', () => { isVisible = (document.visibilityState === 'visible') ? true : false; });\r\n  }\r\n  \r\n  function start()\r\n  {\r\n    stop(false);\r\n    \r\n    intervalId = setInterval(() =>\r\n    {\r\n      if (isVisible)\r\n        players.current.getPosition(updateCallback);\r\n    },\r\n    config.updateTimerInterval);\r\n  }\r\n  \r\n  function stop(mediaEnded = false)\r\n  {\r\n    if (intervalId !== -1)\r\n    {\r\n      clearInterval(intervalId);\r\n      intervalId = -1;\r\n    }\r\n    \r\n    if (mediaEnded)\r\n    {\r\n      updateCallback(0);\r\n      playbackEvents.dispatch(playbackEvents.EVENT.MEDIA_ENDED, getStatus());\r\n    }\r\n\r\n    lastPosSeconds = 0;\r\n    playbackControls.blinkPlayPause(false);\r\n  }\r\n  \r\n  function updateCallback(positionMilliseconds, durationSeconds = 0)\r\n  {\r\n    const positionSeconds = Math.round(positionMilliseconds / 1000);\r\n\r\n    playbackControls.updateTimerAndProgress(positionMilliseconds, positionSeconds, durationSeconds);\r\n\r\n    if ((positionSeconds > 0) && (durationSeconds > 0))\r\n    {\r\n      updateTimeRemainingWarning(positionSeconds, durationSeconds);\r\n      updateAutoCrossfade(positionSeconds, durationSeconds);\r\n    }\r\n  }\r\n  \r\n  function updateTimeRemainingWarning(positionSeconds, durationSeconds)\r\n  {\r\n    if ((settings.playback.autoplay === false)  &&\r\n         settings.playback.timeRemainingWarning &&\r\n        (lastPosSeconds !== positionSeconds))\r\n    {\r\n      const remainingSeconds = durationSeconds - positionSeconds;\r\n      lastPosSeconds         = positionSeconds;\r\n\r\n      if (remainingSeconds <= settings.playback.timeRemainingSeconds)\r\n      {\r\n        playbackControls.blinkPlayPause(true);\r\n        playbackEvents.dispatch(playbackEvents.EVENT.MEDIA_TIME_REMAINING, { timeRemainingSeconds: remainingSeconds });\r\n      }\r\n      else\r\n      {\r\n        playbackControls.blinkPlayPause(false);\r\n      }\r\n    }\r\n  }\r\n\r\n  function updateAutoCrossfade(positionSeconds, durationSeconds)\r\n  {\r\n    if ((settings.playback.masterMute === false) && settings.playback.autoplay && settings.gallery.autoCrossfade)\r\n    {\r\n      if ((durationSeconds - positionSeconds) === (settings.gallery.autoCrossfadeLength + config.maxBufferingDelay))\r\n      {\r\n        if ((players.getCurrentTrack() + 1) <= players.getNumTracks())\r\n          crossfadeInit(CROSSFADE_TYPE.AUTO, { name: 'Auto Crossfade', length: settings.gallery.autoCrossfadeLength, curve: settings.gallery.autoCrossfadeCurve});\r\n      }\r\n    }\r\n  }\r\n})();\r\n", "//\r\n// Embedded players\r\n//\r\n// https://ultrafunk.com\r\n//\r\n\r\n\r\nimport * as debugLogger    from '../../shared/debuglogger.js';\r\nimport * as eventLogger    from '../eventlogger.js';\r\nimport * as mediaPlayers   from '../mediaplayers.js';\r\nimport * as playbackEvents from '../playback-events.js';\r\nimport { settings }        from '../../shared/session-data.js';\r\nimport { playbackTimer }   from './gallery-playback-timer.js';\r\n\r\n\r\nexport {\r\n  eventLog,\r\n  init,\r\n  onPlayerError,\r\n};\r\n\r\n\r\n/*************************************************************************************************/\r\n\r\n\r\nconst debug    = debugLogger.newInstance('embedded-players');\r\nconst eventLog = new eventLogger.Playback(10);\r\n\r\nconst m = {\r\n  players:         {},\r\n  playbackState:   null,\r\n  embeddedEvent:   null,\r\n  loadEventsTotal: 0,\r\n  loadEventsCount: 1,\r\n};\r\n\r\nconst config = {\r\n  youTubeIframeIdRegEx:    /youtube-uid/i,\r\n  soundCloudIframeIdRegEx: /soundcloud-uid/i,\r\n  maxPlaybackStartDelay:   3, // VERY rough estimate of \"max\" network buffering delay in seconds (see also: maxBufferingDelay)\r\n};\r\n\r\n\r\n// ************************************************************************************************\r\n//\r\n// ************************************************************************************************\r\n\r\nfunction init(players, playbackState, embeddedEventHandler)\r\n{\r\n  m.players       = players;\r\n  m.playbackState = playbackState;\r\n  m.embeddedEvent = embeddedEventHandler;\r\n\r\n  // The total number of loadEvents include 3 stages before embedded players are loaded\r\n  m.loadEventsTotal = 3 + parseInt(document.body.getAttribute('data-gallery-track-count'));\r\n\r\n  initYouTubeAPI();\r\n  initSoundCloudAPI();\r\n}\r\n\r\nfunction getLoadingPercent()\r\n{\r\n  return { loadingPercent: (100 * (m.loadEventsCount++ / m.loadEventsTotal)) };\r\n}\r\n\r\nfunction updatePlayersReady()\r\n{\r\n  if (m.loadEventsCount >= m.loadEventsTotal)\r\n    m.embeddedEvent(playbackEvents.EVENT.READY, { resetProgressBar: true });\r\n  else\r\n    playbackEvents.dispatch(playbackEvents.EVENT.LOADING, getLoadingPercent());\r\n}\r\n\r\n\r\n// ************************************************************************************************\r\n// Get and wrap all embedder players in MediaPlayer YouTube or SoundCloud classes\r\n// ************************************************************************************************\r\n\r\nfunction getAllPlayers()\r\n{\r\n  const entries = document.querySelectorAll('single-track');\r\n\r\n  entries.forEach(entry => \r\n  {\r\n    const iframe = entry.querySelector('iframe');\r\n    let player   = null;\r\n\r\n    if (config.youTubeIframeIdRegEx.test(iframe.id)) \r\n    {\r\n      const embeddedPlayer = new YT.Player(iframe.id, // eslint-disable-line no-undef\r\n      {\r\n        events:\r\n        {\r\n          onReady:       onYouTubePlayerReady,\r\n          onStateChange: onYouTubePlayerStateChange,\r\n          onError:       onYouTubePlayerError,\r\n        }\r\n      });\r\n\r\n      player = new mediaPlayers.YouTube(entry.id, iframe.id, embeddedPlayer, entry.getAttribute('data-track-source-data'));\r\n    }\r\n    else if (config.soundCloudIframeIdRegEx.test(iframe.id))\r\n    {\r\n      /* eslint-disable */\r\n      const embeddedPlayer = SC.Widget(iframe.id);\r\n      player = new mediaPlayers.SoundCloud(entry.id, iframe.id, embeddedPlayer, iframe.src);\r\n\r\n      // Preload thumbnail image as early as possible\r\n      embeddedPlayer.bind(SC.Widget.Events.READY, () =>\r\n      {\r\n        player.setThumbnail(entry.querySelector('.track-share-control span'));\r\n        onSoundCloudPlayerEventReady();\r\n      });\r\n\r\n      embeddedPlayer.bind(SC.Widget.Events.PLAY,   onSoundCloudPlayerEventPlay);\r\n      embeddedPlayer.bind(SC.Widget.Events.PAUSE,  onSoundCloudPlayerEventPause);\r\n      embeddedPlayer.bind(SC.Widget.Events.FINISH, onSoundCloudPlayerEventFinish);\r\n      embeddedPlayer.bind(SC.Widget.Events.ERROR,  onSoundCloudPlayerEventError);\r\n      /* eslint-enable */\r\n    }\r\n\r\n    if (player !== null)\r\n    {\r\n      player.setTitle(entry.getAttribute('data-track-title'));\r\n      player.setArtist(entry.getAttribute('data-track-artist'));\r\n      m.players.add(player);\r\n    }\r\n  });\r\n}\r\n\r\n\r\n// ************************************************************************************************\r\n// Helper functions for the YouTube and SoundCloud MediaPlayer classes\r\n// ************************************************************************************************\r\n\r\nfunction onPlayerError(player, mediaUrl)\r\n{\r\n  debug.log('onPlayerError()');\r\n  debug.log(player);\r\n\r\n  const eventSource = (player instanceof mediaPlayers.SoundCloud)\r\n                        ? eventLogger.SOURCE.SOUNDCLOUD\r\n                        : eventLogger.SOURCE.YOUTUBE;\r\n\r\n  // Stop the current track if it is not the one we are going to next\r\n  if (m.players.isCurrent(player.getUid()) === false)\r\n    m.players.stop();\r\n  \r\n  eventLog.add(eventSource, eventLogger.EVENT.PLAYER_ERROR, player.getUid());\r\n  m.embeddedEvent(playbackEvents.EVENT.MEDIA_UNAVAILABLE, getPlayerErrorData(player, mediaUrl));\r\n}\r\n\r\nfunction getPlayerErrorData(player, mediaUrl)\r\n{\r\n  const artist = player.getArtist() || 'N/A';\r\n  const title  = player.getTitle()  || 'N/A';\r\n\r\n  return {\r\n    currentTrack: m.players.trackFromUid(player.getUid()),\r\n    numTracks:    m.players.getNumTracks(),\r\n    trackId:      player.getTrackId(),\r\n    mediaTitle:   `${artist} - ${title}`,\r\n    mediaUrl:     mediaUrl,\r\n  };\r\n}\r\n\r\n\r\n// ************************************************************************************************\r\n// YouTube init and event functions\r\n// https://developers.google.com/youtube/iframe_api_reference\r\n// ************************************************************************************************\r\n\r\nfunction initYouTubeAPI()\r\n{\r\n  debug.log('initYouTubeAPI()');\r\n  playbackEvents.dispatch(playbackEvents.EVENT.LOADING, getLoadingPercent());\r\n\r\n  window.onYouTubeIframeAPIReady = function()\r\n  {\r\n    debug.log('onYouTubeIframeAPIReady()');\r\n    playbackEvents.dispatch(playbackEvents.EVENT.LOADING, getLoadingPercent());\r\n  \r\n    // ToDo: THIS SHOULD NOT BE TRIGGERED HERE ONLY?\r\n    getAllPlayers();\r\n  };\r\n\r\n  const tag = document.createElement('script');\r\n  tag.id    = 'youtube-iframe-api';\r\n  tag.src   = 'https://www.youtube.com/iframe_api';\r\n  const firstScriptTag = document.getElementsByTagName('script')[0];\r\n  firstScriptTag.parentNode.insertBefore(tag, firstScriptTag);\r\n}\r\n  \r\nfunction onYouTubePlayerReady()\r\n{\r\n  debug.log('onYouTubePlayerReady()');\r\n  updatePlayersReady();\r\n}\r\n\r\nfunction onYouTubePlayerStateChange(event)\r\n{\r\n  eventLog.add(eventLogger.SOURCE.YOUTUBE, event.data, event.target.h.id);\r\n\r\n  switch (event.data)\r\n  {\r\n    /* eslint-disable */\r\n    case YT.PlayerState.UNSTARTED: onYouTubeStateUnstarted(event); break;\r\n    case YT.PlayerState.BUFFERING: onYouTubeStateBuffering(event); break;\r\n    case YT.PlayerState.PLAYING:   onYouTubeStatePlaying(event);   break;\r\n    case YT.PlayerState.PAUSED:    onYouTubeStatePaused(event);    break;\r\n    case YT.PlayerState.CUED:      onYouTubeStateCued(event);      break;\r\n    case YT.PlayerState.ENDED:     onYouTubeStateEnded(event);     break;\r\n    /* eslint-enable */\r\n  }\r\n}\r\n\r\nfunction onYouTubeStateUnstarted(event)\r\n{\r\n  debug.log(`onYouTubePlayerStateChange: UNSTARTED (uID: ${event.target.h.id})`);\r\n  \r\n  if (eventLog.ytAutoplayBlocked(event.target.h.id, 3000))\r\n    m.embeddedEvent(playbackEvents.EVENT.AUTOPLAY_BLOCKED);\r\n}\r\n\r\nfunction onYouTubeStateBuffering(event)\r\n{\r\n  debug.log(`onYouTubePlayerStateChange: BUFFERING (uID: ${event.target.h.id})`);\r\n\r\n  if (m.players.crossfade.isFading() === false)\r\n  {\r\n    const player = m.players.playerFromUid(event.target.h.id);\r\n    player.mute(settings.playback.masterMute);\r\n    player.setVolume(settings.playback.masterVolume);\r\n    playbackEvents.dispatch(playbackEvents.EVENT.MEDIA_LOADING);\r\n  }\r\n}\r\n\r\nfunction onYouTubeStatePlaying(event)\r\n{\r\n  debug.log(`onYouTubePlayerStateChange: PLAYING   (uID: ${event.target.h.id})`);\r\n  \r\n  // Call order is important on play events for state handling: Always sync first!\r\n  m.playbackState.syncAll(event.target.h.id, m.playbackState.STATE.PLAY);\r\n  m.players.current.setDuration(Math.round(event.target.getDuration()));\r\n  playbackTimer.start();\r\n}\r\n\r\nfunction onYouTubeStatePaused(event)\r\n{\r\n  debug.log(`onYouTubePlayerStateChange: PAUSED    (uID: ${event.target.h.id})`);\r\n\r\n  if (m.players.isCurrent(event.target.h.id))\r\n  {\r\n    m.playbackState.syncAll(event.target.h.id, m.playbackState.STATE.PAUSE);\r\n    playbackTimer.stop(false);\r\n  }\r\n  else\r\n  {\r\n    m.players.crossfade.stop();\r\n  }\r\n}\r\n\r\nfunction onYouTubeStateCued(event)\r\n{\r\n  debug.log(`onYouTubePlayerStateChange: CUED      (uID: ${event.target.h.id})`);\r\n}\r\n\r\nfunction onYouTubeStateEnded(event)\r\n{\r\n  debug.log(`onYouTubePlayerStateChange: ENDED     (uID: ${event.target.h.id})`);\r\n\r\n  if (m.players.isCurrent(event.target.h.id))\r\n  {\r\n    playbackTimer.stop(true);\r\n    m.embeddedEvent(playbackEvents.EVENT.MEDIA_ENDED);\r\n  }\r\n  else\r\n  {\r\n    m.players.crossfade.stop();\r\n  }\r\n}\r\n\r\nfunction onYouTubePlayerError(event)\r\n{\r\n  debug.log('onYouTubePlayerError: ' + event.data);\r\n\r\n  const player = m.players.playerFromUid(event.target.h.id);\r\n  player.setPlayable(false);\r\n  onPlayerError(player, event.target.getVideoUrl());\r\n}\r\n\r\n\r\n// ************************************************************************************************\r\n// SoundCloud init and event functions\r\n// https://developers.soundcloud.com/docs/api/html5-widget\r\n// ************************************************************************************************\r\n\r\nfunction initSoundCloudAPI()\r\n{\r\n  debug.log('initSoundCloudAPI()');\r\n  playbackEvents.dispatch(playbackEvents.EVENT.LOADING, getLoadingPercent());\r\n}\r\n\r\nfunction onSoundCloudPlayerEventReady()\r\n{\r\n  debug.log('onSoundCloudPlayerEventReady()');\r\n  updatePlayersReady();\r\n}\r\n\r\nfunction onSoundCloudPlayerEventPlay(event)\r\n{\r\n  debug.log(`onSoundCloudPlayerEvent: PLAY   (uID: ${event.soundId})`);\r\n  eventLog.add(eventLogger.SOURCE.SOUNDCLOUD, eventLogger.EVENT.STATE_PLAYING, event.soundId);\r\n\r\n  if (m.players.crossfade.isFading() && m.players.isCurrent(event.soundId))\r\n  {\r\n    // Call order is important on play events for state handling: Always sync first!\r\n    if (eventLog.scPlayDoubleTrigger(event.soundId, (config.maxPlaybackStartDelay * 1000)))\r\n      m.playbackState.syncAll(event.soundId, m.playbackState.STATE.PLAY);\r\n  }\r\n  else\r\n  {\r\n    // Call order is important on play events for state handling: Always sync first!\r\n    m.playbackState.syncAll(event.soundId, m.playbackState.STATE.PLAY);\r\n\r\n    m.players.current.mute(settings.playback.masterMute);\r\n    m.players.current.setVolume(settings.playback.masterVolume);\r\n  }\r\n\r\n  m.players.current.getEmbeddedPlayer().getDuration(durationMilliseconds =>\r\n  {\r\n    m.players.current.setDuration(Math.round(durationMilliseconds / 1000));\r\n    playbackTimer.start();\r\n  });  \r\n}\r\n\r\nfunction onSoundCloudPlayerEventPause(event)\r\n{\r\n  debug.log(`onSoundCloudPlayerEvent: PAUSE  (uID: ${event.soundId})`);\r\n  eventLog.add(eventLogger.SOURCE.SOUNDCLOUD, eventLogger.EVENT.STATE_PAUSED, event.soundId);\r\n  \r\n  if (eventLog.scAutoplayBlocked(event.soundId, 3000))\r\n  {\r\n    playbackTimer.stop(false);\r\n    m.embeddedEvent(playbackEvents.EVENT.AUTOPLAY_BLOCKED);\r\n  }\r\n  else if (eventLog.scWidgetPlayBlocked(event.soundId, 30000))\r\n  {\r\n    playbackTimer.stop(false);\r\n    m.embeddedEvent(playbackEvents.EVENT.PLAYBACK_BLOCKED, { currentTrack: m.players.trackFromUid(event.soundId), numTracks: m.players.getNumTracks() });\r\n  }\r\n  else\r\n  {\r\n    // Only sync state if we get pause events on the same (current) player\r\n    if (m.players.isCurrent(event.soundId))\r\n    {\r\n      m.players.current.getPosition(positionMilliseconds =>\r\n      {\r\n        if (positionMilliseconds > 0)\r\n        {\r\n          m.playbackState.syncAll(event.soundId, m.playbackState.STATE.PAUSE);\r\n          playbackTimer.stop(false);\r\n        }\r\n      });    \r\n    }\r\n    else\r\n    {\r\n      m.players.crossfade.stop();\r\n    }\r\n  }\r\n}\r\n\r\nfunction onSoundCloudPlayerEventFinish(event)\r\n{\r\n  debug.log(`onSoundCloudPlayerEvent: FINISH (uID: ${event.soundId})`);\r\n\r\n  if (m.players.isCurrent(event.soundId))\r\n  {\r\n    playbackTimer.stop(true);\r\n    m.embeddedEvent(playbackEvents.EVENT.MEDIA_ENDED);\r\n  }\r\n  else\r\n  {\r\n    m.players.crossfade.stop();\r\n  }\r\n}\r\n\r\nfunction onSoundCloudPlayerEventError()\r\n{\r\n  this.getCurrentSound(soundObject =>\r\n  {\r\n    const player = m.players.playerFromUid(soundObject.id);\r\n    debug.log(`onSoundCloudPlayerEvent: ERROR for track: ${m.players.trackFromUid(soundObject.id)}. ${player.getArtist()} - ${player.getTitle()} - [${player.getUid()} / ${player.getIframeId()}]`);\r\n    player.setPlayable(false);\r\n  });\r\n}\r\n", "//\r\n// Gallery playback events module\r\n//\r\n// https://ultrafunk.com\r\n//\r\n\r\n\r\nimport * as debugLogger          from '../../shared/debuglogger.js';\r\nimport { KEY }                   from '../../shared/storage.js';\r\nimport { replaceClass }          from '../../shared/utils.js';\r\nimport { response, settings }    from '../../shared/session-data.js';\r\nimport { EVENT, addListener }    from '../playback-events.js';\r\nimport { updateProgressPercent } from '../playback-controls.js';\r\n\r\nimport {\r\n  playerScrollTo,\r\n  autoplayNavTo,\r\n} from '../shared-gallery-list.js';\r\n\r\nimport {\r\n  showSnackbar,\r\n  dismissSnackbar,\r\n} from '../../shared/snackbar.js';\r\n\r\n\r\nexport { init };\r\n\r\n\r\n/*************************************************************************************************/\r\n\r\n\r\nconst debug = debugLogger.newInstance('gallery-events');\r\n\r\nconst m = {\r\n  snackbarId:      0,\r\n  nowPlayingIcons: null,\r\n};\r\n\r\nconst config = {\r\n  nowPlayingIconsSelector: 'h2.entry-title',\r\n};\r\n\r\n\r\n// ************************************************************************************************\r\n// \r\n// ************************************************************************************************\r\n\r\nfunction init()\r\n{\r\n  debug.log('init()');\r\n  \r\n  m.nowPlayingIcons = document.querySelectorAll(config.nowPlayingIconsSelector);\r\n\r\n  addListener(EVENT.MEDIA_PLAYING,     mediaPlaying);\r\n  addListener(EVENT.MEDIA_PAUSED,      mediaPaused);\r\n  addListener(EVENT.MEDIA_ENDED,       mediaEnded);\r\n  addListener(EVENT.MEDIA_SHOW,        mediaShow);\r\n  addListener(EVENT.CONTINUE_AUTOPLAY, continueAutoplay);\r\n  addListener(EVENT.RESUME_AUTOPLAY,   resumeAutoplay);\r\n  addListener(EVENT.AUTOPLAY_BLOCKED,  autoplayBlocked);\r\n  addListener(EVENT.PLAYBACK_BLOCKED,  playbackBlocked);\r\n  addListener(EVENT.MEDIA_UNAVAILABLE, mediaUnavailable);\r\n}\r\n\r\n\r\n// ************************************************************************************************\r\n// \r\n// ************************************************************************************************\r\n\r\nfunction mediaPlaying(playbackEvent)\r\n{\r\n  debug.log(playbackEvent);\r\n  \r\n  // If autoplayBlocked() snackbar is still visible, dismiss it when playback starts\r\n  dismissSnackbar(m.snackbarId);\r\n\r\n  if (playbackEvent.data.numTracks > 1)\r\n  {\r\n    const nowPlayingIcon = document.querySelector(`#${playbackEvent.data.trackId} ${config.nowPlayingIconsSelector}`);\r\n\r\n    resetNowPlayingIcons(nowPlayingIcon);\r\n    replaceClass(nowPlayingIcon, 'playing-paused', 'now-playing-icon');\r\n\r\n    if (settings.gallery.animateNowPlayingIcon)\r\n      nowPlayingIcon.classList.add('playing-animate');\r\n  }\r\n\r\n  /*\r\n  if (settings.mobile.keepScreenOn)\r\n    screenWakeLock.enable();\r\n  */\r\n}\r\n\r\nfunction mediaPaused(playbackEvent)\r\n{\r\n  debug.log(playbackEvent);\r\n\r\n  if (playbackEvent.data.numTracks > 1)\r\n    document.querySelector(`#${playbackEvent.data.trackId} ${config.nowPlayingIconsSelector}`).classList.add('playing-paused');\r\n\r\n  /*\r\n  if (settings.mobile.keepScreenOn)\r\n    screenWakeLock.disable();\r\n  */\r\n}\r\n\r\nfunction mediaEnded(playbackEvent)\r\n{\r\n  debug.log(playbackEvent);\r\n\r\n  updateProgressPercent(0);\r\n\r\n  if ((playbackEvent !== null) && (playbackEvent.data.numTracks > 1))\r\n    resetNowPlayingIcons();\r\n}\r\n\r\nfunction mediaShow(playbackEvent)\r\n{\r\n  debug.log(playbackEvent);\r\n\r\n  updateProgressPercent(0);\r\n\r\n  if (playbackEvent.data.scrollToMedia)\r\n    playerScrollTo(playbackEvent.data.trackId);\r\n}\r\n\r\nfunction continueAutoplay(playbackEvent)\r\n{\r\n  debug.log(playbackEvent);\r\n  autoplayNavTo(response.nextPage, true);\r\n}\r\n\r\nfunction resumeAutoplay(playbackEvent)\r\n{\r\n  const autoplayData = JSON.parse(sessionStorage.getItem(KEY.UF_AUTOPLAY));\r\n  sessionStorage.removeItem(KEY.UF_AUTOPLAY);\r\n\r\n  debug.log(playbackEvent);\r\n  debug.log(`RESUME_AUTOPLAY: ${(autoplayData !== null) ? JSON.stringify(autoplayData) : 'NO'}`);\r\n\r\n  if (autoplayData !== null)\r\n  {\r\n    const iframeId = document.getElementById(autoplayData.trackId)?.querySelector('iframe').id;\r\n    playbackEvent.callback.resumeAutoplay(autoplayData, iframeId);\r\n  }\r\n}\r\n\r\nfunction autoplayBlocked(playbackEvent)\r\n{\r\n  debug.log(playbackEvent);\r\n  m.snackbarId = showSnackbar('Autoplay blocked, Play to continue', 0, 'play', () => playbackEvent.callback.togglePlayPause());\r\n}\r\n\r\nfunction playbackBlocked(playbackEvent)\r\n{\r\n  debug.log(playbackEvent);\r\n  showSnackbar('Unable to play track, skipping to next', 5, 'Stop', () => {}, () => playbackEventErrorTryNext(playbackEvent));\r\n}\r\n\r\nfunction mediaUnavailable(playbackEvent)\r\n{\r\n  debug.log(playbackEvent);\r\n\r\n  if (isPremiumTrack(playbackEvent.data.trackId))\r\n  {\r\n    showSnackbar('YouTube Premium track, skipping', 5, 'help',  () => (window.location.href = '/channel/premium/'), () => playbackEventErrorTryNext(playbackEvent));\r\n  }\r\n  else\r\n  {\r\n    showSnackbar('Unable to play track, skipping to next', 5, 'Stop', () => {}, () => playbackEventErrorTryNext(playbackEvent));\r\n    debugLogger.logErrorOnServer('EVENT_MEDIA_UNAVAILABLE', playbackEvent.data);\r\n  }\r\n}\r\n\r\n\r\n// ************************************************************************************************\r\n// \r\n// ************************************************************************************************\r\n\r\nfunction resetNowPlayingIcons(nowPlayingElement)\r\n{\r\n  m.nowPlayingIcons.forEach(element =>\r\n  {\r\n    if (element !== nowPlayingElement)\r\n      element.classList.remove('now-playing-icon', 'playing-animate', 'playing-paused');\r\n  });\r\n}\r\n\r\nfunction playbackEventErrorTryNext(playbackEvent)\r\n{\r\n  if (playbackEvent.data.currentTrack < playbackEvent.data.numTracks)\r\n  {\r\n    // Only supports skipping FORWARD for now...\r\n    playbackEvent.callback.skipToTrack(playbackEvent.data.currentTrack + 1, true);\r\n  }\r\n  else\r\n  {\r\n    if (response.nextPage !== null)\r\n      autoplayNavTo(response.nextPage, true);\r\n  }\r\n}\r\n\r\nfunction isPremiumTrack(trackId)\r\n{\r\n  const postWithId = document.getElementById(trackId);\r\n\r\n  if (postWithId !== null)\r\n    return postWithId.classList.contains('uf_channel-premium');\r\n  \r\n  return false;\r\n}\r\n", "//\r\n// Crossfade UI controls\r\n//\r\n// https://ultrafunk.com\r\n//\r\n\r\n\r\nimport * as debugLogger    from '../../shared/debuglogger.js';\r\nimport * as playbackEvents from '../playback-events.js';\r\nimport { isPlaying }       from '../playback-controls.js';\r\nimport { presetList }      from '../../shared/settings/settings.js';\r\nimport { replaceClass }    from '../../shared/utils.js';\r\nimport { settings }        from '../../shared/session-data.js';\r\n\r\nimport {\r\n  STATE,\r\n  ElementsWrapper\r\n} from '../element-wrappers.js';\r\n\r\n\r\nexport {\r\n  init,\r\n  ready,\r\n};\r\n\r\n\r\n/*************************************************************************************************/\r\n\r\n\r\nconst debug = debugLogger.newInstance('crossfade-controls');\r\nconst m     = { players: {} };\r\nconst ctrl  = {};\r\n\r\nconst config = {\r\n  crossfadePresetSelector: '.crossfade-preset-control',\r\n  crossfadePresetData:     'data-crossfade-preset',\r\n  crossfadeToSelector:     '.crossfade-fadeto-control',\r\n};\r\n\r\n\r\n// ************************************************************************************************\r\n// Init and make ready all controls\r\n// ************************************************************************************************\r\n\r\nfunction init(mediaPlayers, crossfadeClickCallback)\r\n{\r\n  debug.log('init()');\r\n\r\n  m.players = mediaPlayers;\r\n\r\n  ctrl.crossfadePreset = new ElementsWrapper(config.crossfadePresetSelector);\r\n  ctrl.crossfadeTo     = new ElementsWrapper(config.crossfadeToSelector);\r\n\r\n  if ((ctrl.crossfadePreset.length > 1) && (ctrl.crossfadeTo.length > 1))\r\n  {\r\n    ctrl.crossfadePreset.forEach(element => setCrossfadePreset(element, settings.gallery.trackCrossfadeDefPreset));\r\n    ctrl.crossfadeTo.clickCallback = crossfadeClickCallback;\r\n  }\r\n\r\n  playbackEvents.addListener(playbackEvents.EVENT.READY, ready);\r\n}\r\n\r\nfunction ready()\r\n{\r\n  debug.log('ready()');\r\n\r\n  if ((ctrl.crossfadePreset.length > 1) && (ctrl.crossfadeTo.length > 1))\r\n  {\r\n    ctrl.crossfadePreset.forEach(element =>\r\n    {\r\n      element.addEventListener('click', crossfadePresetClick);\r\n      replaceClass(element, STATE.DISABLED.CLASS, STATE.ENABLED.CLASS);\r\n    });\r\n\r\n    ctrl.crossfadeTo.forEach(element => element.addEventListener('click', crossfadeToClick));\r\n\r\n    playbackEvents.addListener(playbackEvents.EVENT.MEDIA_PLAYING, updateCrossfadeToState);\r\n    playbackEvents.addListener(playbackEvents.EVENT.MEDIA_PAUSED,  updateCrossfadeToState);\r\n  }\r\n}\r\n\r\n\r\n// ************************************************************************************************\r\n// Crossfade controls (preset and fadeTo)\r\n// ************************************************************************************************\r\n\r\nfunction setCrossfadePreset(element, index)\r\n{\r\n  element.setAttribute(config.crossfadePresetData, index);\r\n  element.textContent = `${index + 1}`;\r\n  element.title       = `Preset: ${presetList.crossfade[index].name}`;\r\n}\r\n\r\nfunction crossfadePresetClick(event)\r\n{\r\n  const index = parseInt(event.target.getAttribute(config.crossfadePresetData));\r\n  setCrossfadePreset(event.target, ((index + 1) < presetList.crossfade.length) ? (index + 1) : 0);\r\n}\r\n\r\nfunction crossfadeToClick(event)\r\n{\r\n  if (isPlaying() && (m.players.crossfade.isFading() === false))\r\n  {\r\n    const element = event.target.closest('single-track');\r\n\r\n    if (element !== null)\r\n    {\r\n      const iframe = element.querySelector('iframe');\r\n      const index  = parseInt(element.querySelector(config.crossfadePresetSelector).getAttribute(config.crossfadePresetData));\r\n\r\n      replaceClass(element.querySelector(`div${config.crossfadeToSelector}`), STATE.ENABLED.CLASS, STATE.DISABLED.CLASS);\r\n      ctrl.crossfadeTo.clickCallback(m.players.uIdFromIframeId(iframe.id), presetList.crossfade[index]);\r\n    }\r\n  }\r\n}\r\n\r\nfunction updateCrossfadeToState()\r\n{\r\n  const isPlayingState = isPlaying();\r\n  const currentTrack   = isPlayingState ? m.players.getTrackData().currentTrack : -1;\r\n\r\n  debug.log(`updateCrossfadeToState() - playingState: ${isPlayingState} - currentTrack: ${currentTrack}`);\r\n\r\n  ctrl.crossfadeTo.forEach((element, index) =>\r\n  {\r\n    if (currentTrack === (index + 1))\r\n      replaceClass(element, (isPlayingState ? STATE.ENABLED.CLASS : STATE.DISABLED.CLASS), (isPlayingState ? STATE.DISABLED.CLASS : STATE.ENABLED.CLASS));\r\n    else\r\n      replaceClass(element, (isPlayingState ? STATE.DISABLED.CLASS : STATE.ENABLED.CLASS), (isPlayingState ? STATE.ENABLED.CLASS : STATE.DISABLED.CLASS));\r\n  });\r\n}\r\n", "//\r\n// Gallery players module\r\n//\r\n// https://ultrafunk.com\r\n//\r\n\r\n\r\nimport * as debugLogger       from '../../shared/debuglogger.js';\r\nimport * as crossfadeModule   from './crossfade.js';\r\nimport { settings }           from '../../shared/session-data.js';\r\nimport { EVENT, addListener } from '../playback-events.js';\r\n\r\n\r\nexport { galleryPlayers };\r\n\r\n\r\n/*************************************************************************************************/\r\n\r\n\r\nconst debug = debugLogger.newInstance('gallery-players');\r\n\r\n\r\n// ************************************************************************************************\r\n// Media players closure\r\n// ************************************************************************************************\r\n\r\nconst galleryPlayers = (() =>\r\n{\r\n  let playTrack      = null;\r\n  let crossfade      = null;\r\n  const mediaPlayers = [];\r\n  const indexMap     = new Map();\r\n  let playerIndex    = 0;\r\n\r\n  return {\r\n  // Objects\r\n    indexMap,\r\n  // Functions\r\n    init,\r\n    get crossfade()                 { return crossfade;                       },\r\n    add,\r\n    getPlayerIndex()                { return playerIndex;                     },\r\n    setPlayerIndex(nextPlayerIndex) { playerIndex = nextPlayerIndex;          },\r\n    get current()                   { return mediaPlayers[playerIndex];       },\r\n    get next()                      { return mediaPlayers[playerIndex + 1];   },\r\n    getNumTracks()                  { return mediaPlayers.length;             },\r\n    getCurrentTrack()               { return playerIndex + 1;                 },\r\n    playerFromUid(uId)              { return mediaPlayers[indexMap.get(uId)]; },\r\n    trackFromUid(uId)               { return (indexMap.get(uId) + 1);         },\r\n    isCurrent(uId)                  { return (uId === this.current.getUid()); },\r\n    uIdFromIframeId,\r\n    stop,\r\n    mute,\r\n    getTrackData,\r\n    prevTrack,\r\n    nextTrack,\r\n    jumpToTrack,\r\n  };\r\n\r\n  function init(playTrackCallback)\r\n  {\r\n    debug.log('init()');\r\n\r\n    playTrack = playTrackCallback;\r\n    crossfade = crossfadeModule.getInstance(this);\r\n\r\n    addListener(EVENT.MEDIA_PLAYING, () => crossfade.start());\r\n    addListener(EVENT.MEDIA_PAUSED,  () => crossfade.stop());\r\n  }\r\n\r\n  function add(player)\r\n  {\r\n    debug.log(player);\r\n    \r\n    mediaPlayers.push(player);\r\n    indexMap.set(player.getUid(), mediaPlayers.length - 1);\r\n  }\r\n\r\n  function uIdFromIframeId(iframeId)\r\n  {\r\n    return mediaPlayers.find(player => (player.iframeId === iframeId)).getUid();\r\n  }\r\n\r\n  function stop()\r\n  {\r\n    this.current.stop();\r\n    crossfade.stop();\r\n  }\r\n  \r\n  function mute()\r\n  {\r\n    this.current.mute(settings.playback.masterMute);\r\n    crossfade.mute(settings.playback.masterMute);\r\n  }\r\n\r\n  function getTrackData()\r\n  {\r\n    return {\r\n      currentTrack: this.getCurrentTrack(),\r\n      numTracks:    this.getNumTracks(),\r\n      artist:       this.current.getArtist(),\r\n      title:        this.current.getTitle(),\r\n      thumbnail:    { src: this.current.getThumbnailSrc(), class: this.current.getThumbnailClass() },\r\n    };\r\n  }\r\n\r\n  function prevTrack(playMedia)\r\n  {\r\n    if (playerIndex > 0)\r\n    {\r\n      playerIndex--;\r\n      playTrack(playMedia);\r\n      return true;\r\n    }\r\n    \r\n    return false;\r\n  }\r\n  \r\n  function nextTrack(playMedia)\r\n  {\r\n    playerIndex++;\r\n    \r\n    if (playerIndex < this.getNumTracks())\r\n    {\r\n      playTrack(playMedia);\r\n      return true;\r\n    }\r\n    \r\n    return false;\r\n  }\r\n  \r\n  function jumpToTrack(track, playMedia, scrollToMedia = true)\r\n  {\r\n    if ((track > 0) && (track <= this.getNumTracks()))\r\n    {\r\n      playerIndex = track - 1;\r\n      playTrack(playMedia, scrollToMedia);\r\n      return true;\r\n    }\r\n  \r\n    return false;\r\n  }\r\n});\r\n", "//\r\n// List playback module\r\n//\r\n// https://ultrafunk.com\r\n//\r\n\r\n\r\nimport * as debugLogger       from '../../shared/debuglogger.js';\r\nimport * as eventLogger       from '../eventlogger.js';\r\nimport * as playbackControls  from '../playback-controls.js';\r\nimport * as listControls      from './list-controls.js';\r\nimport * as mediaPlayers      from '../mediaplayers.js';\r\nimport * as playbackEvents    from '../playback-events.js';\r\nimport * as utils             from '../../shared/utils.js';\r\nimport { KEY }                from '../../shared/storage.js';\r\nimport { STATE }              from '../element-wrappers.js';\r\nimport { playbackTimer }      from './list-playback-timer.js';\r\nimport { response, settings } from '../../shared/session-data.js';\r\n\r\nimport {\r\n  TRACK_TYPE,\r\n  playerScrollTo,\r\n  autoplayNavTo,\r\n} from '../shared-gallery-list.js';\r\n\r\nimport {\r\n  showSnackbar,\r\n  dismissSnackbar,\r\n} from '../../shared/snackbar.js';\r\n\r\n\r\nexport {\r\n  init,\r\n  togglePlayPause,\r\n  prevTrack,\r\n  nextTrack,\r\n  toggleMute,\r\n  getStatus,\r\n};\r\n\r\n\r\n/*************************************************************************************************/\r\n\r\n\r\nconst debug    = debugLogger.newInstance('list-playback');\r\nconst eventLog = new eventLogger.Playback(10);\r\n\r\nconst m = {\r\n  player:            null,\r\n  autoplayData:      null,\r\n  playerReady:       false,\r\n  firstStatePlaying: true,\r\n  currentTrackId:    null,\r\n  currentSnackbarId: 0,\r\n};\r\n\r\n\r\n// ************************************************************************************************\r\n//\r\n// ************************************************************************************************\r\n\r\nfunction init()\r\n{\r\n  debug.log('init()');\r\n\r\n  listControls.init(setCurrentTrack);\r\n  \r\n  if (cueInitialTrack() !== null)\r\n    initYouTubeAPI();\r\n  else\r\n    showSnackbar('No playable YouTube tracks!', 0, 'help', () => (window.location.href = \"/help/#list-player\"));\r\n}\r\n\r\n\r\n// ************************************************************************************************\r\n//\r\n// ************************************************************************************************\r\n\r\nfunction cueInitialTrack()\r\n{\r\n  m.currentTrackId = listControls.getNextPlayableId();\r\n  m.autoplayData   = JSON.parse(sessionStorage.getItem(KEY.UF_AUTOPLAY));\r\n  sessionStorage.removeItem(KEY.UF_AUTOPLAY);\r\n\r\n  if (m.currentTrackId !== null)\r\n  {\r\n    if ((m.autoplayData !== null) && (m.autoplayData.trackId !== null))\r\n    {\r\n      const matchesVideoId = m.autoplayData.trackId.match(mediaPlayers.youTubeVideoIdRegEx);\r\n      \r\n      if (matchesVideoId !== null)\r\n      {\r\n        const trackElement = listControls.queryTrack(`[data-track-source-uid=\"${matchesVideoId[0]}\"]`);\r\n\r\n        if (trackElement !== null)\r\n          m.currentTrackId = trackElement.id;\r\n      }\r\n      else if (m.autoplayData.trackId.match(/^track-(?!0)\\d{1,9}$/i) !== null)\r\n      {\r\n        const trackElement = listControls.queryTrack(`[data-track-id=\"${m.autoplayData.trackId}\"]`);\r\n\r\n        if (trackElement !== null)\r\n        {\r\n          if (listControls.getTrackType(trackElement) === TRACK_TYPE.YOUTUBE)\r\n            m.currentTrackId = trackElement.id;\r\n          else\r\n            showSnackbar('Cannot play SoundCloud track', 5, 'help', () => (window.location.href = \"/help/#list-player\"));\r\n        }\r\n        else\r\n        {\r\n          showSnackbar('Unable to cue track (not found)', 5);\r\n        }\r\n      }\r\n    }\r\n  \r\n    listControls.setCuedTrack(m.currentTrackId);\r\n  }\r\n\r\n  debug.log(`cueInitialTrack() - currentTrackId: ${m.currentTrackId} - autoplayData: ${(m.autoplayData !== null) ? JSON.stringify(m.autoplayData) : 'N/A'}`);\r\n\r\n  return m.currentTrackId;\r\n}\r\n\r\n\r\n// ************************************************************************************************\r\n//\r\n// ************************************************************************************************\r\n\r\nfunction setCurrentTrack(nextTrackId, playNextTrack = true, isPointerClick = false)\r\n{\r\n  const nextTrackType = listControls.getTrackType(listControls.queryTrackId(nextTrackId));\r\n\r\n  debug.log(`setCurrentTrack() - nextTrackType: ${debug.getObjectKeyForValue(TRACK_TYPE, nextTrackType)} - nextTrackId: ${nextTrackId} - playNextTrack: ${playNextTrack} - isPointerClick: ${isPointerClick}`);\r\n\r\n  if ((nextTrackType === TRACK_TYPE.SOUNDCLOUD) && isPointerClick)\r\n  {\r\n    showSnackbar('Cannot play SoundCloud track', 5, 'help', () => (window.location.href = \"/help/#list-player\"));\r\n    return;\r\n  }\r\n\r\n  if (nextTrackId === m.currentTrackId)\r\n  {\r\n    togglePlayPause();\r\n  }\r\n  else\r\n  {\r\n    if (playbackControls.isPlaying())\r\n      m.player.embedded.stopVideo();\r\n\r\n    m.currentTrackId = nextTrackId;\r\n\r\n    listControls.setNextTrackState(nextTrackId, isPointerClick);\r\n    loadOrCueCurrentTrack(playNextTrack);\r\n  }\r\n}\r\n\r\nfunction loadOrCueCurrentTrack(playTrack)\r\n{\r\n  const sourceUid = listControls.updateTrackDetails();\r\n  \r\n  if (playTrack)\r\n  {\r\n    m.player.embedded.loadVideoById(sourceUid);\r\n    listControls.setCurrentTrackState(STATE.PLAYING);\r\n    playbackControls.getSetTrackData();\r\n  }\r\n  else\r\n  {\r\n    m.player.embedded.cueVideoById(sourceUid);\r\n    listControls.setCurrentTrackState(STATE.PAUSED);\r\n  }\r\n}\r\n\r\n\r\n// ************************************************************************************************\r\n//\r\n// ************************************************************************************************\r\n\r\nfunction togglePlayPause()\r\n{\r\n  if (m.currentTrackId === null)\r\n  {\r\n    setCurrentTrack(listControls.queryTrack('div.track-entry.current').id);\r\n  }\r\n  else\r\n  {\r\n    if (playbackControls.isPlaying())\r\n      m.player.embedded.pauseVideo();\r\n    else\r\n      m.player.play(onYouTubePlayerError);\r\n  }\r\n}\r\n\r\nfunction toggleMute(setCurrentSetting = false)\r\n{\r\n  if (setCurrentSetting === false)\r\n    settings.playback.masterMute = (settings.playback.masterMute === true) ? false : true;\r\n\r\n  if (settings.playback.masterMute)\r\n    m.player.embedded.mute();\r\n  else\r\n    m.player.embedded.unMute();\r\n}\r\n\r\nfunction prevTrack()\r\n{\r\n  const prevTrackId = listControls.getPrevPlayableId();\r\n  const position    = m.player.embedded.getCurrentTime();\r\n\r\n  if ((prevTrackId !== null) && (position <= 5))\r\n  {\r\n    setCurrentTrack(prevTrackId, playbackControls.isPlaying());\r\n    playbackControls.updatePrevState();\r\n  }\r\n  else if (position !== 0)\r\n  {\r\n    m.player.embedded.seekTo(0);\r\n    playbackTimer.update(0, 0);\r\n  }\r\n}\r\n\r\nfunction nextTrack()\r\n{\r\n  const nextTrackId = listControls.getNextPlayableId();\r\n\r\n  if (nextTrackId !== null)\r\n  {\r\n    setCurrentTrack(nextTrackId, playbackControls.isPlaying());\r\n    playbackControls.updateNextState();\r\n  }\r\n}\r\n\r\nasync function advanceToNextTrack(autoplay = false, isPlaybackError = false)\r\n{\r\n  const repeatMode  = isPlaybackError ? playbackControls.REPEAT.OFF : playbackControls.getRepeatMode();\r\n  const nextTrackId = listControls.getNextPlayableId();\r\n\r\n  debug.log(`advanceToNextTrack() autoplay: ${autoplay} - isPlaybackError: ${isPlaybackError} - nextTrackId: ${nextTrackId} - repeatMode: ${debug.getObjectKeyForValue(playbackControls.REPEAT, repeatMode)}`);\r\n\r\n  if (autoplay && (repeatMode === playbackControls.REPEAT.ONE))\r\n  {\r\n    m.player.embedded.seekTo(0);\r\n    m.player.play(onYouTubePlayerError);\r\n  }\r\n  else if (autoplay && (nextTrackId === null) && (repeatMode === playbackControls.REPEAT.ALL))\r\n  {\r\n    setCurrentTrack(listControls.getNextPlayableId(null)); // getNextPlayableId(null) means the nextTrackId will come from the top of the playlist\r\n    playerScrollTo(0);\r\n  }\r\n  else\r\n  {\r\n    if (nextTrackId === null)\r\n    {\r\n      if (settings.list.showLoadMoreTracks)\r\n      {\r\n        const tracksLoaded = await listControls.loadMoreTracks();\r\n\r\n        if (autoplay && tracksLoaded)\r\n          setCurrentTrack(listControls.getNextPlayableId());\r\n      }\r\n      else\r\n      {\r\n        autoplayNavTo(response.nextPage, autoplay);\r\n      }\r\n    }\r\n    else\r\n    {\r\n      autoplay ? setCurrentTrack(nextTrackId) : listControls.setCurrentTrackState(STATE.PAUSED);\r\n    }\r\n  }\r\n}\r\n\r\nfunction skipToNextTrack()\r\n{\r\n  if ((playbackControls.isPlaying() === false) && (m.autoplayData !== null))\r\n  {\r\n    eventLog.add(eventLogger.SOURCE.ULTRAFUNK, eventLogger.EVENT.RESUME_AUTOPLAY, null);\r\n    eventLog.add(eventLogger.SOURCE.YOUTUBE, -1, listControls.getNextPlayableId());\r\n  }\r\n\r\n  if (playbackControls.isPlaying() === false)\r\n    advanceToNextTrack(true, true);\r\n}\r\n\r\nfunction stopSkipToNextTrack()\r\n{\r\n  m.currentTrackId = null;\r\n  listControls.setCurrentTrackState(STATE.PAUSED);\r\n}\r\n\r\nfunction getStatus()\r\n{\r\n  const currentTrack = listControls.queryTrack('div.track-entry.current');\r\n\r\n  if (currentTrack !== null)\r\n  {\r\n    const allTracksList = listControls.queryTrackAll('div.track-entry');\r\n    const currentIndex  = Array.prototype.indexOf.call(allTracksList, currentTrack);\r\n\r\n    return {\r\n      isPlaying:    playbackControls.isPlaying(),\r\n      currentTrack: (currentIndex + 1),\r\n      position:     Math.ceil(m.player.embedded.getCurrentTime()),\r\n      numTracks:    m.player.getNumTracks(),\r\n      trackId:      allTracksList[currentIndex].getAttribute('data-track-id'),\r\n      iframeId:     'youtube-player',\r\n    };\r\n  }\r\n\r\n  return { isPlaying: false, currentTrack: 1, position: 0, trackId: 0 };\r\n}\r\n\r\n\r\n// ************************************************************************************************\r\n//\r\n// ************************************************************************************************\r\n\r\nfunction initYouTubeAPI()\r\n{\r\n  debug.log('initYouTubeAPI()');\r\n\r\n  window.onYouTubeIframeAPIReady = function()\r\n  {\r\n    debug.log('onYouTubeIframeAPIReady()');\r\n\r\n    // eslint-disable-next-line no-undef\r\n    const embeddedPlayer = new YT.Player('youtube-player',\r\n    {\r\n      events:\r\n      {\r\n        onReady:       onYouTubePlayerReady,\r\n        onStateChange: onYouTubePlayerStateChange,\r\n        onError:       onYouTubePlayerError,\r\n      }\r\n    });\r\n\r\n    m.player = new mediaPlayers.Playlist(embeddedPlayer);\r\n    playbackControls.init(m.player, (positionSeconds) => m.player.embedded.seekTo(positionSeconds));\r\n    playbackControls.updateProgressPercent(33);\r\n  };\r\n\r\n  const tag = document.createElement('script');\r\n  tag.id    = 'youtube-iframe-api';\r\n  tag.src   = 'https://www.youtube.com/iframe_api';\r\n  const firstScriptTag = document.getElementsByTagName('script')[0];\r\n  firstScriptTag.parentNode.insertBefore(tag, firstScriptTag);\r\n}\r\n\r\nfunction onYouTubePlayerReady()\r\n{\r\n  debug.log('onYouTubePlayerReady()');\r\n  \r\n  if (m.autoplayData?.autoplay === true)\r\n    eventLog.add(eventLogger.SOURCE.ULTRAFUNK, eventLogger.EVENT.RESUME_AUTOPLAY, null);\r\n\r\n  playbackControls.ready(prevTrack, togglePlayPause, nextTrack, toggleMute);\r\n  playbackControls.updateProgressPercent(66);\r\n  playbackTimer.ready(m.player);\r\n  listControls.ready(m.player);\r\n\r\n  toggleMute(true);\r\n  playbackEvents.dispatch(playbackEvents.EVENT.READY, { resetProgressBar: false });\r\n  loadOrCueCurrentTrack(m.autoplayData?.autoplay === true);\r\n}\r\n\r\nfunction onYouTubePlayerStateChange(event)\r\n{\r\n  debug.log(`onYouTubePlayerStateChange(): ${event.data} - trackId: ${m.currentTrackId}`);\r\n  eventLog.add(eventLogger.SOURCE.YOUTUBE, event.data, m.currentTrackId);\r\n\r\n  // Set playback controls state to YouTube state so we have a single source of truth = playbackControls.isPlaying()\r\n  if (event.data !== YT.PlayerState.PLAYING) // eslint-disable-line no-undef\r\n    playbackControls.setPauseState();\r\n\r\n  switch(event.data)\r\n  {\r\n    // eslint-disable-next-line no-undef\r\n    case YT.PlayerState.UNSTARTED:\r\n      {\r\n        if (eventLog.ytAutoplayBlocked(m.currentTrackId, 3000))\r\n        {\r\n          listControls.setCurrentTrackState(STATE.PAUSED);\r\n          m.currentSnackbarId = showSnackbar('Autoplay blocked, Play to continue', 0, 'play', () => m.player.play(onYouTubePlayerError));\r\n        }\r\n\r\n        if (m.playerReady === false)\r\n        {\r\n          m.playerReady = true;\r\n          playbackControls.updateProgressPercent(0);\r\n        }\r\n      }\r\n      break;\r\n\r\n    // eslint-disable-next-line no-undef\r\n    case YT.PlayerState.CUED:\r\n      m.player.setPlayerState(event.data); // For internal state when trying to play a track that does not exist\r\n      break;\r\n\r\n    // eslint-disable-next-line no-undef\r\n    case YT.PlayerState.BUFFERING:\r\n      playbackEvents.dispatch(playbackEvents.EVENT.MEDIA_LOADING);\r\n      break;\r\n    \r\n    // eslint-disable-next-line no-undef\r\n    case YT.PlayerState.PLAYING:\r\n      onYouTubeStatePlaying(event);\r\n      playbackEvents.dispatch(playbackEvents.EVENT.MEDIA_PLAYING);\r\n      break;\r\n\r\n    // eslint-disable-next-line no-undef\r\n    case YT.PlayerState.PAUSED:\r\n      listControls.setCurrentTrackState(STATE.PAUSED);\r\n      break;\r\n\r\n    // eslint-disable-next-line no-undef\r\n    case YT.PlayerState.ENDED:\r\n      playbackTimer.stop(true);\r\n      advanceToNextTrack(settings.playback.autoplay);\r\n      break;\r\n  }\r\n}\r\n\r\nfunction onYouTubeStatePlaying(event)\r\n{\r\n  dismissSnackbar(m.currentSnackbarId);\r\n  m.player.setDuration(Math.round(event.target.getDuration()));\r\n\r\n  if (m.firstStatePlaying)\r\n  {\r\n    m.firstStatePlaying = false;\r\n    m.autoplayData      = null;\r\n    \r\n    setTimeout(() =>\r\n    {\r\n      if (settings.playback.autoplay            &&\r\n          playbackControls.isPlaying()          &&\r\n          (Math.round(window.pageYOffset) <= 1) &&\r\n          utils.matchesMedia(utils.MATCH.SITE_MAX_WIDTH_MOBILE))\r\n      {\r\n        playerScrollTo(0);\r\n      }\r\n    },\r\n    6000);\r\n  }\r\n}\r\n\r\nfunction onYouTubePlayerError(event)\r\n{\r\n  debug.log(`onYouTubePlayerError(): ${event.data} - trackId: ${m.currentTrackId}`);\r\n\r\n  listControls.setTrackMessage('Error!');\r\n  eventLog.add(eventLogger.SOURCE.YOUTUBE, eventLogger.EVENT.PLAYER_ERROR, m.currentTrackId);\r\n  showSnackbar('Unable to play track, skipping to next', 5, 'Stop', stopSkipToNextTrack, skipToNextTrack);\r\n  \r\n  debugLogger.logErrorOnServer('EVENT_MEDIA_UNAVAILABLE', {\r\n    mediaUrl:   m.player.embedded.getVideoUrl(),\r\n    mediaTitle: `${m.player.getArtist()} - ${m.player.getTitle()}`,\r\n  });\r\n}\r\n", "//\r\n// List-player playback timer module\r\n//\r\n// https://ultrafunk.com\r\n//\r\n\r\n\r\nimport * as playbackControls from '../playback-controls.js';\r\nimport * as playbackEvents   from '../playback-events.js';\r\nimport { settings }          from '../../shared/session-data.js';\r\n\r\n\r\nexport { playbackTimer };\r\n\r\n\r\n/*************************************************************************************************/\r\n\r\n\r\nconst config = { updateTimerInterval: 250 }; // Milliseconds between each timer event\r\n\r\n\r\n// ************************************************************************************************\r\n// Playback timer and event handling module\r\n// ************************************************************************************************\r\n\r\nconst playbackTimer = (() =>\r\n{\r\n  let intervalId     = -1;\r\n  let lastPosSeconds = 0;\r\n  let isVisible      = true;\r\n  let player         = null;\r\n\r\n  return {\r\n    ready,\r\n    start,\r\n    stop,\r\n    update,\r\n  };\r\n\r\n  function ready(listPlayer)\r\n  {\r\n    player = listPlayer;\r\n    \r\n    playbackEvents.addListener(playbackEvents.EVENT.MEDIA_PLAYING, () => start());\r\n    document.addEventListener('visibilitychange', () => { isVisible = (document.visibilityState === 'visible') ? true : false; });\r\n  }\r\n  \r\n  function start()\r\n  {\r\n    stop();\r\n\r\n    intervalId = setInterval(() =>\r\n    {\r\n      if (isVisible && playbackControls.isPlaying())\r\n        update(player.embedded.getCurrentTime(), player.getDuration());\r\n    },\r\n    config.updateTimerInterval);\r\n  }\r\n  \r\n  function stop(resetState = false)\r\n  {\r\n    if (intervalId !== -1)\r\n    {\r\n      clearInterval(intervalId);\r\n      intervalId = -1;\r\n    }\r\n\r\n    if (resetState)\r\n      update(0, 0);\r\n\r\n    lastPosSeconds = 0;\r\n    playbackControls.blinkPlayPause(false);\r\n  }\r\n  \r\n  function update(positionSecondsDecimal, durationSeconds)\r\n  {\r\n    if (positionSecondsDecimal !== undefined)\r\n    {\r\n      const positionSeconds = Math.round(positionSecondsDecimal);\r\n\r\n      playbackControls.updateTimerAndProgress((positionSecondsDecimal * 1000), positionSeconds, durationSeconds);\r\n\r\n      if ((positionSeconds > 0) && (durationSeconds > 0))\r\n        updateTimeRemainingWarning(positionSeconds, durationSeconds);\r\n    }\r\n  }\r\n\r\n  function updateTimeRemainingWarning(positionSeconds, durationSeconds)\r\n  {\r\n    if ((settings.playback.autoplay === false)  &&\r\n         settings.playback.timeRemainingWarning &&\r\n        (lastPosSeconds !== positionSeconds))\r\n    {\r\n      lastPosSeconds = positionSeconds;\r\n\r\n      if ((durationSeconds - positionSeconds) <= settings.playback.timeRemainingSeconds)\r\n        playbackControls.blinkPlayPause(true);\r\n      else\r\n        playbackControls.blinkPlayPause(false);\r\n    }\r\n  }\r\n})();\r\n", "//\r\n// Experimental Screen Wake Lock API support: https://web.dev/wakelock/\r\n//\r\n// https://ultrafunk.com\r\n//\r\n\r\n\r\nimport * as debugLogger from '../shared/debuglogger.js';\r\nimport { showSnackbar } from '../shared/snackbar.js';\r\nimport { settings }     from '../shared/session-data.js';\r\n\r\n\r\nexport {\r\n  enable,\r\n//disable,\r\n  stateVisible,\r\n};\r\n\r\n\r\n/*************************************************************************************************/\r\n\r\n\r\nconst debug = debugLogger.newInstance('screen-wakelock');\r\nconst m     = { wakeLock: null };\r\n\r\n\r\n// ************************************************************************************************\r\n// \r\n// ************************************************************************************************\r\n\r\nfunction isSupported()\r\n{\r\n  return (('wakeLock' in navigator) && ('request' in navigator.wakeLock));\r\n}\r\n\r\nasync function enable()\r\n{\r\n  if (isSupported())\r\n  {\r\n    if (document.visibilityState === 'visible')\r\n    {\r\n      /*\r\n      if (wakeLock !== null)\r\n        wakeLock.release();\r\n      */\r\n\r\n      if (await request() !== true)\r\n      {\r\n        debug.log('enable(): Screen Wake Lock request failed');\r\n      //showSnackbar('Keep Screen On failed', 3);\r\n      }\r\n    }\r\n  }\r\n  else\r\n  {\r\n    debug.log('enable(): Screen Wake Lock is not supported');\r\n    showSnackbar('Keep Screen On is not supported', 5, 'Disable', () => (settings.mobile.keepScreenOn = false));\r\n  }\r\n}\r\n\r\n/*\r\nfunction disable()\r\n{\r\n  debug.log('disable()');\r\n\r\n  if (wakeLock !== null)\r\n    wakeLock.release();\r\n}\r\n*/\r\n\r\nfunction stateVisible()\r\n{\r\n  debug.log('stateVisible()');\r\n\r\n  if (isSupported() && (m.wakeLock === null))\r\n    request();\r\n}\r\n\r\nasync function request()\r\n{\r\n  try\r\n  {\r\n    m.wakeLock = await navigator.wakeLock.request('screen');\r\n\r\n    debug.log('request(): Screen Wake Lock is Enabled');\r\n  //showSnackbar('Keep Screen On success', 3);\r\n\r\n    m.wakeLock.addEventListener('release', () =>\r\n    {\r\n      debug.log('request(): Screen Wake Lock was Released');\r\n    //showSnackbar('Keep Screen On was released', 3);\r\n      m.wakeLock = null;\r\n    });\r\n\r\n    return true;\r\n  }\r\n  catch (exception)\r\n  {\r\n    debug.error(`request(): ${exception.name} - ${exception.message}`);\r\n  }\r\n\r\n  return false;\r\n}\r\n", "//\r\n// Browser interaction and media playback handler\r\n//\r\n// https://ultrafunk.com\r\n//\r\n\r\n\r\nimport * as debugLogger     from '../shared/debuglogger.js';\r\nimport * as eventLogger     from './eventlogger.js';\r\nimport * as galleryPlayback from './gallery/gallery-playback.js';\r\nimport * as listPlayback    from './list/list-playback.js';\r\nimport * as playbackEvents  from './playback-events.js';\r\nimport * as screenWakeLock  from './screen-wakelock.js';\r\nimport * as utils           from '../shared/utils.js';\r\nimport * as footerToggles   from './footer-toggles.js';\r\nimport { toggleRepeat }     from './playback-controls.js';\r\nimport { showSnackbar }     from '../shared/snackbar.js';\r\n\r\nimport {\r\n  response,\r\n  settings,\r\n  getSessionData,\r\n} from '../shared/session-data.js';\r\n\r\nimport {\r\n  hasGalleryPlayer,\r\n  hasListPlayer,\r\n  isGalleryPlayer,\r\n  isListPlayer,\r\n  playerScrollTo,\r\n  playerOnKeyScroll,\r\n  shuffleClickNavTo,\r\n  autoplayNavTo,\r\n} from './shared-gallery-list.js';\r\n\r\n\r\n/*************************************************************************************************/\r\n\r\n\r\nconst debug    = debugLogger.newInstance('playback-interaction');\r\nconst eventLog = new eventLogger.Interaction(10);\r\n\r\nconst m = {\r\n  player:          null,\r\n  isPlaybackReady: false,\r\n};\r\n\r\nconst config = {\r\n  doubleClickDelay: 500,\r\n};\r\n\r\n\r\n// ************************************************************************************************\r\n// Document ready and document / window event listeners\r\n// ************************************************************************************************\r\n\r\ndocument.addEventListener('DOMContentLoaded', () =>\r\n{ \r\n  debug.log('DOMContentLoaded');\r\n\r\n  getSessionData();\r\n\r\n  if (hasGalleryPlayer())\r\n    m.player = galleryPlayback;\r\n  else if (hasListPlayer())\r\n    m.player = listPlayback;\r\n\r\n  if (m.player !== null)\r\n    initShared();\r\n\r\n  footerToggles.init(m.player?.getStatus);\r\n});\r\n\r\n\r\n// ************************************************************************************************\r\n// Read settings and interaction init\r\n// ************************************************************************************************\r\n\r\nfunction initShared()\r\n{\r\n  debug.log('initShared()');\r\n\r\n  // Must be done before player.init() since events are used to relay player status updates\r\n  initPlaybackEvents();\r\n\r\n  m.player.init();\r\n  fullscreenElement.init();\r\n  keyboardShortcuts.init();\r\n\r\n  initListeners();\r\n}\r\n\r\nfunction initPlaybackEvents()\r\n{\r\n  playbackEvents.addListener(playbackEvents.EVENT.READY,                playbackEventReady);\r\n  playbackEvents.addListener(playbackEvents.EVENT.MEDIA_SHOW,           playbackEventMediaEnded);\r\n  playbackEvents.addListener(playbackEvents.EVENT.MEDIA_ENDED,          playbackEventMediaEnded);\r\n  playbackEvents.addListener(playbackEvents.EVENT.MEDIA_TIME_REMAINING, playbackEventMediaTimeRemaining);\r\n}\r\n\r\nfunction initListeners()\r\n{\r\n  utils.addListener('.playback-shuffle-control span', 'click', shuffleClickNavTo);\r\n\r\n  utils.addListenerAll('span.navbar-arrow-back',           'click', prevNextNavTo, response.prevPage);\r\n  utils.addListenerAll('span.navbar-arrow-fwd',            'click', prevNextNavTo, response.nextPage);\r\n  utils.addListener('nav.post-navigation .nav-previous a', 'click', prevNextNavTo, response.prevPage);\r\n  utils.addListener('nav.post-navigation .nav-next a',     'click', prevNextNavTo, response.nextPage);\r\n  \r\n  document.addEventListener('keydown', documentEventKeyDown);\r\n  window.addEventListener('blur', windowEventBlur);\r\n}\r\n\r\n\r\n// ************************************************************************************************\r\n// Keyboard events handler and functions\r\n// ************************************************************************************************\r\n\r\nfunction documentEventKeyDown(event)\r\n{\r\n  if (m.isPlaybackReady         &&\r\n      keyboardShortcuts.allow() &&\r\n      (event.repeat  === false) &&\r\n      (event.ctrlKey === false) &&\r\n      (event.altKey  === false))\r\n  {\r\n    switch(event.code)\r\n    {\r\n      case 'Backquote':\r\n        event.preventDefault();\r\n        playerScrollTo(m.player.getStatus().trackId);\r\n        break;\r\n    }\r\n\r\n    switch (event.key)\r\n    {\r\n      case ' ':\r\n        event.preventDefault();\r\n        m.player.togglePlayPause();\r\n        break;\r\n\r\n      case 'Home':\r\n      case 'End':\r\n      case 'PageUp':\r\n      case 'PageDown':\r\n        playerOnKeyScroll(event);\r\n        break;\r\n\r\n      case 'ArrowLeft':\r\n        {\r\n          event.preventDefault();\r\n          \r\n          if (event.shiftKey === true)\r\n            prevNextNavTo(null, response.prevPage);\r\n          else\r\n            m.player.prevTrack();\r\n        }\r\n        break;\r\n\r\n      case 'ArrowRight':\r\n        {\r\n          event.preventDefault();\r\n\r\n          if (event.shiftKey === true)\r\n            prevNextNavTo(null, response.nextPage);\r\n          else\r\n            m.player.nextTrack();\r\n        }\r\n        break;\r\n\r\n      case 'A':\r\n        footerToggles.autoplay.toggle();\r\n        break;\r\n\r\n      case 'f':\r\n      case 'F':\r\n        event.preventDefault();\r\n        fullscreenElement.toggle(document.getElementById(m.player.getStatus().iframeId));\r\n        break;\r\n\r\n      case 'm':\r\n      case 'M':\r\n        event.preventDefault();\r\n        m.player.toggleMute();\r\n        showSnackbar(settings.playback.masterMute ? 'Volume is muted (<b>m</b> to unmute)' : 'Volume is unmuted (<b>m</b> to mute)', 3);\r\n        break;\r\n\r\n      case 'p':\r\n      case 'P':\r\n        footerToggles.playerType.toggle();\r\n        break;\r\n\r\n      case 'r':\r\n      case 'R':\r\n        showSnackbar(`${toggleRepeat().title} (<b>r</b> to change)`, 3);\r\n        break;\r\n\r\n      case 'x':\r\n      case 'X':\r\n        footerToggles.crossfade.toggle();\r\n        break;\r\n    }\r\n  }\r\n}\r\n\r\n\r\n// ************************************************************************************************\r\n// playbackEvent listeners\r\n// ************************************************************************************************\r\n\r\nfunction playbackEventReady()\r\n{\r\n  utils.addListener('.playback-details-control',   'click', playbackDetailsClick);\r\n  utils.addListener('.playback-thumbnail-control', 'click', playbackThumbnailClick);\r\n  utils.addListener('.playback-timer-control',     'click', playbackTimerClick);\r\n  \r\n  document.addEventListener('visibilitychange', () =>\r\n  {\r\n    if ((document.visibilityState === 'visible') && (settings.mobile.keepScreenOn))\r\n      screenWakeLock.stateVisible();\r\n  });\r\n\r\n  if (settings.mobile.keepScreenOn)\r\n    screenWakeLock.enable();\r\n\r\n  m.isPlaybackReady = true;\r\n}\r\n\r\nfunction playbackEventMediaEnded()\r\n{\r\n  if (settings.playback.autoExitFullscreen)\r\n    fullscreenElement.exit();\r\n}\r\n\r\nfunction playbackEventMediaTimeRemaining(playbackEvent)\r\n{\r\n  if (settings.playback.autoExitFsOnWarning && (playbackEvent.data.timeRemainingSeconds <= settings.playback.timeRemainingSeconds))\r\n    fullscreenElement.exit();\r\n}\r\n\r\n\r\n// ************************************************************************************************\r\n// Window and document event handlers\r\n// ************************************************************************************************\r\n\r\nfunction windowEventBlur()\r\n{\r\n  // ToDo: This is only for gallery players for now...?\r\n  if (isListPlayer())\r\n    return;\r\n\r\n  // setTimeout(0) = Yield\r\n  setTimeout(() =>\r\n  {\r\n    // document (page) iframe was focused\r\n    if (document.activeElement instanceof HTMLIFrameElement)\r\n    {\r\n      setTimeout(() =>\r\n      {\r\n        document.activeElement.blur();\r\n        \r\n        // Needed to get Firefox to behave like Chrome\r\n        if (document.activeElement instanceof HTMLIFrameElement)\r\n          document.activeElement.blur();\r\n      }, 250);\r\n    }\r\n  }, 0);\r\n}\r\n\r\n\r\n// ************************************************************************************************\r\n// Click event handlers\r\n// ************************************************************************************************\r\n\r\nfunction playbackDetailsClick()\r\n{\r\n  playerScrollTo(m.player.getStatus().trackId);\r\n  showSnackbarHint('showTrackDetailsHint', '<b>Tip:</b> Click or tap Artist &amp; Title to show current track');\r\n}\r\n\r\nfunction playbackThumbnailClick()\r\n{\r\n  if (isGalleryPlayer())\r\n  {\r\n    eventLog.add(eventLogger.SOURCE.MOUSE, eventLogger.EVENT.MOUSE_CLICK, null);\r\n    showSnackbarHint('showGalleryTrackThumbnailHint', '<b>Tip:</b> Double click or tap Track Thumbnail for full screen');\r\n  \r\n    if (eventLog.doubleClicked(eventLogger.SOURCE.MOUSE, eventLogger.EVENT.MOUSE_CLICK, config.doubleClickDelay))\r\n      fullscreenElement.enter(document.getElementById(m.player.getStatus().iframeId));\r\n  }\r\n  else if (isListPlayer())\r\n  {\r\n    playerScrollTo(0);\r\n    showSnackbarHint('showListTrackThumbnailHint', '<b>Tip:</b> Click or tap Track Thumbnail to show player');\r\n  }\r\n}\r\n\r\nfunction playbackTimerClick()\r\n{\r\n  footerToggles.autoplay.toggle();\r\n  showSnackbarHint('showTrackTimerHint', '<b>Tip:</b> Click or tap Track Timer to toggle Autoplay On / Off');\r\n}\r\n\r\nfunction showSnackbarHint(hintKey, hintText, snackbarTimeout = 0)\r\n{\r\n  if (settings.tips[hintKey])\r\n  {\r\n    showSnackbar(hintText, snackbarTimeout);\r\n    settings.tips[hintKey] = false;\r\n  }\r\n}\r\n\r\nfunction prevNextNavTo(event, destUrl)\r\n{\r\n  event?.preventDefault();\r\n  autoplayNavTo(destUrl, m.player.getStatus().isPlaying);\r\n}\r\n\r\n\r\n// ************************************************************************************************\r\n// Fullscreen Element module\r\n// ************************************************************************************************\r\n\r\nconst fullscreenElement = (() =>\r\n{\r\n  const fseEvent = new Event('fullscreenElement');\r\n  let fseTarget  = null;\r\n\r\n  return {\r\n    init,\r\n    enter,\r\n    exit,        \r\n    toggle,\r\n  };\r\n\r\n  function init()\r\n  {\r\n    document.addEventListener('fullscreenchange',       fullscreenChange);\r\n    document.addEventListener('webkitfullscreenchange', fullscreenChange);\r\n  }\r\n\r\n  function fullscreenChange()\r\n  {\r\n    fseTarget = (document.fullscreenElement !== null)\r\n                  ? document.fullscreenElement.id\r\n                  : null;\r\n    \r\n    fseEvent.fullscreenTarget = fseTarget;\r\n    document.dispatchEvent(fseEvent);\r\n  }\r\n\r\n  function enter(fullscreenElement)\r\n  {\r\n    fullscreenElement.requestFullscreen();\r\n  }\r\n  \r\n  function exit()\r\n  {\r\n    if (fseTarget !== null)\r\n    {\r\n      document.exitFullscreen();\r\n      fseTarget = null;\r\n    }\r\n  }\r\n\r\n  function toggle(fullscreenElement)\r\n  {\r\n    if (fseTarget === null)\r\n      enter(fullscreenElement);\r\n    else\r\n      exit();\r\n  }\r\n})();\r\n\r\n\r\n// ************************************************************************************************\r\n// Allow / Deny keyboard shortcuts event handling module\r\n// ************************************************************************************************\r\n\r\nconst keyboardShortcuts = (() =>\r\n{\r\n  let allow = false;\r\n\r\n  return {\r\n    allow() { return allow; },\r\n    init,\r\n  };\r\n\r\n  function init()\r\n  {\r\n    allow = settings.playback.keyboardShortcuts;\r\n    document.addEventListener('allowKeyboardShortcuts', () => { if (settings.playback.keyboardShortcuts) allow = true;  });\r\n    document.addEventListener('denyKeyboardShortcuts',  () => { if (settings.playback.keyboardShortcuts) allow = false; });\r\n  }\r\n})();\r\n"],
  "mappings": "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",
  "names": []
}
