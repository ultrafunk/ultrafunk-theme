import{$ as Lt,$a as Jt,A as o,Aa as Yt,B as kt,Ba as Ot,Ca as Je,D as f,Da as _t,E as me,Ea as W,F as be,Fa as Mt,G as ft,Ga as wt,H as D,Ha as q,I as mt,Ia as Vt,J as qe,Ja as xt,K as bt,Ka as Bt,L as At,La as Kt,M as Pt,Na as $t,O as St,Oa as he,P as oe,Pa as Ft,Qa as H,Ra as x,Sa as Gt,T as Ct,Ta as te,U as G,Ua as Wt,Va as qt,Wa as je,Xa as Ht,Ya as N,Za as ce,_a as Xt,a as Et,ab as ue,b as Ge,ba as He,c as p,d as S,da as Ae,e as C,ea as ht,f as We,fa as s,g as F,ga as E,h as Te,ha as y,i as P,ia as m,j as ke,ja as Xe,k as Tt,ka as It,la as Pe,ma as Se,na as Dt,oa as B,p as fe,pa as v,q as Z,qa as b,ra as vt,sa as ee,ta as Ce,ua as V,va as Le,wa as Nt,xa as Ut,ya as Rt,z as L,za as ie}from"../chunk-FWOYMI7O.js";var ze=P("eventlogger"),u={UNKNOWN:1e3,KEYBOARD:100,MOUSE:110,YOUTUBE:1,SOUNDCLOUD:2,ULTRAFUNK:50},d={UNKNOWN:-2e3,KEY_ARROW_LEFT:180,KEY_ARROW_RIGHT:181,MOUSE_CLICK:182,STATE_ERROR:-5,STATE_UNSTARTED:-1,STATE_ENDED:0,STATE_PLAYING:1,STATE_PAUSED:2,STATE_BUFFERING:3,STATE_CUED:5,RESUME_AUTOPLAY:50,PLAYER_ERROR:60,CROSSFADE_START:70},Oa={eventSource:u.UNKNOWN,eventType:d.UNKNOWN,uId:null,timeStamp:0},h,pe,X,_,Ie=class{constructor(t=10){S(this,h,[]);S(this,pe,0);S(this,X,0);S(this,_,0);C(this,pe,t)}add(t,a,n,c=Date.now()){let k=Object.create(Oa);k.eventSource=t,k.eventType=a,k.uId=n,k.timeStamp=c,p(this,h).length<p(this,pe)?p(this,h).push(k):(p(this,h).shift(),p(this,h).push(k))}clear(){C(this,h,[])}getLastPos(){return p(this,_)}initMatch(){C(this,_,p(this,h).length-1),C(this,X,0)}matchesEvent(t,a,n,c=null){p(this,h)[p(this,_)-t].eventSource===a&&p(this,h)[p(this,_)-t].eventType===n&&p(this,h)[p(this,_)-t].uId===c&&We(this,X)._++}matchesDelta(t,a){p(this,h)[p(this,_)].timeStamp-p(this,h)[p(this,_)-t].timeStamp<=a&&We(this,X)._++}isPatternMatch(t,a){return p(this,X)===t?(ze.log(`MATCH for: ${a}`),ze.logEventLog(p(this,h),u,d),!0):!1}};h=new WeakMap,pe=new WeakMap,X=new WeakMap,_=new WeakMap;var De=class extends Ie{doubleClicked(t,a,n){return this.initMatch(),this.getLastPos()>=1&&(this.matchesEvent(1,t,a),this.matchesEvent(0,t,a),this.matchesDelta(1,n)),this.isPatternMatch(3,`${ze.getKeyForValue(u,t)} Double Clicked`)}},ae=class extends Ie{ytAutoplayBlocked(t,a){return this.initMatch(),this.getLastPos()>=3&&(this.matchesEvent(3,u.ULTRAFUNK,d.RESUME_AUTOPLAY,null),this.matchesEvent(2,u.YOUTUBE,d.STATE_UNSTARTED,t),this.matchesEvent(1,u.YOUTUBE,d.STATE_BUFFERING,t),this.matchesEvent(0,u.YOUTUBE,d.STATE_UNSTARTED,t),this.matchesDelta(3,a)),this.isPatternMatch(5,"YouTube Autoplay Blocked")}scAutoplayBlocked(t,a){return this.initMatch(),this.getLastPos()>=3&&(this.matchesEvent(3,u.ULTRAFUNK,d.RESUME_AUTOPLAY,null),this.matchesEvent(2,u.SOUNDCLOUD,d.STATE_PLAYING,t),this.matchesEvent(1,u.SOUNDCLOUD,d.STATE_PAUSED,t),this.matchesEvent(0,u.SOUNDCLOUD,d.STATE_PAUSED,t),this.matchesDelta(3,a)),this.isPatternMatch(5,"SoundCloud Autoplay Blocked")}scWidgetPlayBlocked(t,a){return this.initMatch(),this.getLastPos()>=2&&(this.matchesEvent(2,u.SOUNDCLOUD,d.STATE_PLAYING,t),this.matchesEvent(1,u.SOUNDCLOUD,d.STATE_PAUSED,t),this.matchesEvent(0,u.SOUNDCLOUD,d.STATE_PAUSED,t),this.matchesDelta(2,a)),this.isPatternMatch(4,"SoundCloud WidgetPlay Blocked")}scPlayDoubleTrigger(t,a){return this.initMatch(),this.getLastPos()>=2&&(this.matchesEvent(2,u.ULTRAFUNK,d.CROSSFADE_START,null),this.matchesEvent(1,u.SOUNDCLOUD,d.STATE_PLAYING,t),this.matchesEvent(0,u.SOUNDCLOUD,d.STATE_PLAYING,t),this.matchesDelta(1,a)),this.isPatternMatch(4,"SoundCloud Play Double Trigger")}};var nt={};Et(nt,{getStatus:()=>Ve,init:()=>fr,nextTrack:()=>st,prevTrack:()=>ca,toggleMute:()=>ua,togglePlayPause:()=>we});var J,re,se=class{constructor(){S(this,J,-1);S(this,re,0);Ge(this,"isVisible",!0);Ge(this,"config",{updateTimerInterval:250,maxBufferingDelay:3})}init(){document.addEventListener("visibilitychange",()=>{this.isVisible=document.visibilityState==="visible"})}updateTimer(){}start(){this.stop(),C(this,J,setInterval(()=>this.updateTimer(),this.config.updateTimerInterval))}stop(){p(this,J)!==-1&&(clearInterval(p(this,J)),C(this,J,-1)),C(this,re,0),Ce(!1)}updateTimeRemainingWarning(t,a){if(o.playback.autoplay===!1&&o.playback.timeRemainingWarning&&p(this,re)!==t){let n=a-t;C(this,re,t),n<=o.playback.timeRemainingSeconds?(Ce(!0),y(s.MEDIA_TIME_REMAINING,{timeRemainingSeconds:n})):Ce(!1)}}};J=new WeakMap,re=new WeakMap;var j,de,Ne,jt,ye,Ze,Ue,zt,et=class extends se{constructor(){super(...arguments);S(this,Ne);S(this,ye);S(this,Ue);S(this,j,null);S(this,de,null)}init(a,n){super.init(),C(this,j,a),C(this,de,n)}updateTimer(){(this.isVisible||F(this,ye,Ze).call(this))&&p(this,j).current.getPosition((a,n)=>F(this,Ne,jt).call(this,a,n))}},Qe=et;j=new WeakMap,de=new WeakMap,Ne=new WeakSet,jt=function(a,n=0){let c=Math.round(a/1e3);B(a,c,n),c>0&&n>0&&(Te(et.prototype,this,"updateTimeRemainingWarning").call(this,c,n),F(this,Ue,zt).call(this,c,n))},ye=new WeakSet,Ze=function(){return o.playback.autoplay&&o.gallery.autoCrossfade},Ue=new WeakSet,zt=function(a,n){o.playback.masterMute===!1&&F(this,ye,Ze).call(this)&&n-a===o.gallery.autoCrossfadeLength+this.config.maxBufferingDelay&&p(this,j).getCurrentTrack()+1<=p(this,j).getNumTracks()&&p(this,de).call(this,be.AUTO,{name:"Auto Crossfade",length:o.gallery.autoCrossfadeLength,curve:o.gallery.autoCrossfadeCurve})};var Y=new Qe;var A=P("embedded-players"),M=new ae(10),i={players:{},playbackState:null,embeddedEvent:null,loadEventsTotal:0,loadEventsCount:1},Ma={maxPlaybackStartDelay:3};function Zt(e,t,a){i.players=e,i.playbackState=t,i.embeddedEvent=a,i.loadEventsTotal=3+parseInt(document.body.getAttribute("data-gallery-track-count")),xa(),Ja()}function Re(){return{loadingPercent:100*(i.loadEventsCount++/i.loadEventsTotal)}}function ea(){i.loadEventsCount>=i.loadEventsTotal?i.embeddedEvent(s.PLAYBACK_READY,{resetProgressBar:!0}):y(s.PLAYBACK_LOADING,Re())}function wa(){let e=document.querySelectorAll("single-track, gallery-track");e.forEach(t=>{let a=parseInt(t.getAttribute("data-track-type")),n=t.querySelector("iframe"),c=null;if(a===D.YOUTUBE)e.length===1&&n===null?c=Qt("youtube-player",t,!0):c=Qt(n.id,t,!1);else if(a===D.SOUNDCLOUD){let k=SC.Widget(n.id);c=new bt(t.id,n.id,k,n.src),k.bind(SC.Widget.Events.READY,()=>{c.setThumbnail(t),k.getDuration(w=>c.setDuration(Math.round(w/1e3))),ja(c,n.id)}),k.bind(SC.Widget.Events.PLAY,za),k.bind(SC.Widget.Events.PAUSE,Qa),k.bind(SC.Widget.Events.FINISH,Za),k.bind(SC.Widget.Events.ERROR,er)}c!==null&&(c.setArtistTitle(t.getAttribute("data-track-artist"),t.getAttribute("data-track-title")),i.players.add(c))})}function Qt(e,t,a=!1){let n=t.getAttribute("data-track-source-uid"),c=new YT.Player(e,{events:{onReady:w=>Ba(w,e),onStateChange:w=>Ka(w,e),onError:w=>Xa(w,e)},...a&&{videoId:n}}),k=null;return a?k=new qe(t.id,e,c,n):k=new mt(t.id,e,c,n),k.setDuration(parseInt(t.getAttribute("data-track-duration"))),k}function Oe(e,t){A.log("onPlayerError()"),A.log(e);let a=e.getTrackType()===D.YOUTUBE?u.YOUTUBE:u.SOUNDCLOUD;i.players.isCurrent(e.getUid())===!1&&i.players.stop(),M.add(a,d.PLAYER_ERROR,e.getUid()),i.embeddedEvent(s.MEDIA_UNAVAILABLE,Va(e,t))}function Va(e,t){let a=e.getArtist()||"N/A",n=e.getTitle()||"N/A";return{currentTrack:i.players.trackFromUid(e.getUid()),numTracks:i.players.getNumTracks(),trackId:e.getTrackId(),mediaTitle:`${a} - ${n}`,mediaUrl:t}}function xa(){A.log("initYouTubeAPI()"),y(s.PLAYBACK_LOADING,Re()),window.onYouTubeIframeAPIReady=function(){A.log("onYouTubeIframeAPIReady()"),y(s.PLAYBACK_LOADING,Re()),wa()};let e=document.createElement("script");e.id="youtube-iframe-api",e.src="https://www.youtube.com/iframe_api";let t=document.getElementsByTagName("script")[0];t.parentNode.insertBefore(e,t)}function Ba(e,t){let a=i.players.playerFromUid(t);e.target.getPlayerState()===-1?(A.warn(`onYouTubePlayerReady() - MEDIA_UNAVAILABLE: ${t} => ${e.target.getVideoData().video_id} => ${a.getArtist()} - "${a.getTitle()}"`),a.setIsPlayable(!1)):A.log(`onYouTubePlayerReady(): ${t} => ${e.target.getVideoData().video_id} => ${a.getArtist()} - ${a.getTitle()}`),ea()}function Ka(e,t){switch(M.add(u.YOUTUBE,e.data,t),e.data){case YT.PlayerState.UNSTARTED:$a(t);break;case YT.PlayerState.BUFFERING:Fa(t);break;case YT.PlayerState.PLAYING:Ga(t);break;case YT.PlayerState.PAUSED:Wa(t);break;case YT.PlayerState.CUED:qa(t);break;case YT.PlayerState.ENDED:Ha(t);break}}function $a(e){A.log(`onYouTubePlayerStateChange: UNSTARTED (uID: ${e})`),M.ytAutoplayBlocked(e,3e3)&&i.embeddedEvent(s.AUTOPLAY_BLOCKED)}function Fa(e){if(A.log(`onYouTubePlayerStateChange: BUFFERING (uID: ${e})`),i.players.crossfade.isFading()===!1){let t=i.players.playerFromUid(e);t.mute(o.playback.masterMute),t.setVolume(o.playback.masterVolume),y(s.MEDIA_LOADING)}}function Ga(e){A.log(`onYouTubePlayerStateChange: PLAYING   (uID: ${e})`),i.playbackState.sync(e,i.playbackState.STATE.PLAY),Y.start()}function Wa(e){A.log(`onYouTubePlayerStateChange: PAUSED    (uID: ${e})`),i.players.isCurrent(e)?(i.playbackState.sync(e,i.playbackState.STATE.PAUSE),Y.stop()):i.players.crossfade.stop()}function qa(e){A.log(`onYouTubePlayerStateChange: CUED      (uID: ${e})`)}function Ha(e){A.log(`onYouTubePlayerStateChange: ENDED     (uID: ${e})`),i.players.isCurrent(e)?(Y.stop(),i.embeddedEvent(s.MEDIA_ENDED)):i.players.crossfade.stop()}function Xa(e,t){let a=i.players.playerFromUid(t);e.data===150&&a instanceof qe&&a.isCued()?(A.log("onYouTubePlayerError(150) - SingleTrack.isCued(): true"),a.setIsCued(!1),a.setIsPlayable(!1)):e.data!==null&&a.isPlayable()&&(A.log("onYouTubePlayerError: "+e.data),a.setIsPlayable(!1),Oe(a,e.target.getVideoUrl()))}function Ja(){A.log("initSoundCloudAPI()"),y(s.PLAYBACK_LOADING,Re())}function ja(e,t){A.log(`onSCPlayerEventReady(): ${t} => ${e.getUid()} => ${e.getArtist()} - ${e.getTitle()}`),ea()}function za(e){A.log(`onSoundCloudPlayerEvent: PLAY   (uID: ${e.soundId})`),M.add(u.SOUNDCLOUD,d.STATE_PLAYING,e.soundId),i.players.crossfade.isFading()&&i.players.isCurrent(e.soundId)?M.scPlayDoubleTrigger(e.soundId,Ma.maxPlaybackStartDelay*1e3)&&i.playbackState.sync(e.soundId,i.playbackState.STATE.PLAY):(i.playbackState.sync(e.soundId,i.playbackState.STATE.PLAY),i.players.current.mute(o.playback.masterMute),i.players.current.setVolume(o.playback.masterVolume)),Y.start()}function Qa(e){A.log(`onSoundCloudPlayerEvent: PAUSE  (uID: ${e.soundId})`),M.add(u.SOUNDCLOUD,d.STATE_PAUSED,e.soundId),M.scAutoplayBlocked(e.soundId,3e3)?(Y.stop(),i.embeddedEvent(s.AUTOPLAY_BLOCKED)):M.scWidgetPlayBlocked(e.soundId,3e4)?(Y.stop(),i.embeddedEvent(s.PLAYBACK_BLOCKED,{currentTrack:i.players.trackFromUid(e.soundId),numTracks:i.players.getNumTracks()})):i.players.isCurrent(e.soundId)?i.players.current.getPosition(t=>{t>0&&(i.playbackState.sync(e.soundId,i.playbackState.STATE.PAUSE),Y.stop())}):i.players.crossfade.stop()}function Za(e){A.log(`onSoundCloudPlayerEvent: FINISH (uID: ${e.soundId})`),i.players.isCurrent(e.soundId)?(Y.stop(),i.embeddedEvent(s.MEDIA_ENDED)):i.players.crossfade.stop()}function er(){this.getCurrentSound(e=>{let t=i.players.playerFromUid(e.id);A.log(`onSoundCloudPlayerEvent: ERROR for track: ${i.players.trackFromUid(e.id)}. ${t.getArtist()} - ${t.getTitle()} - [${t.getUid()} / ${t.getIframeId()}]`),t.setIsPlayable(!1)})}var O=P("gallery-events"),_e={snackbarId:0,nowPlayingIcons:null},at={nowPlayingIconsSelector:"h2.track-title"};function ta(){O.log("init()"),_e.nowPlayingIcons=document.querySelectorAll(at.nowPlayingIconsSelector),E(s.MEDIA_PLAYING,ar),E(s.MEDIA_PAUSED,rr),E(s.MEDIA_ENDED,sr),E(s.MEDIA_CUE_TRACK,nr),E(s.CONTINUE_AUTOPLAY,lr),E(s.RESUME_AUTOPLAY,or),E(s.AUTOPLAY_BLOCKED,ir),E(s.PLAYBACK_BLOCKED,cr),E(s.MEDIA_UNAVAILABLE,ur)}function ar(e){if(O.log(e),me(_e.snackbarId),e.data.numTracks>1){let t=document.querySelector(`#${e.data.trackId} ${at.nowPlayingIconsSelector}`);aa(t),G(t,"playing-paused","now-playing-icon"),o.gallery.animateNowPlayingIcon&&t.classList.add("playing-animate")}}function rr(e){O.log(e),e.data.numTracks>1&&document.querySelector(`#${e.data.trackId} ${at.nowPlayingIconsSelector}`).classList.add("playing-paused")}function sr(e){O.log(e),e!==null&&e.data.numTracks>1&&aa()}function nr(e){O.log(e),e.data.scrollToMedia&&x(e.data.trackId)}function lr(e){O.log(e),ce()&&e.data.trackType===D.YOUTUBE?ue(N.NEXT,!0):H(L.nextPage,!0)}function or(e){let t=JSON.parse(sessionStorage.getItem(Z.UF_AUTOPLAY));if(sessionStorage.removeItem(Z.UF_AUTOPLAY),O.log(e),O.log(`RESUME_AUTOPLAY: ${t!==null?JSON.stringify(t):"NO"}`),t!==null){let a=document.getElementById(t.trackId)?.querySelector("iframe").id;e.callback.resumeAutoplay(t,a)}}function ir(e){O.log(e),_e.snackbarId=f("Autoplay blocked, Play to continue",0,"play",()=>e.callback.togglePlayPause())}function cr(e){O.log(e),f("Unable to play track, skipping to next",5,"Stop",()=>{},()=>tt(e))}function ur(e){O.log(e),pr(e.data.trackId)?f("YouTube Premium track, skipping",5,"help",()=>window.location.href="/channel/premium/",()=>tt(e)):(f("Unable to play track, skipping to next",5,"Stop",()=>{},()=>tt(e)),ke("EVENT_MEDIA_UNAVAILABLE",e.data))}function aa(e){_e.nowPlayingIcons.forEach(t=>{t!==e&&t.classList.remove("now-playing-icon","playing-animate","playing-paused")})}function tt(e){e.data.currentTrack<e.data.numTracks?e.callback.skipToTrack(e.data.currentTrack+1,!0):ce()?ue(N.NEXT,o.playback.autoplay):L.nextPage!==null&&H(L.nextPage,!0)}function pr(e){let t=document.getElementById(e);return t!==null?t.classList.contains("uf_channel-premium"):!1}var rt=P("crossfade-controls"),Me={players:{}},U={},z={crossfadePresetSelector:".crossfade-preset-control",crossfadePresetData:"data-crossfade-preset",crossfadeToSelector:".crossfade-fadeto-control"};function sa(e,t){rt.log("init()"),Me.players=e,U.crossfadePreset=Xe(z.crossfadePresetSelector),U.crossfadeTo=Xe(z.crossfadeToSelector),U.crossfadePreset.length>1&&U.crossfadeTo.length>1&&(U.crossfadePreset.forEach(a=>na(a,o.gallery.trackCrossfadeDefPreset)),U.crossfadeTo.clickCallback=t),E(s.PLAYBACK_READY,yr)}function yr(){rt.log("playbackReady()"),U.crossfadePreset.length>1&&U.crossfadeTo.length>1&&(U.crossfadePreset.forEach(e=>{e.addEventListener("click",gr),G(e,m.DISABLED.CLASS,m.ENABLED.CLASS)}),U.crossfadeTo.forEach(e=>e.addEventListener("click",Er)),E(s.MEDIA_PLAYING,ra),E(s.MEDIA_PAUSED,ra))}function na(e,t){e.setAttribute(z.crossfadePresetData,t),e.textContent=`${t+1}`,e.title=`Preset: ${fe.crossfade[t].name}`}function gr(e){let t=parseInt(e.target.getAttribute(z.crossfadePresetData));na(e.target,t+1<fe.crossfade.length?t+1:0)}function Er(e){if(b()&&Me.players.crossfade.isFading()===!1){let t=e.target.closest("gallery-track");if(t!==null){let a=t.querySelector("iframe"),n=parseInt(t.querySelector(z.crossfadePresetSelector).getAttribute(z.crossfadePresetData));G(t.querySelector(`div${z.crossfadeToSelector}`),m.ENABLED.CLASS,m.DISABLED.CLASS),U.crossfadeTo.clickCallback(Me.players.uIdFromIframeId(a.id),fe.crossfade[n])}}}function ra(){let e=b(),t=e?Me.players.getTrackData().currentTrack:-1;rt.log(`updateCrossfadeToState() - playingState: ${e} - currentTrack: ${t}`),U.crossfadeTo.forEach((a,n)=>{t===n+1?G(a,e?m.ENABLED.CLASS:m.DISABLED.CLASS,e?m.DISABLED.CLASS:m.ENABLED.CLASS):G(a,e?m.DISABLED.CLASS:m.ENABLED.CLASS,e?m.ENABLED.CLASS:m.DISABLED.CLASS)})}var la=P("gallery-players"),oa=()=>{let e=null,t=null,a=[],n=new Map,c=0;return{indexMap:n,get crossfade(){return t},get current(){return a[c]},get next(){return a[c+1]},getPlayerIndex(){return c},setPlayerIndex(T){c=T},getTrackType(){return this.current.getTrackType()},getNumTracks(){return a.length},getCurrentTrack(){return c+1},playerFromUid(T){return a[n.get(T)]},trackFromUid(T){return n.get(T)+1},isCurrent(T){return T===this.current.getUid()},init:k,add:w,uIdFromIframeId:ha,stop:Ia,mute:Da,getTrackData:va,prevTrack:Na,nextTrack:Ua,jumpToTrack:Ra};function k(T){la.log("init()"),e=T,t=ft(this),E(s.MEDIA_PLAYING,()=>t.start()),E(s.MEDIA_PAUSED,()=>t.stop())}function w(T){la.log(T),a.push(T),n.set(T.getUid(),a.length-1)}function ha(T){return a.find(Fe=>Fe.getIframeId()===T).getUid()}function Ia(){this.current.stop(),t.stop()}function Da(){this.current.mute(o.playback.masterMute),t.mute(o.playback.masterMute)}function va(){return{currentTrack:this.getCurrentTrack(),numTracks:this.getNumTracks(),artist:this.current.getArtist(),title:this.current.getTitle(),duration:this.current.getDuration(),thumbnail:{src:this.current.getThumbnailSrc(),class:this.current.getThumbnailClass()}}}function Na(T){return c>0?(c--,e(T),!0):!1}function Ua(T){return c++,c<this.getNumTracks()?(e(T),!0):!1}function Ra(T,Fe,Ya=!0){return T>0&&T<=this.getNumTracks()?(c=T-1,e(Fe,Ya),!0):!1}};var I=P("gallery-playback"),r={eventLog:null,players:{}},ia={minCrossfadeToTime:5,maxBufferingDelay:3};function fr(){I.log("init()"),r.eventLog=M,ta(),r.players=oa(),r.players.init(pa),Pe(r.players,br),sa(r.players,Cr),Y.init(r.players,ya),Zt(r.players,hr,Lr)}function we(){b()?(ee(),r.players.current.pause()):(vt(),r.players.current.play(Oe))}function ca(){I.log(`prevTrack() - prevTrack: ${r.players.getCurrentTrack()-1} - numTracks: ${r.players.getNumTracks()}`),r.players.getCurrentTrack()>0&&r.players.current.getPosition(e=>{e>5e3?(r.players.current.seekTo(0),B(0,0,r.players.current.getDuration())):(r.players.getCurrentTrack()>1&&r.players.stop(),r.players.prevTrack(b())?v():y(s.MEDIA_PREV_TRACK))})}function st(e=!1){let t=r.players.getCurrentTrack()+1>r.players.getNumTracks();I.log(`nextTrack() - isMediaEnded: ${e} - isLastTrack: ${t} - autoplay: ${o.playback.autoplay}`),!mr(e,t)&&(t===!1?(r.players.stop(),e&&o.playback.autoplay===!1?ee():r.players.nextTrack(b())&&v()):t===!0&&e===!1?y(s.MEDIA_NEXT_TRACK):e&&(ee(),o.playback.autoplay?y(s.CONTINUE_AUTOPLAY,{trackType:r.players.current.getTrackType()}):r.players.stop()))}function mr(e,t){if(e&&o.playback.autoplay){let a=Le();if(I.log(`repeatPlayback(): ${I.getKeyForValue(V,a)}`),a===V.ONE)return r.players.current.seekTo(0),r.players.current.play(),!0;if(t&&a===V.ALL)return r.players.stop(),r.players.setPlayerIndex(0),pa(!0),!0}return!1}function br(e){r.players.current.seekTo(e)}function ua(){o.playback.masterMute=o.playback.masterMute!==!0,r.players.mute()}function Ar(e,t=!0){I.log(`cueTrack(): ${e}`),r.players.setPlayerIndex(r.players.indexMap.get(e)),y(s.MEDIA_CUE_TRACK,{scrollToMedia:t,trackId:r.players.current.getTrackId()}),v()}function pa(e,t=!0){y(s.MEDIA_CUE_TRACK,{scrollToMedia:t,trackId:r.players.current.getTrackId()}),e&&r.players.current.play(Oe)}function da(e,t=!0){I.log(`skipToTrack(): ${e} - ${t}`),t===!0&&b()===!1&&(r.eventLog.add(u.ULTRAFUNK,d.RESUME_AUTOPLAY,null),r.players.jumpToTrack(e,t)&&v())}function Pr(e,t=null){I.log(`resumeAutoplay(): ${e.autoplay}${t!==null?" - "+t:""}`),t!==null?e.autoplay?da(r.players.trackFromUid(t),!0):Ar(t):e.autoplay&&(r.eventLog.add(u.ULTRAFUNK,d.RESUME_AUTOPLAY,null),we())}function Sr(e,t,a=!1){I.log(`cueOrPlaySingleTrackById() - playMedia: ${a}`),r.players.current.setIsCued(!1),r.players.current.setIsPlayable(!0),r.players.current.setArtistTitle(e.track_artist,e.track_title),r.players.current.setDuration(parseInt(e.track_duration)),r.players.current.setThumbnail(t),Dt(0),v(),a?(r.eventLog.add(u.ULTRAFUNK,d.RESUME_AUTOPLAY,null),r.players.current.playTrackById(t.uid)):r.players.current.cueTrackById(t.uid)}function Ve(){return{isPlaying:b(),currentTrack:r.players.getCurrentTrack(),trackType:r.players.current.getTrackType(),position:0,numTracks:r.players.getNumTracks(),trackId:r.players.current.getTrackId(),iframeId:r.players.current.getIframeId()}}function Cr(e,t){r.players.isCurrent(e)===!1&&r.players.current.getDuration()>0&&(I.log(`crossfadeToClick():
      fadeOut: ${r.players.current.getArtist()} - "${r.players.current.getTitle()}" (${r.players.current.getUid()})
      fadeIn.: ${r.players.playerFromUid(e).getArtist()} - "${r.players.playerFromUid(e).getTitle()}" (${e})`),o.playback.masterMute===!1&&o.playback.autoplay===!1&&r.players.current.getPosition(a=>{r.players.current.getDuration()-a/1e3>=ia.minCrossfadeToTime+ia.maxBufferingDelay&&ya(be.TRACK,t,e)}))}function ya(e,t,a=null){r.eventLog.add(u.ULTRAFUNK,d.CROSSFADE_START,null),r.players.crossfade.init(e,t,a)!==null&&v()}function Lr(e,t=null){switch(I.log(`embeddedEventHandler() - event: ${I.getKeyForValue(s,e)}`),t!==null&&I.log(t),e){case s.MEDIA_ENDED:y(s.MEDIA_ENDED,Ve()),st(!0);break;case s.PLAYBACK_READY:Se(ca,we,st,ua),Jt(Sr),y(s.PLAYBACK_READY,t),y(s.RESUME_AUTOPLAY,null,{resumeAutoplay:Pr});break;case s.AUTOPLAY_BLOCKED:y(s.AUTOPLAY_BLOCKED,null,{togglePlayPause:we});break;case s.PLAYBACK_BLOCKED:case s.MEDIA_UNAVAILABLE:y(e,t,{skipToTrack:da});break}}var hr=(()=>{let e={PLAY:1,PAUSE:2};return{STATE:e,sync:function a(n,c){I.log(`playbackState.sync() - previousTrack: ${r.players.getPlayerIndex()+1} - nextTrack: ${r.players.indexMap.get(n)+1} - syncState: ${I.getKeyForValue(e,c)}`),r.players.isCurrent(n)?c===e.PLAY?y(s.MEDIA_PLAYING,Ve()):c===e.PAUSE&&y(s.MEDIA_PAUSED,Ve()):(r.players.stop(),r.players.setPlayerIndex(r.players.indexMap.get(n)),v(),a(n,c))}}})();var dt={};Et(dt,{getStatus:()=>Rr,init:()=>Dr,nextTrack:()=>ka,prevTrack:()=>Ta,toggleMute:()=>ct,togglePlayPause:()=>pt});var ne,xe,ga,it=class extends se{constructor(){super(...arguments);S(this,xe);S(this,ne,null)}ready(a){super.init(),C(this,ne,a),E(s.MEDIA_PLAYING,()=>super.start())}updateTimer(){this.isVisible&&b()&&F(this,xe,ga).call(this,p(this,ne).embedded.getCurrentTime(),p(this,ne).getDuration())}},lt=it;ne=new WeakMap,xe=new WeakSet,ga=function(a,n){if(a!==void 0){let c=Math.round(a);B(a*1e3,c,n),c>0&&n>0&&Te(it.prototype,this,"updateTimeRemainingWarning").call(this,c,n)}};var ot=new lt;var R=P("list-playback"),le=new ae(10),l={player:null,autoplayData:null,playerReady:!1,firstStatePlaying:!0,currentTrackId:null,currentSnackbarId:0},ut=`
  <p>The <b>List Player</b> only supports playing YouTube tracks, SoundCloud tracks will be automatically skipped over.</p>
  <p>SoundCloud tracks must be played using the <b>Gallery Player</b> or by clicking / tapping on the track <b>Artist + Title</b> text link in the <b>List Player</b>.</p>
  <p>To toggle between the <b>Gallery</b> and <b>List</b> players, please use the <b>Pref. Player: GALLERY / LIST</b> setting toggle button in the sites footer area.</p>`;function Dr(){R.log("init()"),Ut(Q),vr()!==null?Yr():f("No playable YouTube tracks!",0,"help",()=>Ae("No playable tracks",ut))}function vr(){if(l.currentTrackId=W(),l.autoplayData=JSON.parse(sessionStorage.getItem(Z.UF_AUTOPLAY)),sessionStorage.removeItem(Z.UF_AUTOPLAY),l.currentTrackId!==null){if(l.autoplayData!==null&&l.autoplayData.trackId!==null){let e=l.autoplayData.trackId.match(Pt);if(e!==null){let t=ie(`[data-track-source-uid="${e[0]}"]`);t!==null&&(l.currentTrackId=t.id)}else if(l.autoplayData.trackId.match(/^track-(?!0)\d{1,9}$/i)!==null){let t=ie(`[data-track-id="${l.autoplayData.trackId}"]`);t!==null?Je(t)===D.YOUTUBE?l.currentTrackId=t.id:f("Cannot play SoundCloud track",5,"help",()=>Ae("Cannot play SoundCloud track",ut)):f("Unable to cue track (not found)",5)}}Mt(l.currentTrackId)}return R.log(`cueInitialTrack() - currentTrackId: ${l.currentTrackId} - autoplayData: ${l.autoplayData!==null?JSON.stringify(l.autoplayData):"N/A"}`),l.currentTrackId}function Q(e,t=!0,a=!1){let n=Je(Ot(e));if(R.log(`setCurrentTrack() - nextTrackType: ${R.getKeyForValue(D,n)} - nextTrackId: ${e} - playNextTrack: ${t} - isPointerClick: ${a}`),n===D.SOUNDCLOUD&&a){f("Cannot play SoundCloud track",5,"help",()=>Ae("Cannot play SoundCloud track",ut));return}e===l.currentTrackId?pt():(b()&&l.player.embedded.stopVideo(),l.currentTrackId=e,y(s.MEDIA_CUE_TRACK,{trackId:e,isPointerClick:a}),Ea(t))}function Ea(e){let t=xt();l.player.reset(),e?(l.player.playTrackById(t),q(m.PLAYING),v()):(l.player.cueTrackById(t),q(m.PAUSED))}function pt(){l.currentTrackId===null?Q(ie("div.track-entry.current").id):b()?l.player.embedded.pauseVideo():l.player.play(Be)}function ct(e=!1){e===!1&&(o.playback.masterMute=o.playback.masterMute!==!0),o.playback.masterMute?l.player.embedded.mute():l.player.embedded.unMute()}function Ta(){let e=_t(),t=l.player.embedded.getCurrentTime();e!==null&&t<=5?(Q(e,b()),v()):t!==0&&(l.player.embedded.seekTo(0),B(0,0,l.player.getDuration()))}function ka(){let e=W();e!==null&&(Q(e,b()),v())}async function fa(e=!1,t=!1){let a=t?V.OFF:Le(),n=W();if(R.log(`advanceToNextTrack() autoplay: ${e} - isPlaybackError: ${t} - nextTrackId: ${n} - repeatMode: ${R.getKeyForValue(V,a)}`),e&&a===V.ONE)l.player.embedded.seekTo(0),l.player.play(Be);else if(e&&n===null&&a===V.ALL)Q(W(null)),x(0);else if(n===null)if(o.list.showLoadMoreTracks){let c=await wt();e&&c&&Q(W())}else H(L.nextPage,e);else e?Q(n):q(m.PAUSED)}function Nr(){b()===!1&&l.autoplayData!==null&&(le.add(u.ULTRAFUNK,d.RESUME_AUTOPLAY,null),le.add(u.YOUTUBE,-1,W())),b()===!1&&fa(!0,!0)}function Ur(){l.currentTrackId=null,q(m.PAUSED)}function Rr(){let e=ie("div.track-entry.current");if(e!==null){let t=Yt("div.track-entry"),a=Array.prototype.indexOf.call(t,e);return{isPlaying:b(),currentTrack:a+1,trackType:D.YOUTUBE,position:Math.ceil(l.player.embedded.getCurrentTime()),numTracks:1,trackId:t[a].getAttribute("data-track-id"),iframeId:"youtube-player"}}return{isPlaying:!1,currentTrack:1,position:0,trackId:0}}function Yr(){R.log("initYouTubeAPI()"),window.onYouTubeIframeAPIReady=function(){R.log("onYouTubeIframeAPIReady()");let a=new YT.Player("youtube-player",{events:{onReady:Or,onStateChange:_r,onError:Be}});l.player=new At(a),R.log(l.player),Pe(l.player,n=>l.player.embedded.seekTo(n)),y(s.PLAYBACK_LOADING,{loadingPercent:33})};let e=document.createElement("script");e.id="youtube-iframe-api",e.src="https://www.youtube.com/iframe_api";let t=document.getElementsByTagName("script")[0];t.parentNode.insertBefore(e,t)}function Or(){R.log("onYouTubePlayerReady()"),l.autoplayData?.autoplay===!0&&le.add(u.ULTRAFUNK,d.RESUME_AUTOPLAY,null),Se(Ta,pt,ka,ct),y(s.PLAYBACK_LOADING,{loadingPercent:66}),ot.ready(l.player),Rt(l.player),ct(!0),y(s.PLAYBACK_READY,{resetProgressBar:!1}),Ea(l.autoplayData?.autoplay===!0)}function _r(e){switch(R.log(`onYouTubePlayerStateChange(): ${e.data} - trackId: ${l.currentTrackId}`),le.add(u.YOUTUBE,e.data,l.currentTrackId),e.data!==YT.PlayerState.PLAYING&&ee(),e.data){case YT.PlayerState.UNSTARTED:Mr();break;case YT.PlayerState.BUFFERING:y(s.MEDIA_LOADING);break;case YT.PlayerState.PLAYING:wr(),y(s.MEDIA_PLAYING);break;case YT.PlayerState.PAUSED:q(m.PAUSED);break;case YT.PlayerState.ENDED:ot.stop(),y(s.MEDIA_ENDED),fa(o.playback.autoplay);break}}function Mr(){le.ytAutoplayBlocked(l.currentTrackId,3e3)&&(q(m.PAUSED),l.currentSnackbarId=f("Autoplay blocked, Play to continue",0,"play",()=>l.player.play(Be))),l.playerReady===!1&&(l.playerReady=!0,y(s.PLAYBACK_LOADING,{loadingPercent:0}))}function wr(){me(l.currentSnackbarId),l.firstStatePlaying&&(l.firstStatePlaying=!1,l.autoplayData=null,setTimeout(()=>{o.playback.autoplay&&b()&&Math.round(window.pageYOffset)<=1&&Ct(St.SITE_MAX_WIDTH_MOBILE)&&x(0)},6e3))}function Be(e){R.log(`onYouTubePlayerError(): playerError: ${e.data} - currentTrackId: ${l.currentTrackId} - isTrackCued: ${l.player.isTrackCued()}`),l.player.setPlayerError(e.data),l.player.isTrackCued()===!1&&(Vt("Error!"),le.add(u.YOUTUBE,d.PLAYER_ERROR,l.currentTrackId),f("Unable to play track, skipping to next",5,"Stop",Ur,Nr),ke("EVENT_MEDIA_UNAVAILABLE",{mediaUrl:l.player.embedded.getVideoUrl(),mediaTitle:`${l.player.getArtist()} - ${l.player.getTitle()}`}))}var $e=P("screen-wakelock"),Ke={wakeLock:null};function ma(){o.mobile.keepScreenOn&&document.addEventListener("click",ba)}function ba(){$e.log("enableScreenWakeLock()"),document.removeEventListener("click",ba),xr(),document.addEventListener("visibilitychange",()=>{document.visibilityState==="visible"&&o.mobile.keepScreenOn&&Vr()})}function Vr(){Aa()&&Ke.wakeLock===null&&Pa()}function Aa(){return"wakeLock"in navigator&&"request"in navigator.wakeLock}async function xr(){Aa()?document.visibilityState==="visible"&&await Pa()!==!0&&($e.log("enableWakeLock(): Screen Wake Lock request failed"),f("Keep Screen On failed",5,"Disable",()=>o.mobile.keepScreenOn=!1)):($e.log("enableWakeLock(): Screen Wake Lock is not supported"),f("Keep Screen On is not supported",5,"Disable",()=>o.mobile.keepScreenOn=!1))}async function Pa(){try{return Ke.wakeLock=await navigator.wakeLock.request("screen"),Ke.wakeLock.addEventListener("release",()=>{Ke.wakeLock=null}),!0}catch(e){$e.error(`requestWakeLock(): ${e.name} - ${e.message}`)}return!1}var ge=P("playback-interaction"),Sa=new De(10),g={player:null,isPlaybackReady:!1,siteNavUiElements:null,trackNavUiElements:null,keyboardShortcuts:null},Br={doubleClickDelay:500};document.addEventListener("DOMContentLoaded",()=>{Tt(),ge.log("DOMContentLoaded"),kt(),Bt()?g.player=nt:Kt()&&(g.player=dt),g.player!==null&&Kr(),Ht(g.player?.getStatus)});function Kr(){ge.log("initShared()"),It(),$r(),g.player.init(),g.siteNavUiElements=new yt("#site-navigation"),g.trackNavUiElements=new gt("nav.single-track-nav .nav-links"),te.init(),g.keyboardShortcuts=Lt(o.playback.keyboardShortcuts),Fr(),ma()}function $r(){E(s.PLAYBACK_READY,Xr),E(s.MEDIA_CUE_TRACK,Ca),E(s.MEDIA_ENDED,Ca),E(s.MEDIA_TIME_REMAINING,Jr),E(s.MEDIA_PREV_TRACK,()=>$(null,N.PREV,L.prevPage)),E(s.MEDIA_NEXT_TRACK,()=>$(null,N.NEXT,L.nextPage))}function Fr(){oe(".playback-shuffle-control span","click",Ft),document.addEventListener("keydown",Gr),document.addEventListener("keydown",Wr),window.addEventListener("blur",jr)}function Gr(e){if(g.isPlaybackReady&&g.keyboardShortcuts.allow()&&e.repeat===!1&&e.ctrlKey===!1&&e.altKey===!1){switch(e.code){case"Backquote":e.preventDefault(),x(g.player.getStatus().trackId);break}switch(e.key){case" ":e.preventDefault(),g.player.togglePlayPause();break;case"Home":case"End":case"PageUp":case"PageDown":Gt(e);break;case"ArrowLeft":qr(e);break;case"ArrowRight":Hr(e);break;case"A":je.toggle();break;case"f":case"F":e.preventDefault(),te.toggle(document.getElementById(g.player.getStatus().iframeId));break;case"m":case"M":e.preventDefault(),g.player.toggleMute(),f(o.playback.masterMute?"Volume is muted (<b>m</b> to unmute)":"Volume is unmuted (<b>m</b> to mute)",3);break;case"p":case"P":Wt.toggle();break;case"r":case"R":f(`${Nt().title} (<b>r</b> to change)`,3);break;case"x":case"X":qt.toggle();break}}}function Wr(e){if(g.isPlaybackReady&&g.keyboardShortcuts.allow())switch(e.key){case"MediaPlayPause":ht===!1&&(ge.log("documentEventMediaKeyDown(): MediaPlayPause"),e.preventDefault(),g.player.togglePlayPause());break;case"MediaTrackPrevious":ge.log("documentEventMediaKeyDown(): MediaTrackPrevious"),e.preventDefault(),g.player.prevTrack();break;case"MediaTrackNext":ge.log("documentEventMediaKeyDown(): MediaTrackNext"),e.preventDefault(),g.player.nextTrack();break}}function qr(e){e.preventDefault(),e.shiftKey===!0?$(null,N.PREV,L.prevPage):g.player.prevTrack()}function Hr(e){e.preventDefault(),e.shiftKey===!0?$(null,N.NEXT,L.nextPage):g.player.nextTrack()}function $(e,t,a){e?.preventDefault(),ce()&&g.player.getStatus().trackType===D.YOUTUBE?Xt()===!1?ue(t,g.player.getStatus().isPlaying):f("Loading track, please wait...",3):La(null,a)}function Xr(){oe(".playback-details-control","click",zr),oe(".playback-thumbnail-control","click",Qr),oe(".playback-timer-control","click",Zr),g.isPlaybackReady=!0}function Ca(){o.playback.autoExitFullscreen&&te.exit()}function Jr(e){o.playback.autoExitFsOnWarning&&e.data.timeRemainingSeconds<=o.playback.timeRemainingSeconds&&te.exit()}function jr(){he()||setTimeout(()=>{document.activeElement instanceof HTMLIFrameElement&&setTimeout(()=>{document.activeElement.blur(),document.activeElement instanceof HTMLIFrameElement&&document.activeElement.blur()},250)},0)}function zr(){x(g.player.getStatus().trackId),he()&&o.list.showUpNextModal?Ee("showUpNextModalHint","<b>Tip:</b> Click or tap Artist &amp; Title to show Up Next queue"):Ee("showTrackDetailsHint","<b>Tip:</b> Click or tap Artist &amp; Title to show current track")}function Qr(){$t()?(Sa.add(u.MOUSE,d.MOUSE_CLICK,null),Ee("showGalleryTrackThumbnailHint","<b>Tip:</b> Double click or tap Track Thumbnail for full screen"),Sa.doubleClicked(u.MOUSE,d.MOUSE_CLICK,Br.doubleClickDelay)&&te.enter(document.getElementById(g.player.getStatus().iframeId))):he()&&(x(0),Ee("showListTrackThumbnailHint","<b>Tip:</b> Click or tap Track Thumbnail to show player"))}function Zr(){je.toggle(),Ee("showTrackTimerHint","<b>Tip:</b> Click or tap Track Timer to toggle Autoplay On / Off")}var yt=class extends He{elementClicked(){if(this.clicked("a.navbar-prev-link"))return $(this.event,N.PREV,L.prevPage);if(this.clicked("a.navbar-next-link"))return $(this.event,N.NEXT,L.nextPage)}},gt=class extends He{elementClicked(){if(this.clicked("div.nav-previous a"))return $(this.event,N.PREV,L.prevPage);if(this.clicked("div.nav-next a"))return $(this.event,N.NEXT,L.nextPage)}};function Ee(e,t,a=0){o.tips[e]&&(f(t,a),o.tips[e]=!1)}function La(e,t){e?.preventDefault(),H(t,g.player.getStatus().isPlaying)}
//# sourceMappingURL=interaction.js.map
