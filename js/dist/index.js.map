{
  "version": 3,
  "sources": ["../src/site/share-modal.js", "../src/site/interaction.js", "../src/site/termlist-templates.js", "../src/site/termlist-rest.js", "../src/site/termlist.js", "../src/shared/settings/settings-ui.js", "../src/site/nav-menu.js", "../src/site/nav-search.js", "../src/index.js"],
  "sourcesContent": ["//\r\n// Share modal\r\n//\r\n// https://ultrafunk.com\r\n//\r\n\r\n\r\nimport * as debugLogger from '../shared/debuglogger.js';\r\nimport { showModal }    from '../shared/modal.js';\r\nimport { showSnackbar } from '../shared/snackbar.js';\r\n\r\n\r\n/*************************************************************************************************/\r\n\r\n\r\nconst debug = debugLogger.newInstance('share-modal');\r\n\r\n\r\n// ************************************************************************************************\r\n// Share Modal Dialog closure\r\n// ************************************************************************************************\r\n\r\nconst shareModalClosure = (() =>\r\n{\r\n  const filterBodyTextRegEx = /\\s{1,}[\\u002D\\u00B7\\u2013]\\s{1,}/i;\r\n  let title, bodyText, filterBodyText, bodyHtml, url, urlType, sourceUid, verb, icon;\r\n\r\n  return {\r\n    show,\r\n  };\r\n\r\n  function show(args)\r\n  {\r\n    ({\r\n      title          = 'Share / Play Track',\r\n      bodyText       = null,\r\n      filterBodyText = false,\r\n      bodyHtml       = null,\r\n      url            = null,\r\n      urlType        = 'Link',\r\n      sourceUid      = null,\r\n      verb           = 'Play',\r\n      icon           = 'link',\r\n    } = args);\r\n\r\n    return showModal(title, getSingleChoiceList(), 'share', singleChoiceListClick);\r\n  }\r\n\r\n  function getSingleChoiceList()\r\n  {\r\n    const singleChoiceList = [\r\n      { clickId: 'copyToClipboardId', icon: 'content_copy', content: '<b>Copy Link</b> to Clipboard'   },\r\n      { clickId: 'shareOnEmailId',    icon: 'share',        content: '<b>Share</b> on Email'           },\r\n      { clickId: 'searchOnGoogleId',  icon: 'search',       content: '<b>Search</b> on Google'         },\r\n      { clickId: 'amazonMusicId',     icon: icon,           content: `<b>${verb}</b> on Amazon Music`  },\r\n      { clickId: 'appleMusicId',      icon: icon,           content: `<b>${verb}</b> on Apple Music`   },\r\n      { clickId: 'spotifyId',         icon: icon,           content: `<b>${verb}</b> on Spotify`       },\r\n      { clickId: 'youTubeMusicId',    icon: icon,           content: `<b>${verb}</b> on YouTube Music` },\r\n    ];\r\n\r\n    if (bodyHtml !== null)\r\n      singleChoiceList.unshift({ class: 'track-share-entry', content: bodyHtml });\r\n\r\n    return singleChoiceList;\r\n  }\r\n\r\n  function singleChoiceListClick(clickedId)\r\n  {\r\n    debug.log(`singleChoiceListClick(): ${clickedId} - title: \"${title}\" - bodyText: \"${bodyText}\" - filterBodyText: ${filterBodyText} - url: ${url} - urlType: ${urlType} - sourceUid: ${sourceUid} - verb: ${verb}`);\r\n\r\n    const searchString = filterBodyText\r\n                           ? encodeURIComponent(bodyText.replace(filterBodyTextRegEx, ' '))\r\n                           : encodeURIComponent(bodyText);\r\n\r\n    switch (clickedId)\r\n    {\r\n      case 'copyToClipboardId':\r\n        copyTextToClipboard(url, urlType);\r\n        break;\r\n\r\n      case 'shareOnEmailId':\r\n        window.location.href = `mailto:?subject=${encodeURIComponent(`Ultrafunk ${urlType}: ${bodyText}`)}&body=${encodeURI(url)}%0d%0a`;\r\n        break;\r\n\r\n      case 'searchOnGoogleId':\r\n        window.open(`https://www.google.com/search?q=${searchString}`, \"_blank\");\r\n        break;\r\n\r\n      case 'amazonMusicId':\r\n        window.open(`https://music.amazon.com/search/${searchString}`, \"_blank\");\r\n        break;\r\n\r\n      case 'appleMusicId':\r\n        window.open(`https://music.apple.com/ca/search?term=${searchString}`, \"_blank\");\r\n        break;\r\n\r\n      case 'spotifyId':\r\n        window.open(`https://open.spotify.com/search/${searchString}`, \"_blank\");\r\n        break;\r\n\r\n      case 'youTubeMusicId':\r\n        {\r\n          if (sourceUid !== null)\r\n            window.open(`https://music.youtube.com/watch?v=${sourceUid}`, \"_blank\");\r\n          else\r\n            window.open(`https://music.youtube.com/search?q=${searchString}`, \"_blank\");\r\n        }\r\n        break;\r\n    }\r\n  }\r\n});\r\n\r\nexport const shareModal = shareModalClosure();\r\n\r\n\r\n// ************************************************************************************************\r\n//\r\n// ************************************************************************************************\r\n\r\nexport function copyTextToClipboard(clipboardText, contentDescription = 'Content')\r\n{\r\n  if (navigator.clipboard)\r\n  {\r\n    navigator.clipboard.writeText(clipboardText).then(() =>\r\n    {\r\n      showSnackbar(`${contentDescription} copied to clipboard`, 3);\r\n    },\r\n    (reason) =>\r\n    {\r\n      onClipboardWriteError(reason, clipboardText, contentDescription);\r\n    });\r\n  }\r\n  else\r\n  {\r\n    // Handle navigator.clipboard not properly supported on WebKit / Safari yet...\r\n    if (copyTextToClipboardExecCommand(clipboardText))\r\n      showSnackbar(`${contentDescription} copied to clipboard`, 3);\r\n    else\r\n      onClipboardWriteError(`document.execCommand('copy') for \"${clipboardText}\" failed!`, clipboardText, contentDescription);\r\n  }\r\n}\r\n\r\nfunction copyTextToClipboardExecCommand(clipboardText)\r\n{\r\n  const element = document.createElement('textarea');\r\n\r\n  document.body.appendChild(element);\r\n  element.textContent = clipboardText;\r\n  element.select();\r\n  const isCopied = document.execCommand('copy');\r\n  document.body.removeChild(element);\r\n\r\n  return isCopied;\r\n}\r\n\r\nfunction onClipboardWriteError(logError, clipboardText, contentDescription)\r\n{\r\n  debug.error(`copyTextToClipboard() error: ${logError}`);\r\n\r\n  const modalBody = /*html*/ `\r\n    <style>\r\n      .modal-dialog-body p.modal-clipboard-content {\r\n        padding: 10px 15px;\r\n        border-radius: var(--dialog-border-radius);\r\n        background-color: var(--list-row-odd-color);\r\n      }\r\n    </style>\r\n    <p class=\"modal-clipboard-error\">Failed to write ${contentDescription} to the clipboard, please copy the text below:</p>\r\n    <p class=\"modal-clipboard-content\">${clipboardText}</p>`;\r\n\r\n  showModal('Copy to Clipboard error!', modalBody);\r\n}\r\n", "//\r\n// Ultrafunk site interaction\r\n//\r\n// https://ultrafunk.com\r\n//\r\n\r\n\r\nimport * as debugLogger      from '../shared/debuglogger.js';\r\nimport * as utils            from '../shared/utils.js';\r\nimport { ElementToggle }     from '../shared/element-toggle.js';\r\nimport { ElementClick }      from '../shared/element-click.js';\r\nimport { settings }          from '../shared/session-data.js';\r\nimport { showModal }         from '../shared/modal.js';\r\nimport { KEY, setValue }     from '../shared/storage.js';\r\nimport { getModalTrackHtml } from '../shared/modal-templates.js';\r\n\r\nimport {\r\n  shareModal,\r\n  copyTextToClipboard,\r\n} from './share-modal.js';\r\n\r\n\r\n/*************************************************************************************************/\r\n\r\n\r\nconst debug = debugLogger.newInstance('site-interaction');\r\nconst htmlClassList = document.documentElement.classList;\r\n\r\nconst m = {\r\n  metaUiElements: null,\r\n  listUiElements: null,\r\n};\r\n\r\nexport let siteTheme     = {};\r\nexport let galleryLayout = {};\r\n\r\n\r\n// ************************************************************************************************\r\n//\r\n// ************************************************************************************************\r\n\r\nexport function init()\r\n{\r\n  debug.log('init()');\r\n\r\n  m.metaUiElements = new MetaUiElements('div.track-meta', true);\r\n  m.listUiElements = new ListUiElements('#tracklist');\r\n  siteTheme        = new SiteThemeToggle('footer-site-theme-toggle');\r\n  galleryLayout    = new GalleryLayoutToggle('footer-gallery-layout-toggle');\r\n\r\n  window.addEventListener('load', () =>\r\n  {\r\n    utils.addListener('.widget ul.uf_channel',     'click', linkClick);\r\n    utils.addListener('.widget ul.uf_artist',      'click', linkClick);\r\n    utils.addListener('.widget.widget_archive ul', 'click', linkClick);\r\n  });\r\n}\r\n\r\nexport function settingsUpdated()\r\n{\r\n  siteTheme.setCurrent();\r\n  galleryLayout.setCurrent();\r\n}\r\n\r\n\r\n// ************************************************************************************************\r\n// UI elements event handling\r\n// ************************************************************************************************\r\n\r\nclass MetaUiElements extends ElementClick\r\n{\r\n  elementClicked()\r\n  {\r\n    if (this.clicked('div.track-share-control'))\r\n      return sharePlayClick(this.closest('single-track, gallery-track'));\r\n\r\n    if (this.clicked('div.track-details-control'))\r\n      return detailsClick(this.closest('single-track, gallery-track'));\r\n\r\n    if (this.clicked('span.track-artists-links'))\r\n      return linkClick(this.event);\r\n\r\n    if (this.clicked('span.track-channels-links'))\r\n      return linkClick(this.event);\r\n  }\r\n}\r\n\r\nclass ListUiElements extends ElementClick\r\n{\r\n  elementClicked()\r\n  {\r\n    if (this.clicked('div.share-play-button'))\r\n      return sharePlayClick(this.closest('div.track-entry'));\r\n\r\n    if (this.clicked('div.details-button'))\r\n      return detailsClick(this.closest('div.track-entry'));\r\n  }\r\n}\r\n\r\nfunction linkClick(event)\r\n{\r\n  if (event.target.matches('a'))\r\n  {\r\n    event?.preventDefault();\r\n    utils.navToUrl(utils.getPrefPlayerUrl(event.target.href));\r\n  }\r\n}\r\n\r\nfunction sharePlayClick(element)\r\n{\r\n  const trackArtist = utils.stripAttribute(element, 'data-track-artist');\r\n  const trackTitle  = utils.stripAttribute(element, 'data-track-title');\r\n\r\n  const modalId = shareModal.show({\r\n    bodyText:       `${trackArtist} - ${trackTitle}`,\r\n    filterBodyText: true,\r\n    bodyHtml:       getModalTrackHtml(element, trackArtist, trackTitle),\r\n    url:            utils.stripAttribute(element, 'data-track-url'),\r\n    urlType:        'Track link',\r\n    sourceUid:      utils.stripAttribute(element, 'data-track-source-uid'),\r\n  });\r\n\r\n  trackThumbnailClick(modalId, `${trackArtist} - ${trackTitle}`);\r\n}\r\n\r\nfunction detailsClick(element)\r\n{\r\n  const trackArtist   = utils.stripAttribute(element, 'data-track-artist');\r\n  const trackTitle    = utils.stripAttribute(element, 'data-track-title');\r\n  const trackDuration = parseInt(element.getAttribute('data-track-duration'));\r\n  const artists       = element.querySelector('.track-artists-links').querySelectorAll('a');\r\n  const channels      = element.querySelector('.track-channels-links').querySelectorAll('a');\r\n  const modalEntries  = [];\r\n\r\n  modalEntries.push({\r\n    class:   'track-details-entry',\r\n    content: getModalTrackHtml(element, trackArtist, trackTitle),\r\n  });\r\n\r\n  modalEntries.push({ class: 'header-entry', content: 'Artists' });\r\n\r\n  artists.forEach(item =>\r\n  {\r\n    modalEntries.push({\r\n      clickId: `entry-${modalEntries.length}`,\r\n      class:   `icon-text ${item.classList[0] ?? ''}`,\r\n      title:   'Go to Artist',\r\n      content: item.innerText,\r\n      link:    item.href,\r\n      icon:    'link',\r\n    });\r\n  });\r\n\r\n  modalEntries.push({ class: 'header-entry', content: 'Channels' });\r\n\r\n  channels.forEach(item =>\r\n  {\r\n    modalEntries.push({\r\n      clickId: `entry-${modalEntries.length}`,\r\n      title:   'Go to Channel',\r\n      content: item.innerText,\r\n      link:    item.href,\r\n      icon:    'link'\r\n    });\r\n  });\r\n\r\n  const modalId = showModal(\r\n    `Track Details<span class=\"light-text lowercase-text\">${((trackDuration > 0) ? utils.getTimeString(trackDuration) : 'N / A')}</span>`,\r\n    modalEntries,\r\n    'track-details',\r\n    (clickedId) =>\r\n  {\r\n    utils.navToUrl(modalEntries.find(item => (item.clickId === clickedId)).link);\r\n  });\r\n\r\n  trackThumbnailClick(modalId, `${trackArtist} - ${trackTitle}`);\r\n}\r\n\r\nfunction trackThumbnailClick(modalId, artistTitle)\r\n{\r\n  document.getElementById(modalId).querySelector('.modal-track .modal-track-thumbnail').title = 'Click / tap to Copy Artist & Title';\r\n  document.getElementById(modalId)?.querySelector('img')?.addEventListener('click', () => copyTextToClipboard(artistTitle, 'Artist &amp Title'));\r\n}\r\n\r\n\r\n// ************************************************************************************************\r\n// Site theme and layout settings helpers\r\n// ************************************************************************************************\r\n\r\nfunction getCurrentSetting(settingsObject, currentId, defaultSetting)\r\n{\r\n  const setting = Object.values(settingsObject).find(value => (value.id === currentId));\r\n  return ((setting !== undefined) ? setting : defaultSetting);\r\n}\r\n\r\nfunction getNextSetting(settingsObject, currentSetting)\r\n{\r\n  const index = Object.values(settingsObject).findIndex(value => (value.id === currentSetting.id));\r\n  const keys  = Object.keys(settingsObject);\r\n\r\n  return (((index + 1) < keys.length)\r\n           ? settingsObject[keys[index + 1]]\r\n           : settingsObject[keys[0]]);\r\n}\r\n\r\n\r\n// ************************************************************************************************\r\n// Site theme handling\r\n// ************************************************************************************************\r\n\r\nclass SiteThemeToggle extends ElementToggle\r\n{\r\n  constructor(elementId)\r\n  {\r\n    super(elementId, false);\r\n\r\n    this.themes = {\r\n      light: { id: 'light', text: 'light', class: 'site-theme-light' },\r\n      dark:  { id: 'dark',  text: 'dark',  class: 'site-theme-dark'  },\r\n      black: { id: 'black', text: 'black', class: 'site-theme-black' },\r\n      auto:  { id: 'auto',  text: 'auto'                             }, // This has no CSS class since auto is always light or dark\r\n    };\r\n\r\n    this.setCurrent();\r\n\r\n    window.matchMedia('(prefers-color-scheme: dark)').addEventListener('change', () => this.matchMediaPrefColorScheme());\r\n  }\r\n\r\n  setCurrent()\r\n  {\r\n    this.currentTheme = getCurrentSetting(this.themes, settings.site.theme, this.themes.auto);\r\n    this.update();\r\n  }\r\n\r\n  matchMediaPrefColorScheme()\r\n  {\r\n    if (this.currentTheme.id === this.themes.auto.id)\r\n      this.update();\r\n  }\r\n\r\n  toggle()\r\n  {\r\n    this.currentTheme   = getNextSetting(this.themes, this.currentTheme);\r\n    settings.site.theme = this.currentTheme.id;\r\n  }\r\n\r\n  update()\r\n  {\r\n    let newTheme = this.currentTheme;\r\n\r\n    if (this.currentTheme.id === this.themes.auto.id)\r\n    {\r\n      newTheme = window.matchMedia('(prefers-color-scheme: dark)').matches\r\n                   ? this.themes.dark\r\n                   : this.themes.light;\r\n    }\r\n\r\n    setValue(KEY.UF_SITE_THEME, newTheme.id);\r\n\r\n    // Only update DOM if something has actually changed...\r\n    if (htmlClassList.contains(newTheme.class) === false)\r\n    {\r\n      debug.log(`SiteThemeToggle.update() - newSiteTheme: ${newTheme.id}`);\r\n\r\n      htmlClassList.remove(this.themes.light.class, this.themes.dark.class, this.themes.black.class);\r\n      htmlClassList.add(newTheme.class);\r\n    }\r\n\r\n    // Always update this because AUTO is not a separate class (only DARK + LIGHT are classes)\r\n    this.value = this.currentTheme.text;\r\n  }\r\n}\r\n\r\n\r\n// ************************************************************************************************\r\n// Gallery layout handling\r\n// ************************************************************************************************\r\n\r\nclass GalleryLayoutToggle extends ElementToggle\r\n{\r\n  constructor(elementId)\r\n  {\r\n    super(elementId, false);\r\n\r\n    this.minWidth = `(max-width: ${utils.getCssPropString('--gallery-layout-min-width')})`;\r\n\r\n    this.layouts = {\r\n      oneColumn:   { id: '1-column', text: '1 column',     class: 'gallery-1-col' },\r\n      twoColumn:   { id: '2-column', text: '2 column',     class: 'gallery-2-col' },\r\n      threeColumn: { id: '3-column', text: '3 / 4 column', class: 'gallery-3-col' },\r\n    };\r\n\r\n    this.setCurrent();\r\n\r\n    window.matchMedia(this.minWidth).addEventListener('change', (event) => this.matchMediaMinWidth(event));\r\n  }\r\n\r\n  setCurrent()\r\n  {\r\n    this.currentLayout = getCurrentSetting(this.layouts, settings.gallery.layout, this.layouts.threeColumn);\r\n    this.update();\r\n  }\r\n\r\n  matchMediaMinWidth(event)\r\n  {\r\n    if (htmlClassList.contains('gallery-layout'))\r\n    {\r\n      if (event.matches)\r\n      {\r\n        htmlClassList.remove(this.currentLayout.class);\r\n        htmlClassList.add(this.layouts.oneColumn.class);\r\n      }\r\n      else\r\n      {\r\n        htmlClassList.remove(this.layouts.oneColumn.class);\r\n        htmlClassList.add(this.currentLayout.class);\r\n      }\r\n    }\r\n  }\r\n\r\n  toggle()\r\n  {\r\n    this.currentLayout      = getNextSetting(this.layouts, this.currentLayout);\r\n    settings.gallery.layout = this.currentLayout.id;\r\n  }\r\n\r\n  update(event)\r\n  {\r\n    this.value = this.currentLayout.text;\r\n    setValue(KEY.UF_GALLERY_LAYOUT, this.currentLayout.id);\r\n\r\n    if (window.matchMedia(this.minWidth).matches)\r\n      return;\r\n\r\n    // Only update DOM if needed and when something has actually changed\r\n    if ((htmlClassList.contains('gallery-layout')) && (htmlClassList.contains(this.currentLayout.class) === false))\r\n    {\r\n      debug.log(`GalleryLayoutToggle.update() - newGalleryLayout: ${this.currentLayout.id}`);\r\n\r\n      htmlClassList.remove(this.layouts.oneColumn.class, this.layouts.twoColumn.class, this.layouts.threeColumn.class);\r\n      htmlClassList.add(this.currentLayout.class);\r\n    }\r\n\r\n    if (event?.type === 'click')\r\n      this.element.scrollIntoView();\r\n  }\r\n}\r\n", "//\r\n// Termlist template functions\r\n//\r\n// https://ultrafunk.com\r\n//\r\n\r\n\r\nimport {\r\n  SITE_URL,\r\n  getPrefPlayerUrl,\r\n  getThumbnailData,\r\n} from \"../shared/utils.js\";\r\n\r\n\r\n// ************************************************************************************************\r\n// Render fetched track and meta-data as HTML\r\n// ************************************************************************************************\r\n\r\nexport function getTermlistHtml(header, termSlug, termData)\r\n{\r\n  let html = `<b>${header}</b>`;\r\n\r\n  termData.forEach((track, index) =>\r\n  {\r\n    const thumbnailData = getThumbnailData(track.meta);\r\n\r\n    html += /*html*/ `\r\n    <div class=\"track\">\r\n      <div class=\"thumbnail ${thumbnailData.class}\"\r\n        data-term-url=\"${track.link}\"\r\n        data-term-slug=\"${termSlug}\"\r\n        data-track-num=\"${index + 1}\"\r\n        data-track-type=\"${track.meta.track_source_type}\"\r\n        data-track-id=\"track-${track.id}\"\r\n        data-track-source-uid=\"${thumbnailData.uid}\" title=\"Play Track\"\r\n        >\r\n        <img src=\"${thumbnailData.src}\">\r\n      </div>\r\n      <div class=\"artist-title text-nowrap-ellipsis\">\r\n        <a href=\"${track.link}\" title=\"Go to track\"><span><b>${track.meta.track_artist}</b></span><br><span>${track.meta.track_title}</span></a>\r\n      </div>\r\n    </div>`;\r\n  });\r\n\r\n  return html;\r\n}\r\n\r\nexport function getTermLinksHtml(header, termData)\r\n{\r\n  let html = `<b>${header}</b><br>`;\r\n\r\n  termData.forEach(item => (html += `<a href=\"${getPrefPlayerUrl(item.link)}\">${item.name}</a>, `));\r\n\r\n  return html.slice(0, (html.length - 2));\r\n}\r\n\r\nexport function getTopArtistsLinksHtml(header, artistsData, channelSlug)\r\n{\r\n  let html = `<b>${header}</b><br>`;\r\n\r\n  artistsData.forEach((item) =>\r\n  {\r\n    const artistLink = getPrefPlayerUrl(`${SITE_URL}/artist/${item.artist_slug}/?channel=${channelSlug}`);\r\n    html += `<a href=\"${artistLink}\">${item.artist_name}</a> (${item.track_count})<br>`;\r\n  });\r\n\r\n  return html;\r\n}\r\n", "//\r\n// Termlist REST data fetch and caching\r\n//\r\n// https://ultrafunk.com\r\n//\r\n\r\n\r\nimport { KEY }          from '../shared/storage.js';\r\nimport { showSnackbar } from '../shared/snackbar.js';\r\n\r\nimport {\r\n  fetchRest,\r\n  stripAttribute,\r\n} from '../shared/utils.js';\r\n\r\nimport {\r\n  getTermlistHtml,\r\n  getTermLinksHtml,\r\n  getTopArtistsLinksHtml,\r\n} from './termlist-templates.js';\r\n\r\n\r\n/*************************************************************************************************/\r\n\r\n\r\nconst m = { termCache: {} };\r\n\r\n\r\n// ************************************************************************************************\r\n// Fetch data via REST API and update DOM with results\r\n// ************************************************************************************************\r\n\r\nexport function loadTermlist(termlistContainer, termlistEntry, termlistBody)\r\n{\r\n  const termType      = stripAttribute(termlistContainer, 'data-term-type');\r\n  const termId        = parseInt(termlistEntry.getAttribute('data-term-id'));\r\n  const termSlug      = stripAttribute(termlistEntry, 'data-term-slug');\r\n  const isAllChannels = (termType === 'channels');\r\n\r\n  fetchTracks(termType, termId, (isAllChannels ? 10 : 50), async (termData) =>\r\n  {\r\n    let header  = isAllChannels ? 'Latest Tracks' : 'All Tracks';\r\n    let element = termlistBody.querySelector('.body-left');\r\n\r\n    if (termData !== null)\r\n    {\r\n      element.innerHTML = getTermlistHtml(header, termSlug, termData);\r\n      termlistEntry.setAttribute('data-is-fetched', 1);\r\n    }\r\n    else\r\n    {\r\n      showSnackbar('Failed to fetch track data!', 30, 'retry', () => loadTermlist(termlistContainer, termlistEntry, termlistBody));\r\n    }\r\n\r\n    if (!isAllChannels && (termData !== null))\r\n    {\r\n      fetchArtistMeta(termData, termId, 50, (metaType, metadata) =>\r\n      {\r\n        header  = (metaType === 'artists') ? 'Related Artists' : 'In Channels';\r\n        element = (metaType === 'artists')\r\n                    ? termlistBody.querySelector('.artists')\r\n                    : termlistBody.querySelector('.channels');\r\n\r\n        if (metadata !== null)\r\n          element.innerHTML = getTermLinksHtml(header, metadata);\r\n        else\r\n          element.innerHTML = `<b>${header}</b><br>None found`;\r\n      });\r\n    }\r\n    else if (termData !== null)\r\n    {\r\n      if (('topArtists' in m.termCache[termId]) === false)\r\n      {\r\n        const restResponse = await fetchRest({\r\n          endpoint: 'top-artists',\r\n          query: `channelId=${termId}`,\r\n          returnStatus: true,\r\n          path: '/wp-json/ultrafunk/v1/',\r\n        });\r\n\r\n        if ((restResponse !== null) && (restResponse.status.code === 200))\r\n          m.termCache[termId]['topArtists'] = restResponse.data;\r\n      }\r\n\r\n      termlistBody.querySelector('.top-artists').innerHTML = getTopArtistsLinksHtml('Top Artists (tracks)', m.termCache[termId]['topArtists'], termSlug);\r\n    }\r\n  });\r\n}\r\n\r\n\r\n// ************************************************************************************************\r\n// Fetch tracks for a given termType with termId (channel or artist)\r\n// ************************************************************************************************\r\n\r\nasync function fetchTracks(termType, termId, maxItems, callback)\r\n{\r\n  if ((termId in m.termCache) === false)\r\n  {\r\n    const restResponse = await fetchRest({\r\n      endpoint: 'tracks',\r\n      query: `${termType}=${termId}&per_page=${maxItems}&_fields=id,link,artists,channels,meta`,\r\n      returnStatus: true,\r\n    });\r\n\r\n    if ((restResponse !== null) && (restResponse.status.code === 200))\r\n      m.termCache[termId] = { tracks: restResponse.data };\r\n  }\r\n\r\n  callback((m.termCache[termId] !== undefined) ? m.termCache[termId].tracks : null);\r\n}\r\n\r\n\r\n// ************************************************************************************************\r\n// Merge then fetch channels and artists for a given artist (termId)\r\n// ************************************************************************************************\r\n\r\nfunction fetchArtistMeta(termData, termId, maxItems, callback)\r\n{\r\n  if (('channels' in m.termCache[termId]) && ('artists' in m.termCache[termId]))\r\n  {\r\n    callback('channels', m.termCache[termId].channels);\r\n    callback('artists',  m.termCache[termId].artists);\r\n  }\r\n  else\r\n  {\r\n    const channels = [];\r\n    let   artists  = [];\r\n\r\n    termData.forEach(item =>\r\n    {\r\n      channels.push.apply(channels, item.channels);\r\n      artists.push.apply(artists, item.artists);\r\n    });\r\n\r\n    artists = artists.filter(item => (item !== termId));\r\n\r\n    fetchMeta('channels', termId, [...new Set(channels)], maxItems, callback);\r\n    fetchMeta('artists',  termId, [...new Set(artists)],  maxItems, callback);\r\n  }\r\n}\r\n\r\nasync function fetchMeta(\r\n  termType,\r\n  termId,\r\n  termIds,\r\n  maxItems,\r\n  callback\r\n)\r\n{\r\n  if (termIds.length > 0)\r\n  {\r\n    const restResponse = await fetchRest({\r\n      endpoint: termType,\r\n      query: `include=${termIds}&per_page=${maxItems}&_fields=link,name`,\r\n      returnStatus: true,\r\n    });\r\n\r\n    if ((restResponse !== null) && (restResponse.status.code === 200))\r\n      m.termCache[termId][termType] = restResponse.data;\r\n  }\r\n  else\r\n  {\r\n    m.termCache[termId][termType] = null;\r\n  }\r\n\r\n  callback(termType, (m.termCache[termId][termType] !== undefined) ? m.termCache[termId][termType] : null);\r\n}\r\n\r\n\r\n// ************************************************************************************************\r\n// Term cache functions\r\n// ************************************************************************************************\r\n\r\nexport function readCache()\r\n{\r\n  m.termCache = JSON.parse(sessionStorage.getItem(KEY.UF_TERMLIST_CACHE));\r\n\r\n  if (m.termCache === null)\r\n    m.termCache = {};\r\n}\r\n\r\nexport function writeCache()\r\n{\r\n  sessionStorage.setItem(KEY.UF_TERMLIST_CACHE, JSON.stringify(m.termCache));\r\n}\r\n\r\nexport function deleteCache()\r\n{\r\n  sessionStorage.removeItem(KEY.UF_TERMLIST_CACHE);\r\n}\r\n\r\nexport function hasCache()\r\n{\r\n  return (Object.keys(m.termCache).length > 0);\r\n}\r\n", "//\r\n// Termlist UI module\r\n//\r\n// https://ultrafunk.com\r\n//\r\n\r\n\r\nimport * as debugLogger       from '../shared/debuglogger.js';\r\nimport * as termlistRest      from './termlist-rest.js';\r\nimport * as utils             from '../shared/utils.js';\r\nimport { ElementClick }       from '../shared/element-click.js';\r\nimport { shareModal }         from './share-modal.js';\r\nimport { TRACK_TYPE }         from '../playback/mediaplayers.js';\r\nimport { KEY, setCookie }     from '../shared/storage.js';\r\nimport { PREF_PLAYER }        from '../shared/settings/settings.js';\r\nimport { response, settings } from '../shared/session-data.js';\r\n\r\n\r\n/*************************************************************************************************/\r\n\r\n\r\nconst debug = debugLogger.newInstance('termlist');\r\n\r\nconst m = {\r\n  listContainer:       null,\r\n  uiElements:          null,\r\n  navTitleFoundItems:  null,\r\n  termlistFilterInput: null,\r\n  termlistEntries:     null,\r\n  transitionTimeoutId: 0,\r\n};\r\n\r\nconst allowKeyboardShortcutsEvent = new Event('allowKeyboardShortcuts');\r\nconst denyKeyboardShortcutsEvent  = new Event('denyKeyboardShortcuts');\r\n\r\n\r\n// ************************************************************************************************\r\n// Init module\r\n// ************************************************************************************************\r\n\r\nexport function initTermlist()\r\n{\r\n  if (document.getElementById('termlist-container') !== null)\r\n  {\r\n    debug.log('initTermlist()');\r\n\r\n    m.listContainer = document.getElementById('termlist-container');\r\n    m.uiElements    = new UiElements('#termlist-container');\r\n\r\n    initTermlistFilter();\r\n    restoreState();\r\n  }\r\n}\r\n\r\n\r\n// ************************************************************************************************\r\n// Save and restore Termlist state\r\n// ************************************************************************************************\r\n\r\nfunction saveState()\r\n{\r\n  if (termlistRest.hasCache())\r\n  {\r\n    const termlistState = {\r\n      pageUrl:     window.location.href,\r\n      scrollPos:   Math.round(window.pageYOffset),\r\n      openTermIds: [],\r\n    };\r\n\r\n    document.querySelectorAll('.termlist-entry').forEach(element =>\r\n    {\r\n      if (element.getAttribute('data-is-expanded') === '1')\r\n        termlistState.openTermIds.push(element.id);\r\n    });\r\n\r\n    sessionStorage.setItem(KEY.UF_TERMLIST_STATE, JSON.stringify(termlistState));\r\n    termlistRest.writeCache();\r\n  }\r\n}\r\n\r\nfunction restoreState()\r\n{\r\n  termlistRest.readCache();\r\n\r\n  if (performance.getEntriesByType('navigation')[0].type !== 'reload')\r\n  {\r\n    const termlistState = JSON.parse(sessionStorage.getItem(KEY.UF_TERMLIST_STATE));\r\n\r\n    if ((termlistState !== null) && (termlistState.pageUrl === window.location.href))\r\n    {\r\n      history.scrollRestoration = 'manual';\r\n\r\n      termlistState.openTermIds.forEach(item =>\r\n      {\r\n        document.getElementById(item).querySelector('div.termlist-header').click();\r\n      });\r\n\r\n      window.scroll({ top: termlistState.scrollPos, left: 0, behavior: 'auto' });\r\n    }\r\n    else\r\n    {\r\n      history.scrollRestoration = 'auto';\r\n    }\r\n  }\r\n\r\n  sessionStorage.removeItem(KEY.UF_TERMLIST_STATE);\r\n  termlistRest.deleteCache();\r\n}\r\n\r\n\r\n// ************************************************************************************************\r\n// Realtime filtering of termlist items\r\n// ************************************************************************************************\r\n\r\nfunction initTermlistFilter()\r\n{\r\n  if (m.listContainer.getAttribute('data-term-type') === 'artists')\r\n  {\r\n    m.navTitleFoundItems  = document.querySelectorAll('div.navbar-title span.found-items');\r\n    m.termlistFilterInput = document.getElementById('termlist-filter-input');\r\n    m.termlistEntries     = m.listContainer.querySelectorAll('.termlist-entry');\r\n\r\n    m.termlistFilterInput.addEventListener('keyup', (event) => filterTermsList(event));\r\n    m.termlistFilterInput.addEventListener('focus', () => document.dispatchEvent(denyKeyboardShortcutsEvent));\r\n    m.termlistFilterInput.addEventListener('blur',  () => document.dispatchEvent(allowKeyboardShortcutsEvent));\r\n  //m.termlistFilterInput.focus();\r\n\r\n    // Lowercase all search term names now, optimizing comparison to user input later\r\n    termsListArray.forEach(entry => entry.name = entry.name.toLowerCase()); // eslint-disable-line no-undef\r\n\r\n    // Scroll current selection (artist letter) into view if needed...\r\n    document.querySelector('div.artist-letter.current').scrollIntoView(false);\r\n  }\r\n}\r\n\r\nfunction skipKeys(key)\r\n{\r\n  return ((key === 'ArrowLeft')  ||\r\n          (key === 'ArrowRight') ||\r\n          (key === 'Home')       ||\r\n          (key === 'End')        ||\r\n          (key === 'Shift'));\r\n}\r\n\r\nfunction filterTermsList(event)\r\n{\r\n  // Skip updating on keys that are not relevant\r\n  if (skipKeys(event.key))\r\n    return;\r\n\r\n  const filterStart  = performance.now();\r\n  const filterString = m.termlistFilterInput.value.toLowerCase();\r\n  let   foundCount   = m.termlistEntries.length;\r\n\r\n  // Disable all CSS transitions when updating the filtered items\r\n  m.listContainer.classList.add('notransitions');\r\n\r\n  if (filterString.length >= 3)\r\n  {\r\n    // eslint-disable-next-line no-undef\r\n    const foundEntries = termsListArray.filter(entry => (entry.name.includes(filterString)));\r\n    let filteredOddEvenRow = 1;\r\n    foundCount = (foundEntries.length > 0) ? foundEntries.length : 0;\r\n\r\n    m.termlistEntries.forEach(element =>\r\n    {\r\n      if (foundEntries.some(entry => (entry.id === element.id)) === false)\r\n        element.className = 'termlist-entry hidden';\r\n      else\r\n        element.className = `termlist-entry ${(filteredOddEvenRow++ % 2) ? 'odd' : 'even'}`;\r\n    });\r\n  }\r\n  else\r\n  {\r\n    m.termlistEntries.forEach(element => (element.className = 'termlist-entry'));\r\n  }\r\n\r\n  const currentFilterInput = (filterString.length >= 3) ? `\"${filterString}\" - ` : '';\r\n  m.navTitleFoundItems.forEach(element => (element.textContent = ` ( ${currentFilterInput}${foundCount} found )`));\r\n\r\n  // Cancel previous timeout if already running to prevent multiple setTimeout()s\r\n  clearTimeout(m.transitionTimeoutId);\r\n  // Restore all CSS transitions when done updating\r\n  m.transitionTimeoutId = setTimeout(() => m.listContainer.classList.remove('notransitions'), 250);\r\n\r\n  const filterStop = performance.now();\r\n  debug.log(`filterTermsList(): ${(Math.round((filterStop - filterStart) * 100) / 100)} ms.`);\r\n}\r\n\r\n\r\n// ************************************************************************************************\r\n// Click event functions\r\n// ************************************************************************************************\r\n\r\nclass UiElements extends ElementClick\r\n{\r\n  elementClicked()\r\n  {\r\n    if (this.clicked('div.play-button'))\r\n      return playClick(this.event, utils.getPrefPlayerUrl(this.querySelector('a').href));\r\n\r\n    if (this.clicked('div.shuffle-button'))\r\n      return shuffleClick(this.event, utils.getPrefPlayerUrl(this.querySelector('a').href));\r\n\r\n    if (this.clicked('div.share-find-button'))\r\n      return shareFindClick(this.element);\r\n\r\n    if (this.clicked('div.termlist-header'))\r\n      return termlistHeaderClick(this.event);\r\n\r\n    if (this.clicked('div.thumbnail'))\r\n      return playTrackClick(this.event, this.element);\r\n\r\n    if (this.clicked('a'))\r\n      return linkClicked(this.event, this.element);\r\n  }\r\n}\r\n\r\nfunction playClick(event, destUrl, trackId = null)\r\n{\r\n  event?.preventDefault();\r\n  saveState();\r\n\r\n  // ToDo: Create a playbackSetting for this? Or use SHIFT + click to skip autoplay\r\n  sessionStorage.setItem(KEY.UF_AUTOPLAY, JSON.stringify({ autoplay: (event.shiftKey === false), trackId: trackId, position: 0 }));\r\n\r\n  utils.navToUrl(destUrl);\r\n}\r\n\r\nfunction shuffleClick(event, destUrl)\r\n{\r\n  setCookie(KEY.UF_RESHUFFLE, 'true');\r\n  playClick(event, destUrl);\r\n}\r\n\r\nfunction shareFindClick(element)\r\n{\r\n  const termName = utils.stripAttribute(element, 'data-term-name');\r\n  const urlType  = (m.listContainer.getAttribute('data-term-type') === 'channels') ? 'Channel link' : 'Artist link';\r\n\r\n  shareModal.show({\r\n    title:    `Share / Find ${utils.stripAttribute(element, 'data-term-path')}`,\r\n    bodyText: termName,\r\n    bodyHtml: `<b>${termName}</b>`,\r\n    url:      utils.getPrefPlayerUrl(element.getAttribute('data-term-url')),\r\n    urlType:  urlType,\r\n    verb:     'Find',\r\n    icon:     'search',\r\n  });\r\n}\r\n\r\nfunction playTrackClick(event, element)\r\n{\r\n  const termType       = (m.listContainer.getAttribute('data-term-type') === 'channels') ? 'channel' : 'artist';\r\n  const termSlug       = utils.stripAttribute(element, 'data-term-slug');\r\n  const trackType      = parseInt(element.getAttribute('data-track-type'));\r\n  const trackSourceUid = element.getAttribute('data-track-source-uid');\r\n\r\n  if ((settings.playback.preferredPlayer === PREF_PLAYER.GALLERY) || (trackType === TRACK_TYPE.SOUNDCLOUD))\r\n  {\r\n    playClick(event, element.getAttribute('data-term-url'), null);\r\n  }\r\n  else\r\n  {\r\n    const trackNum = parseInt(element.getAttribute('data-track-num'));\r\n    let pagination = '';\r\n\r\n    if (trackNum > response.listPerPage)\r\n      pagination = `page/${Math.ceil(trackNum / response.listPerPage)}/`;\r\n\r\n    playClick(event, `${utils.SITE_URL}/list/${termType}/${termSlug}/${pagination}`, trackSourceUid);\r\n  }\r\n}\r\n\r\nfunction linkClicked(event, element)\r\n{\r\n  saveState();\r\n\r\n  if (element.closest('div.permalink') !== null)\r\n  {\r\n    event?.preventDefault();\r\n    utils.navToUrl(utils.getPrefPlayerUrl(element.href));\r\n  }\r\n}\r\n\r\nfunction termlistHeaderClick(event)\r\n{\r\n  const termlistEntry = event.target.closest('div.termlist-entry');\r\n  const expandToggle  = termlistEntry.querySelector('div.expand-toggle span');\r\n  const termlistBody  = termlistEntry.querySelector('div.termlist-body');\r\n  const isExpanded    = (termlistEntry.getAttribute('data-is-expanded') === '1');\r\n  const isDataFetched = (termlistEntry.getAttribute('data-is-fetched') === '1');\r\n\r\n  termlistEntry.setAttribute('data-is-expanded', isExpanded ? '' : '1');\r\n\r\n  expandToggle.textContent   = isExpanded ? 'expand_more' : 'expand_less';\r\n  termlistBody.style.display = isExpanded ? ''            : 'flex';\r\n\r\n  if (!isExpanded && !isDataFetched)\r\n    termlistRest.loadTermlist(m.listContainer, termlistEntry, termlistBody);\r\n}\r\n", "//\r\n// View / change settings UI\r\n//\r\n// https://ultrafunk.com\r\n//\r\n\r\n\r\nimport * as debugLogger from '../debuglogger.js';\r\nimport { showSnackbar } from '../snackbar.js';\r\nimport { showModal }    from '../modal.js';\r\nimport { addListener }  from '../utils.js';\r\n\r\nimport {\r\n  settings as storedSettings\r\n} from '../session-data.js';\r\n\r\nimport {\r\n  KEY,\r\n  YEAR_IN_SECONDS,\r\n  setCookie,\r\n  deleteCookie,\r\n  readJson,\r\n  writeJson,\r\n  cleanupOldData,\r\n} from '../storage.js';\r\n\r\nimport {\r\n  TYPE_INTEGER,\r\n  TYPE_BOOLEAN,\r\n  TYPE_STRING,\r\n  settingsSchema,\r\n  defaultSettings,\r\n} from './settings.js';\r\n\r\n\r\n/*************************************************************************************************/\r\n\r\n\r\nconst debug = debugLogger.newInstance('settings-ui');\r\n\r\nconst m = {\r\n  settings:  null,\r\n  container: null,\r\n};\r\n\r\nconst config = {\r\n  containerId:  'settings-container',\r\n  saveResetId:  'settings-save-reset',\r\n  updatedEvent: new Event('settingsUpdated'),\r\n};\r\n\r\nconst settingsSections = [\r\n  { name: 'Playback',       id: 'playback',     schema: settingsSchema.playback     },\r\n  { name: 'List Player',    id: 'list',         schema: settingsSchema.list         },\r\n  { name: 'Gallery Player', id: 'gallery',      schema: settingsSchema.gallery      },\r\n  { name: 'Mobile',         id: 'mobile',       schema: settingsSchema.mobile       },\r\n  { name: 'Site',           id: 'site',         schema: settingsSchema.site         },\r\n//{ name: 'Experimental',   id: 'experimental', schema: settingsSchema.experimental },\r\n];\r\n\r\nconst errorTemplate = /*html*/ `<h3>An error occurred while reading Playback and Site settings</h3>\r\n  <p>This can be caused by several issues, but most likely it happened because of corrupt or malformed JSON data in the browsers Local Storage.</p>\r\n  <p>Clearing all settings stored locally in the browser will probably fix the problem, click on the button below to do that.\r\n  <b>Note:</b> All Playback and Site settings will be reset to default values.</p>\r\n  <div class=\"settings-clear\"><b>Clear All Settings</b></div>\r\n  <p>If that does not work, another possible fix is to clear all cached data stored in the browser, the following links contain more information about how to do that for\r\n  <a href=\"https://support.google.com/accounts/answer/32050\">Chrome</a> and\r\n  <a href=\"https://support.mozilla.org/en-US/kb/clear-cookies-and-site-data-firefox\">Firefox</a>.</p>`;\r\n\r\n\r\n// ************************************************************************************************\r\n// Init + settings read error handling\r\n// ************************************************************************************************\r\n\r\nexport function initSettingsUi()\r\n{\r\n  if (document.getElementById('settings-container') !== null)\r\n  {\r\n    debug.log('initSettingsUi');\r\n\r\n    m.container = document.getElementById(config.containerId);\r\n\r\n    if (m.container !== null)\r\n    {\r\n      // For quick access to the Clear All Settings page...\r\n      if (document.URL.includes('?clear=true'))\r\n      {\r\n        readSettingsError();\r\n        return;\r\n      }\r\n\r\n      readSettings(false);\r\n\r\n      if (m.settings !== null)\r\n      {\r\n        settingsSections.forEach(entry => setCurrentSettings(m.settings[entry.id], entry.schema));\r\n\r\n        insertSettingsHtml();\r\n        m.container.style.opacity = 1;\r\n        m.container.addEventListener('click',       (event) => settingClicked(event));\r\n        m.container.addEventListener('contextmenu', (event) => settingClicked(event));\r\n\r\n        addListener(`#${config.saveResetId} .settings-save`,  'click', settingsSaveClick);\r\n        addListener(`#${config.saveResetId} .settings-reset`, 'click', settingsResetClick);\r\n      }\r\n      else\r\n      {\r\n        readSettingsError();\r\n      }\r\n    }\r\n    else\r\n    {\r\n      debug.error(`Unable to getElementById() for '#${config.containerId}'`);\r\n    }\r\n  }\r\n}\r\n\r\nfunction readSettingsError()\r\n{\r\n  document.getElementById(config.saveResetId).style.display = 'none';\r\n\r\n  m.container.insertAdjacentHTML('afterbegin', errorTemplate);\r\n  m.container.style.minHeight = '100%';\r\n  m.container.style.opacity = 1;\r\n\r\n  addListener(`#${config.containerId} .settings-clear`, 'click', () =>\r\n  {\r\n    localStorage.removeItem(KEY.UF_SETTINGS);\r\n    localStorage.removeItem(KEY.UF_SITE_THEME);\r\n    localStorage.removeItem(KEY.UF_GALLERY_LAYOUT);\r\n    deleteCookie(KEY.UF_GALLERY_PER_PAGE);\r\n    deleteCookie(KEY.UF_LIST_PER_PAGE);\r\n    deleteCookie(KEY.UF_PREFERRED_PLAYER);\r\n    deleteCookie(KEY.UF_SHUFFLE_UID);\r\n\r\n    cleanupOldData(true);\r\n    readSettings(true);\r\n\r\n    if (m.settings !== null)\r\n      showSnackbar('All settings have been cleared', 5, 'Reload', () => (window.location.href = '/settings/'), () => (window.location.href = '/settings/'));\r\n    else\r\n      showSnackbar('Sorry, unable to clear all settings', 5);\r\n  });\r\n}\r\n\r\n\r\n// ************************************************************************************************\r\n// Read and write settings JSON data\r\n// ************************************************************************************************\r\n\r\nfunction readSettings(setDefault = false)\r\n{\r\n  m.settings = readJson(KEY.UF_SETTINGS, setDefault ? defaultSettings : null, setDefault);\r\n}\r\n\r\nfunction writeSettings()\r\n{\r\n  writeJson(KEY.UF_SETTINGS, m.settings);\r\n\r\n  setCookie(KEY.UF_GALLERY_PER_PAGE, m.settings.gallery.tracksPerPage,    (YEAR_IN_SECONDS * 5));\r\n  setCookie(KEY.UF_LIST_PER_PAGE,    m.settings.list.tracksPerPage,       (YEAR_IN_SECONDS * 5));\r\n  setCookie(KEY.UF_PREFERRED_PLAYER, m.settings.playback.preferredPlayer, (YEAR_IN_SECONDS * 5));\r\n\r\n  document.dispatchEvent(config.updatedEvent);\r\n}\r\n\r\n\r\n// ************************************************************************************************\r\n// Set current (read) and default settings values\r\n// ************************************************************************************************\r\n\r\nfunction setCurrentSettings(settings, schema)\r\n{\r\n  Object.entries(settings).forEach(([key, settingValue]) =>\r\n  {\r\n    if (key in schema)\r\n    {\r\n      schema[key].current = getValueStringsIndex(schema[key], settingValue);\r\n\r\n      if (schema[key].current === -1)\r\n        schema[key].current = getValueStringsIndex(schema[key], schema[key].default);\r\n    }\r\n  });\r\n}\r\n\r\nfunction setDefaultSettings(settings, schema)\r\n{\r\n  Object.keys(settings).forEach(key =>\r\n  {\r\n    if (key in schema)\r\n    {\r\n      settings[key]       = schema[key].default;\r\n      schema[key].current = getValueStringsIndex(schema[key], schema[key].default);\r\n    }\r\n  });\r\n}\r\n\r\nfunction getValueStringsIndex(schemaEntry, findValue)\r\n{\r\n  return schemaEntry.values.findIndex(value => (value === findValue));\r\n}\r\n\r\n\r\n// ************************************************************************************************\r\n// Create HTML table content for settings\r\n// ************************************************************************************************\r\n\r\nfunction insertSettingsHtml()\r\n{\r\n  let html = `\\n<h3>${settingsSections[0].name}</h3>\\n<table id=\"${settingsSections[0].id}-settings\" class=\"settings\">\\n<tbody>`;\r\n  Object.entries(settingsSections[0].schema).forEach(row => (html += addTableRow(settingsSections[0].id, row)));\r\n\r\n  settingsSections.slice(1).forEach(entry =>\r\n  {\r\n    html += `\\n</tbody>\\n</table>\\n<h3>${entry.name}</h3>\\n<table id=\"${entry.id}-settings\" class=\"settings\">\\n<tbody>`;\r\n    Object.entries(entry.schema).forEach(row => (html += addTableRow(entry.id, row)));\r\n  });\r\n\r\n  m.container.insertAdjacentHTML('afterbegin', html + '\\n</tbody>\\n</table>\\n');\r\n}\r\n\r\nfunction addTableRow(idPrefix, entry)\r\n{\r\n  const defaultValueString = entry[1].valueStrings[getValueStringsIndex(entry[1], entry[1].default)];\r\n\r\n  const html = /*html*/\r\n    `\\n<tr id=\"${idPrefix}:${entry[0]}\" class=\"settings-entry\" title=\"Default: ${defaultValueString}\">\r\n      <td class=\"changed-indicator\"></td>\r\n      <td class=\"spacer\"></td>\r\n      <td class=\"description\">${entry[1].description}</td>\r\n      <td class=\"${getTypeValueClasses(entry[1])}\">${entry[1].valueStrings[entry[1].current]}</td>\r\n    </tr>`;\r\n\r\n  return html;\r\n}\r\n\r\nfunction getTypeValueClasses(entry)\r\n{\r\n  switch (entry.type)\r\n  {\r\n    case TYPE_INTEGER: return 'value-string type-integer';\r\n    case TYPE_STRING:  return 'value-string type-string';\r\n\r\n    case TYPE_BOOLEAN:\r\n      {\r\n        const currentValue = (entry.values[entry.current] === true) ? 'true' : 'false';\r\n        return `value-string type-boolean current-value-${currentValue}`;\r\n      }\r\n  }\r\n}\r\n\r\n\r\n// ************************************************************************************************\r\n// Update row data and DOM\r\n// ************************************************************************************************\r\n\r\nfunction updateRowData(element, settingsSection, settingsKey, schemaEntry)\r\n{\r\n  schemaEntry.current = ((schemaEntry.current + 1) < schemaEntry.values.length)\r\n                          ? schemaEntry.current + 1\r\n                          : schemaEntry.current = 0;\r\n  m.settings[settingsSection][settingsKey] = schemaEntry.values[schemaEntry.current];\r\n\r\n  if (m.settings[settingsSection][settingsKey] !== storedSettings[settingsSection][settingsKey])\r\n    element.classList.add('value-changed');\r\n  else\r\n    element.classList.remove('value-changed');\r\n\r\n  updateRowDOM(element.querySelector('.value-string'), schemaEntry);\r\n}\r\n\r\nfunction updateRowDOM(element, schemaEntry)\r\n{\r\n  element.classList   = getTypeValueClasses(schemaEntry);\r\n  element.textContent = schemaEntry.valueStrings[schemaEntry.current];\r\n}\r\n\r\nfunction updateSettingsDOM(settings, schema, idPrefix)\r\n{\r\n  Object.keys(settings).forEach(key =>\r\n  {\r\n    if (key in schema)\r\n      updateRowDOM(document.getElementById(`${idPrefix}:${key}`).querySelector('.value-string'), schema[key]);\r\n  });\r\n}\r\n\r\n\r\n// ************************************************************************************************\r\n// Update data and DOM on UI-events (click)\r\n// ************************************************************************************************\r\n\r\nfunction settingClicked(event)\r\n{\r\n  const clickedSetting = event.target.closest('tr');\r\n\r\n  if (clickedSetting !== null)\r\n  {\r\n    const settingsId  = clickedSetting.id.split(':')[0];\r\n    const settingsKey = clickedSetting.id.split(':')[1];\r\n    const index       = settingsSections.findIndex(entry => (entry.id === settingsId));\r\n\r\n    if (event.type === 'contextmenu')\r\n    {\r\n      // showSettingDetailsModal() for Touch and Hold input on Chromium and Firefox browsers\r\n      if ((event.pointerType === 'touch') || (event.mozInputSource === 5))\r\n      {\r\n        event.preventDefault();\r\n        showSettingDetailsModal(settingsSections[index].name, settingsSections[index].schema[settingsKey]);\r\n      }\r\n    }\r\n    else\r\n    {\r\n      if (event.shiftKey === true)\r\n        showSettingDetailsModal(settingsSections[index].name, settingsSections[index].schema[settingsKey]);\r\n      else\r\n        updateRowData(clickedSetting, settingsSections[index].id, settingsKey, settingsSections[index].schema[settingsKey]);\r\n    }\r\n  }\r\n}\r\n\r\nfunction showSettingDetailsModal(sectionName ,schemaEntry)\r\n{\r\n  let valueStrings = '';\r\n  schemaEntry.valueStrings.forEach(entry => (valueStrings += `${entry}, `));\r\n\r\n  showModal(\r\n    `${sectionName} setting details`,\r\n    `<p><b>Description</b><br>${schemaEntry.description}</p>\r\n     <p><b>Values</b><br>${valueStrings.slice(0, (valueStrings.length - 2))}</p>\r\n     <p><b>Current Value</b><br>${schemaEntry.valueStrings[schemaEntry.current]}</p>\r\n     <p><b>Default Value</b><br>${schemaEntry.valueStrings[getValueStringsIndex(schemaEntry, schemaEntry.default)]}</p>`,\r\n  );\r\n}\r\n\r\nfunction clearValueChanged()\r\n{\r\n  document.querySelectorAll('#settings-container table').forEach(table =>\r\n  {\r\n    table.querySelectorAll('tr').forEach(row => row.classList.remove('value-changed'));\r\n  });\r\n}\r\n\r\nfunction settingsSaveClick()\r\n{\r\n  writeSettings();\r\n  clearValueChanged();\r\n  showSnackbar('All settings saved', 3);\r\n}\r\n\r\nfunction settingsResetClick()\r\n{\r\n  settingsSections.forEach(entry =>\r\n  {\r\n    setDefaultSettings(m.settings[entry.id], entry.schema);\r\n    updateSettingsDOM(m.settings[entry.id], entry.schema, entry.id);\r\n  });\r\n\r\n  clearValueChanged();\r\n  showSnackbar('All settings reset', 4, 'Undo', () => location.reload(), () => writeSettings());\r\n}\r\n", "//\r\n// Ultrafunk site nav-menu\r\n//\r\n// https://ultrafunk.com\r\n//\r\n\r\n\r\nimport * as utils             from '../shared/utils.js';\r\nimport { settings }           from '../shared/session-data.js';\r\nimport { playerType }         from '../playback/footer-toggles.js';\r\nimport { isSingleTrackFetch } from '../playback/gallery/single-track-fetch.js';\r\n\r\nimport {\r\n  noPlayback,\r\n  shuffleClickNavTo,\r\n} from '../playback/shared-gallery-list.js';\r\n\r\n\r\n// ************************************************************************************************\r\n// Main navigation menu handling closure\r\n// ************************************************************************************************\r\n\r\nconst navMenuClosure = (() =>\r\n{\r\n  const observer = new ResizeObserver(observerCallback);\r\n  let siteHeader = null, navMenuOuter = null, navMenuInner = null, modalOverlay = null;\r\n  let isVisible = false;\r\n  let siteHeaderHeight = 0;\r\n\r\n  window.addEventListener('load', () =>\r\n  {\r\n    utils.addListener('#menu-primary-sections .menu-item-reshuffle a', 'click', shuffleClickNavTo);\r\n    utils.addListener('#menu-primary-sections .menu-item-pref-player', 'click', () => playerType.toggle());\r\n    document.getElementById('menu-primary-channels')?.addEventListener('click', menuClickUsePrefPlayer);\r\n  });\r\n\r\n  return {\r\n    isVisible()   { return isVisible;                },\r\n    scrolledTop() { navMenuOuter.style.display = ''; },\r\n    init,\r\n    toggle,\r\n  };\r\n\r\n  function init()\r\n  {\r\n    siteHeader   = document.getElementById('site-header');\r\n    navMenuOuter = document.querySelector('#site-navigation .nav-menu-outer');\r\n    navMenuInner = document.querySelector('#site-navigation .nav-menu-inner');\r\n    modalOverlay = document.getElementById('nav-menu-modal-overlay');\r\n\r\n    utils.addListenerAll('div.nav-menu-toggle', 'click', toggle);\r\n    modalOverlay.addEventListener('click', toggle);\r\n    window.addEventListener('resize', () => setNavMenuInnerSize());\r\n    observer.observe(navMenuOuter);\r\n  }\r\n\r\n  function toggle()\r\n  {\r\n    siteHeaderHeight = siteHeader.offsetHeight;\r\n\r\n    if (siteHeader.classList.contains('sticky-nav-up'))\r\n    {\r\n      navMenuOuter.style.display = isVisible ? 'none' : 'flex';\r\n    }\r\n    else\r\n    {\r\n      if (siteHeader.classList.contains('sticky-nav-down') === false)\r\n        siteHeader.classList.toggle('hide-nav-menu');\r\n    }\r\n  }\r\n\r\n  function menuClickUsePrefPlayer(event)\r\n  {\r\n    const menuElement = event.target.closest('li.menu-item.menu-item-object-uf_channel');\r\n\r\n    if (menuElement !== null)\r\n    {\r\n      if (isSingleTrackFetch() || noPlayback())\r\n      {\r\n        event?.preventDefault();\r\n        utils.navToUrl(utils.getPrefPlayerUrl(menuElement.querySelector('a').href));\r\n      }\r\n    }\r\n  }\r\n\r\n  function observerCallback(entries)\r\n  {\r\n    isVisible = (entries[0].contentRect.height !== 0) ? true : false;\r\n\r\n    if (isVisible)\r\n    {\r\n      if (modalOverlay.className === '')\r\n      {\r\n        modalOverlay.style.backgroundColor = `rgba(0, 0, 0, ${Math.round(10 * (settings.site.modalOverlayOpacity / 100)) / 10})`;\r\n        modalOverlay.classList.add('show');\r\n\r\n        if (utils.matchesMedia(utils.MATCH.SITE_MAX_WIDTH_MOBILE))\r\n          setNavMenuProps('hidden', 'close', '100vh');\r\n\r\n        setNavMenuInnerSize();\r\n      }\r\n    }\r\n    else\r\n    {\r\n      modalOverlay.className     = '';\r\n      navMenuOuter.style.display = '';\r\n      setNavMenuProps();\r\n    }\r\n  }\r\n\r\n  function setNavMenuInnerSize()\r\n  {\r\n    if (isVisible && utils.matchesMedia(utils.MATCH.SITE_MAX_WIDTH_MOBILE))\r\n    {\r\n      const margins = utils.getCssPropValue('margin-top', navMenuInner) + utils.getCssPropValue('margin-bottom', navMenuInner);\r\n      navMenuInner.style = `overflow-y: auto; max-height: ${window.innerHeight - (siteHeaderHeight + margins)}px`;\r\n    }\r\n  }\r\n\r\n  function setNavMenuProps(overflowY = '', textContent = 'menu', height = '')\r\n  {\r\n    document.documentElement.style.overflowY = overflowY;\r\n    siteHeader.querySelectorAll('.nav-menu-toggle span')?.forEach(element => element.textContent = textContent);\r\n    siteHeader.style.height = height;\r\n    navMenuInner.style = '';\r\n  }\r\n});\r\n\r\nexport const navMenu = navMenuClosure();\r\n", "//\r\n// Ultrafunk site nav-search\r\n//\r\n// https://ultrafunk.com\r\n//\r\n\r\n\r\nimport * as utils from '../shared/utils.js';\r\n\r\n\r\n// ************************************************************************************************\r\n// Main navigation search handling closure\r\n// ************************************************************************************************\r\n\r\nconst navSearchClosure = (() =>\r\n{\r\n  const allowKeyboardShortcutsEvent = new Event('allowKeyboardShortcuts');\r\n  const denyKeyboardShortcutsEvent  = new Event('denyKeyboardShortcuts');\r\n  let siteHeader = null, searchContainer = null, searchField = null, brandingContainer = null;\r\n  let isVisible = false;\r\n\r\n  return {\r\n    isVisible() { return isVisible; },\r\n    init,\r\n    toggle,\r\n    hide,\r\n  };\r\n\r\n  function init()\r\n  {\r\n    siteHeader        = document.getElementById('site-header');\r\n    searchContainer   = document.getElementById('search-container');\r\n    searchField       = searchContainer.querySelector('.search-field');\r\n    brandingContainer = siteHeader.querySelector('div.site-branding-container');\r\n\r\n    utils.addListenerAll('.nav-search-toggle', 'click', toggle);\r\n    // To prevent extra 'blur' event before 'click' event\r\n    utils.addListenerAll('.nav-search-toggle', 'mousedown', (event) => event.preventDefault());\r\n    // Hide nav search bar on focus loss\r\n    searchField.addEventListener('blur', hide);\r\n\r\n    // Hide nav search bar on ESC\r\n    searchField.addEventListener('keydown', (event) =>\r\n    {\r\n      if ((event.key === 'Escape') && isVisible)\r\n      {\r\n        event.stopPropagation();\r\n        hide();\r\n      }\r\n    });\r\n  }\r\n\r\n  function toggle()\r\n  {\r\n    hasVisibleSearchContainer() ? show() : hide();\r\n  }\r\n\r\n  function hide()\r\n  {\r\n    if (isVisible)\r\n      setNavSearchProps(false, allowKeyboardShortcutsEvent, '', 'search');\r\n  }\r\n\r\n  function hasVisibleSearchContainer()\r\n  {\r\n    if (searchContainer.style.display.length === 0)\r\n    {\r\n      // Has no visible site header at all, bail out...\r\n      if (siteHeader.offsetHeight === 0)\r\n        return false;\r\n\r\n      // Is mobile with no visible navbar, bail out...\r\n      if (utils.matchesMedia(utils.MATCH.SITE_MAX_WIDTH_MOBILE))\r\n      {\r\n        if ((siteHeader.querySelector('.navbar-container-mobile-top').offsetHeight === 0) &&\r\n            (siteHeader.querySelector('.navbar-container-mobile-up').offsetHeight  === 0))\r\n        {\r\n          return false;\r\n        }\r\n      }\r\n\r\n      return true;\r\n    }\r\n\r\n    return false;\r\n  }\r\n\r\n  function show()\r\n  {\r\n    setPosSize();\r\n    setNavSearchProps(true, denyKeyboardShortcutsEvent, 'flex', 'close');\r\n    searchField.focus();\r\n    searchField.setSelectionRange(9999, 9999);\r\n  }\r\n\r\n  function setNavSearchProps(visible, keyboardShortcutsEvent, display, icon)\r\n  {\r\n    isVisible = visible;\r\n    document.dispatchEvent(keyboardShortcutsEvent);\r\n    searchContainer.style.display = display;\r\n    document.querySelectorAll('div.nav-search-toggle span').forEach(element => (element.textContent = icon));\r\n\r\n    if (isVisible)\r\n      document.getElementById('playback-controls').classList.add('hide');\r\n    else\r\n      document.getElementById('playback-controls').classList.remove('hide');\r\n  }\r\n\r\n  function setPosSize()\r\n  {\r\n    let position = {};\r\n\r\n    if (utils.matchesMedia(utils.MATCH.SITE_MAX_WIDTH_MOBILE))\r\n    {\r\n      if (brandingContainer.offsetHeight !== 0)\r\n        position.top = brandingContainer.offsetTop;\r\n      else\r\n        position.top = siteHeader.querySelector('.navbar-container-mobile-up').offsetTop;\r\n\r\n      position = new DOMRect(63, (position.top + 3), (document.body.clientWidth - 60), 30);\r\n    }\r\n    else\r\n    {\r\n      if (brandingContainer.offsetHeight !== 0)\r\n      {\r\n        const rect = brandingContainer.getBoundingClientRect();\r\n        position   = new DOMRect(rect.left, (rect.top + 7), rect.right, (rect.height - 15));\r\n      }\r\n      else\r\n      {\r\n        const rect = siteHeader.querySelector('.navbar-container').getBoundingClientRect();\r\n        position   = new DOMRect((rect.left + 88), rect.top, (rect.right - 90), (rect.height - 1));\r\n      }\r\n    }\r\n\r\n    searchContainer.style.left   = `${position.left}px`;\r\n    searchContainer.style.top    = `${position.top}px`;\r\n    searchContainer.style.width  = `${position.width - position.left}px`;\r\n    searchContainer.style.height = `${position.height}px`;\r\n  }\r\n});\r\n\r\nexport const navSearch = navSearchClosure();\r\n", "//\r\n// Ultrafunk site interaction\r\n//\r\n// https://ultrafunk.com\r\n//\r\n\r\n\r\nimport * as debugLogger   from './shared/debuglogger.js';\r\nimport * as utils         from './shared/utils.js';\r\nimport * as interaction   from './site/interaction.js';\r\nimport { initTermlist }   from './site/termlist.js';\r\nimport { initSettingsUi } from './shared/settings/settings-ui.js';\r\nimport { navMenu }        from './site/nav-menu.js';\r\nimport { navSearch }      from './site/nav-search.js';\r\n\r\nimport {\r\n  showSnackbar,\r\n  isShowingSnackbar,\r\n} from './shared/snackbar.js';\r\n\r\nimport {\r\n  noPlayback,\r\n  isGalleryPlayer,\r\n  isListPlayer,\r\n} from './playback/shared-gallery-list.js';\r\n\r\nimport {\r\n  response,\r\n  settings,\r\n  readSettings,\r\n} from './shared/session-data.js';\r\n\r\n\r\n/*************************************************************************************************/\r\n\r\n\r\nconst debug = debugLogger.newInstance('index');\r\nconst m     = { keyboardShortcuts: null };\r\n\r\nconst elements = {\r\n  siteHeader:        null,\r\n  siteContent:       null,\r\n  siteContentSearch: null,\r\n  fullscreenTarget:  null,\r\n};\r\n\r\n\r\n// ************************************************************************************************\r\n// Document ready and document / window event listeners\r\n// ************************************************************************************************\r\n\r\ndocument.addEventListener('DOMContentLoaded', () =>\r\n{\r\n  debug.log('DOMContentLoaded');\r\n\r\n  initIndex();\r\n  initTermlist();\r\n  initSettingsUi();\r\n  setSiteContentSearchFocus();\r\n  setPreviousPageTitle();\r\n\r\n  debugLogger.logStartupExecutionTime();\r\n});\r\n\r\nfunction initIndex()\r\n{\r\n  debug.log('initIndex()');\r\n\r\n  m.keyboardShortcuts = utils.keyboardShortcuts(settings.site.keyboardShortcuts);\r\n\r\n  elements.siteHeader        = document.getElementById('site-header');\r\n  elements.siteContent       = document.getElementById('site-content');\r\n  elements.siteContentSearch = document.querySelector('#site-content form input.search-field');\r\n\r\n  interaction.init();\r\n  navSearch.init();\r\n  navMenu.init();\r\n\r\n  resize.addEventListener();\r\n  scroll.addEventListener();\r\n\r\n  document.addEventListener('fullscreenElement', (event) => (elements.fullscreenTarget = event.fullscreenTarget));\r\n  document.addEventListener('keydown', documentEventKeyDown);\r\n}\r\n\r\nwindow.addEventListener('load', () =>\r\n{\r\n  if (window.localStorage && settings.internal.showSiteInfoOnLoad)\r\n  {\r\n    if (isGalleryPlayer() || isListPlayer())\r\n    {\r\n      const message = 'Ultrafunk is an interactive playlist with carefully chosen and continually updated tracks rooted in Funk and related genres. <a class=\"snackbar-message-link\" href=\"/about/\">More Details</a>';\r\n\r\n      setTimeout(() =>\r\n      {\r\n        if (isShowingSnackbar() === false)\r\n        {\r\n          showSnackbar(message, 11, null, null, () => { settings.internal.showSiteInfoOnLoad = false; }, 'rgb(122, 30, 30)');\r\n          utils.addListener('.snackbar-message-link', 'click', () => { settings.internal.showSiteInfoOnLoad = false; });\r\n        }\r\n      }, 2000);\r\n    }\r\n  }\r\n});\r\n\r\ndocument.addEventListener('settingsUpdated', () =>\r\n{\r\n  readSettings();\r\n  interaction.settingsUpdated();\r\n});\r\n\r\n\r\n// ************************************************************************************************\r\n// Keyboard events handling\r\n// ************************************************************************************************\r\n\r\nfunction documentEventKeyDown(event)\r\n{\r\n  // UI keyboard events (cannot be disable by the user)\r\n  if ((event.repeat  === false) &&\r\n      (event.ctrlKey === false) &&\r\n      (event.altKey  === false))\r\n  {\r\n    switch (event.key)\r\n    {\r\n      case 'Escape':\r\n        if (navMenu.isVisible())\r\n        {\r\n          event.preventDefault();\r\n          navMenu.toggle();\r\n        }\r\n        return;\r\n    }\r\n  }\r\n\r\n  // User enabled keyboard shortcuts (on by default)\r\n  if (m.keyboardShortcuts.allow() &&\r\n      (event.repeat  === false)   &&\r\n      (event.ctrlKey === false)   &&\r\n      (event.altKey  === false))\r\n  {\r\n    switch (event.key)\r\n    {\r\n      case 'L':\r\n        if (searchNotFocused() && notSettingsPage())\r\n        {\r\n          interaction.galleryLayout.toggle(event);\r\n          resize.trigger();\r\n        }\r\n        break;\r\n\r\n      case 'n':\r\n      case 'N':\r\n        if (searchNotFocused())\r\n        {\r\n          event.preventDefault();\r\n          navMenu.toggle();\r\n        }\r\n        break;\r\n\r\n      case 's':\r\n      case 'S':\r\n        if (searchNotFocused() && notFullscreenElement())\r\n        {\r\n          event.preventDefault();\r\n          navSearch.toggle();\r\n        }\r\n        break;\r\n\r\n      case 'T':\r\n        if (searchNotFocused() && notSettingsPage())\r\n        {\r\n          interaction.siteTheme.toggle(event);\r\n        }\r\n        break;\r\n\r\n      case 'ArrowLeft':\r\n        if (event.shiftKey && noPlayback())\r\n        {\r\n          event.preventDefault();\r\n          utils.navToUrl(response.prevPage);\r\n        }\r\n        break;\r\n\r\n      case 'ArrowRight':\r\n        if (event.shiftKey && noPlayback())\r\n        {\r\n          event.preventDefault();\r\n          utils.navToUrl(response.nextPage);\r\n        }\r\n        break;\r\n    }\r\n  }\r\n}\r\n\r\nfunction searchNotFocused()\r\n{\r\n  return ((navSearch.isVisible() === false) && (elements.siteContentSearch !== document.activeElement));\r\n}\r\n\r\nfunction notSettingsPage()\r\n{\r\n  return (document.body.classList.contains('page-settings') === false);\r\n}\r\n\r\nfunction notFullscreenElement()\r\n{\r\n  return ((elements.fullscreenTarget === null) ? true : false);\r\n}\r\n\r\n\r\n// ************************************************************************************************\r\n// Misc. support functions\r\n// ************************************************************************************************\r\n\r\nfunction setSiteContentSearchFocus()\r\n{\r\n  if (elements.siteContentSearch !== null)\r\n  {\r\n    elements.siteContentSearch.focus();\r\n    elements.siteContentSearch.setSelectionRange(9999, 9999);\r\n  }\r\n}\r\n\r\nfunction setPreviousPageTitle()\r\n{\r\n  if (document.querySelector('.navbar-title .go-back-to') !== null)\r\n  {\r\n    let pathString = '';\r\n\r\n    if (document.referrer.length === 0)\r\n    {\r\n      pathString = 'Previous Page';\r\n    }\r\n    else\r\n    {\r\n      const referrerUrlParts = new URL(decodeURIComponent(document.referrer));\r\n\r\n      if (referrerUrlParts.search.length !== 0)\r\n      {\r\n        pathString = 'Search Results';\r\n      }\r\n      else if (referrerUrlParts.pathname.length > 1)\r\n      {\r\n        const endSlash  = (referrerUrlParts.pathname.slice(-1) === '/') ? 1 : 0;\r\n        const pathParts = referrerUrlParts.pathname.slice(1, referrerUrlParts.pathname.length - endSlash).replace(/-/gi, ' ').split('/');\r\n\r\n        pathParts.forEach((part, index) =>\r\n        {\r\n          pathString += ((index + 1) < pathParts.length)\r\n                          ? part + ' / '\r\n                          : part;\r\n        });\r\n      }\r\n    }\r\n\r\n    document.querySelectorAll('#site-navigation .navbar-title').forEach(element =>\r\n    {\r\n      element.querySelector('.go-back-title').textContent = (pathString.length > 0) ? pathString : 'Ultrafunk (home)';\r\n      element.querySelector('.go-back-to').style.opacity  = 1;\r\n    });\r\n  }\r\n}\r\n\r\n\r\n// ************************************************************************************************\r\n// window.addEventListener('resize') handling\r\n// ************************************************************************************************\r\n\r\nconst resize = (() =>\r\n{\r\n  let siteHeaderYOffset = 0;\r\n\r\n  return {\r\n    getSiteHeaderYOffset() { return siteHeaderYOffset; },\r\n    addEventListener,\r\n    trigger: resizeEvent,\r\n  };\r\n\r\n  function addEventListener()\r\n  {\r\n    resizeEvent();\r\n    window.addEventListener('resize', resizeEvent);\r\n  }\r\n\r\n  function resizeEvent()\r\n  {\r\n    let headerHeight = 0;\r\n\r\n    if (noPlayback())\r\n      headerHeight = utils.getCssPropValue('--site-header-height-no-playback');\r\n    else\r\n      headerHeight = utils.getCssPropValue('--site-header-height');\r\n\r\n    siteHeaderYOffset = Math.round((headerHeight > 150) ? (headerHeight / 2) : (headerHeight / 3));\r\n  }\r\n})();\r\n\r\n\r\n// ************************************************************************************************\r\n// window.addEventListener('scroll') handling\r\n// ************************************************************************************************\r\n\r\nconst scroll = (() =>\r\n{\r\n  let previousScrollPos = 0;\r\n  let scrollDeltaUp     = 0;\r\n  let scrollDeltaDown   = 0;\r\n  let isScrolledDown    = false;\r\n  const scrollThreshold = 44; // px minimum amount of scrolling for direction change\r\n\r\n  return {\r\n    addEventListener,\r\n  };\r\n\r\n  function addEventListener()\r\n  {\r\n    scrollEvent();\r\n    window.addEventListener('scroll', scrollEvent);\r\n  }\r\n\r\n  function scrollEvent()\r\n  {\r\n    const currentScrollPos = window.pageYOffset;\r\n\r\n    if (currentScrollPos === 0)\r\n    {\r\n      scrolledTop();\r\n    }\r\n    else if (currentScrollPos > previousScrollPos)\r\n    {\r\n      scrollDeltaDown += (currentScrollPos - previousScrollPos);\r\n\r\n      if ((scrollDeltaDown > scrollThreshold) && (currentScrollPos > resize.getSiteHeaderYOffset()))\r\n      {\r\n        scrollDeltaUp = 0;\r\n        scrolledDown();\r\n      }\r\n    }\r\n    else\r\n    {\r\n      scrollDeltaUp += (previousScrollPos - currentScrollPos);\r\n\r\n      if (scrollDeltaUp > scrollThreshold)\r\n      {\r\n        scrollDeltaDown = 0;\r\n        scrolledUp();\r\n      }\r\n    }\r\n\r\n    previousScrollPos = currentScrollPos;\r\n  }\r\n\r\n  function scrolledTop()\r\n  {\r\n    elements.siteHeader.classList.remove('sticky-nav-down', 'sticky-nav-up');\r\n    elements.siteHeader.classList.add('hide-nav-menu');\r\n    navSearch.hide();\r\n    navMenu.scrolledTop();\r\n  }\r\n\r\n  function scrolledDown()\r\n  {\r\n    if (isScrolledDown === false)\r\n    {\r\n      isScrolledDown = true;\r\n      utils.replaceClass(elements.siteHeader, 'sticky-nav-up', 'sticky-nav-down');\r\n      navSearch.hide();\r\n    }\r\n  }\r\n\r\n  function scrolledUp()\r\n  {\r\n    if (isScrolledDown === true)\r\n    {\r\n      isScrolledDown = false;\r\n      utils.replaceClass(elements.siteHeader, 'sticky-nav-down', 'sticky-nav-up');\r\n    }\r\n  }\r\n})();\r\n"],
  "mappings": "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",
  "names": ["debug", "newInstance", "shareModalClosure", "filterBodyTextRegEx", "title", "bodyText", "filterBodyText", "bodyHtml", "url", "urlType", "sourceUid", "verb", "icon", "show", "args", "showModal", "getSingleChoiceList", "singleChoiceListClick", "singleChoiceList", "clickedId", "searchString", "copyTextToClipboard", "shareModal", "clipboardText", "contentDescription", "showSnackbar", "reason", "onClipboardWriteError", "copyTextToClipboardExecCommand", "element", "isCopied", "logError", "modalBody", "debug", "newInstance", "htmlClassList", "m", "siteTheme", "galleryLayout", "init", "MetaUiElements", "ListUiElements", "SiteThemeToggle", "GalleryLayoutToggle", "addListener", "linkClick", "settingsUpdated", "ElementClick", "sharePlayClick", "detailsClick", "event", "navToUrl", "getPrefPlayerUrl", "element", "trackArtist", "stripAttribute", "trackTitle", "modalId", "shareModal", "getModalTrackHtml", "trackThumbnailClick", "trackDuration", "artists", "channels", "modalEntries", "item", "showModal", "getTimeString", "clickedId", "artistTitle", "copyTextToClipboard", "getCurrentSetting", "settingsObject", "currentId", "defaultSetting", "setting", "value", "getNextSetting", "currentSetting", "index", "keys", "ElementToggle", "elementId", "settings", "newTheme", "setValue", "KEY", "getCssPropString", "getTermlistHtml", "header", "termSlug", "termData", "html", "track", "index", "thumbnailData", "getThumbnailData", "getTermLinksHtml", "item", "getPrefPlayerUrl", "getTopArtistsLinksHtml", "artistsData", "channelSlug", "artistLink", "SITE_URL", "loadTermlist", "termlistContainer", "termlistEntry", "termlistBody", "termType", "stripAttribute", "termId", "termSlug", "isAllChannels", "fetchTracks", "termData", "header", "element", "getTermlistHtml", "showSnackbar", "fetchArtistMeta", "metaType", "metadata", "getTermLinksHtml", "restResponse", "fetchRest", "getTopArtistsLinksHtml", "maxItems", "callback", "channels", "artists", "item", "fetchMeta", "termIds", "readCache", "KEY", "writeCache", "deleteCache", "hasCache", "debug", "newInstance", "m", "allowKeyboardShortcutsEvent", "denyKeyboardShortcutsEvent", "initTermlist", "UiElements", "initTermlistFilter", "restoreState", "saveState", "hasCache", "termlistState", "element", "KEY", "writeCache", "readCache", "item", "deleteCache", "event", "filterTermsList", "entry", "skipKeys", "key", "filterStart", "filterString", "foundCount", "foundEntries", "filteredOddEvenRow", "currentFilterInput", "filterStop", "ElementClick", "playClick", "getPrefPlayerUrl", "shuffleClick", "shareFindClick", "termlistHeaderClick", "playTrackClick", "linkClicked", "destUrl", "trackId", "navToUrl", "setCookie", "termName", "stripAttribute", "urlType", "shareModal", "termType", "termSlug", "trackType", "trackSourceUid", "settings", "PREF_PLAYER", "TRACK_TYPE", "trackNum", "pagination", "response", "SITE_URL", "termlistEntry", "expandToggle", "termlistBody", "isExpanded", "isDataFetched", "loadTermlist", "debug", "newInstance", "m", "config", "settingsSections", "settingsSchema", "errorTemplate", "initSettingsUi", "readSettingsError", "readSettings", "entry", "setCurrentSettings", "insertSettingsHtml", "event", "settingClicked", "addListener", "settingsSaveClick", "settingsResetClick", "KEY", "deleteCookie", "cleanupOldData", "showSnackbar", "setDefault", "readJson", "defaultSettings", "writeSettings", "writeJson", "setCookie", "YEAR_IN_SECONDS", "settings", "schema", "key", "settingValue", "getValueStringsIndex", "setDefaultSettings", "schemaEntry", "findValue", "value", "html", "row", "addTableRow", "idPrefix", "defaultValueString", "getTypeValueClasses", "updateRowData", "element", "settingsSection", "settingsKey", "updateRowDOM", "updateSettingsDOM", "clickedSetting", "settingsId", "index", "showSettingDetailsModal", "sectionName", "valueStrings", "showModal", "clearValueChanged", "table", "navMenuClosure", "observer", "observerCallback", "siteHeader", "navMenuOuter", "navMenuInner", "modalOverlay", "isVisible", "siteHeaderHeight", "addListener", "shuffleClickNavTo", "playerType", "menuClickUsePrefPlayer", "init", "toggle", "addListenerAll", "setNavMenuInnerSize", "event", "menuElement", "isSingleTrackFetch", "noPlayback", "navToUrl", "getPrefPlayerUrl", "entries", "settings", "matchesMedia", "MATCH", "setNavMenuProps", "margins", "getCssPropValue", "overflowY", "textContent", "height", "element", "navMenu", "navSearchClosure", "allowKeyboardShortcutsEvent", "denyKeyboardShortcutsEvent", "siteHeader", "searchContainer", "searchField", "brandingContainer", "isVisible", "init", "toggle", "hide", "addListenerAll", "event", "hasVisibleSearchContainer", "show", "setNavSearchProps", "matchesMedia", "MATCH", "setPosSize", "visible", "keyboardShortcutsEvent", "display", "icon", "element", "position", "rect", "navSearch", "debug", "newInstance", "m", "elements", "initIndex", "initTermlist", "initSettingsUi", "setSiteContentSearchFocus", "setPreviousPageTitle", "logStartupExecutionTime", "keyboardShortcuts", "settings", "init", "navSearch", "navMenu", "resize", "scroll", "event", "documentEventKeyDown", "isGalleryPlayer", "isListPlayer", "message", "isShowingSnackbar", "showSnackbar", "addListener", "readSettings", "settingsUpdated", "searchNotFocused", "notSettingsPage", "galleryLayout", "notFullscreenElement", "siteTheme", "noPlayback", "navToUrl", "response", "pathString", "referrerUrlParts", "endSlash", "pathParts", "part", "index", "element", "siteHeaderYOffset", "addEventListener", "resizeEvent", "headerHeight", "getCssPropValue", "previousScrollPos", "scrollDeltaUp", "scrollDeltaDown", "isScrolledDown", "scrollThreshold", "scrollEvent", "currentScrollPos", "scrolledTop", "scrolledDown", "scrolledUp", "replaceClass"]
}
