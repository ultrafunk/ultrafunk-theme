{
  "version": 3,
  "sources": ["../src/shared/debuglogger.js", "../src/shared/settings/settings.js", "../src/shared/settings/validate-settings.js", "../src/shared/storage.js", "../src/shared/session-data.js", "../src/shared/toggle-element.js", "../src/playback/footer-toggles.js", "../src/playback/playback-events.js", "../src/playback/element-wrappers.js", "../src/playback/playback-controls.js", "../src/playback/list/list-track-templates.js", "../src/playback/list/list-tracks-rest.js", "../src/playback/list/list-controls.js", "../src/shared/modal-templates.js", "../src/shared/modal.js", "../src/playback/list/up-next-modal.js", "../src/playback/shared-gallery-list.js", "../src/playback/gallery/crossfade.js", "../src/playback/mediaplayers.js", "../src/shared/utils.js", "../src/shared/snackbar.js"],
  "sourcesContent": ["//\r\n// Debug logging helper classes\r\n//\r\n// https://ultrafunk.com\r\n//\r\n\r\n\r\nconst DEBUG = false;\r\n\r\n\r\n// ************************************************************************************************\r\n// DebugLog parent and child classes\r\n// ************************************************************************************************\r\n\r\nclass DebugLog\r\n{\r\n  constructor(moduleName = 'unknown')\r\n  {\r\n    this.moduleName = padString(moduleName.toUpperCase(), 20, '.');\r\n  }\r\n  \r\n  isDebug()   { return DEBUG;                               }\r\n  warn(data)  { console.warn(`${this.moduleName}:`,  data); }\r\n  error(data) { console.error(`${this.moduleName}:`, data); }\r\n}\r\n\r\nclass DevBuild extends DebugLog\r\n{\r\n  constructor(moduleName) { super(moduleName); }\r\n\r\n  log(data)\r\n  {\r\n    console.log(`${this.moduleName}:`, data);\r\n  }\r\n\r\n  logEventLog(eventLog, eventSource, eventType)\r\n  {\r\n    const entries = [];\r\n    \r\n    for (let i = 0; i < eventLog.length; i++)\r\n    {\r\n      const data = {\r\n        eventSource: this.getObjectKeyForValue(eventSource, eventLog[i].eventSource),\r\n        eventType:   this.getObjectKeyForValue(eventType, eventLog[i].eventType),\r\n        uId:         eventLog[i].uId,\r\n        timeStamp:   eventLog[i].timeStamp,\r\n      };\r\n\r\n      entries.push(data);\r\n    }\r\n    \r\n    this.log(entries);\r\n  }\r\n\r\n  getObjectKeyForValue(object, value)\r\n  {\r\n    return Object.keys(object).find(key => (object[key] === value));\r\n  }\r\n}\r\n\r\nclass ProdBuild extends DebugLog\r\n{\r\n  constructor(moduleName) { super(moduleName); }\r\n\r\n  log()                  {}\r\n  logEventLog()          {}\r\n  getObjectKeyForValue() {}\r\n}\r\n\r\n\r\n// ************************************************************************************************\r\n// DebugLog class support functions\r\n// ************************************************************************************************\r\n\r\nexport function newInstance(moduleName)\r\n{\r\n  return ((DEBUG === true)\r\n           ? new DevBuild(moduleName)\r\n           : new ProdBuild(moduleName));\r\n}\r\n\r\nfunction padString(string, maxLength, padChar)\r\n{\r\n  return ((string.length > maxLength)\r\n           ? string.slice(0, maxLength)\r\n           : string.padEnd(maxLength, padChar));\r\n}\r\n\r\nexport function logErrorOnServer(errorCategory, errorData)\r\n{\r\n  const eventAction = errorData.mediaUrl + ' | ' + errorData.mediaTitle;\r\n  \r\n  console.warn(`logErrorOnServer(): ${errorCategory} - ${eventAction}`);\r\n  \r\n  gtag('event', eventAction, // eslint-disable-line no-undef\r\n  {\r\n    event_category: errorCategory,\r\n    event_label:    'Ultrafunk Client Error',\r\n  });\r\n}\r\n", "//\r\n// Schemas and default objects for settings data\r\n//\r\n// https://ultrafunk.com\r\n//\r\n\r\n\r\nexport {\r\n  INTEGER as TYPE_INTEGER,\r\n  BOOLEAN as TYPE_BOOLEAN,\r\n  STRING  as TYPE_STRING,\r\n};\r\n\r\n\r\n/*************************************************************************************************/\r\n\r\n\r\nconst INTEGER = 1;\r\nconst BOOLEAN = 2;\r\nconst STRING  = 3;\r\n\r\nexport const PREF_PLAYER = {\r\n  NONE:    0,\r\n  GALLERY: 1,\r\n  LIST:    2,\r\n};\r\n\r\n\r\n// ************************************************************************************************\r\n// Ultrafunk (user) settings:     Playback, List, Gallery, Mobile and Site\r\n// Ultrafunk (internal) settings: Tips and Banners\r\n// ************************************************************************************************\r\n\r\nconst galleryPerPageValues       = [...Array(22).keys()].map(i => i + 3);\r\nconst galleryPerPageValueStrings = [...Array(22).keys()].map(i => `${i + 3}`);\r\n\r\nexport const settingsSchema = {\r\n  version: { description: '', type: INTEGER, values: [1, 999999], default: 6, valueStrings: [] },\r\n  playback: {\r\n    preferredPlayer:      { description: 'Preferred Player',                type: INTEGER, values: [1, 2],               default: 2,     valueStrings: ['Gallery', 'List'] },\r\n    keyboardShortcuts:    { description: 'Keyboard Shortcuts',              type: BOOLEAN, values: [true, false],        default: true,  valueStrings: ['ON', 'OFF'] },\r\n    masterVolume:         { description: 'Master Volume',                   type: INTEGER, values: [0, 25, 50, 75, 100], default: 100,   valueStrings: ['0%', '25%', '50%', '75%', '100%'] },\r\n    masterMute:           { description: 'Master Mute',                     type: BOOLEAN, values: [true, false],        default: false, valueStrings: ['ON', 'OFF'] },\r\n    autoplay:             { description: 'Autoplay next track',             type: BOOLEAN, values: [true, false],        default: true,  valueStrings: ['ON', 'OFF'] },\r\n    autoExitFullscreen:   { description: 'Exit Fullscreen on next track',   type: BOOLEAN, values: [true, false],        default: true,  valueStrings: ['ON', 'OFF'] },\r\n    timeRemainingWarning: { description: 'Track Time Remaining Warning',    type: BOOLEAN, values: [true, false],        default: true,  valueStrings: ['ON', 'OFF'] },\r\n    timeRemainingSeconds: { description: 'Time Remaining Warning Seconds',  type: INTEGER, values: [30, 60, 90, 120],    default: 60,    valueStrings: ['30 sec', '60 sec', '90 sec', '120 sec'] },\r\n    autoExitFsOnWarning:  { description: 'Exit Fullscreen on Time Warning', type: BOOLEAN, values: [true, false],        default: true,  valueStrings: ['ON', 'OFF'] },\r\n  },\r\n  list: {\r\n    moveTrackOnPlayNext: { description: 'Move Track on Play as Next',        type: BOOLEAN, values: [true, false], default: true, valueStrings: ['ON', 'OFF'] },\r\n    showUpNextModal:     { description: 'Show Up Next modal',                type: BOOLEAN, values: [true, false], default: true, valueStrings: ['ON', 'OFF'] },\r\n    showLoadMoreTracks:  { description: 'Show \"Load More Tracks...\" prompt', type: BOOLEAN, values: [true, false], default: true, valueStrings: ['ON', 'OFF'] },\r\n  },\r\n  gallery: {\r\n    layout:                  { description: 'Track Layout',                      type: STRING,  values: ['1-column', '2-column', '3-column'],    default: '3-column', valueStrings: ['1 Column', '2 Column', '3 / 4 Column'] },\r\n    tracksPerPage:           { description: 'Tracks Per Page: Search & Shuffle', type: INTEGER, values: galleryPerPageValues,    default: 12,    valueStrings: galleryPerPageValueStrings },\r\n    autoCrossfade:           { description: 'Auto Crossfade to next track',      type: BOOLEAN, values: [true, false],           default: false, valueStrings: ['ON', 'OFF'] },\r\n    autoCrossfadeLength:     { description: 'Auto Crossfade Length',             type: INTEGER, values: [5, 10, 15, 20, 25, 30], default: 20,    valueStrings: ['5 sec', '10 sec', '15 sec', '20 sec', '25 sec', '30 sec'] },\r\n    autoCrossfadeCurve:      { description: 'Auto Crossfade Curve',              type: INTEGER, values: [1, 2],                  default: 2,     valueStrings: ['Equal Power', 'Linear'] },\r\n    autoScroll:              { description: 'Autoscroll to next track',          type: BOOLEAN, values: [true, false],           default: true,  valueStrings: ['ON', 'OFF'] },\r\n    animateNowPlayingIcon:   { description: 'Animate Now Playing Track Icon',    type: BOOLEAN, values: [true, false],           default: true,  valueStrings: ['ON', 'OFF'] },\r\n    trackCrossfadeDefPreset: { description: 'Track Crossfade Def. Preset',       type: INTEGER, values: [0, 1, 2, 3, 4, 5],      default: 1,     valueStrings: ['10 sec EqPow (1)', '20 sec EqPow (2)', '30 sec EqPow (3)', '10 sec Linear (4)', '20 sec Linear (5)', '30 sec Linear (6)'] },\r\n  },\r\n  mobile: {\r\n    keepScreenOn:       { description: 'Keep Screen On when playing', type: BOOLEAN, values: [true, false], default: false, valueStrings: ['ON', 'OFF'] },\r\n    showTrackTimes:     { description: 'Show Track Times',            type: BOOLEAN, values: [true, false], default: true,  valueStrings: ['ON', 'OFF'] },\r\n    showTrackThumbnail: { description: 'Show Track Thumbnail',        type: BOOLEAN, values: [true, false], default: true,  valueStrings: ['ON', 'OFF'] },\r\n  },\r\n  site: {\r\n    keyboardShortcuts: { description: 'Keyboard Shortcuts',                    type: BOOLEAN, values: [true, false],             default: true,   valueStrings: ['ON', 'OFF'] },\r\n    theme:             { description: 'Theme',                                 type: STRING,  values: ['light', 'dark', 'auto'], default: 'auto', valueStrings: ['Light', 'Dark', 'Auto / System'] },\r\n    smoothScrolling:   { description: 'Use Smooth Scrolling (where possible)', type: BOOLEAN, values: [true, false],             default: true,   valueStrings: ['ON', 'OFF'] },\r\n  },\r\n  tips: {\r\n    showTrackDetailsHint:          { description: '', type: BOOLEAN, values: [true, false], default: true,  valueStrings: [] },\r\n    showUpNextModalHint:           { description: '', type: BOOLEAN, values: [true, false], default: true,  valueStrings: [] },\r\n    showGalleryTrackThumbnailHint: { description: '', type: BOOLEAN, values: [true, false], default: true,  valueStrings: [] },\r\n    showListTrackThumbnailHint:    { description: '', type: BOOLEAN, values: [true, false], default: true,  valueStrings: [] },\r\n    showTrackTimerHint:            { description: '', type: BOOLEAN, values: [true, false], default: true,  valueStrings: [] },\r\n  },\r\n  banners: {\r\n    showFrontpageIntro: { description: '', type: BOOLEAN, values: [true, false], default: true, valueStrings: [] },\r\n    showPremiumIntro:   { description: '', type: BOOLEAN, values: [true, false], default: true, valueStrings: [] },\r\n    showPromoIntro:     { description: '', type: BOOLEAN, values: [true, false], default: true, valueStrings: [] },\r\n  }\r\n};\r\n\r\nexport const defaultSettings = {\r\n  version: settingsSchema.version.default,\r\n  playback: {\r\n    preferredPlayer:      settingsSchema.playback.preferredPlayer.default,\r\n    keyboardShortcuts:    settingsSchema.playback.keyboardShortcuts.default,\r\n    masterVolume:         settingsSchema.playback.masterVolume.default,\r\n    masterMute:           settingsSchema.playback.masterMute.default,\r\n    autoplay:             settingsSchema.playback.autoplay.default,\r\n    autoExitFullscreen:   settingsSchema.playback.autoExitFullscreen.default,\r\n    timeRemainingWarning: settingsSchema.playback.timeRemainingWarning.default,\r\n    timeRemainingSeconds: settingsSchema.playback.timeRemainingSeconds.default,\r\n    autoExitFsOnWarning:  settingsSchema.playback.autoExitFsOnWarning.default,\r\n  },\r\n  list: {\r\n    moveTrackOnPlayNext: settingsSchema.list.moveTrackOnPlayNext.default,\r\n    showUpNextModal:     settingsSchema.list.showUpNextModal.default,\r\n    showLoadMoreTracks:  settingsSchema.list.showLoadMoreTracks.default,\r\n  },\r\n  gallery: {\r\n    layout:                  settingsSchema.gallery.layout.default,\r\n    tracksPerPage:           settingsSchema.gallery.tracksPerPage.default,\r\n    autoCrossfade:           settingsSchema.gallery.autoCrossfade.default,\r\n    autoCrossfadeLength:     settingsSchema.gallery.autoCrossfadeLength.default,\r\n    autoCrossfadeCurve:      settingsSchema.gallery.autoCrossfadeCurve.default,\r\n    autoScroll:              settingsSchema.gallery.autoScroll.default,\r\n    animateNowPlayingIcon:   settingsSchema.gallery.animateNowPlayingIcon.default,\r\n    trackCrossfadeDefPreset: settingsSchema.gallery.trackCrossfadeDefPreset.default,\r\n  },\r\n  mobile: {\r\n    keepScreenOn:       settingsSchema.mobile.keepScreenOn.default,\r\n    showTrackTimes:     settingsSchema.mobile.showTrackTimes.default,\r\n    showTrackThumbnail: settingsSchema.mobile.showTrackThumbnail.default,\r\n  },\r\n  site: {\r\n    keyboardShortcuts: settingsSchema.site.keyboardShortcuts.default,\r\n    theme:             settingsSchema.site.theme.default,\r\n    smoothScrolling:   settingsSchema.site.smoothScrolling.default,\r\n  },\r\n  tips: {\r\n    showTrackDetailsHint:          settingsSchema.tips.showTrackDetailsHint.default,\r\n    showUpNextModalHint:           settingsSchema.tips.showUpNextModalHint.default,\r\n    showGalleryTrackThumbnailHint: settingsSchema.tips.showGalleryTrackThumbnailHint.default,\r\n    showListTrackThumbnailHint:    settingsSchema.tips.showListTrackThumbnailHint.default,\r\n    showTrackTimerHint:            settingsSchema.tips.showTrackTimerHint.default,\r\n  },\r\n  banners: {\r\n    showFrontpageIntro: settingsSchema.banners.showFrontpageIntro.default,\r\n    showPremiumIntro:   settingsSchema.banners.showPremiumIntro.default,\r\n    showPromoIntro:     settingsSchema.banners.showPromoIntro.default,\r\n  },\r\n};\r\n\r\n\r\n// ************************************************************************************************\r\n// Presets\r\n// ************************************************************************************************\r\n\r\nexport const presetsSchema = {\r\n  version: { description: '', type: INTEGER, values: [1, 999999], default: 1, valueStrings: [] },\r\n  crossfade: [\r\n    {\r\n      name:   { description: 'Preset 1',         type: STRING,  values: [5, 50],                 default: '10 sec EqPow', valueStrings: [] },\r\n      length: { description: 'Crossfade Length', type: INTEGER, values: [5, 10, 15, 20, 25, 30], default: 10,             valueStrings: ['5 sec', '10 sec', '15 sec', '20 sec', '25 sec', '30 sec'] },\r\n      curve:  { description: 'Crossfade Curve',  type: INTEGER, values: [1, 2],                  default: 1,              valueStrings: ['Equal Power', 'Linear'] },\r\n    },\r\n    {\r\n      name:   { description: 'Preset 2',         type: STRING,  values: [5, 50],                 default: '20 sec EqPow', valueStrings: [] },\r\n      length: { description: 'Crossfade Length', type: INTEGER, values: [5, 10, 15, 20, 25, 30], default: 20,             valueStrings: ['5 sec', '10 sec', '15 sec', '20 sec', '25 sec', '30 sec'] },\r\n      curve:  { description: 'Crossfade Curve',  type: INTEGER, values: [1, 2],                  default: 1,              valueStrings: ['Equal Power', 'Linear'] },\r\n    },\r\n    {\r\n      name:   { description: 'Preset 3',         type: STRING,  values: [5, 50],                 default: '30 sec EqPow', valueStrings: [] },\r\n      length: { description: 'Crossfade Length', type: INTEGER, values: [5, 10, 15, 20, 25, 30], default: 30,             valueStrings: ['5 sec', '10 sec', '15 sec', '20 sec', '25 sec', '30 sec'] },\r\n      curve:  { description: 'Crossfade Curve',  type: INTEGER, values: [1, 2],                  default: 1,              valueStrings: ['Equal Power', 'Linear'] },\r\n    },\r\n    {\r\n      name:   { description: 'Preset 4',         type: STRING,  values: [5, 50],                 default: '10 sec Linear', valueStrings: [] },\r\n      length: { description: 'Crossfade Length', type: INTEGER, values: [5, 10, 15, 20, 25, 30], default: 10,              valueStrings: ['5 sec', '10 sec', '15 sec', '20 sec', '25 sec', '30 sec'] },\r\n      curve:  { description: 'Crossfade Curve',  type: INTEGER, values: [1, 2],                  default: 2,               valueStrings: ['Equal Power', 'Linear'] },\r\n    },\r\n    {\r\n      name:   { description: 'Preset 5',         type: STRING,  values: [5, 50],                 default: '20 sec Linear', valueStrings: [] },\r\n      length: { description: 'Crossfade Length', type: INTEGER, values: [5, 10, 15, 20, 25, 30], default: 20,              valueStrings: ['5 sec', '10 sec', '15 sec', '20 sec', '25 sec', '30 sec'] },\r\n      curve:  { description: 'Crossfade Curve',  type: INTEGER, values: [1, 2],                  default: 2,               valueStrings: ['Equal Power', 'Linear'] },\r\n    },\r\n    {\r\n      name:   { description: 'Preset 6',         type: STRING,  values: [5, 50],                 default: '30 sec Linear', valueStrings: [] },\r\n      length: { description: 'Crossfade Length', type: INTEGER, values: [5, 10, 15, 20, 25, 30], default: 30,              valueStrings: ['5 sec', '10 sec', '15 sec', '20 sec', '25 sec', '30 sec'] },\r\n      curve:  { description: 'Crossfade Curve',  type: INTEGER, values: [1, 2],                  default: 2,               valueStrings: ['Equal Power', 'Linear'] },\r\n    },\r\n  ],\r\n};\r\n\r\nexport const presetList = {\r\n  version: presetsSchema.version.default,\r\n  crossfade: [\r\n    {\r\n      name:   presetsSchema.crossfade[0].name.default,\r\n      length: presetsSchema.crossfade[0].length.default,\r\n      curve:  presetsSchema.crossfade[0].curve.default,\r\n    },\r\n    {\r\n      name:   presetsSchema.crossfade[1].name.default,\r\n      length: presetsSchema.crossfade[1].length.default,\r\n      curve:  presetsSchema.crossfade[1].curve.default,\r\n    },\r\n    {\r\n      name:   presetsSchema.crossfade[2].name.default,\r\n      length: presetsSchema.crossfade[2].length.default,\r\n      curve:  presetsSchema.crossfade[2].curve.default,\r\n    },\r\n    {\r\n      name:   presetsSchema.crossfade[3].name.default,\r\n      length: presetsSchema.crossfade[3].length.default,\r\n      curve:  presetsSchema.crossfade[3].curve.default,\r\n    },\r\n    {\r\n      name:   presetsSchema.crossfade[4].name.default,\r\n      length: presetsSchema.crossfade[4].length.default,\r\n      curve:  presetsSchema.crossfade[4].curve.default,\r\n    },\r\n    {\r\n      name:   presetsSchema.crossfade[5].name.default,\r\n      length: presetsSchema.crossfade[5].length.default,\r\n      curve:  presetsSchema.crossfade[5].curve.default,\r\n    },\r\n  ],\r\n};\r\n", "//\r\n// Validation for playback and site settings\r\n//\r\n// https://ultrafunk.com\r\n//\r\n\r\n\r\nimport * as debugLogger from '../debuglogger.js';\r\n\r\nimport {\r\n  TYPE_INTEGER,\r\n  TYPE_BOOLEAN,\r\n  TYPE_STRING\r\n} from './settings.js';\r\n\r\n\r\n/*************************************************************************************************/\r\n\r\n\r\nconst debug = debugLogger.newInstance('validate-settings');\r\n\r\n\r\n// ************************************************************************************************\r\n// Validation\r\n// ************************************************************************************************\r\n\r\nexport function validateSettings(settings, schema)\r\n{\r\n  let invalidCount = 0;\r\n\r\n  validateRecursive(settings, schema);\r\n\r\n  return invalidCount;\r\n\r\n  function validateRecursive(settingsObject, schemaObject)\r\n  {\r\n    for (const key in settingsObject)\r\n    {\r\n      if (settingsObject && schemaObject && (typeof settingsObject[key] === 'object') && (typeof schemaObject[key] === 'object'))\r\n      {\r\n        validateRecursive(settingsObject[key], schemaObject[key]);\r\n      }\r\n      else\r\n      {\r\n        if (schemaObject[key] !== undefined)\r\n        {\r\n          if (isEntryInvalid(settingsObject, schemaObject[key], settingsObject[key], key))\r\n            invalidCount++;\r\n        }\r\n        else\r\n        {\r\n          throw(`'${key}' ${(typeof settingsObject[key] === 'object') ? 'object' : 'property'} is not in schema`);\r\n        }\r\n      }\r\n    }\r\n  }\r\n}\r\n\r\nfunction isEntryInvalid(settings, schemaEntry, settingValue, entryKey)\r\n{\r\n  switch (schemaEntry.type)\r\n  {\r\n    case TYPE_INTEGER:\r\n      if ((Number.isInteger(settingValue) === false) || (settingValue < schemaEntry.values[0]) || (settingValue > schemaEntry.values[schemaEntry.values.length - 1]))\r\n      {\r\n        debug.warn(`validate() - '${entryKey}' has invalid value: ${settingValue} ('${entryKey}' is type: INTEGER - min: ${schemaEntry.values[0]} - max: ${schemaEntry.values[schemaEntry.values.length - 1]}) -- setting default value: ${schemaEntry.default}`);\r\n        settings[entryKey] = schemaEntry.default;\r\n        return true;\r\n      }\r\n      break;\r\n    \r\n    case TYPE_BOOLEAN:\r\n      if ((settingValue !== true) && (settingValue !== false))\r\n      {\r\n        debug.warn(`validate() - '${entryKey}' has invalid value: ${settingValue} ('${entryKey}' is type: BOOLEAN) -- setting default value: ${schemaEntry.default}`);\r\n        settings[entryKey] = schemaEntry.default;\r\n        return true;\r\n      }\r\n      break;\r\n\r\n    case TYPE_STRING:\r\n      if (typeof settingValue !== 'string')\r\n      {\r\n        debug.warn(`validate() - '${entryKey}' has invalid value: ${settingValue} ('${entryKey}' is type: STRING) -- setting default value: ${schemaEntry.default}`);\r\n        settings[entryKey] = schemaEntry.default;\r\n        return true;\r\n      }\r\n      break;\r\n\r\n    default:\r\n      debug.warn(`validate() - '${entryKey}' has unknown type: ${schemaEntry.type}`);\r\n      return true;\r\n  }\r\n}\r\n\r\n", "//\r\n// Set and get storage values\r\n// Read, write and parse storage JSON data\r\n//\r\n// https://ultrafunk.com\r\n//\r\n\r\n\r\nimport * as debugLogger   from './debuglogger.js';\r\nimport { settingsSchema } from  './settings/settings.js';\r\n\r\nimport {\r\n  validateSettings as validateSettingsDeep\r\n} from './settings/validate-settings.js';\r\n\r\n\r\n/*************************************************************************************************/\r\n\r\n\r\nconst debug     = debugLogger.newInstance('storage');\r\nconst observers = {};\r\n\r\nexport const KEY = {\r\n//sessionStorage keys\r\n  UF_AUTOPLAY:         'uf_autoplay',\r\n  UF_TERMLIST_CACHE:   'uf_termlist_cache',\r\n  UF_TERMLIST_STATE:   'uf_termlist_state',\r\n//localStorage keys\r\n  UF_SETTINGS:         'uf_settings',\r\n  UF_PRESET_LIST:      'uf_preset_list',\r\n  UF_SITE_THEME:       'uf_site_theme',\r\n  UF_GALLERY_LAYOUT:   'uf_gallery_layout',\r\n//document.cookie keys\r\n//Merge all cookies into one cookie (UF_USER_SETTINGS) as a JSON encoded string\r\n//UF_USER_SETTINGS:    'uf_user_settings',\r\n//UF_LIST_PER_PAGE:    'uf_list_per_page',\r\n  UF_GALLERY_PER_PAGE: 'uf_gallery_per_page',\r\n  UF_PREFERRED_PLAYER: 'uf_preferred_player',\r\n  UF_SHUFFLE_UID:      'uf_shuffle_uid',\r\n//Temp document.cookie keys\r\n  UF_RESHUFFLE:        'uf_reshuffle',\r\n};\r\n\r\nconst DEPRECATED_KEYS = {\r\n//localStorage keys\r\n  UF_PLAYBACK_SETTINGS: 'UF_PLAYBACK_SETTINGS',\r\n  UF_SITE_SETTINGS:     'UF_SITE_SETTINGS',\r\n  UF_SITE_THEME:        'UF_SITE_THEME',\r\n  UF_TRACK_LAYOUT:      'UF_TRACK_LAYOUT',\r\n  UF_GALLERY_LAYOUT:    'UF_GALLERY_LAYOUT',\r\n//document.cookie keys\r\n  UF_TRACKS_PER_PAGE:  'UF_TRACKS_PER_PAGE',\r\n  UF_PREFERRED_PLAYER: 'UF_PREFERRED_PLAYER',\r\n  UF_SHUFFLE_UID:      'UF_SHUFFLE_UID',\r\n  UF_RESHUFFLE:        'UF_RESHUFFLE',\r\n  ULTRAFUNK_UID:       'ultrafunk_uid',\r\n};\r\n\r\nexport const YEAR_IN_SECONDS = (60 * 60 * 24 * 365);\r\n\r\n\r\n// ************************************************************************************************\r\n// https://developer.mozilla.org/en-US/docs/Web/API/Web_Storage_API/Using_the_Web_Storage_API\r\n// ************************************************************************************************\r\n\r\nexport function isAvailable(storageType)\r\n{\r\n  let storage;\r\n\r\n  try\r\n  {\r\n    storage = window[storageType];\r\n    const test = '__storage_test__';\r\n    storage.setItem(test, test);\r\n    storage.removeItem(test);\r\n    return true;\r\n  }\r\n  catch(exception)\r\n  {\r\n    return exception instanceof DOMException && (\r\n      // everything except Firefox\r\n      exception.code === 22 ||\r\n      // Firefox\r\n      exception.code === 1014 ||\r\n      // test name field too, because code might not be present\r\n      // everything except Firefox\r\n      exception.name === 'QuotaExceededError' ||\r\n      // Firefox\r\n      exception.name === 'NS_ERROR_DOM_QUOTA_REACHED') &&\r\n      // acknowledge QuotaExceededError only if there's something already stored\r\n      (storage && storage.length !== 0);\r\n  }\r\n}\r\n\r\n\r\n// ************************************************************************************************\r\n// Set and delete cookie key => value pairs\r\n// ************************************************************************************************\r\n\r\nexport function setCookie(keyName, keyValue = '', maxAge = YEAR_IN_SECONDS, path = '/')\r\n{\r\n  document.cookie = `${keyName}=${keyValue}; Max-Age=${maxAge}; Path=${path}; Secure; SameSite=Strict`;\r\n}\r\n\r\nexport function deleteCookie(keyName, path = '/')\r\n{\r\n  document.cookie = `${keyName}=; expires=Thu, 01 Jan 1970 00:00:00 UTC; path=${path}`;\r\n}\r\n\r\n\r\n// ************************************************************************************************\r\n// get / set local storage key => value pairs\r\n// ************************************************************************************************\r\n\r\nexport function getValue(keyName, defaultValue = null, setDefault = false)\r\n{\r\n  const keyValue = localStorage.getItem(keyName);\r\n\r\n  if (keyValue === null)\r\n  {\r\n    if (setDefault && (defaultValue !== null))\r\n      setValue(keyName, defaultValue);\r\n\r\n    return defaultValue;\r\n  }\r\n  \r\n  return keyValue;\r\n}\r\n\r\nexport function setValue(keyName, keyValue)\r\n{\r\n  try\r\n  {\r\n    localStorage.setItem(keyName, keyValue);\r\n  }\r\n  catch(exception)\r\n  {\r\n    debug.error(exception);\r\n  }\r\n}\r\n\r\n\r\n// ************************************************************************************************\r\n// Read (parse) and write (stringify) JSON data from local storage\r\n// ************************************************************************************************\r\n\r\nexport function readJson(keyName, defaultValue = null, setDefault = false)\r\n{\r\n  debug.log(`readJson(): ${keyName} - ${defaultValue} - ${setDefault}`);\r\n  \r\n  const keyValue     = localStorage.getItem(keyName);\r\n  let parsedKeyValue = null;\r\n\r\n  if (keyValue === null)\r\n  {\r\n    if (setDefault && (defaultValue !== null))\r\n      writeJson(keyName, defaultValue);\r\n\r\n    return defaultValue;\r\n  }\r\n  else\r\n  {\r\n    try\r\n    {\r\n      parsedKeyValue = JSON.parse(keyValue);\r\n    }\r\n    catch(exception)\r\n    {\r\n      debug.error(exception);\r\n\r\n      // ToDo: Return error state to specify (for the user) that default settings are used??\r\n      if (defaultValue !== null)\r\n        parsedKeyValue = defaultValue;\r\n    }\r\n  }\r\n\r\n  return parsedKeyValue;\r\n}\r\n\r\nexport function writeJson(keyName, keyData)\r\n{\r\n  debug.log(`writeJson(): ${keyName} - ${keyData}`);\r\n\r\n  try\r\n  {\r\n    localStorage.setItem(keyName, JSON.stringify(keyData));\r\n  }\r\n  catch(exception)\r\n  {\r\n    debug.error(exception);\r\n  }\r\n}\r\n\r\n\r\n// ************************************************************************************************\r\n// Recursive merge and cleanup for settings objects on new version\r\n// ************************************************************************************************\r\n\r\nfunction mergeSettings(oldSettings, newSettings, settingsKey)\r\n{\r\n  debug.log(`mergeSettings(): Merging ${settingsKey} from version ${oldSettings.version} to version ${newSettings.version}`);\r\n\r\n  const mergedSettings = { version: newSettings.version };\r\n\r\n  mergeDeep(oldSettings, newSettings, mergedSettings);\r\n  cleanDeep(mergedSettings, newSettings);\r\n\r\n  return mergedSettings;\r\n}\r\n\r\nfunction mergeDeep(oldSettings, newSettings, destination)\r\n{\r\n  for (const key in newSettings)\r\n  {\r\n    if (typeof newSettings[key] === 'object')\r\n    {\r\n      if (oldSettings && (typeof oldSettings[key] === 'object'))\r\n      {\r\n        debug.log(`mergeDeep() - Merging: ${key}`);\r\n        destination[key] = { ...newSettings[key], ...oldSettings[key] };\r\n        mergeDeep(oldSettings[key], newSettings[key], destination[key]);\r\n      }\r\n      else\r\n      {\r\n        debug.log(`mergeDeep() - Copying: ${key}`);\r\n        destination[key] = { ...newSettings[key] };\r\n        mergeDeep({}, newSettings[key], destination[key]);\r\n      }\r\n    }\r\n  }\r\n}\r\n\r\n//\r\n// Delete all orphaned Settings properties / objects that are no longer in use after merge\r\n//\r\nfunction cleanDeep(mergedSettings, newSettings)\r\n{\r\n  for (const key in mergedSettings)\r\n  {\r\n    if ((key in newSettings) === false)\r\n    {\r\n      debug.log(`cleanDeep() - Deleting: ${key} (${(typeof mergedSettings[key] === 'object') ? 'object' : 'property'})`);\r\n      delete mergedSettings[key];\r\n    }\r\n    \r\n    if (typeof mergedSettings[key] === 'object')\r\n      cleanDeep(mergedSettings[key], newSettings[key]);\r\n  }\r\n}\r\n\r\n//\r\n// Clean up (delete) any localStorage or cookie-data that is no longer in use...\r\n//\r\nfunction cleanupOldData(skipOldDataCheck = false)\r\n{\r\n  debug.log(`cleanupOldData(): ${skipOldDataCheck ? 'Skipping' : 'Performing quick'} old data cleanup check...`);\r\n\r\n  if (skipOldDataCheck || (localStorage.getItem(DEPRECATED_KEYS.UF_SITE_THEME) !== null))\r\n  {\r\n    debug.log(`cleanupOldData(): Running cleanup...`);\r\n\r\n    localStorage.removeItem(DEPRECATED_KEYS.UF_PLAYBACK_SETTINGS);\r\n    localStorage.removeItem(DEPRECATED_KEYS.UF_SITE_SETTINGS);\r\n    localStorage.removeItem(DEPRECATED_KEYS.UF_SITE_THEME);\r\n    localStorage.removeItem(DEPRECATED_KEYS.UF_TRACK_LAYOUT);\r\n    localStorage.removeItem(DEPRECATED_KEYS.UF_GALLERY_LAYOUT);\r\n    deleteCookie(DEPRECATED_KEYS.UF_TRACKS_PER_PAGE);\r\n    deleteCookie(DEPRECATED_KEYS.UF_PREFERRED_PLAYER);\r\n    deleteCookie(DEPRECATED_KEYS.UF_SHUFFLE_UID);\r\n    deleteCookie(DEPRECATED_KEYS.UF_RESHUFFLE);\r\n    deleteCookie(DEPRECATED_KEYS.ULTRAFUNK_UID);\r\n  }\r\n}\r\n\r\nfunction validateSettings(settingsKey, settingsObject, defaultSettings)\r\n{\r\n  try\r\n  {\r\n    const invalidSettingsCount = validateSettingsDeep(settingsObject, settingsSchema);\r\n\r\n    if (invalidSettingsCount > 0)\r\n      writeJson(settingsKey, settingsObject);\r\n  }\r\n  catch(exception)\r\n  {\r\n    debug.error(`validateSettings() exception: ${exception} -- using default settings`);\r\n\r\n    writeJson(settingsKey, defaultSettings);\r\n\r\n    return defaultSettings;\r\n  }\r\n\r\n  return settingsObject;\r\n}\r\n\r\n\r\n// ************************************************************************************************\r\n// Read and write settings proxy\r\n// ************************************************************************************************\r\n\r\nexport function readWriteSettingsProxy(settingsKey, defaultSettings = null, setDefault = false)\r\n{\r\n  const parsedJson = readJson(settingsKey, defaultSettings, setDefault);\r\n\r\n  if ((parsedJson !== null) && (defaultSettings !== null) && (parsedJson.version !== undefined))\r\n  {\r\n    let settingsObject = parsedJson;\r\n    \r\n    // If version is new, perform settings merge, cleanup and deletion of deprecated settings\r\n    if (parsedJson.version < defaultSettings.version)\r\n    {\r\n      debug.log(parsedJson);\r\n\r\n      settingsObject = mergeSettings(parsedJson, defaultSettings, settingsKey);\r\n      writeJson(settingsKey, settingsObject);\r\n\r\n      // Always run cleanup on version update\r\n      cleanupOldData(true);\r\n\r\n      debug.log(settingsObject);\r\n    }\r\n    else\r\n    {\r\n      // Only run cleanup if old data is detected (much quicker)\r\n      cleanupOldData(false);\r\n    }\r\n\r\n    return onSettingsChange(settingsKey, validateSettings(settingsKey, settingsObject, defaultSettings));\r\n  }\r\n\r\n  if (defaultSettings !== null)\r\n  {\r\n    debug.warn(`readWriteSettingsProxy() - Failed for: ${settingsKey} -- using default settings`);\r\n\r\n    writeJson(settingsKey, defaultSettings);\r\n\r\n    return onSettingsChange(settingsKey, defaultSettings);\r\n  }\r\n\r\n  debug.error(`readWriteSettingsProxy() - Fatal error for: ${settingsKey} -- unable to read settings!`);\r\n\r\n  return null;\r\n}\r\n\r\n\r\n// ************************************************************************************************\r\n// Proxy traps (handlers) for settings get and set\r\n// ************************************************************************************************\r\n\r\nconst onSettingsChange = (settingsKey, settingsObject) =>\r\n{ \r\n  const handler =\r\n  {\r\n    get(target, property, receiver)\r\n    {\r\n    //debug.log(`onSettingsChange(): Get property: ${property}`);\r\n      \r\n      if (property in target)\r\n      {      \r\n        const value = Reflect.get(target, property, receiver);\r\n        \r\n        if (typeof value === 'object')\r\n          return new Proxy(value, handler);\r\n\r\n        return value;\r\n      }\r\n\r\n      debug.error(`onSettingsChange(): Get unknown property: ${property}`);\r\n    },\r\n    \r\n    set(target, property, newValue, receiver)\r\n    {\r\n    //debug.log(`onSettingsChange(): Set property: ${property}`);\r\n\r\n      if (property in target)\r\n      {\r\n        const oldValue = Reflect.get(target, property, receiver);\r\n\r\n        // Only update and write data if it has changed\r\n        if (newValue !== oldValue)\r\n        {\r\n          Reflect.set(target, property, newValue);\r\n          writeJson(settingsKey, settingsObject);\r\n          callSettingsObservers(property, oldValue, newValue);\r\n        }\r\n\r\n        return true;\r\n      }\r\n\r\n      debug.error(`onSettingsChange(): Set unknown property: ${property}`);\r\n      return true;\r\n    },\r\n  };\r\n\r\n  return new Proxy(settingsObject, handler);\r\n};\r\n\r\n\r\n// ************************************************************************************************\r\n// Add and call settings observers on property changes\r\n// ************************************************************************************************\r\n\r\nexport function addSettingsObserver(property, observer)\r\n{\r\n  debug.log(`addSettingsObserver() for property: ${property}`);\r\n\r\n  if ((property in observers) === false)\r\n    observers[property] = [];\r\n\r\n  observers[property].push(observer);\r\n}\r\n\r\nfunction callSettingsObservers(property, oldValue, newValue)\r\n{\r\n  if (property in observers)\r\n  {\r\n    debug.log(`callSettingsObserver() for property: ${property} - oldValue: ${oldValue} - newValue: ${newValue}`);\r\n    observers[property].forEach(observer => observer(oldValue, newValue));\r\n  }\r\n}\r\n", "//\r\n// Get session data\r\n//\r\n// https://ultrafunk.com\r\n//\r\n\r\n\r\nimport * as debugLogger    from './debuglogger.js';\r\nimport { defaultSettings } from './settings/settings.js';\r\n\r\nimport {\r\n  KEY,\r\n  readWriteSettingsProxy,\r\n} from './storage.js';\r\n\r\n\r\n/*************************************************************************************************/\r\n\r\n\r\nconst debug = debugLogger.newInstance('session-data');\r\n\r\nexport let response = {};\r\nexport let settings = {};\r\n\r\n\r\n// ************************************************************************************************\r\n//\r\n// ************************************************************************************************\r\n\r\nexport function getSessionData()\r\n{\r\n  debug.log('UF_RESPONSE_DATA');\r\n  response = UF_RESPONSE_DATA; // eslint-disable-line no-undef\r\n  debug.log(response);\r\n\r\n  readSettings();\r\n}\r\n\r\nexport function readSettings()\r\n{\r\n  settings = readWriteSettingsProxy(KEY.UF_SETTINGS, defaultSettings, true);\r\n  debug.log(settings);\r\n}\r\n", "//\r\n// ToggleElement UI / Proxy base class\r\n//\r\n// https://ultrafunk.com\r\n//\r\n\r\n\r\nimport { getCssPropString } from \"./utils.js\";\r\n\r\n\r\n/*************************************************************************************************/\r\n\r\n\r\nexport default class ToggleElement\r\n{\r\n  constructor(elementId, updateOnConstruct = true)\r\n  {\r\n    this.element      = document.getElementById(elementId);\r\n    this.valueElement = this.element.querySelector('span.value');\r\n    this.toggleTarget = this.toggle;\r\n    this.toggle       = this.toggleProxy;\r\n    this.updateTarget = this.update;\r\n    this.update       = this.updateProxy;\r\n\r\n    this.element.addEventListener('click', (event) =>\r\n    {\r\n      event?.preventDefault();\r\n      this.toggle(event);\r\n    });\r\n    \r\n    if (updateOnConstruct)\r\n      this.update();\r\n  }\r\n\r\n  get classList()  { return this.element.classList;         }\r\n  set value(value) { this.valueElement.textContent = value; }\r\n\r\n  isEnabled()            { return (this.element.classList.contains('disabled') === false);       }\r\n  pointerEventsEnabled() { return (getCssPropString('pointer-events', this.element) !== 'none'); }\r\n\r\n  // Abstract method to be overriden in child class if needed\r\n  toggle() {}\r\n\r\n  // Proxy for overridden child class method\r\n  toggleProxy(event)\r\n  {\r\n    if (this.isEnabled() && this.pointerEventsEnabled())\r\n    {\r\n      this.toggleTarget(event);\r\n      this.updateTarget(event);\r\n    }\r\n  }\r\n\r\n  // Abstract method to be overriden in child class if needed\r\n  update() {}\r\n\r\n  // Proxy for overridden child class method\r\n  updateProxy()\r\n  {\r\n    this.updateTarget();\r\n  }\r\n}\r\n", "//\r\n// Interaction footer toggle controls\r\n//\r\n// https://ultrafunk.com\r\n//\r\n\r\n\r\nimport ToggleElement          from '../shared/toggle-element.js';\r\nimport { showSnackbar }       from '../shared/snackbar.js';\r\nimport { response, settings } from '../shared/session-data.js';\r\n\r\nimport {\r\n  replaceClass,\r\n  getPrefPlayerUrl,\r\n  navToUrl,\r\n} from '../shared/utils.js';\r\n\r\nimport {\r\n  PLAYER_TYPE,\r\n  isListPlayer,\r\n} from './shared-gallery-list.js';\r\n\r\nimport {\r\n  KEY,\r\n  YEAR_IN_SECONDS,\r\n  setCookie,\r\n} from '../shared/storage.js';\r\n\r\n\r\n/*************************************************************************************************/\r\n\r\n\r\nexport let playerType = null;\r\nexport let crossfade  = null;\r\nexport let autoplay   = null;\r\n\r\n\r\n// ************************************************************************************************\r\n//\r\n// ************************************************************************************************\r\n\r\nexport function init(getPlayerStatus)\r\n{\r\n  playerType = new PlayerTypeToggle('footer-player-type-toggle', getPlayerStatus);\r\n\r\n  // Init crossfade before autoplay because autoplay can disable crossfade in update()\r\n  crossfade = new CrossfadeToggle('footer-crossfade-toggle');\r\n  autoplay  = new AutoplayToggle('footer-autoplay-toggle');\r\n}\r\n\r\n\r\n// ************************************************************************************************\r\n// Footer player type toggle: Gallery or List\r\n// ************************************************************************************************\r\n\r\nclass PlayerTypeToggle extends ToggleElement\r\n{\r\n  constructor(elementId, getPlayerStatus)\r\n  {\r\n    super(elementId);\r\n    this.getPlayerStatus = getPlayerStatus;\r\n  }\r\n  \r\n  toggle()\r\n  {\r\n    const destData = this.getDestData();\r\n    let   destUrl  = window.location.href.replace(/\\/page\\/(?!0)\\d{1,6}/, ''); // Strip off any pagination\r\n  \r\n    // Add new destination pagination if needed\r\n    if (destData.pageNum > 1)\r\n      destUrl = `${destUrl}page/${destData.pageNum}/`;\r\n\r\n    settings.playback.preferredPlayer = isListPlayer() ? PLAYER_TYPE.GALLERY : PLAYER_TYPE.LIST;\r\n    setCookie(KEY.UF_PREFERRED_PLAYER, `${isListPlayer() ? PLAYER_TYPE.GALLERY : PLAYER_TYPE.LIST}`, (YEAR_IN_SECONDS * 5));\r\n    sessionStorage.setItem(KEY.UF_AUTOPLAY, JSON.stringify(destData.trackData));\r\n\r\n    navToUrl(getPrefPlayerUrl(destUrl));\r\n  }\r\n\r\n  update()\r\n  {\r\n    this.value = (settings.playback.preferredPlayer === PLAYER_TYPE.LIST) ? 'List' : 'Gallery';\r\n  }\r\n  \r\n  getDestData()\r\n  {\r\n    const urlParts          = window.location.href.split('/');\r\n    const pageIndex         = urlParts.findIndex(part => (part.toLowerCase() === 'page'));\r\n    const currentPage       = (pageIndex !== -1)\r\n                                ? parseInt(urlParts[pageIndex + 1])\r\n                                : 1;\r\n    const trackData         = this.getPlayerStatus();\r\n    const tracksPerPageFrom = isListPlayer() ? response.listPerPage    : response.galleryPerPage;\r\n    const tracksPerPageTo   = isListPlayer() ? response.galleryPerPage : response.listPerPage;\r\n    const trackOffset       = trackData.currentTrack + ((currentPage - 1) * tracksPerPageFrom);\r\n  \r\n    return {\r\n      pageNum: Math.ceil(trackOffset / tracksPerPageTo),\r\n      trackData: {\r\n        autoplay: trackData?.isPlaying,\r\n        trackId:  trackData?.trackId,\r\n        position: trackData?.position,\r\n      }\r\n    };\r\n  }\r\n}\r\n\r\n\r\n// ************************************************************************************************\r\n// Footer autoplay and crossfade toggles\r\n// ************************************************************************************************\r\n\r\nclass AutoplayToggle extends ToggleElement\r\n{\r\n  constructor(elementId) { super(elementId); }\r\n\r\n  toggle()\r\n  {\r\n    settings.playback.autoplay = (settings.playback.autoplay === true) ? false : true;\r\n    showSnackbar(settings.playback.autoplay ? 'Autoplay enabled (<b>Shift</b> + <b>A</b> to disable)' : 'Autoplay disabled (<b>Shift</b> + <b>A</b> to enable)', 5);\r\n  }\r\n\r\n  update()\r\n  {\r\n    this.value = settings.playback.autoplay ? 'ON' : 'OFF';\r\n    settings.playback.autoplay ? replaceClass(document.body, 'autoplay-off', 'autoplay-on') : replaceClass(document.body, 'autoplay-on', 'autoplay-off');\r\n    settings.playback.autoplay ? crossfade?.classList.remove('disabled')                    : crossfade?.classList.add('disabled');\r\n  }\r\n}\r\n\r\nclass CrossfadeToggle extends ToggleElement\r\n{\r\n  constructor(elementId) { super(elementId); }\r\n\r\n  toggle()\r\n  {\r\n    settings.gallery.autoCrossfade = (settings.gallery.autoCrossfade === true) ? false : true;\r\n    showSnackbar(settings.gallery.autoCrossfade ? 'Auto Crossfade enabled (<b>x</b> to disable)' : 'Auto Crossfade disabled (<b>x</b> to enable)', 5);\r\n  }\r\n\r\n  update()\r\n  {\r\n    this.value = settings.gallery.autoCrossfade ? 'ON' : 'OFF';\r\n  }\r\n}\r\n", "//\r\n// Playback events module\r\n//\r\n// https://ultrafunk.com\r\n//\r\n\r\n\r\nimport * as debugLogger          from '../shared/debuglogger.js';\r\nimport { updateProgressPercent } from './playback-controls.js';\r\n\r\n\r\n/*************************************************************************************************/\r\n\r\n\r\nconst debug = debugLogger.newInstance('playback-events');\r\n\r\nexport const EVENT = {\r\n  LOADING:              'loading',\r\n  READY:                'ready',\r\n  MEDIA_LOADING:        'mediaLoading',\r\n  MEDIA_PLAYING:        'mediaPlaying',\r\n  MEDIA_PAUSED:         'mediaPaused',\r\n  MEDIA_ENDED:          'mediaEnded',\r\n  MEDIA_TIME_REMAINING: 'mediaTimeRemaining',\r\n  MEDIA_SHOW:           'mediaShow',\r\n  MEDIA_UNAVAILABLE:    'mediaUnavailable',\r\n  CONTINUE_AUTOPLAY:    'continueAutoplay',\r\n  RESUME_AUTOPLAY:      'resumeAutoplay',\r\n  AUTOPLAY_BLOCKED:     'autoplayBlocked',\r\n  PLAYBACK_BLOCKED:     'playbackBlocked',\r\n};\r\n\r\nconst eventListeners = {\r\n  [EVENT.LOADING]:              [ loading ],\r\n  [EVENT.READY]:                [ ready ],\r\n  [EVENT.MEDIA_LOADING]:        [],\r\n  [EVENT.MEDIA_PLAYING]:        [],\r\n  [EVENT.MEDIA_PAUSED]:         [],\r\n  [EVENT.MEDIA_ENDED]:          [],\r\n  [EVENT.MEDIA_TIME_REMAINING]: [],\r\n  [EVENT.MEDIA_SHOW]:           [],\r\n  [EVENT.CONTINUE_AUTOPLAY]:    [],\r\n  [EVENT.RESUME_AUTOPLAY]:      [],\r\n  [EVENT.AUTOPLAY_BLOCKED]:     [],\r\n  [EVENT.PLAYBACK_BLOCKED]:     [],\r\n  [EVENT.MEDIA_UNAVAILABLE]:    [],\r\n};\r\n\r\n\r\n// ************************************************************************************************\r\n// \r\n// ************************************************************************************************\r\n\r\nexport function addListener(playbackEvent, playbackEventListener)\r\n{\r\n  if (playbackEvent in eventListeners)\r\n    eventListeners[playbackEvent].push(playbackEventListener);\r\n}\r\n\r\nexport function dispatch(playbackEvent, playbackEventData = null, playbackEventCallback = null)\r\n{\r\n  eventListeners[playbackEvent].forEach(eventListener =>\r\n  {\r\n    eventListener({\r\n      event:    playbackEvent,\r\n      data:     playbackEventData,\r\n      callback: playbackEventCallback,\r\n    });\r\n  });\r\n}\r\n\r\n\r\n// ************************************************************************************************\r\n// Default event listeners\r\n// ************************************************************************************************\r\n\r\nfunction loading(playbackEvent)\r\n{\r\n//debug.log(playbackEvent);\r\n  updateProgressPercent(playbackEvent.data.loadingPercent);\r\n}\r\n\r\nfunction ready(playbackEvent)\r\n{\r\n  debug.log(playbackEvent);\r\n\r\n  if (playbackEvent?.data.resetProgressBar)\r\n    updateProgressPercent(0);\r\n}\r\n", "//\r\n// HTMLElement convenience wrapper objects\r\n//\r\n// https://ultrafunk.com\r\n//\r\n\r\n\r\nexport const STATE = {\r\n  UNKNOWN:  { ID:  0, CLASS: 'state-unknown'  },\r\n  DISABLED: { ID: 10, CLASS: 'state-disabled' },\r\n  ENABLED:  { ID: 20, CLASS: 'state-enabled'  },\r\n  HIDDEN:   { ID: 30, CLASS: 'state-hidden'   },\r\n  PLAYING:  { ID: 40, CLASS: 'state-playing'  },\r\n  PAUSED:   { ID: 50, CLASS: 'state-paused'   },\r\n  LOADING:  { ID: 60, CLASS: 'state-loading'  },\r\n};\r\n\r\n\r\n// ************************************************************************************************\r\n//\r\n// ************************************************************************************************\r\n\r\nexport const ElementWrapper = function(elmentSelector, parentElement = document, initialState = STATE.DISABLED)\r\n{\r\n  const element   = parentElement.querySelector(elmentSelector);\r\n  let   state     = initialState;\r\n  const classList = element.classList;\r\n\r\n  return {\r\n    get state() { return state;         },\r\n    get style() { return element.style; },\r\n\r\n    set elementTitle(title) { element.title = title; },\r\n\r\n    getElement(selector)         { return element.querySelector(selector);    },\r\n    addListener(event, listener) { element.addEventListener(event, listener); },\r\n\r\n    addClass(...cssClass)    { classList.add(...cssClass);    },\r\n    removeClass(...cssClass) { classList.remove(...cssClass); },\r\n    toggleClass(cssClass)    { classList.toggle(cssClass);    },\r\n\r\n    getAttribute(attribute)        { return element.getAttribute(attribute); },\r\n    setAttribute(attribute, value) { element.setAttribute(attribute, value); },\r\n\r\n    setState,\r\n  };\r\n\r\n  function setState(newState = STATE.DISABLED)\r\n  {\r\n    // Only update classList and state if they have actually changed...\r\n    if (state.ID !== newState.ID)\r\n    {\r\n      classList.remove(state.CLASS);\r\n      classList.add(newState.CLASS);\r\n      state = newState;\r\n\r\n      return true;\r\n    }\r\n\r\n    return false;\r\n  }\r\n};\r\n\r\nexport const ElementsWrapper = function(elmentsSelector, parentElement = document)\r\n{\r\n  const elements = parentElement.querySelectorAll(elmentsSelector);\r\n\r\n  return {\r\n    get length()     { return elements.length;    },\r\n    forEach(...args) { elements.forEach(...args); },\r\n  };\r\n};\r\n", "//\r\n// Playback UI controls\r\n//\r\n// https://ultrafunk.com\r\n//\r\n\r\n\r\nimport * as debugLogger        from '../shared/debuglogger.js';\r\nimport { settings }            from '../shared/session-data.js';\r\nimport { EVENT, addListener }  from './playback-events.js';\r\nimport { addSettingsObserver } from '../shared/storage.js';\r\n\r\nimport {\r\n  playerType as playerTypeToggle\r\n} from './footer-toggles.js';\r\n\r\nimport {\r\n  STATE,\r\n  ElementWrapper\r\n} from './element-wrappers.js';\r\n\r\n\r\n/*************************************************************************************************/\r\n\r\n\r\nconst debug = debugLogger.newInstance('playback-controls');\r\nconst m     = { players: {} };\r\nconst ctrl  = {};\r\n\r\n\r\n// ************************************************************************************************\r\n// Init and make ready all controls\r\n// ************************************************************************************************\r\n\r\nexport function init(mediaPlayers, seekClickCallback)\r\n{\r\n  debug.log('init()');\r\n\r\n  m.players = mediaPlayers;\r\n\r\n  const playbackProgress = document.getElementById('progress-controls');\r\n\r\n  if (playbackProgress !== null)\r\n  {\r\n    ctrl.progressSeek = new ElementWrapper('.progress-seek-control', playbackProgress);\r\n    ctrl.progressSeek.clickCallback = seekClickCallback;\r\n    ctrl.progressBar  = new ElementWrapper('.progress-bar-control', playbackProgress);\r\n  }\r\n  else\r\n  {\r\n    debug.error('init(): Unable to getElementById() for #progress-controls');\r\n  }\r\n\r\n  const playbackControls = document.getElementById('playback-controls');\r\n\r\n  if (playbackControls !== null)\r\n  {\r\n    ctrl.details        = new ElementWrapper('.playback-details-control', playbackControls);\r\n    ctrl.details.artist = ctrl.details.getElement('.playback-details-artist');\r\n    ctrl.details.title  = ctrl.details.getElement('.playback-details-title');\r\n    \r\n    ctrl.thumbnail     = new ElementWrapper('.playback-thumbnail-control', playbackControls);\r\n    ctrl.thumbnail.img = ctrl.thumbnail.getElement('img');\r\n    \r\n    ctrl.timer                 = new ElementWrapper('.playback-timer-control', playbackControls);\r\n    ctrl.timer.position        = ctrl.timer.getElement('.playback-timer-position');\r\n    ctrl.timer.duration        = ctrl.timer.getElement('.playback-timer-duration');\r\n    ctrl.timer.positionSeconds = -1;\r\n    ctrl.timer.durationSeconds = -1;\r\n    \r\n    ctrl.playerType = new ElementWrapper('.playback-player-type-control', playbackControls);\r\n    ctrl.prevTrack  = new ElementWrapper('.playback-prev-control', playbackControls);\r\n    \r\n    ctrl.playPause      = new ElementWrapper('.playback-play-pause-control', playbackControls);\r\n    ctrl.playPause.icon = ctrl.playPause.getElement('span.material-icons');\r\n    \r\n    ctrl.nextTrack = new ElementWrapper('.playback-next-control', playbackControls);\r\n    \r\n    ctrl.repeat      = new ElementWrapper('.playback-repeat-control', playbackControls);\r\n    ctrl.repeat.icon = ctrl.repeat.getElement('span.material-icons');\r\n    \r\n    ctrl.shuffle = new ElementWrapper('.playback-shuffle-control', playbackControls);\r\n    \r\n    ctrl.mute      = new ElementWrapper('.playback-mute-control', playbackControls);\r\n    ctrl.mute.icon = ctrl.mute.getElement('span.material-icons');\r\n  }\r\n  else\r\n  {\r\n    debug.error('init(): Unable to getElementById() for #playback-controls');\r\n  }\r\n}\r\n\r\nexport function ready(prevClickCallback, playPauseClickCallback, nextClickCallback, muteClickCallback)\r\n{\r\n  debug.log('ready()');\r\n\r\n  ctrl.progressSeek.setState(STATE.ENABLED);\r\n  ctrl.progressSeek.addListener('click', progressSeekClick);\r\n  ctrl.progressBar.setState(STATE.ENABLED);\r\n  \r\n  ctrl.details.setState(STATE.HIDDEN);\r\n  ctrl.thumbnail.setState(STATE.HIDDEN);\r\n  ctrl.timer.setState(STATE.HIDDEN);\r\n\r\n  if (settings.mobile.showTrackThumbnail)\r\n    ctrl.thumbnail.addClass('show-on-mobile');\r\n\r\n  if (settings.mobile.showTrackTimes)\r\n    ctrl.timer.addClass('show-on-mobile');\r\n\r\n  ctrl.playerType.setState(STATE.ENABLED);\r\n  ctrl.playerType.addListener('click', () => playerTypeToggle.toggle());\r\n\r\n  ctrl.prevTrack.setState((m.players.getCurrentTrack() > 1) ? STATE.ENABLED : STATE.DISABLED);\r\n  ctrl.prevTrack.addListener('click', prevClickCallback);\r\n\r\n  ctrl.playPause.setState(STATE.PAUSED);\r\n  ctrl.playPause.addListener('click', playPauseClickCallback);\r\n\r\n  ctrl.nextTrack.setState((m.players.getNumTracks() > 1) ? STATE.ENABLED : STATE.DISABLED);\r\n  ctrl.nextTrack.addListener('click', () => nextClickCallback());\r\n\r\n  ctrl.repeat.setState(STATE.ENABLED);\r\n  ctrl.repeat.addListener('click', toggleRepeat);\r\n\r\n  ctrl.shuffle.setState(STATE.ENABLED);\r\n\r\n  ctrl.mute.setState(STATE.ENABLED);\r\n  ctrl.mute.addListener('click', () => muteClickCallback());\r\n  updateMuteState();\r\n\r\n  addSettingsObserver('autoplay',   updateAutoplayState);\r\n  addSettingsObserver('masterMute', updateMuteState);\r\n\r\n  addListener(EVENT.MEDIA_LOADING,     setLoadState);\r\n  addListener(EVENT.MEDIA_PLAYING,     setPlayState);\r\n  addListener(EVENT.MEDIA_PAUSED ,     setPauseState);\r\n  addListener(EVENT.AUTOPLAY_BLOCKED,  setPauseState);\r\n  addListener(EVENT.PLAYBACK_BLOCKED,  setPauseState);\r\n  addListener(EVENT.MEDIA_UNAVAILABLE, setPauseState);\r\n}\r\n\r\n\r\n// ************************************************************************************************\r\n// Progress bar and position seek\r\n// ************************************************************************************************\r\n\r\nexport function updateProgressPercent(progressPercent)\r\n{\r\n  updateProgressBar(progressPercent / 100);\r\n}\r\n\r\nfunction updateProgressBar(scaleX)\r\n{\r\n  ctrl.progressBar.style.transform = `scaleX(${scaleX})`;\r\n}\r\n\r\nexport function updateTimerAndProgress(positionMilliseconds, positionSeconds, durationSeconds)\r\n{\r\n  setTimer(positionSeconds, durationSeconds);\r\n\r\n  // Prevent division by zero\r\n  if (durationSeconds === 0)\r\n    updateProgressBar(0);\r\n  else\r\n    updateProgressBar(positionMilliseconds / (durationSeconds * 1000));\r\n}\r\n\r\nexport function progressSeekClick(event)\r\n{\r\n  if (ctrl.timer.durationSeconds > 0)\r\n  {\r\n    const progressPercent = ((event.clientX / document.documentElement.clientWidth) * 100);\r\n    const seekPosSeconds  = Math.round((ctrl.timer.durationSeconds * progressPercent) / 100);\r\n    ctrl.progressSeek.clickCallback(seekPosSeconds);\r\n\r\n    if (isPlaying() === false)\r\n    {\r\n      updateProgressPercent(progressPercent);\r\n      setTimer(seekPosSeconds, ctrl.timer.durationSeconds);\r\n    }\r\n  }\r\n}\r\n\r\n\r\n// ************************************************************************************************\r\n// Details (Artist + Title) and track timer\r\n// ************************************************************************************************\r\n\r\nfunction setDetails(trackData)\r\n{\r\n  if (ctrl.details.state.ID === STATE.HIDDEN.ID)\r\n  {\r\n    ctrl.details.setState(STATE.ENABLED);\r\n    ctrl.thumbnail.setState(STATE.ENABLED);\r\n    ctrl.timer.setState(STATE.ENABLED);\r\n  }\r\n\r\n  ctrl.details.artist.textContent = trackData.artist || ''; // Artist will contain the post title if all else fails\r\n  ctrl.details.title.textContent  = trackData.title  || '';\r\n  setThumbnail(trackData.thumbnail);\r\n  setTimer(-1, -1);\r\n}\r\n\r\nfunction setThumbnail(thumbnail)\r\n{\r\n  // Don't set thumbnail again if the image source / URL is unchanged\r\n  if (thumbnail.src !== ctrl.thumbnail.img.src)\r\n  {\r\n    ctrl.thumbnail.removeClass('type-default', 'type-youtube', 'type-soundcloud');\r\n    ctrl.thumbnail.addClass('loading', thumbnail.class);\r\n    ctrl.thumbnail.img.src = thumbnail.src;\r\n    ctrl.thumbnail.img.decode().then(() => ctrl.thumbnail.removeClass('loading'));\r\n  }\r\n}\r\n\r\nfunction setTimer(positionSeconds, durationSeconds)\r\n{\r\n  if ((positionSeconds !== -1) && (ctrl.timer.positionSeconds !== positionSeconds))\r\n  {\r\n    ctrl.timer.positionSeconds = positionSeconds;\r\n\r\n    if (settings.playback.autoplay === false)\r\n      positionSeconds = (durationSeconds - positionSeconds);\r\n    \r\n    setTimerText(ctrl.timer.position, positionSeconds);\r\n  }\r\n  else if ((positionSeconds === -1) && (ctrl.timer.positionSeconds === -1))\r\n  {\r\n    ctrl.timer.position.textContent = '00:00';\r\n  }\r\n\r\n  if ((durationSeconds !== -1) && (ctrl.timer.durationSeconds !== durationSeconds))\r\n  {\r\n    ctrl.timer.durationSeconds = durationSeconds;\r\n    setTimerText(ctrl.timer.duration, durationSeconds);\r\n  }\r\n  else if ((durationSeconds === -1) && (ctrl.timer.durationSeconds === -1))\r\n  {\r\n    ctrl.timer.duration.textContent = '00:00';\r\n  }\r\n}\r\n\r\nfunction setTimerText(element, seconds)\r\n{\r\n  const timeString = new Date(seconds * 1000).toISOString();\r\n  element.textContent = (seconds > (60 * 60))\r\n                          ? timeString.slice(11, 19)\r\n                          : timeString.slice(14, 19);\r\n}\r\n\r\nfunction clearTimer()\r\n{\r\n  ctrl.timer.position.textContent = '00:00';\r\n  ctrl.timer.duration.textContent = '00:00';\r\n  ctrl.timer.positionSeconds = 0;\r\n  ctrl.timer.durationSeconds = 0;\r\n}\r\n\r\n\r\n// ************************************************************************************************\r\n// Playback controls (prev, play/pause and next)\r\n// ************************************************************************************************\r\n\r\nexport function isPlaying()\r\n{\r\n  // ToDo: This might not be the best place to save / check playback state...?\r\n  return ((ctrl.playPause.state.ID === STATE.PLAYING.ID) ? true : false);    \r\n}\r\n\r\nfunction setLoadState()\r\n{\r\n  if (ctrl.thumbnail.state.ID === STATE.ENABLED.ID)\r\n    ctrl.thumbnail.addClass(STATE.LOADING.CLASS);\r\n}\r\n\r\nexport function setPlayState()\r\n{\r\n  ctrl.thumbnail.removeClass(STATE.LOADING.CLASS);\r\n  ctrl.playPause.setState(STATE.PLAYING);\r\n  ctrl.playPause.icon.textContent = 'pause_circle_filled';\r\n  ctrl.prevTrack.setState(STATE.ENABLED);\r\n  \r\n  setDetails(m.players.getTrackData());\r\n}\r\n\r\nexport function setPauseState()\r\n{\r\n  ctrl.thumbnail.removeClass(STATE.LOADING.CLASS);\r\n  ctrl.playPause.setState(STATE.PAUSED);\r\n  ctrl.playPause.icon.textContent = 'play_circle_filled';\r\n}\r\n\r\nexport function blinkPlayPause(toggleBlink)\r\n{\r\n  if (toggleBlink)\r\n    ctrl.playPause.toggleClass('time-remaining-warning');\r\n  else\r\n    ctrl.playPause.removeClass('time-remaining-warning');\r\n}\r\n\r\nexport function getSetTrackData()\r\n{\r\n  const trackData = m.players.getTrackData();\r\n\r\n  clearTimer();\r\n  setDetails(trackData);\r\n\r\n  return trackData;\r\n}\r\n\r\nexport function updatePrevState()\r\n{\r\n  const trackData = getSetTrackData();\r\n  \r\n  if ((isPlaying() === false) && (trackData.currentTrack <= 1))\r\n    ctrl.prevTrack.setState(STATE.DISABLED);\r\n  \r\n  if (trackData.currentTrack < trackData.numTracks)\r\n    ctrl.nextTrack.setState(STATE.ENABLED);\r\n}\r\n\r\nexport function updateNextState()\r\n{\r\n  const trackData = getSetTrackData();\r\n\r\n  ctrl.prevTrack.setState(STATE.ENABLED);\r\n  \r\n  if (trackData.currentTrack >= trackData.numTracks)\r\n    ctrl.nextTrack.setState(STATE.DISABLED);\r\n}\r\n\r\n\r\n// ************************************************************************************************\r\n// Repeat control\r\n// ************************************************************************************************\r\n\r\nexport const REPEAT = { OFF: 0, ALL: 1, ONE: 2 };\r\n\r\nconst repeatModes = [\r\n  { title: 'Repeat Off', icon: 'repeat'     },\r\n  { title: 'Repeat All', icon: 'repeat'     },\r\n  { title: 'Repeat One', icon: 'repeat_one' },\r\n];\r\n\r\nexport function getRepeatMode()\r\n{\r\n  return parseInt(ctrl.repeat.getAttribute('data-repeat-mode'));\r\n}\r\n\r\nexport function toggleRepeat()\r\n{\r\n  const index = ((getRepeatMode() + 1) < repeatModes.length)\r\n                  ? (getRepeatMode() + 1)\r\n                  : 0;\r\n\r\n  ctrl.repeat.setAttribute('data-repeat-mode', index);\r\n  ctrl.repeat.elementTitle     = `${repeatModes[index].title} (r)`;\r\n  ctrl.repeat.icon.textContent = repeatModes[index].icon;\r\n\r\n  return repeatModes[index];\r\n}\r\n\r\n\r\n// ************************************************************************************************\r\n// Set Mute control and Autoplay states\r\n// ************************************************************************************************\r\n\r\nfunction updateMuteState()\r\n{\r\n  ctrl.mute.icon.textContent = settings.playback.masterMute ? 'volume_off' : 'volume_up';\r\n}\r\n\r\nfunction updateAutoplayState()\r\n{\r\n  if ((isPlaying() === false) && (ctrl.timer.positionSeconds !== -1) && ((ctrl.timer.durationSeconds !== -1)))\r\n  {\r\n    setTimerText(ctrl.timer.position, settings.playback.autoplay\r\n                                        ? ctrl.timer.positionSeconds\r\n                                        : (ctrl.timer.durationSeconds - ctrl.timer.positionSeconds));\r\n\r\n    setTimerText(ctrl.timer.duration, ctrl.timer.durationSeconds);\r\n  }\r\n}\r\n", "//\r\n// List player track template functions\r\n//\r\n// https://ultrafunk.com\r\n//\r\n\r\n\r\nimport * as debugLogger from '../../shared/debuglogger.js';\r\nimport { TRACK_TYPE }   from '../shared-gallery-list.js';\r\n\r\nimport {\r\n  getListPlayerUrl,\r\n  getThumbnailData,\r\n} from '../../shared/utils.js';\r\n\r\n\r\n/*************************************************************************************************/\r\n\r\n\r\nconst debug = debugLogger.newInstance('list-track-templates');\r\n\r\n\r\n// ************************************************************************************************\r\n// \r\n// ************************************************************************************************\r\n\r\nexport function getPageSeparatorHtml(responseData, loadingPage)\r\n{\r\n  const pageUrl = responseData.nextPage.replace(/\\/page\\/(?!0)\\d{1,6}\\/$/i, `/page/${loadingPage}/`);\r\n  \r\n  return `\r\n    <div id=\"tracklist-page-${loadingPage}\" class=\"tracklist-page-separator\" data-page-number=\"${loadingPage}\">\r\n      <span class=\"material-icons arrow-down-button\" title=\"Scroll to next page\">arrow_downward</span>\r\n      <a href=\"${pageUrl}\" title=\"Go to page ${loadingPage}\">Page ${loadingPage} &#9660;</a>\r\n      <span class=\"material-icons arrow-up-button\" title=\"Scroll to previous page\">arrow_upward</span>\r\n    </div>`;\r\n}\r\n\r\nexport function getTrackEntryHtml(track)\r\n{\r\n  const isYouTubeTrack = (track.meta.track_source_type === TRACK_TYPE.YOUTUBE);\r\n  const thumbnailData  = getThumbnailData(track.meta);\r\n\r\n  const youTubeTrackThumbnailUrl = debug.isDebug()\r\n                                     ? \"/wp-content/themes/ultrafunk/inc/img/yt_thumbnail_placeholder.png\"\r\n                                     : thumbnailData.src;\r\n\r\n  const trackThumbnailUrl = isYouTubeTrack\r\n                              ? youTubeTrackThumbnailUrl\r\n                              : '/wp-content/themes/ultrafunk/inc/img/sc_thumbnail_placeholder.png';\r\n\r\n  const trackArtistTitle = isYouTubeTrack\r\n                             ? `<span><b>${track.meta.track_artist}</b></span><br><span>${track.meta.track_title}</span>`\r\n                             : `<a href=\"${track.link}\"><span><b>${track.meta.track_artist}</b></span><br><span>${track.meta.track_title}</span></a>`;\r\n  \r\n  const trackPlayNext = isYouTubeTrack\r\n                          ? `<div class=\"play-next-button\" title=\"Play Next\"><span class=\"material-icons\">playlist_play</span></div>`\r\n                          : '';\r\n\r\n  return `\r\n    <div id=\"${track.uid}\" class=\"track-entry ${thumbnailData.class}\"\r\n      data-track-id=\"track-${track.id}\"\r\n      data-track-artist=\"${track.meta.track_artist}\"\r\n      data-track-title=\"${track.meta.track_title}\"\r\n      data-track-url=\"${track.link}\"\r\n      data-track-type=\"${track.meta.track_source_type}\"\r\n      data-track-thumbnail-url=\"${trackThumbnailUrl}\"\r\n      data-track-source-uid =\"${thumbnailData.uid}\"\r\n      >\r\n      <div class=\"track-artists-links\" data-track-artist-ids=\"${track.artists.toString()}\"></div>\r\n      <div class=\"track-channels-links\" data-track-channel-ids=\"${track.channels.toString()}\"></div>\r\n      <div class=\"track-details\">\r\n        <div class=\"thumbnail\" ${isYouTubeTrack ? 'title=\"Play Track\"' : 'title=\"SoundCloud Track\"'}>\r\n          <div class=\"thumbnail-overlay\"><div class=\"spinner\"></div></div>\r\n          <img src=\"${trackThumbnailUrl}\" alt=\"\">\r\n        </div>\r\n        <div class=\"artist-title text-nowrap-ellipsis\" ${(isYouTubeTrack === false) ? 'title=\"Link: Play SoundCloud track\"' : ''}>\r\n          ${trackArtistTitle}\r\n        </div>\r\n      </div>\r\n      <div class=\"track-actions\">\r\n        <div class=\"track-message\"></div>\r\n        <div class=\"track-action-buttons\">\r\n          ${trackPlayNext}\r\n          <div class=\"remove-button\" title=\"Remove Track from List\"><span class=\"material-icons\">clear</span></div>\r\n          <div class=\"share-play-button\" title=\"Share Track / Play On\"><span class=\"material-icons\">share</span></div>\r\n          <div class=\"details-button\" title=\"Track Details\"><span class=\"material-icons-outlined\">info</span></div>\r\n        </div>\r\n        <div class=\"track-actions-toggle\" title=\"Show / Hide track actions\"><span class=\"material-icons\">more_horiz</span></div>\r\n      </div>\r\n    </div>`;\r\n}\r\n\r\nexport function insertTrackLinksHtml(trackData, trackLinksSelector, linkIdsAttribute, linksMap)\r\n{\r\n  trackData.forEach(track =>\r\n  {\r\n    const linksElement = document.getElementById(track.uid).querySelector(trackLinksSelector);\r\n    const linkIds      = linksElement.getAttribute(linkIdsAttribute)?.split(',');\r\n    let   linksHtml    = '';\r\n    \r\n    linkIds?.forEach(linkId =>\r\n    {\r\n      const mapKey    = parseInt(linkId);\r\n      const linkClass = (track.meta.track_artist_id === mapKey) ? 'primary' : 'secondary';\r\n      linksHtml      +=`<a class=\"${linkClass}\" href=\"${getListPlayerUrl(linksMap.get(mapKey).link)}\">${linksMap.get(mapKey).name}</a>`;\r\n    });\r\n\r\n    linksElement.insertAdjacentHTML('afterbegin', linksHtml);\r\n  });\r\n}\r\n", "//\r\n// List player tracks REST data fetch and caching\r\n//\r\n// https://ultrafunk.com\r\n//\r\n\r\n\r\nimport * as debugLogger from '../../shared/debuglogger.js';\r\n\r\nimport {\r\n  response as responseData\r\n} from '../../shared/session-data.js';\r\n\r\nimport {\r\n  getPageSeparatorHtml,\r\n  getTrackEntryHtml,\r\n  insertTrackLinksHtml,\r\n} from './list-track-templates.js';\r\n\r\n\r\n/*************************************************************************************************/\r\n\r\n\r\nconst debug = debugLogger.newInstance('list-tracks-rest');\r\n\r\nconst m = {\r\n  artistsCache:  new Map(),\r\n  channelsCache: new Map(),\r\n};\r\n\r\n\r\n// ************************************************************************************************\r\n// \r\n// ************************************************************************************************\r\n\r\nexport async function loadTracks(termType, termId)\r\n{\r\n  const loadingPage = parseInt(responseData.currentPage + 1);\r\n  const trackData   = await fetchTracks(termType, termId, loadingPage, parseInt(responseData.listPerPage));\r\n\r\n  if (trackData !== null)\r\n  {\r\n    const artistIds  = new Set();\r\n    const channelIds = new Set();\r\n    let tracksHtml   = getPageSeparatorHtml(responseData, loadingPage);\r\n  \r\n    trackData.forEach((track, index) =>\r\n    {\r\n      track.artists.forEach(key => (m.artistsCache.has(key) === false) && artistIds.add(key));\r\n      track.channels.forEach(key => (m.channelsCache.has(key) === false) && channelIds.add(key));\r\n      track.uid = (Date.now() + index);\r\n      tracksHtml += getTrackEntryHtml(track);\r\n    });\r\n\r\n    document.getElementById('tracklist-load-more').insertAdjacentHTML('beforebegin', tracksHtml);\r\n  \r\n    debug.log(`Fetching: ${artistIds.size} artists (cached: ${m.artistsCache.size}) - Fetching: ${channelIds.size} channels (cached: ${m.channelsCache.size})`);\r\n\r\n    let artistsPromise  = null;\r\n    let channelsPromise = null;\r\n    \r\n    if (artistIds.size > 0)\r\n      artistsPromise = fetchTerms('artists',  [...artistIds], 100);\r\n  \r\n    if (channelIds.size > 0)\r\n      channelsPromise = fetchTerms('channels', [...channelIds], 100);\r\n\r\n    const [artistsData, channelsData] = await Promise.all([artistsPromise, channelsPromise]);\r\n\r\n    if (artistsData !== null)\r\n      artistsData.forEach(entry => m.artistsCache.set(entry.id, { name: entry.name, link: entry.link }));\r\n\r\n    if (channelsData !== null)\r\n      channelsData.forEach(entry => m.channelsCache.set(entry.id, { name: entry.name, link: entry.link }));\r\n\r\n    insertTrackLinksHtml(trackData, '.track-artists-links',  'data-track-artist-ids',  m.artistsCache);\r\n    insertTrackLinksHtml(trackData, '.track-channels-links', 'data-track-channel-ids', m.channelsCache);\r\n\r\n    return true;\r\n  }\r\n\r\n  return false;\r\n}\r\n\r\n\r\n// ************************************************************************************************\r\n// Fetch tracks + terms\r\n// ************************************************************************************************\r\n\r\nfunction getShuffleParams()\r\n{\r\n  let shuffleParams = '';\r\n\r\n  if (responseData.requestType.shuffle)\r\n  {\r\n    shuffleParams = `&shuffle=true&shuffle_type=${responseData.requestType.shuffle_type}`;\r\n\r\n    if (responseData.requestType.shuffle_slug !== null)\r\n      shuffleParams += `&shuffle_slug=${responseData.requestType.shuffle_slug}`;\r\n\r\n    debug.log(`getShuffleParams(): ${shuffleParams}`);\r\n  }\r\n\r\n  return shuffleParams;\r\n}\r\n\r\nfunction fetchTracks(termType = '', termId = '', page = 1, tracksPerPage = 25)\r\n{\r\n  debug.log(`fetchTracks() - termType: ${(termType.length === 0) ? 'N/A' : termType} - termId: ${(termId.length === 0) ? 'N/A' : termId} - page: ${page} - tracksPerPage: ${tracksPerPage}`);\r\n\r\n  let termQueryArgs = '';\r\n\r\n  if ((termType.length !== 0) && (termId.length !== 0))\r\n    termQueryArgs = `${termType}=${parseInt(termId)}&`;\r\n\r\n  return fetch(`/wp-json/wp/v2/tracks?${termQueryArgs}page=${page}&per_page=${tracksPerPage}&_fields=id,link,artists,channels,meta${getShuffleParams()}`)\r\n  .then(response => \r\n  {\r\n    if (!response.ok)\r\n    {\r\n      debug.error(response);\r\n      return null;\r\n    }\r\n    \r\n    return response.json();\r\n  })\r\n  .catch(reason =>\r\n  {\r\n    debug.warn(reason);\r\n    return null;\r\n  });\r\n}\r\n\r\nfunction fetchTerms(termType, termIds, maxItems = 50)\r\n{\r\n  debug.log(`fetchTerms() - termType: ${termType} - termIds: ${(termIds.length > 0) ? termIds : 'Empty'} - maxItems: ${maxItems}`);\r\n\r\n  return fetch(`/wp-json/wp/v2/${termType}?include=${termIds}&per_page=${maxItems}&_fields=id,link,name`)\r\n  .then(response => \r\n  {\r\n    if (!response.ok)\r\n    {\r\n      debug.error(response);\r\n      return null;\r\n    }\r\n    \r\n    return response.json();\r\n  })\r\n  .catch(reason =>\r\n  {\r\n    debug.warn(reason);\r\n    return null;\r\n  });\r\n}\r\n", "//\r\n// List-player controls module\r\n//\r\n// https://ultrafunk.com\r\n//\r\n\r\n\r\nimport * as debugLogger       from '../../shared/debuglogger.js';\r\nimport * as upNextModal       from './up-next-modal.js';\r\nimport * as playbackEvents    from '../playback-events.js';\r\nimport { STATE }              from '../element-wrappers.js';\r\nimport { TRACK_TYPE }         from '../shared-gallery-list.js';\r\nimport { loadTracks }         from './list-tracks-rest.js';\r\nimport { showSnackbar }       from '../../shared/snackbar.js';\r\nimport { response, settings } from '../../shared/session-data.js';\r\n\r\nimport {\r\n  replaceClass,\r\n  stripAttribute,\r\n} from '../../shared/utils.js';\r\n\r\n\r\n/*************************************************************************************************/\r\n\r\n\r\nconst debug = debugLogger.newInstance('list-controls');\r\n\r\nconst m = {\r\n  tracklist:         null,\r\n  tracklistObserver: null,\r\n  tracklistLoadMore: null,\r\n  player:            null,\r\n  currentElement:    null,\r\n  currentState:      STATE.UNKNOWN,\r\n  prevActionButtons: null,\r\n};\r\n\r\n\r\n// ************************************************************************************************\r\n//\r\n// ************************************************************************************************\r\n\r\nexport function init(setCurrentTrackFunc)\r\n{\r\n  debug.log('init()');\r\n\r\n  upNextModal.init(setCurrentTrackFunc);\r\n\r\n  m.tracklist         = document.getElementById('tracklist');\r\n  m.tracklistObserver = new IntersectionObserver(observerCallback, { root: m.tracklist });\r\n\r\n  m.tracklist.addEventListener('click', (event) =>\r\n  {\r\n    const playTrackButton = event.target.closest('div.thumbnail');\r\n    if (playTrackButton !== null) return setCurrentTrackFunc(playTrackButton.closest('div.track-entry').id, true, true);\r\n\r\n    const trackActionsToggle = event.target.closest('div.track-actions-toggle');\r\n    if (trackActionsToggle !== null) return trackActionsClick(trackActionsToggle.closest('div.track-entry'));\r\n  \r\n    const playNextButton = event.target.closest('div.play-next-button');\r\n    if (playNextButton !== null) return playNextClick(playNextButton.closest('div.track-entry'));\r\n\r\n    const removeButton = event.target.closest('div.remove-button');\r\n    if (removeButton !== null) return removeClick(removeButton.closest('div.track-entry'));\r\n\r\n    const arrowUpButton = event.target.closest('span.arrow-up-button');\r\n    if (arrowUpButton !== null) return arrowUpDownClick(arrowUpButton.closest('div.tracklist-page-separator'), true);\r\n\r\n    const arrowDownButton = event.target.closest('span.arrow-down-button');\r\n    if (arrowDownButton !== null) return arrowUpDownClick(arrowDownButton.closest('div.tracklist-page-separator'), false);\r\n  });\r\n}\r\n\r\nexport function ready(player)\r\n{\r\n  m.player = player;\r\n  m.currentElement.classList.add('current');\r\n\r\n  playbackEvents.addListener(playbackEvents.EVENT.MEDIA_LOADING, () => setCurrentTrackState(STATE.LOADING));\r\n  playbackEvents.addListener(playbackEvents.EVENT.MEDIA_PLAYING, () => setCurrentTrackState(STATE.PLAYING));\r\n\r\n  if (settings.list.showLoadMoreTracks)\r\n    initLoadMoreTracks();\r\n}\r\n\r\nfunction observerCallback(entries)\r\n{\r\n  m.tracklistObserver.unobserve(m.currentElement);\r\n\r\n  if ((Math.ceil(entries[0].intersectionRatio * 100) / 100) !== 1)\r\n    m.tracklist.scrollTop = (m.currentElement.offsetTop - m.tracklist.offsetHeight) + m.currentElement.offsetHeight;    \r\n}\r\n\r\n\r\n// ************************************************************************************************\r\n//\r\n// ************************************************************************************************\r\n\r\nexport function queryTrack(selectors)\r\n{\r\n  return m.tracklist.querySelector(selectors);\r\n}\r\n\r\nexport function queryTrackAll(selectors)\r\n{\r\n  return m.tracklist.querySelectorAll(selectors);\r\n}\r\n\r\nexport function queryTrackId(id)\r\n{\r\n  return document.getElementById(id);\r\n}\r\n\r\nexport function getCurrentTrackElement()\r\n{\r\n  return m.currentElement;\r\n}\r\n\r\nexport function getTrackType(element)\r\n{\r\n  const trackType = element.getAttribute('data-track-type');\r\n\r\n  if (trackType !== null)\r\n    return parseInt(trackType);\r\n  \r\n  return TRACK_TYPE.NONE;\r\n}\r\n\r\nexport function getPrevPlayableId()\r\n{\r\n  let destElement = (m.currentElement !== null)\r\n                      ? m.currentElement.previousElementSibling\r\n                      : null;\r\n\r\n  while ((destElement !== null) && (getTrackType(destElement) !== TRACK_TYPE.YOUTUBE))\r\n    destElement = destElement.previousElementSibling;\r\n\r\n  return ((destElement !== null) ? destElement.id : null);\r\n}\r\n\r\nexport function getNextPlayableId(startElement = m.currentElement)\r\n{\r\n  let destElement = (startElement !== null)\r\n                      ? startElement.nextElementSibling\r\n                      : queryTrack('div.track-entry');\r\n\r\n  while ((destElement !== null) && (getTrackType(destElement) !== TRACK_TYPE.YOUTUBE))\r\n    destElement = destElement.nextElementSibling;\r\n  \r\n  return ((destElement !== null) ? destElement.id : null);\r\n}\r\n\r\nexport function setCuedTrack(trackId)\r\n{\r\n  m.currentElement = queryTrackId(trackId);\r\n  m.tracklistObserver.observe(m.currentElement);\r\n}\r\n\r\n\r\n// ************************************************************************************************\r\n//\r\n// ************************************************************************************************\r\n\r\nfunction trackActionsClick(element)\r\n{\r\n  const trackActionButtons = element.querySelector('.track-action-buttons');\r\n\r\n  if ((m.prevActionButtons !== null) && (m.prevActionButtons !== trackActionButtons))\r\n    m.prevActionButtons.style.display = '';\r\n\r\n  if (trackActionButtons.style.display === '')\r\n    trackActionButtons.style.display = 'flex';\r\n  else\r\n    trackActionButtons.style.display = '';\r\n\r\n  m.prevActionButtons = trackActionButtons;\r\n}\r\n\r\nfunction playNextClick(trackElement)\r\n{\r\n  if (m.currentElement !== null)\r\n  {\r\n    const nextTrackElement = trackElement.cloneNode(true);\r\n    \r\n    clearTrackState(nextTrackElement);\r\n    nextTrackElement.id = Date.now();\r\n\r\n    if (settings.list.moveTrackOnPlayNext && (trackElement !== m.currentElement))\r\n      removeClick(trackElement, false, () => addTrack(nextTrackElement, m.currentElement, 'afterend'));\r\n    else\r\n      addTrack(nextTrackElement, m.currentElement, 'afterend'); \r\n\r\n    showSnackbar('Track will play next', 3);\r\n  }\r\n  else\r\n  {\r\n    showSnackbar('Unable to cue track', 3);\r\n  }\r\n}\r\n\r\nfunction removeClick(trackElement, allowUndo = true, animationEndCallback = () => {})\r\n{\r\n  if (trackElement !== m.currentElement)\r\n  {\r\n    const undoRemoveElement = trackElement.cloneNode(true);\r\n    const undoPrevElement   = trackElement.previousElementSibling;\r\n\r\n    trackElement.addEventListener('animationend', () =>\r\n    {\r\n      trackElement.remove();\r\n      animationEndCallback();\r\n    });\r\n    \r\n    trackElement.classList.add('removing');\r\n\r\n    if (allowUndo)\r\n    {\r\n      showSnackbar('Track removed', 4, 'undo', () =>\r\n      {\r\n        addTrack(undoRemoveElement,\r\n                ((undoPrevElement === null) ? m.tracklist  : undoPrevElement),\r\n                ((undoPrevElement === null) ? 'afterbegin' : 'afterend'));\r\n      });\r\n    }\r\n  }\r\n}\r\n\r\nfunction addTrack(trackElement, targetElement, insertPosition)\r\n{\r\n  trackElement.classList.add('adding');\r\n  trackElement.querySelector('.track-action-buttons').style.display = '';\r\n  trackElement.addEventListener('animationend', () => trackElement.classList.remove('adding'));\r\n  targetElement.insertAdjacentElement(insertPosition, trackElement);\r\n}\r\n\r\nfunction arrowUpDownClick(targetElement, isArrowUpClick)\r\n{\r\n  const pageNumber  = parseInt(targetElement.getAttribute('data-page-number'));\r\n  const gotoPageNum = isArrowUpClick ? (pageNumber - 1) : (pageNumber + 1);\r\n  let gotoElement   = document.getElementById(`tracklist-page-${gotoPageNum}`);\r\n  let blockOption   = 'center';\r\n\r\n  if (gotoElement === null)\r\n  {\r\n    gotoElement = isArrowUpClick ? m.tracklist.firstElementChild : m.tracklist.lastElementChild;\r\n    blockOption = isArrowUpClick ? 'end' : ((window.innerWidth > 1350) ? 'nearest' : 'center');\r\n\r\n    if ((isArrowUpClick === false) && (gotoPageNum > response.maxPages))\r\n      gotoElement = gotoElement?.previousElementSibling;\r\n  }\r\n\r\n  gotoElement?.scrollIntoView({ behavior: (settings.site.smoothScrolling ? 'smooth' : 'auto'), block: blockOption });\r\n}\r\n\r\n\r\n// ************************************************************************************************\r\n//\r\n// ************************************************************************************************\r\n\r\nfunction initLoadMoreTracks()\r\n{\r\n  if (response.requestType.all     ||\r\n      response.requestType.channel ||\r\n      response.requestType.artist  ||\r\n      response.requestType.shuffle)\r\n  {\r\n    if ((response.nextPage !== null) && (response.currentPage < response.maxPages))\r\n    {\r\n      m.tracklistLoadMore = document.getElementById('tracklist-load-more');\r\n      m.tracklistLoadMore.querySelector('.load-more-title span').textContent = ` ( ${response.currentPage + 1} / ${response.maxPages} )`;\r\n      m.tracklistLoadMore.style.display = 'block';\r\n      m.tracklistLoadMore.addEventListener('click', loadMoreTracks);\r\n    }\r\n  }\r\n}\r\n\r\nexport async function loadMoreTracks()\r\n{\r\n  let tracksLoaded = false;\r\n  \r\n  if ((response.currentPage + 1) <= response.maxPages)\r\n  {\r\n    setIsLoadingTracks(true);\r\n    tracksLoaded = await loadTracks(stripAttribute(m.tracklist, 'data-term-type'), stripAttribute(m.tracklist, 'data-term-id'));\r\n    setIsLoadingTracks(false);\r\n\r\n    if (tracksLoaded)\r\n    {\r\n      response.currentPage++;\r\n      m.tracklistLoadMore.querySelector('.load-more-title span').textContent = ` ( ${response.currentPage + 1} / ${response.maxPages} )`;\r\n    }\r\n    else\r\n    {\r\n      showSnackbar('Load more tracks failed!', 10, 'Retry', () => loadMoreTracks());\r\n    }\r\n  }\r\n  \r\n  if (response.currentPage >= response.maxPages)\r\n    m.tracklistLoadMore.style.display = 'none';\r\n\r\n  return tracksLoaded;\r\n}\r\n\r\nfunction setIsLoadingTracks(isLoadingTracks)\r\n{\r\n  m.tracklistLoadMore.style.pointerEvents                              = isLoadingTracks ? 'none'  : 'unset';\r\n  m.tracklistLoadMore.querySelector('.load-more-title').style.display  = isLoadingTracks ? 'none'  : 'block';\r\n  m.tracklistLoadMore.querySelector('.load-more-loader').style.display = isLoadingTracks ? 'block' : 'none';\r\n}\r\n\r\n\r\n// ************************************************************************************************\r\n//\r\n// ************************************************************************************************\r\n\r\nfunction clearTrackState(element)\r\n{\r\n  element.classList.remove('current', STATE.LOADING.CLASS, STATE.PLAYING.CLASS, STATE.PAUSED.CLASS);\r\n}\r\n\r\nexport function setCurrentTrackState(newState)\r\n{\r\n  if (m.currentState.ID !== newState.ID)\r\n  {\r\n    m.currentState = newState;\r\n\r\n    if (newState.ID === STATE.LOADING.ID)\r\n    {\r\n      m.currentElement.classList.remove(STATE.PAUSED.CLASS, STATE.PLAYING.CLASS);\r\n      m.currentElement.classList.add(STATE.LOADING.CLASS);\r\n    }\r\n    else\r\n    {\r\n      m.currentElement.classList.remove(STATE.LOADING.CLASS);\r\n    \r\n      if (newState.ID === STATE.PLAYING.ID)\r\n        replaceClass(m.currentElement, STATE.PAUSED.CLASS, STATE.PLAYING.CLASS);\r\n      else\r\n        replaceClass(m.currentElement, STATE.PLAYING.CLASS, STATE.PAUSED.CLASS);\r\n\r\n      upNextModal.updateUpNextModal((newState.ID === STATE.PLAYING.ID) ? true : false);\r\n    }\r\n  }\r\n}\r\n\r\nexport function setNextTrackState(nextTrackId, isPointerClick)\r\n{\r\n  clearTrackState(m.currentElement);\r\n\r\n  m.currentElement = queryTrackId(nextTrackId);\r\n\r\n  if (isPointerClick === false)\r\n    m.tracklistObserver.observe(m.currentElement);\r\n\r\n  m.currentElement.classList.add('current');\r\n}\r\n\r\nexport function setTrackMessage(message)\r\n{\r\n  m.currentElement.querySelector('.track-message').textContent   = message;\r\n  m.currentElement.querySelector('.track-message').style.display = 'block';\r\n}\r\n\r\nexport function updateTrackDetails()\r\n{\r\n  const sourceUid = m.currentElement.getAttribute('data-track-source-uid');\r\n  \r\n  m.player.setArtist(m.currentElement.getAttribute('data-track-artist'));\r\n  m.player.setTitle(m.currentElement.getAttribute('data-track-title'));\r\n  m.player.setThumbnail(sourceUid);\r\n\r\n  return sourceUid;\r\n}\r\n", "//\r\n// Modal dialog template functions\r\n//\r\n// https://ultrafunk.com\r\n//\r\n\r\n\r\nimport { TRACK_TYPE } from '../playback/shared-gallery-list.js';\r\n\r\n\r\n/*************************************************************************************************/\r\n\r\n\r\nexport const config = { id: 'modal-dialog' };\r\n\r\n\r\n// ************************************************************************************************\r\n//\r\n// ************************************************************************************************\r\n\r\nexport function getTemplateHtml()\r\n{\r\n  return `\r\n    <div id=\"${config.id}\" tabindex=\"-1\">\r\n      <div id=\"${config.id}-container\">\r\n        <div class=\"${config.id}-header\">\r\n          <div class=\"${config.id}-title\"></div>\r\n          <div class=\"${config.id}-close-icon\"><span class=\"material-icons\" title=\"Dismiss (esc)\">close</span></div>\r\n        </div>\r\n        <div class=\"${config.id}-body\"></div>\r\n      </div>\r\n    </div>`;\r\n}\r\n\r\nexport function insertSingleChoiceListHtml(singleChoiceList, insertElement)\r\n{\r\n  let listHtml = '';\r\n\r\n  singleChoiceList.forEach((entry, index) =>\r\n  {\r\n    const entryClass   = entry.class ? `modal-${entry.class}`                                       : 'modal-icon-text';\r\n    const entryTitle   = entry.title ? entry.title                                                  : '';\r\n    const entryIcon    = entry.icon  ? `<span class=\"material-icons\">${entry.icon}</span>`          : '';\r\n    const entryContent = entry.icon  ? `<span class=\"text-nowrap-ellipsis\">${entry.content}</span>` : entry.content;\r\n    entry.uid          = `modal-item-${index + 1}`;\r\n  \r\n    if (entry.clickId)\r\n      listHtml += `<div id=\"${entry.uid}\" data-click-id=\"${entry.clickId}\" class=\"modal-click-item ${entryClass}\" title=\"${entryTitle}\">${entryIcon}${entryContent}</div>`;\r\n    else\r\n      listHtml += `<div class=\"${entryClass}\" title=\"${entryTitle}\">${entryIcon}${entryContent}</div>`;\r\n  });\r\n  \r\n  insertElement.innerHTML = listHtml;\r\n}\r\n\r\nexport function getModalTrackHtml(element, trackArtist, trackTitle)\r\n{\r\n  const trackTypeClass = (parseInt(element.getAttribute('data-track-type')) === TRACK_TYPE.YOUTUBE) ? 'type-youtube' : 'type-soundcloud';\r\n\r\n  return `\r\n    <div class=\"modal-track\">\r\n      <div class=\"modal-track-thumbnail ${trackTypeClass}\">\r\n        <img src=\"${encodeURI(element.getAttribute('data-track-thumbnail-url'))}\">\r\n      </div>\r\n      <div class=\"modal-track-artist-title text-nowrap-ellipsis\">\r\n        <span><b>${trackArtist}</b></span><br>\r\n        <span class=\"light-text\">${trackTitle}</span>\r\n      </div>\r\n    </div>`;\r\n}\r\n", "//\r\n// Modal dialog UI module\r\n//\r\n// https://ultrafunk.com\r\n//\r\n\r\n\r\nimport * as debugLogger from './debuglogger.js';\r\n\r\nimport {\r\n  config,\r\n  getTemplateHtml,\r\n  insertSingleChoiceListHtml,\r\n} from './modal-templates.js';\r\n\r\n\r\n/*************************************************************************************************/\r\n\r\n\r\nconst debug = debugLogger.newInstance('modal');\r\n\r\nconst m = {\r\n  onEntryClicked:   null,\r\n  onClickClose:     null,\r\n  modalId:          0,\r\n  isTouchDraggable: false,\r\n};\r\n\r\nconst elements = {\r\n  overlay:   null,\r\n  container: null,\r\n  body:      null,\r\n};\r\n\r\n\r\n// ************************************************************************************************\r\n//\r\n// ************************************************************************************************\r\n\r\nexport function showModal(typeString, title, singleChoiceList = [], onEntryClickedCallback = () => {}, onClickCloseCallback = () => true)\r\n{\r\n  init();\r\n  \r\n  m.onEntryClicked = onEntryClickedCallback;\r\n  m.onClickClose   = onClickCloseCallback;\r\n  setSingleChoiceList(singleChoiceList);\r\n\r\n  elements.container.classList = `modal-type-${typeString}`;\r\n  elements.container.querySelector(`.${config.id}-title`).innerHTML = title;\r\n  elements.overlay.classList.add('show');\r\n  elements.overlay.addEventListener('keydown', keyDown);\r\n  elements.overlay.focus();\r\n  disablePageScrolling(true);\r\n\r\n  m.modalId++;\r\n\r\n  debug.log(`showModal() - modalId: ${m.modalId} - typeString: ${typeString} - title: ${title}`);\r\n\r\n  return config.id;\r\n}\r\n\r\nexport function isShowingModal(showingModalId = -1)\r\n{\r\n  return ((showingModalId === m.modalId) && (elements.container !== null) && (elements.overlay.classList.contains('show')));\r\n}\r\n\r\nexport function closeModal()\r\n{\r\n  document.body.removeEventListener('touchmove', blockTouchScroll, { passive: false });\r\n  document.body.removeEventListener('touchstart', setIsTouchDraggable);\r\n  elements.overlay.removeEventListener('keydown', keyDown);\r\n  elements.overlay.classList.replace('show', 'hide');\r\n}\r\n\r\nexport function getModalId()\r\n{\r\n  return m.modalId;\r\n}\r\n\r\nexport function getModalEntry(entryNum)\r\n{\r\n  return document.getElementById(`modal-item-${entryNum}`);\r\n}\r\n\r\nexport function updateModalTitle(updateModalId, updateTitle)\r\n{\r\n  if (updateModalId === m.modalId)\r\n    elements.container.querySelector(`.${config.id}-title`).innerHTML = updateTitle;\r\n}\r\n\r\nexport function updateModalBody(updateModalId, updateSingleChoiceList)\r\n{\r\n  if (updateModalId === m.modalId)\r\n    setSingleChoiceList(updateSingleChoiceList);\r\n}\r\n\r\n\r\n// ************************************************************************************************\r\n//\r\n// ************************************************************************************************\r\n\r\nfunction init()\r\n{\r\n  if (elements.container === null)\r\n  {\r\n    document.body.insertAdjacentHTML('beforeend', getTemplateHtml());\r\n    \r\n    elements.overlay   = document.getElementById(config.id);\r\n    elements.container = document.getElementById(`${config.id}-container`);\r\n    elements.body      = elements.overlay.querySelector(`.${config.id}-body`);\r\n\r\n    elements.overlay.addEventListener('click', (event) =>\r\n    {\r\n      if (event.target === elements.overlay)\r\n        closeModal();\r\n    });\r\n\r\n    elements.overlay.addEventListener('animationend', () =>\r\n    {\r\n      if (elements.overlay.classList.contains('hide'))\r\n      {\r\n        elements.overlay.className = '';\r\n        disablePageScrolling(false);\r\n      }\r\n    });\r\n\r\n    elements.overlay.querySelector(`.${config.id}-close-icon`).addEventListener('click', closeModal);\r\n  }\r\n}\r\n\r\nfunction setSingleChoiceList(singleChoiceList)\r\n{\r\n  insertSingleChoiceListHtml(singleChoiceList, elements.body);\r\n  \r\n  singleChoiceList.forEach(entry =>\r\n  {\r\n    if (entry.clickId)\r\n      elements.body.querySelector(`#${entry.uid}`).addEventListener('click', singleChoiceListClick);\r\n  });\r\n}\r\n\r\nfunction singleChoiceListClick(event)\r\n{\r\n  if (m.onClickClose(event) === true)\r\n  {\r\n    closeModal();\r\n    setTimeout(() => m.onEntryClicked(this.getAttribute('data-click-id'), event), 150);\r\n  }\r\n}\r\n\r\nfunction keyDown(event)\r\n{\r\n  event.stopPropagation();\r\n\r\n  if (event.key === 'Escape')\r\n    closeModal();\r\n}\r\n\r\nfunction disablePageScrolling(disableScrolling)\r\n{\r\n  const scrollbarWidth = window.innerWidth - document.documentElement.clientWidth;\r\n  \r\n  document.documentElement.style.overflowY    = disableScrolling ? 'hidden' : '';\r\n  document.documentElement.style.paddingRight = disableScrolling ? `${scrollbarWidth}px` : '';\r\n  document.getElementById('site-header').style.paddingRight = disableScrolling ? `${scrollbarWidth}px` : '';\r\n\r\n  if (disableScrolling && ('ontouchstart' in window))\r\n  {\r\n    document.body.addEventListener('touchstart', setIsTouchDraggable);\r\n    document.body.addEventListener('touchmove',  blockTouchScroll, { passive: false });\r\n  }\r\n}\r\n\r\nfunction setIsTouchDraggable(event)\r\n{\r\n  const draggableAttr = event.target.closest('.modal-track')?.getAttribute('draggable');\r\n  m.isTouchDraggable  = (draggableAttr === 'true') ? true : false;\r\n}\r\n\r\nfunction blockTouchScroll(event)\r\n{\r\n  if (m.isTouchDraggable === false)\r\n    event.preventDefault();\r\n}\r\n", "//\r\n// List-player Up Next modal module\r\n//\r\n// https://ultrafunk.com\r\n//\r\n\r\n\r\nimport * as debugLogger from '../../shared/debuglogger.js';\r\nimport { autoplay }     from '../footer-toggles.js';\r\nimport { settings }     from '../../shared/session-data.js';\r\nimport { isPlaying }    from '../playback-controls.js';\r\nimport { TRACK_TYPE }   from '../shared-gallery-list.js';\r\nimport { showSnackbar } from '../../shared/snackbar.js';\r\n\r\nimport {\r\n  addListener,\r\n  escAttribute,\r\n} from '../../shared/utils.js';\r\n\r\nimport {\r\n  queryTrackId,\r\n  getNextPlayableId,\r\n  getCurrentTrackElement,\r\n} from './list-controls.js';\r\n\r\nimport {\r\n  showModal,\r\n  isShowingModal,\r\n  getModalId,\r\n  getModalEntry,\r\n  updateModalTitle,\r\n  updateModalBody,\r\n} from '../../shared/modal.js';\r\n\r\n\r\n/*************************************************************************************************/\r\n\r\n\r\nconst debug = debugLogger.newInstance('up-next-modal');\r\n\r\nconst m = {\r\n  setCurrentTrack: null,\r\n  modalDialogId:   null,\r\n  upNextModalId:   0,\r\n  dragStartY:      0,\r\n  dragEntryId:     null,\r\n};\r\n\r\n\r\n// ************************************************************************************************\r\n//\r\n// ************************************************************************************************\r\n\r\nexport function init(setCurrentTrackFunc)\r\n{\r\n  m.setCurrentTrack = setCurrentTrackFunc;\r\n}\r\n\r\nfunction loadDragDropTouch()\r\n{\r\n  if (('ontouchstart' in window) && (document.getElementById('drag-drop-touch') === null))\r\n  {\r\n    debug.log('Loading drag-drop-touch.js...');\r\n\r\n    const tag = document.createElement('script');\r\n    tag.type  = 'text/javascript';\r\n    tag.id    = 'drag-drop-touch';\r\n    tag.src   = debug.isDebug()\r\n                  ? 'https://wordpress.ultrafunk.com/wp-content/themes/ultrafunk/inc/js/drag-drop-touch.js?ver=1.40.8'\r\n                  : 'https://ultrafunk.com/wp-content/themes/ultrafunk/inc/js/drag-drop-touch.min.js?ver=1.40.8';\r\n    const firstScriptTag = document.getElementsByTagName('script')[0];\r\n    firstScriptTag.parentNode.insertBefore(tag, firstScriptTag);\r\n  }\r\n}\r\n\r\n\r\n// ************************************************************************************************\r\n//\r\n// ************************************************************************************************\r\n\r\nexport function showUpNextModal()\r\n{\r\n  // Only load this dependency IF we actually need it...\r\n  loadDragDropTouch();\r\n\r\n  const modalEntries = getEntries(isPlaying());\r\n\r\n  if (modalEntries.length > 2)\r\n  {\r\n    m.modalDialogId = showModal('tracklist', getTitle(isPlaying()), modalEntries, (clickedId) =>\r\n    {\r\n      const nextTrackId = modalEntries.find(item => (item.clickId === clickedId)).clickId;\r\n\r\n      if ((nextTrackId === getCurrentTrackElement().id) && isPlaying())\r\n        getCurrentTrackElement().scrollIntoView({ behavior: (settings.site.smoothScrolling ? 'smooth' : 'auto'), block: 'center' });\r\n      else\r\n        m.setCurrentTrack(nextTrackId, true, false);\r\n    },\r\n    (event) => \r\n    {\r\n      if (event.target.closest('#modal-item-1'))\r\n        return true;\r\n      else if (event.target.classList.contains('modal-track-thumbnail'))\r\n        return true;\r\n\r\n      return false;\r\n    });\r\n\r\n    m.upNextModalId = getModalId();\r\n\r\n    addTitleListener();\r\n    addDragDropListeners();\r\n  }\r\n  else\r\n  {\r\n    showSnackbar('No more tracks to play!', 5);\r\n  }\r\n}\r\n\r\nexport function updateUpNextModal(isPlayingTrack)\r\n{\r\n  if (isShowingModal(m.upNextModalId))\r\n  {\r\n    updateModalTitle(m.upNextModalId, getTitle(isPlayingTrack));\r\n    addTitleListener();\r\n  \r\n    const modalEntry = getModalEntry(1);\r\n  \r\n    if (modalEntry.getAttribute('data-click-id') === getCurrentTrackElement().id)\r\n    {\r\n      modalEntry.classList.remove('playing-track', 'cued-track');\r\n      modalEntry.classList.add(`${isPlayingTrack ? 'playing-track' : 'cued-track'}`);\r\n      modalEntry.title = `${isPlayingTrack ? 'Go To Track' : 'Play Track'}`;\r\n    }\r\n    else\r\n    {\r\n      updateModalBody(m.upNextModalId, getEntries(isPlayingTrack));\r\n      addDragDropListeners();\r\n    }\r\n  }\r\n}\r\n\r\nfunction getTitle(isPlayingTrack)\r\n{\r\n  return `${isPlayingTrack ? 'Playing' : 'Cued'}\r\n            <span class=\"light-text lowercase-text toggle-element\" title=\"Toggle Autoplay\">\r\n            Autoplay is <b>${settings.playback.autoplay ? 'On' : 'Off'}</b></span>`;\r\n}\r\n\r\nfunction getEntries(isPlayingTrack)\r\n{\r\n  const modalEntries = [];\r\n  let trackElement   = getCurrentTrackElement();\r\n\r\n  modalEntries.push({\r\n    clickId: trackElement.id,\r\n    class:   `tracklist-entry ${isPlayingTrack ? 'playing-track' : 'cued-track'}`,\r\n    title:   `${isPlayingTrack ? 'Go To Track' : 'Play Track'}`,\r\n    content: getUpNextTrackHtml(trackElement, 'data-track-artist', 'data-track-title'),\r\n  });\r\n\r\n  modalEntries.push({ class: 'header-entry', content: 'Up Next' });\r\n\r\n  for (let i = 0; i < 10; i++)\r\n  {\r\n    trackElement = queryTrackId(getNextPlayableId(trackElement));\r\n\r\n    if (trackElement === null)\r\n      break;\r\n\r\n    modalEntries.push({\r\n      clickId: trackElement.id,\r\n      class:   'tracklist-entry',\r\n      content: getUpNextTrackHtml(trackElement, 'data-track-artist', 'data-track-title', true),\r\n    });\r\n  }\r\n\r\n  return modalEntries;\r\n}\r\n\r\nfunction addTitleListener()\r\n{\r\n  addListener(`#${m.modalDialogId} .modal-dialog-title span`, 'click', (event) => \r\n  {\r\n    autoplay.toggle();\r\n    event.target.closest('span').innerHTML = `Autoplay is <b>${settings.playback.autoplay ? 'On' : 'Off'}</b>`;\r\n  });\r\n}\r\n\r\n\r\n// ************************************************************************************************\r\n//\r\n// ************************************************************************************************\r\n\r\nfunction addDragDropListeners()\r\n{\r\n  document.querySelectorAll('.modal-tracklist-entry')?.forEach((element) =>\r\n  {\r\n    if (element.id !== 'modal-item-1')\r\n    {\r\n      element.addEventListener('mousedown', mouseDown);\r\n      element.addEventListener('dragstart', dragStart);\r\n      element.addEventListener('dragover',  dragOver);\r\n      element.addEventListener('drop',      dragDrop);\r\n    }\r\n  });\r\n}\r\n\r\n// Disable drag & drop for track play button (modal-track-thumbnail)\r\nfunction mouseDown(event)\r\n{\r\n  if (event.target.classList.contains('modal-track-thumbnail'))\r\n    event.preventDefault();\r\n}\r\n\r\nfunction dragStart(event)\r\n{\r\n  m.dragStartY  = event.clientY;\r\n  m.dragEntryId = event.target.closest('div.modal-tracklist-entry').id;\r\n  event.dataTransfer.effectAllowed = 'move';\r\n}\r\n\r\nfunction dragOver(event)\r\n{\r\n  event.preventDefault();\r\n  event.dataTransfer.dropEffect = 'move';\r\n  return false;\r\n}\r\n\r\nfunction dragDrop(event)\r\n{\r\n  event.preventDefault();\r\n\r\n  const insertPos = (event.clientY  > m.dragStartY) ? 'afterend' : 'beforebegin';\r\n  \r\n  // Modal tracks drag & drop reorder\r\n  const modalDragSource = document.getElementById(m.dragEntryId);\r\n  const modalDropTarget = event.target.closest('div.modal-tracklist-entry');\r\n  modalDropTarget.insertAdjacentElement(insertPos, modalDragSource);\r\n\r\n  // List player tracks drag & drop reorder = sync track lists\r\n  const listTrackSource = document.getElementById(modalDragSource.getAttribute('data-click-id'));\r\n  const listTrackTarget = document.getElementById(modalDropTarget.getAttribute('data-click-id'));\r\n  listTrackTarget.insertAdjacentElement(insertPos, listTrackSource);\r\n\r\n  return false;\r\n}\r\n\r\n\r\n// ************************************************************************************************\r\n//\r\n// ************************************************************************************************\r\n\r\nfunction getUpNextTrackHtml(element, trackArtistAttr, trackTitleAttr, isDraggable = false)\r\n{\r\n  const trackTypeClass = (parseInt(element.getAttribute('data-track-type')) === TRACK_TYPE.YOUTUBE) ? 'type-youtube' : 'type-soundcloud';\r\n\r\n  return `\r\n    <div class=\"modal-track\" ${isDraggable ? 'draggable=\"true\"' : ''}>\r\n      <div class=\"modal-track-thumbnail ${trackTypeClass}\" ${isDraggable ? 'title=\"Click to Play Track\"' : ''}\">\r\n        <img src=\"${encodeURI(element.getAttribute('data-track-thumbnail-url'))}\">\r\n      </div>\r\n      <div class=\"modal-track-artist-title text-nowrap-ellipsis\" ${isDraggable ? 'title=\"Drag to Move Track\"' : ''}\">\r\n        <span><b>${escAttribute(element, trackArtistAttr)}</b></span><br>\r\n        <span class=\"light-text\">${escAttribute(element, trackTitleAttr)}</span>\r\n      </div>\r\n      ${isDraggable ? getModalTrackButtons() : ''}\r\n    </div>`;\r\n}\r\n\r\nfunction getModalTrackButtons()\r\n{\r\n  return `\r\n    <div class=\"modal-track-buttons\">\r\n      <div class=\"drag-drop-button\" title=\"Drag to Move Track\"><span class=\"material-icons\">drag_handle</span></div>\r\n    </div>`;\r\n}\r\n", "//\r\n// Shared gallery and list-player functionality\r\n//\r\n// https://ultrafunk.com\r\n//\r\n\r\n\r\nimport * as debugLogger       from '../shared/debuglogger.js';\r\nimport { KEY, setCookie }     from '../shared/storage.js';\r\nimport { showUpNextModal }    from './list/up-next-modal.js';\r\nimport { response, settings } from '../shared/session-data.js';\r\n\r\nimport {\r\n  getCssPropValue,\r\n  getPrefPlayerUrl,\r\n  navToUrl,\r\n} from '../shared/utils.js';\r\n\r\n\r\n/*************************************************************************************************/\r\n\r\n\r\nconst debug = debugLogger.newInstance('shared-gallery-list');\r\n\r\nexport const PLAYER_TYPE = {\r\n  NONE:    0,\r\n  GALLERY: 1,\r\n  LIST:    2,\r\n};\r\n\r\nexport const TRACK_TYPE = {\r\n  NONE:       0,\r\n  YOUTUBE:    1,\r\n  SOUNDCLOUD: 2,\r\n};\r\n\r\nconst isPlayer = {\r\n  gallery: false,\r\n  list:    false,\r\n};\r\n\r\n\r\n// ************************************************************************************************\r\n//\r\n// ************************************************************************************************\r\n\r\nexport function hasGalleryPlayer()\r\n{\r\n  isPlayer.gallery = (document.body.getAttribute('data-player-type') === 'gallery');\r\n  return isPlayer.gallery;\r\n}\r\n\r\nexport function hasListPlayer()\r\n{\r\n  isPlayer.list = (document.body.getAttribute('data-player-type') === 'list');\r\n  return isPlayer.list;\r\n}\r\n\r\nexport function noPlayback()\r\n{\r\n  return ((isPlayer.gallery === false) && (isPlayer.list === false));\r\n}\r\n\r\nexport function isGalleryPlayer() { return isPlayer.gallery; }\r\nexport function isListPlayer()    { return isPlayer.list;    }\r\n\r\nexport function shuffleClickNavTo(event)\r\n{\r\n  event?.preventDefault();\r\n  setCookie(KEY.UF_RESHUFFLE, 'true');\r\n  navToUrl(getPrefPlayerUrl(response.shufflePath));\r\n}\r\n\r\nexport function autoplayNavTo(destUrl, continueAutoplay = false)\r\n{\r\n  debug.log(`autoplayNavTo(): ${destUrl} - continueAutoplay: ${continueAutoplay}`);\r\n  \r\n  if (destUrl)\r\n  {\r\n    sessionStorage.setItem(KEY.UF_AUTOPLAY, JSON.stringify({ autoplay: continueAutoplay, trackId: null, position: 0 }));\r\n    navToUrl(destUrl);\r\n  }\r\n}\r\n\r\n\r\n// ************************************************************************************************\r\n//\r\n// ************************************************************************************************\r\n\r\nexport function playerScrollTo(trackId = 0)\r\n{\r\n  isListPlayer() ? listPlayerScrollTo(trackId) : galleryPlayerScrollTo(trackId);\r\n}\r\n\r\nfunction scrollToYPos(element, destYPos)\r\n{\r\n  element.scroll(\r\n  {\r\n    top:      destYPos,\r\n    left:     0,\r\n    behavior: (settings.site.smoothScrolling ? 'smooth' : 'auto'),\r\n  });\r\n}\r\n\r\n\r\n// ************************************************************************************************\r\n//\r\n// ************************************************************************************************\r\n\r\nfunction listPlayerScrollTo(trackId = 0)\r\n{\r\n  if (trackId === 0)\r\n  {\r\n    let scrollDestPos = 0;\r\n\r\n    if ((window.pageYOffset === 0) || (Math.round(window.pageYOffset) <= 1))\r\n      scrollDestPos = getCssPropValue('--site-header-height') - getCssPropValue('--site-header-height-down');\r\n  \r\n    scrollToYPos(window, scrollDestPos);\r\n  }\r\n  else\r\n  {\r\n    if (settings.list.showUpNextModal)\r\n    {\r\n      showUpNextModal();\r\n    }\r\n    else\r\n    {\r\n      const trackElement = document.getElementById('tracklist').querySelector(`[data-track-id=\"${trackId}\"]`);\r\n      trackElement.scrollIntoView({ behavior: (settings.site.smoothScrolling ? 'smooth' : 'auto'), block: 'center' });\r\n    }\r\n  }\r\n}\r\n\r\nfunction galleryPlayerScrollTo(trackId)\r\n{\r\n  if (settings.gallery.autoScroll)\r\n  {\r\n    // Actual functional 'offsetTop' calculation: https://stackoverflow.com/a/52477551\r\n    const offsetTop    = Math.round(window.scrollY + document.getElementById(trackId).getBoundingClientRect().top);\r\n    const scrollTop    = Math.round(window.pageYOffset); // Don't want float results that can cause jitter\r\n    let   headerHeight = getScrollHeaderHeight(offsetTop > scrollTop);\r\n\r\n    // If we get obscured by the sticky header menu, recalculate headerHeight to account for that\r\n    if ((scrollTop + headerHeight + getContentMarginTop()) > offsetTop)\r\n      headerHeight = getScrollHeaderHeight(false);\r\n\r\n    scrollToYPos(window, (offsetTop - (headerHeight + getContentMarginTop())));\r\n  }\r\n\r\n  function getScrollHeaderHeight(isScrollDown)\r\n  {\r\n    return (isScrollDown\r\n             ? getCssPropValue('--site-header-height-down')\r\n             : getCssPropValue('--site-header-height-up'));\r\n  }\r\n  \r\n  function getContentMarginTop()\r\n  {\r\n    // -1 because of fractional pixels on HiDPI displays (iframe bottom 1 px would show on top)\r\n    return (getCssPropValue('--site-content-margin-top', document.body) - 1);\r\n  }\r\n}\r\n\r\n\r\n// ************************************************************************************************\r\n//\r\n// ************************************************************************************************\r\n\r\nexport function playerOnKeyScroll(event)\r\n{\r\n  if (isListPlayer() && (event.shiftKey === true) && (window.innerWidth > 1350))\r\n  {\r\n    const tracklist = document.getElementById('tracklist');\r\n\r\n    event.preventDefault();\r\n\r\n    if ((event.key === 'PageUp') || (event.key === 'PageDown'))\r\n    {\r\n      const scrollByPx = tracklist.offsetHeight - ((tracklist.offsetHeight * 10)  / 100);\r\n\r\n      tracklist.scrollBy(\r\n      {\r\n        top:      (event.key === 'PageUp') ? -scrollByPx : scrollByPx,\r\n        left:     0,\r\n        behavior: (settings.site.smoothScrolling ? 'smooth' : 'auto'),\r\n      });\r\n    }\r\n    else if ((event.key === 'Home') || (event.key === 'End'))\r\n    {\r\n      scrollToYPos(tracklist, ((event.key === 'Home') ? 0 : tracklist.scrollHeight));\r\n    }\r\n  }\r\n}\r\n", "//\r\n// Track to track crossfade module\r\n//\r\n// https://ultrafunk.com\r\n//\r\n\r\n\r\nimport * as debugLogger from '../../shared/debuglogger.js';\r\nimport { settings }     from '../../shared/session-data.js';\r\n\r\n\r\nexport { TYPE as CROSSFADE_TYPE };\r\n\r\n\r\n/*************************************************************************************************/\r\n\r\n\r\nconst debug = debugLogger.newInstance('crossfade');\r\n\r\nexport const VOLUME = {\r\n  MIN:   0,\r\n  MAX: 100,\r\n};\r\n\r\nconst TYPE = {\r\n  NONE:  0,\r\n  AUTO:  1,\r\n  TRACK: 2,\r\n};\r\n\r\nconst CURVE = {\r\n  NONE:        0,\r\n  EQUAL_POWER: 1,\r\n  LINEAR:      2,\r\n};\r\n\r\nconst STATE = {\r\n  NONE:   0,\r\n  INIT:   1,\r\n  FADING: 2,\r\n};\r\n\r\nconst config = {\r\n  intervalEqPow:   33, // Milliseconds between each crossfade update event\r\n  intervalLinear: 100,\r\n};\r\n\r\n\r\n// ************************************************************************************************\r\n// Crossfade closure\r\n// ************************************************************************************************\r\n\r\nexport const crossfade = ((galleryPlayers) =>\r\n{\r\n  const players       = galleryPlayers;\r\n  let fadeState       = STATE.NONE;\r\n  let intervalId      = -1;\r\n  let fadeOutPlayer   = null;\r\n  let fadeInPlayer    = null;\r\n  let fadeLength      = 0;\r\n  let fadeStartVolume = 0;\r\n  let fadeType        = TYPE.NONE;\r\n  let fadePreset      = null;\r\n  let fadeStartTime   = 0;\r\n\r\n  return {\r\n    isFading() { return (fadeState !== STATE.NONE); },\r\n    init,\r\n    start,\r\n    stop,\r\n    mute,\r\n  };\r\n  \r\n  function init(crossfadeType, crossfadePreset, fadeInUid = null)\r\n  {\r\n    if ((fadeState === STATE.NONE) && (set(fadeInUid) === true))\r\n    {\r\n      debug.log(`init() - type: ${debug.getObjectKeyForValue(TYPE, crossfadeType)} - fadeInUid: ${fadeInUid} - preset: ${crossfadePreset.length} sec ${debug.getObjectKeyForValue(CURVE, crossfadePreset.curve)} (Name: ${crossfadePreset.name})`);\r\n  \r\n      fadeState       = STATE.INIT;\r\n      fadeStartVolume = settings.playback.masterVolume;\r\n      fadeType        = crossfadeType;\r\n      fadePreset      = crossfadePreset;\r\n      \r\n      fadeInPlayer.setVolume(0);\r\n  \r\n      if (fadeInUid === null)\r\n        players.nextTrack(true);\r\n      else\r\n        players.jumpToTrack(players.trackFromUid(fadeInUid), true, false);\r\n  \r\n      return {\r\n        fadeOutPlayer: players.indexMap.get(fadeOutPlayer.getUid()),\r\n        fadeInPlayer:  players.indexMap.get(fadeInPlayer.getUid())\r\n      };\r\n    }\r\n  \r\n    return null;\r\n  }\r\n  \r\n  function start()\r\n  {\r\n    if (fadeState === STATE.INIT)\r\n    {\r\n      fadeState = STATE.FADING;\r\n\r\n      fadeOutPlayer.getPosition((positionMilliseconds) =>\r\n      {\r\n        const updateInterval = (fadePreset.curve === CURVE.EQUAL_POWER) ? config.intervalEqPow : config.intervalLinear;\r\n        fadeStartTime        = ((positionMilliseconds + updateInterval) / 1000);\r\n        const timeRemaining  = fadeOutPlayer.getDuration() - fadeStartTime;\r\n        const fadeRemaining  = timeRemaining - (updateInterval / 1000);\r\n  \r\n        if (fadeType === TYPE.AUTO)\r\n          fadeLength = fadeRemaining;\r\n        else if (fadeType === TYPE.TRACK)\r\n          fadeLength = (timeRemaining > fadePreset.length) ? fadePreset.length : fadeRemaining;\r\n  \r\n        debug.log(`start() - fadeStartTime: ${fadeStartTime.toFixed(2)} sec - timeRemaining: ${timeRemaining.toFixed(2)} sec - fadeLength: ${fadeLength.toFixed(2)} sec - updateInterval: ${updateInterval} ms`);\r\n  \r\n        intervalId = setInterval((fadePreset.curve === CURVE.EQUAL_POWER) ? equalPowerFade : linearFade, updateInterval);\r\n      });\r\n    }\r\n  }\r\n  \r\n  function stop()\r\n  {\r\n    debug.log(`stop() - fadeState: ${debug.getObjectKeyForValue(STATE, fadeState)}`);\r\n  \r\n    if (fadeState !== STATE.NONE)\r\n    {\r\n      if (intervalId !== -1)\r\n      {\r\n        clearInterval(intervalId);\r\n        intervalId = -1;\r\n      }\r\n  \r\n      if (fadeOutPlayer !== null)\r\n      {\r\n        fadeOutPlayer.pause();\r\n        fadeOutPlayer.seekTo(0);\r\n  \r\n        // ToDo: Temp fix for: This might POP on fade out end, check if there is a safer way to reset the volume\r\n        setTimeout(() =>\r\n        {\r\n          fadeOutPlayer.setVolume(settings.playback.masterVolume); // ToDo: fadeStartVolume is 0 because of setTimeout()\r\n          fadeOutPlayer = null;\r\n        },\r\n        200);\r\n      }\r\n    \r\n      if (fadeInPlayer !== null)\r\n        fadeInPlayer = null;\r\n    \r\n      fadeState       = STATE.NONE;\r\n      fadeLength      = 0;\r\n      fadeStartVolume = 0;\r\n      fadeType        = TYPE.NONE;\r\n      fadePreset      = null;\r\n      fadeStartTime   = 0;\r\n    }\r\n  }\r\n  \r\n  function mute(setMute)\r\n  {\r\n    if (fadeOutPlayer !== null)\r\n      fadeOutPlayer.mute(setMute);\r\n  }\r\n  \r\n  function set(fadeInUid)\r\n  {\r\n    fadeOutPlayer = players.current;\r\n    fadeInPlayer  = (fadeInUid === null) ? players.next : players.playerFromUid(fadeInUid);\r\n  \r\n    if (fadeOutPlayer.getPlayable() && fadeInPlayer.getPlayable())\r\n      return true;\r\n  \r\n    return false;\r\n  }\r\n  \r\n  //\r\n  // https://dsp.stackexchange.com/questions/14754/equal-power-crossfade\r\n  //\r\n  function equalPowerFade()\r\n  {\r\n    fadeOutPlayer.getPosition((positionMilliseconds) =>\r\n    {\r\n      // Clamp negative position values\r\n      const position     = ((positionMilliseconds / 1000) - fadeStartTime);\r\n      const fadePosition = (position >= 0) ? position : 0;\r\n  \r\n      // Clamp negative volume values\r\n      const volume     = fadeStartVolume - (fadeStartVolume * (fadePosition / fadeLength));\r\n      const fadeVolume = (volume >= VOLUME.MIN) ? volume : VOLUME.MIN;\r\n  \r\n      const fadeOutVolume = Math.round(Math.sqrt(fadeStartVolume * fadeVolume));\r\n      const fadeInVolume  = Math.round(Math.sqrt(fadeStartVolume * (fadeStartVolume - fadeVolume)));\r\n  \r\n      if ((fadePosition >= fadeLength) && (fadeVolume <= VOLUME.MIN) && (fadeInVolume >= fadeStartVolume))\r\n      {\r\n        fadeOutPlayer.setVolume(VOLUME.MIN);\r\n        fadeInPlayer.setVolume(fadeStartVolume);\r\n        stop();\r\n      }\r\n      else\r\n      {\r\n        fadeOutPlayer.setVolume(fadeOutVolume);\r\n        fadeInPlayer.setVolume(fadeInVolume);\r\n      }\r\n    });\r\n  }\r\n  \r\n  function linearFade()\r\n  {\r\n    fadeOutPlayer.getPosition((positionMilliseconds) =>\r\n    {\r\n      const fadePosition  = ((positionMilliseconds / 1000) - fadeStartTime);\r\n      const fadeInVolume  = Math.round(fadeStartVolume * (fadePosition / fadeLength));\r\n      const fadeOutVolume = fadeStartVolume - fadeInVolume;\r\n  \r\n      if ((fadePosition > fadeLength) && (fadeOutVolume < VOLUME.MIN) && (fadeInVolume > fadeStartVolume))\r\n      {\r\n        fadeOutPlayer.setVolume(VOLUME.MIN);\r\n        fadeInPlayer.setVolume(fadeStartVolume);\r\n        stop();\r\n      }\r\n      else\r\n      {\r\n        fadeOutPlayer.setVolume(fadeOutVolume);\r\n        fadeInPlayer.setVolume(fadeInVolume);\r\n      }\r\n    });\r\n  }\r\n});\r\n", "//\r\n// Embedded media player classes + playlist\r\n//\r\n// https://ultrafunk.com\r\n//\r\n\r\n\r\nimport * as debugLogger from '../shared/debuglogger.js';\r\nimport { VOLUME }       from './gallery/crossfade.js';\r\n\r\n\r\n/*************************************************************************************************/\r\n\r\n\r\nconst debug = debugLogger.newInstance('mediaplayers');\r\n\r\n\r\n// ************************************************************************************************\r\n// MediaPlayer parent class\r\n// ************************************************************************************************\r\n\r\nclass MediaPlayer\r\n{\r\n  constructor(trackId, iframeId, embeddedPlayer)\r\n  {\r\n    this.trackId        = trackId;\r\n    this.iframeId       = iframeId;\r\n    this.embeddedPlayer = embeddedPlayer;\r\n    this.playable       = true;\r\n\r\n    this.duration = 0;\r\n    this.artist   = null;\r\n    this.title    = null;\r\n\r\n    this.thumbnailSrc       = null;\r\n    this.thumbnailClass     = 'type-default';\r\n    this.thumbnail          = new Image();\r\n    this.thumbnail.decoding = 'async';\r\n  }\r\n  \r\n  getTrackId()          { return this.trackId;                   }\r\n  getIframeId()         { return this.iframeId;                  }\r\n  getUid()              { return this.iframeId;                  }\r\n  getEmbeddedPlayer()   { return this.embeddedPlayer;            }\r\n\r\n  getPlayable()         { return this.playable;                  }\r\n  setPlayable(playable) { this.playable = playable;              }\r\n\r\n  getDuration()         { return this.duration;                  }\r\n  setDuration(duration) { this.duration = duration;              }\r\n\r\n  getArtist()           { return this.artist;                    }\r\n  setArtist(artist)     { this.artist = artist;                  }\r\n\r\n  getTitle()            { return this.title;                     }\r\n  setTitle(title)       { this.title = title;                    }\r\n\r\n  getThumbnailSrc()     { return this.thumbnailSrc;              }\r\n  getThumbnailClass()   { return this.thumbnailClass;            }\r\n\r\n  seekTo(position)      { this.embeddedPlayer.seekTo(position);  }\r\n  setVolume(volume)     { this.embeddedPlayer.setVolume(volume); }\r\n\r\n  setThumbnail(thumbnail)\r\n  {\r\n    this.thumbnailSrc   = thumbnail.src;\r\n    this.thumbnailClass = thumbnail.class;\r\n    this.thumbnail.src  = thumbnail.src;\r\n  }\r\n}\r\n\r\n\r\n// ************************************************************************************************\r\n// YouTube child class\r\n// ************************************************************************************************\r\n\r\nexport class YouTube extends MediaPlayer\r\n{\r\n  constructor(trackId, iframeId, embeddedPlayer, trackSourceUrl)\r\n  {\r\n    super(trackId, iframeId, embeddedPlayer);\r\n    this.previousPlayerState = -1;\r\n    super.setThumbnail(getYouTubeImgUrl(trackSourceUrl));\r\n  }\r\n\r\n  pause() { this.embeddedPlayer.pauseVideo(); }\r\n  stop()  { this.embeddedPlayer.stopVideo();  }\r\n\r\n  //\r\n  // ToDo: Remove if no longer needed??\r\n  // Handles YouTube iframe API edge case that causes playVideo() to silently fail with no API errors\r\n  //\r\n  isPlaybackError(onErrorCallback)\r\n  {\r\n    debug.log(`YouTube.play() - current playerState: ${this.embeddedPlayer.getPlayerState()} - previous playerState: ${this.previousPlayerState} - playable: ${this.playable}`);\r\n\r\n    if ((this.embeddedPlayer.getPlayerState() === -1) && (this.previousPlayerState === -1) && (this.playable === true))\r\n    {\r\n      debug.warn(`MediaPlayer.YouTube.play() - Unable to play track: ${this.getArtist()} - \"${this.getTitle()}\" with videoId: ${this.embeddedPlayer.getVideoData().video_id} -- No YouTube API error given!`);\r\n\r\n      this.playable = false;\r\n      onErrorCallback(this, this.embeddedPlayer.getVideoUrl());\r\n\r\n      return true;\r\n    }\r\n\r\n    this.previousPlayerState = this.embeddedPlayer.getPlayerState();\r\n\r\n    return false;\r\n  }\r\n\r\n  play(onErrorCallback)\r\n  {\r\n    if (this.isPlaybackError(onErrorCallback) === false)\r\n    {\r\n      if (this.playable === true)\r\n        this.embeddedPlayer.playVideo();\r\n      else\r\n        onErrorCallback(this, this.embeddedPlayer.getVideoUrl());\r\n    }\r\n  }\r\n\r\n  getVolume(callback)\r\n  {\r\n    callback(this.embeddedPlayer.getVolume());\r\n  }\r\n\r\n  mute(setMute)\r\n  {\r\n    if (setMute)\r\n      this.embeddedPlayer.mute();\r\n    else\r\n      this.embeddedPlayer.unMute();\r\n  }\r\n\r\n  getPosition(callback)\r\n  {\r\n    callback((this.embeddedPlayer.getCurrentTime() * 1000), this.duration);\r\n  }\r\n}\r\n\r\n\r\n// ************************************************************************************************\r\n// SoundCloud child class\r\n// ************************************************************************************************\r\n\r\nexport class SoundCloud extends MediaPlayer\r\n{\r\n  constructor(trackId, iframeId, embeddedPlayer, iframeSrc)\r\n  {\r\n    super(trackId, iframeId, embeddedPlayer);\r\n    this.soundId = this.getSoundId(iframeSrc);\r\n    this.volume  = VOLUME.MAX;\r\n    this.muted   = false;\r\n  }\r\n\r\n  getSoundId(iframeSrc)\r\n  {\r\n    if (iframeSrc)\r\n    {\r\n      const iframeSrcParts = new URL(decodeURIComponent(iframeSrc));\r\n      const trackUrl       = iframeSrcParts.searchParams.get('url');\r\n      \r\n      if (trackUrl !== null)\r\n      {\r\n        const trackUrlParts = trackUrl.split('/');\r\n        const tracksString  = 'tracks'.toUpperCase();\r\n  \r\n        for (let i = 0; i < trackUrlParts.length; i++)\r\n        {\r\n          if (trackUrlParts[i].toUpperCase() === tracksString)\r\n            return parseInt(trackUrlParts[i + 1]);\r\n        }\r\n      }\r\n    }\r\n    \r\n    debug.error(`MediaPlayer.SoundCloud.getSoundId() failed for: ${this.iframeId}`);\r\n\r\n    return null;\r\n  }\r\n\r\n  setThumbnail(trackThumbnailUrlElement)\r\n  {\r\n    this.embeddedPlayer.getCurrentSound(soundObject =>\r\n    {\r\n      super.setThumbnail(getSoundCloudImgUrl(soundObject));\r\n      trackThumbnailUrlElement?.setAttribute('data-track-thumbnail-url', this.getThumbnailSrc());\r\n    });\r\n  }\r\n\r\n  // Override parent getUid() because SoundCloud provides its own UID\r\n  getUid() { return this.soundId;         }\r\n  pause()  { this.embeddedPlayer.pause(); }\r\n  \r\n  play(onErrorCallback)\r\n  {\r\n    // playable is set to FALSE if the widget fires SC.Widget.Events.ERROR (track does not exist)\r\n    if (this.playable === true)\r\n    {\r\n      this.embeddedPlayer.getCurrentSound(soundObject =>\r\n      {\r\n        if (soundObject.playable === true)\r\n          this.embeddedPlayer.play();\r\n        else\r\n          onErrorCallback(this, soundObject.permalink_url);\r\n      });\r\n    }\r\n    else\r\n    {\r\n      onErrorCallback(this, 'https://soundcloud.com');\r\n    }\r\n  }\r\n  \r\n  stop()\r\n  {\r\n    this.pause();\r\n    super.seekTo(0);\r\n  }\r\n\r\n  // Override parent because SoundCloud seekTo() needs milliseconds instead of just seconds\r\n  seekTo(positionSeconds)\r\n  {\r\n    super.seekTo(positionSeconds * 1000);\r\n  }\r\n  \r\n  getVolume(callback)\r\n  {\r\n    this.embeddedPlayer.getVolume(volume => callback(volume));\r\n  }\r\n\r\n  // Override parent setVolume() because we use it for mute() as well \r\n  setVolume(volume)\r\n  {\r\n    if (volume !== 0)\r\n      this.volume = volume;\r\n\r\n    if ((this.muted === false) || (volume === 0))\r\n      super.setVolume(volume);\r\n  }\r\n\r\n  mute(setMute)\r\n  {\r\n    this.muted = setMute ? true : false;\r\n\r\n    if (setMute)\r\n      this.setVolume(0);\r\n    else\r\n      this.setVolume(this.volume);\r\n  }\r\n\r\n  getPosition(callback)\r\n  {\r\n    this.embeddedPlayer.getPosition(positionMilliseconds => callback(positionMilliseconds, this.duration));\r\n  }\r\n}\r\n\r\n\r\n// ************************************************************************************************\r\n// Playlist child class\r\n// ************************************************************************************************\r\n\r\nexport class Playlist extends MediaPlayer\r\n{\r\n  constructor(embeddedPlayer)\r\n  {\r\n    super(null, null, embeddedPlayer);\r\n    this.numTracks    = 3;\r\n    this.currentTrack = 2;\r\n    this.playerState  = -1; // YT.PlayerState.UNSTARTED\r\n  }\r\n\r\n  get embedded()        { return this.embeddedPlayer; }\r\n  getNumTracks()        { return this.numTracks;      }\r\n  getCurrentTrack()     { return this.currentTrack;   }\r\n  setPlayerState(state) { this.playerState = state;   }\r\n\r\n  play(onErrorCallback)\r\n  {\r\n    //YT.PlayerState.CUED === 5\r\n    if ((this.playerState === 5) && (this.embeddedPlayer.getDuration() === 0))\r\n    {\r\n      onErrorCallback({ data: 'Unable to play track -- No YouTube API error given!' });\r\n      this.playerState = -1; // YT.PlayerState.UNSTARTED\r\n    }\r\n    else\r\n    {\r\n      this.embeddedPlayer.playVideo();\r\n    }\r\n  }\r\n\r\n  setThumbnail(youTubeVideoId)\r\n  {\r\n    super.setThumbnail(getYouTubeImgUrl(`youtube.com/watch?v=${youTubeVideoId}`));\r\n  }\r\n\r\n  getTrackData()\r\n  {\r\n    return {\r\n      currentTrack: this.getCurrentTrack(),\r\n      numTracks:    this.getNumTracks(),\r\n      artist:       this.getArtist(),\r\n      title:        this.getTitle(),\r\n      thumbnail:    { src: this.getThumbnailSrc(), class: this.getThumbnailClass() },\r\n    };\r\n  }\r\n}\r\n\r\n\r\n// ************************************************************************************************\r\n// MediaPlayer class support functions\r\n// ************************************************************************************************\r\n\r\n// Default / fallback track thumbnail object\r\nconst defThumbnailObj = { src: '/wp-content/themes/ultrafunk/inc/img/photo_filled_grey.png', class: 'type-default', uid: '' };\r\nexport const youTubeVideoIdRegEx = /[0-9A-Za-z_-]{10}[048AEIMQUYcgkosw]/;\r\n\r\nexport function getYouTubeImgUrl(trackSourceUrl)\r\n{\r\n  const youTubeVideoId = trackSourceUrl.match(youTubeVideoIdRegEx);\r\n\r\n  if (youTubeVideoId !== null)\r\n    return { src: `https://img.youtube.com/vi/${youTubeVideoId[0]}/default.jpg`, class: 'type-youtube', uid: youTubeVideoId[0] };\r\n\r\n  return defThumbnailObj;\r\n}\r\n\r\nfunction getSoundCloudImgUrl(soundObject)\r\n{\r\n  const thumbnailSrc = (soundObject.artwork_url !== null)\r\n                         ? soundObject.artwork_url\r\n                         : soundObject.user.avatar_url;\r\n\r\n  if (thumbnailSrc)\r\n    return { src: thumbnailSrc, class: 'type-soundcloud', uid: '' };\r\n\r\n  return defThumbnailObj;\r\n}\r\n", "//\r\n// Shared utility functions\r\n//\r\n// https://ultrafunk.com\r\n//\r\n\r\n\r\nimport * as debugLogger     from './debuglogger.js';\r\nimport { settings }         from './session-data.js';\r\nimport { TRACK_TYPE }       from '../playback/shared-gallery-list.js';\r\nimport { PREF_PLAYER }      from './settings/settings.js';\r\nimport { showSnackbar }     from './snackbar.js';\r\nimport { getYouTubeImgUrl } from '../playback/mediaplayers.js';\r\n\r\n\r\n/*************************************************************************************************/\r\n\r\n\r\nconst debug = debugLogger.newInstance('utils');\r\n\r\nexport const SITE_URL = debug.isDebug() ? 'https://wordpress.ultrafunk.com'      : 'https://ultrafunk.com';\r\nconst SITE_URL_LIST   = debug.isDebug() ? 'https://wordpress.ultrafunk.com/list' : 'https://ultrafunk.com/list';\r\n\r\nconst validUrlRegEx = debug.isDebug()\r\n                        ? /^https:\\/\\/wordpress\\.ultrafunk\\.com[/?=%A-Za-z0-9\\-_.~+]*$/\r\n                        : /^https:\\/\\/ultrafunk\\.com[/?=%A-Za-z0-9\\-_.~+]*$/;\r\n\r\nconst DOMParserInstance = new DOMParser();\r\n\r\nexport const MATCH = {\r\n  SITE_MIN_WIDTH_WIDE:   1,\r\n  SITE_MAX_WIDTH:        2,\r\n  SITE_MAX_WIDTH_MOBILE: 3,\r\n};\r\n\r\nconst siteMinWidthWide   = window.matchMedia(`(min-width: ${getCssPropString('--site-min-width-wide')})`);\r\nconst siteMaxWidth       = window.matchMedia(`(max-width: ${getCssPropString('--site-max-width')})`);\r\nconst siteMaxWidthMobile = window.matchMedia(`(max-width: ${getCssPropString('--site-max-width-mobile')})`);\r\n\r\n\r\n// ************************************************************************************************\r\n// Misc. shared utility functions\r\n// ************************************************************************************************\r\n\r\nexport function addListener(selectors, type, listener, data = null)\r\n{\r\n  document.querySelector(selectors)?.addEventListener(type, (event) => listener(event, data));\r\n}\r\n\r\n// Plain JS function equivalent to jQuery(selectors).eventX();\r\n// Adds event listeners of 'type' to all matching selectors \r\nexport function addListenerAll(selectors, type, listener, data = null)\r\n{\r\n  const elementList = document.querySelectorAll(selectors);\r\n  elementList.forEach(element => element.addEventListener(type, (event) => listener(event, data)));\r\n}\r\n\r\nexport function getCssPropString(prop, element = document.documentElement)\r\n{\r\n  let string = getComputedStyle(element).getPropertyValue(prop);\r\n\r\n  if (string.length !== 0)\r\n    string = string.replace(/'|\"/g, '').trim();\r\n  else\r\n    debug.error(`getCssPropString(${prop}): Returned CSS property string is empty`);\r\n\r\n  return string;\r\n}\r\n\r\nexport function getCssPropValue(prop, element = document.documentElement)\r\n{\r\n  const string = getCssPropString(prop, element);\r\n  let value    = NaN;\r\n\r\n  if (string.length !== 0)\r\n    value = parseInt(string);\r\n\r\n  if (isNaN(value))\r\n    debug.error(`getCssPropValue(${prop}): Returned CSS property value is NaN`);\r\n\r\n  return value;\r\n}\r\n\r\n// Match against live CSS media queries defined in style.css\r\nexport function matchesMedia(matchMedia)\r\n{\r\n  switch (matchMedia)\r\n  {\r\n    case MATCH.SITE_MIN_WIDTH_WIDE:\r\n      return siteMinWidthWide.matches;\r\n      \r\n    case MATCH.SITE_MAX_WIDTH:\r\n      return siteMaxWidth.matches;\r\n\r\n    case MATCH.SITE_MAX_WIDTH_MOBILE:\r\n      return siteMaxWidthMobile.matches;\r\n  }\r\n\r\n  return false;\r\n}\r\n\r\nexport function replaceClass(element, removeClass, addClass)\r\n{\r\n  element.classList.remove(removeClass);\r\n  element.classList.add(addClass);\r\n}\r\n\r\n\r\n// ************************************************************************************************\r\n// https://github.com/janl/mustache.js/blob/master/mustache.js#L59\r\n// ************************************************************************************************\r\n\r\nconst entityMap = {\r\n  '&': '&amp;',\r\n  '<': '&lt;',\r\n  '>': '&gt;',\r\n  '\"': '&quot;',\r\n  \"'\": '&#39;',\r\n  '`': '&#x60;',\r\n  '=': '&#x3D;',\r\n  '/': '&#x2F;',\r\n};\r\n\r\nexport function escHtml(string)\r\n{\r\n  return String(string).replace(/[&<>\"'`=/]/g, (s) => entityMap[s]);\r\n}\r\n\r\nexport function escAttribute(element, attribute)\r\n{\r\n  const value = element.getAttribute(attribute);\r\n\r\n  if (value !== null)\r\n    return escHtml(value);\r\n\r\n  return value;\r\n}\r\n\r\n//\r\n// ToDo: Replace with DOMPurify or the HTML Sanitizer API: https://github.com/WICG/sanitizer-api\r\n//\r\nexport function stripHtml(string)\r\n{\r\n  const firstPass  = DOMParserInstance.parseFromString(string, 'text/html');\r\n  const secondPass = DOMParserInstance.parseFromString(firstPass.body.textContent, 'text/html');\r\n\r\n//debug.log(`stripHtml(DOMParser): ${secondPass.body.textContent}`);\r\n\r\n  return secondPass.body.textContent;\r\n}\r\n\r\nexport function stripAttribute(element, attribute)\r\n{\r\n  const value = element.getAttribute(attribute);\r\n\r\n  if (value !== null)\r\n    return stripHtml(value);\r\n  \r\n  return value;\r\n}\r\n\r\n\r\n// ************************************************************************************************\r\n// \r\n// ************************************************************************************************\r\n\r\nexport function navToUrl(destUrl)\r\n{\r\n  if (destUrl && (destUrl.match(validUrlRegEx) !== null))\r\n  {\r\n    debug.log(`navToUrl() - Valid destUrl: ${destUrl}`);\r\n    window.location.href = destUrl;\r\n  }\r\n  else if (destUrl !== null)\r\n  {\r\n    debug.error(`navToUrl() - Invalid destUrl: ${destUrl}`);\r\n    showSnackbar('Error navigating to URL!', 0, 'Reload', () => location.reload());\r\n  }\r\n}\r\n\r\nexport function getListPlayerUrl(destUrl)\r\n{\r\n  return destUrl.replace(SITE_URL, SITE_URL_LIST);\r\n}\r\n\r\nexport function getGalleryPlayerUrl(destUrl)\r\n{\r\n  return destUrl.replace(SITE_URL_LIST, SITE_URL);  \r\n}\r\n\r\nexport function getPrefPlayerUrl(destUrl)\r\n{\r\n  if (destUrl)\r\n  {\r\n    if (settings.playback.preferredPlayer === PREF_PLAYER.LIST)\r\n    {\r\n      if (destUrl.startsWith(SITE_URL_LIST) === false)\r\n        return getListPlayerUrl(destUrl);\r\n    }\r\n    else if (settings.playback.preferredPlayer === PREF_PLAYER.GALLERY)\r\n    {\r\n      if (destUrl.startsWith(SITE_URL_LIST) === true)\r\n        return getGalleryPlayerUrl(destUrl);\r\n    }\r\n  }\r\n\r\n  return destUrl;\r\n}\r\n\r\nexport function getThumbnailData(metaData)\r\n{\r\n  if (metaData.track_source_type === TRACK_TYPE.YOUTUBE)\r\n    return getYouTubeImgUrl(metaData.track_source_data);\r\n\r\n  return { src: '/wp-content/themes/ultrafunk/inc/img/sc_thumbnail_placeholder.png', class: 'type-soundcloud', uid: '' };\r\n}\r\n", "//\r\n// Snackbar UI module\r\n//\r\n// https://ultrafunk.com\r\n//\r\n\r\n\r\nimport * as debugLogger        from './debuglogger.js';\r\nimport { MATCH, matchesMedia } from './utils.js';\r\n\r\n\r\n/*************************************************************************************************/\r\n\r\n\r\nconst debug = debugLogger.newInstance('snackbar');\r\n\r\nconst m = {\r\n  snackbarId:       0,\r\n  actionClick:      null,\r\n  afterClose:       null,\r\n  visibleTimeoutId: -1,\r\n  fadeTimeoutId:    -1,\r\n};\r\n\r\nconst config = { id: 'snackbar' };\r\n\r\nconst template = `\r\n  <div id=\"${config.id}\">\r\n    <div class=\"${config.id}-container\">\r\n      <div class=\"${config.id}-message\"></div>\r\n      <div class=\"${config.id}-action-text\"></div>\r\n      <div class=\"${config.id}-close-icon\"><span class=\"material-icons\" title=\"Dismiss\">close</span></div>\r\n    </div>\r\n  </div>\r\n`;\r\n\r\nconst elements = {\r\n  snackbar:   null,\r\n  actionText: null,\r\n  closeIcon:  null,\r\n};\r\n\r\n\r\n// ************************************************************************************************\r\n// \r\n// ************************************************************************************************\r\n\r\nexport function showSnackbar(message, timeout = 5, actionText = null, actionClickCallback = null, afterCloseCallback = () => {})\r\n{\r\n  debug.log(`showSnackbar(): ${message} (${timeout} sec.)`);\r\n\r\n  init();\r\n  reset();\r\n\r\n  elements.snackbar.querySelector(`.${config.id}-message`).innerHTML = message;\r\n  elements.snackbar.classList.add('show');\r\n  elements.actionText.style.display = 'none';\r\n  m.afterClose = afterCloseCallback;\r\n\r\n  if ((actionText !== null) && (actionClickCallback !== null))\r\n  {\r\n    m.actionClick = actionClickCallback;\r\n    elements.actionText.style.display = 'block';\r\n    elements.actionText.textContent   = actionText;\r\n    elements.actionText.addEventListener('click', actionTextClick);\r\n  }\r\n  else\r\n  {\r\n    // Fix edge case when actionText is hidden...\r\n    if (matchesMedia(MATCH.SITE_MAX_WIDTH_MOBILE))\r\n      elements.closeIcon.style.paddingLeft = '10px';\r\n    else\r\n      elements.closeIcon.style.paddingLeft = '20px';\r\n  }\r\n  \r\n  if (timeout !== 0)\r\n  {\r\n    m.visibleTimeoutId = setTimeout(() =>\r\n    {\r\n      elements.snackbar.classList.add('hide');\r\n      \r\n      m.fadeTimeoutId = setTimeout(() =>\r\n      {\r\n        elements.snackbar.className = '';\r\n        m.afterClose();\r\n      }, 450);\r\n    },\r\n    (timeout * 1000));\r\n  }\r\n\r\n  return ++m.snackbarId;\r\n}\r\n\r\nexport function dismissSnackbar(dismissId = 0)\r\n{\r\n  if (isShowing())\r\n  {\r\n    if ((m.snackbarId === 0) || (m.snackbarId === dismissId))\r\n    {\r\n      elements.snackbar.classList.add('hide');\r\n      m.fadeTimeoutId = setTimeout(() => (elements.snackbar.className = ''), 450);\r\n    }\r\n  }\r\n}\r\n\r\n\r\n// ************************************************************************************************\r\n// \r\n// ************************************************************************************************\r\n\r\nfunction init()\r\n{\r\n  if (elements.snackbar === null)\r\n  {\r\n    document.body.insertAdjacentHTML('beforeend', template);\r\n\r\n    elements.snackbar   = document.getElementById(config.id);\r\n    elements.actionText = elements.snackbar.querySelector(`.${config.id}-action-text`);\r\n    elements.closeIcon  = elements.snackbar.querySelector(`.${config.id}-close-icon`);\r\n    \r\n    elements.closeIcon.addEventListener('click', () =>\r\n    {\r\n      m.afterClose();\r\n      reset(true);\r\n    });\r\n  }\r\n}\r\n\r\nfunction actionTextClick()\r\n{\r\n  m.actionClick();\r\n  reset(true);\r\n}\r\n\r\nfunction isShowing()\r\n{\r\n  return ((elements.snackbar !== null)               &&\r\n          (elements.snackbar.classList.length === 1) &&\r\n           elements.snackbar.classList.contains('show'));\r\n}\r\n\r\nfunction reset(hideSnackbar = false)\r\n{\r\n  if (m.visibleTimeoutId !== -1)\r\n  {\r\n    clearTimeout(m.visibleTimeoutId);\r\n    m.visibleTimeoutId = -1;\r\n  }\r\n\r\n  if (m.fadeTimeoutId !== -1)\r\n  {\r\n    clearTimeout(m.fadeTimeoutId);\r\n    m.fadeTimeoutId = -1;\r\n  }\r\n\r\n  if (elements.actionText !== null)\r\n    elements.actionText.removeEventListener('click', actionTextClick);\r\n\r\n  if (hideSnackbar)\r\n    elements.snackbar.classList.remove('show');\r\n}\r\n"],
  "mappings": "6FAcA,YACA,CACE,YAAY,EAAa,UACzB,CACE,KAAK,WAAa,GAAU,EAAW,cAAe,GAAI,KAG5D,SAAY,CAAE,MAAO,GACrB,KAAK,EAAO,CAAE,QAAQ,KAAK,GAAG,KAAK,cAAgB,GACnD,MAAM,EAAM,CAAE,QAAQ,MAAM,GAAG,KAAK,cAAe,KAqCrD,oBAAwB,GACxB,CACE,YAAY,EAAY,CAAE,MAAM,GAEhC,KAAuB,EACvB,aAAuB,EACvB,sBAAuB,IAQlB,WAAqB,EAC5B,CACE,MAEW,IAAI,IAAU,GAG3B,YAAmB,EAAQ,EAAW,EACtC,CACE,MAAS,GAAO,OAAS,EACd,EAAO,MAAM,EAAG,GAChB,EAAO,OAAO,EAAW,GAG/B,YAA0B,EAAe,EAChD,CACE,GAAM,GAAc,EAAU,SAAW,MAAQ,EAAU,WAE3D,QAAQ,KAAK,uBAAuB,OAAmB,KAEvD,KAAK,QAAS,EACd,CACE,eAAgB,EAChB,YAAgB,2BChFpB,GAAM,GAAU,EACV,EAAU,EACV,EAAU,EAEH,GAAc,CACzB,KAAS,EACT,QAAS,EACT,KAAS,GASL,GAA6B,CAAC,GAAG,MAAM,IAAI,QAAQ,IAAI,GAAK,EAAI,GAChE,GAA6B,CAAC,GAAG,MAAM,IAAI,QAAQ,IAAI,GAAK,GAAG,EAAI,KAE5D,EAAiB,CAC5B,QAAS,CAAE,YAAa,GAAI,KAAM,EAAS,OAAQ,CAAC,EAAG,QAAS,QAAS,EAAG,aAAc,IAC1F,SAAU,CACR,gBAAsB,CAAE,YAAa,mBAAmC,KAAM,EAAS,OAAQ,CAAC,EAAG,GAAkB,QAAS,EAAO,aAAc,CAAC,UAAW,SAC/J,kBAAsB,CAAE,YAAa,qBAAmC,KAAM,EAAS,OAAQ,CAAC,GAAM,IAAe,QAAS,GAAO,aAAc,CAAC,KAAM,QAC1J,aAAsB,CAAE,YAAa,gBAAmC,KAAM,EAAS,OAAQ,CAAC,EAAG,GAAI,GAAI,GAAI,KAAM,QAAS,IAAO,aAAc,CAAC,KAAM,MAAO,MAAO,MAAO,SAC/K,WAAsB,CAAE,YAAa,cAAmC,KAAM,EAAS,OAAQ,CAAC,GAAM,IAAe,QAAS,GAAO,aAAc,CAAC,KAAM,QAC1J,SAAsB,CAAE,YAAa,sBAAmC,KAAM,EAAS,OAAQ,CAAC,GAAM,IAAe,QAAS,GAAO,aAAc,CAAC,KAAM,QAC1J,mBAAsB,CAAE,YAAa,gCAAmC,KAAM,EAAS,OAAQ,CAAC,GAAM,IAAe,QAAS,GAAO,aAAc,CAAC,KAAM,QAC1J,qBAAsB,CAAE,YAAa,+BAAmC,KAAM,EAAS,OAAQ,CAAC,GAAM,IAAe,QAAS,GAAO,aAAc,CAAC,KAAM,QAC1J,qBAAsB,CAAE,YAAa,iCAAmC,KAAM,EAAS,OAAQ,CAAC,GAAI,GAAI,GAAI,KAAS,QAAS,GAAO,aAAc,CAAC,SAAU,SAAU,SAAU,YAClL,oBAAsB,CAAE,YAAa,kCAAmC,KAAM,EAAS,OAAQ,CAAC,GAAM,IAAe,QAAS,GAAO,aAAc,CAAC,KAAM,SAE5J,KAAM,CACJ,oBAAqB,CAAE,YAAa,6BAAqC,KAAM,EAAS,OAAQ,CAAC,GAAM,IAAQ,QAAS,GAAM,aAAc,CAAC,KAAM,QACnJ,gBAAqB,CAAE,YAAa,qBAAqC,KAAM,EAAS,OAAQ,CAAC,GAAM,IAAQ,QAAS,GAAM,aAAc,CAAC,KAAM,QACnJ,mBAAqB,CAAE,YAAa,oCAAqC,KAAM,EAAS,OAAQ,CAAC,GAAM,IAAQ,QAAS,GAAM,aAAc,CAAC,KAAM,SAErJ,QAAS,CACP,OAAyB,CAAE,YAAa,eAAqC,KAAM,EAAS,OAAQ,CAAC,WAAY,WAAY,YAAgB,QAAS,WAAY,aAAc,CAAC,WAAY,WAAY,iBACzM,cAAyB,CAAE,YAAa,oCAAqC,KAAM,EAAS,OAAQ,GAAyB,QAAS,GAAO,aAAc,IAC3J,cAAyB,CAAE,YAAa,+BAAqC,KAAM,EAAS,OAAQ,CAAC,GAAM,IAAkB,QAAS,GAAO,aAAc,CAAC,KAAM,QAClK,oBAAyB,CAAE,YAAa,wBAAqC,KAAM,EAAS,OAAQ,CAAC,EAAG,GAAI,GAAI,GAAI,GAAI,IAAK,QAAS,GAAO,aAAc,CAAC,QAAS,SAAU,SAAU,SAAU,SAAU,WAC7M,mBAAyB,CAAE,YAAa,uBAAqC,KAAM,EAAS,OAAQ,CAAC,EAAG,GAAqB,QAAS,EAAO,aAAc,CAAC,cAAe,WAC3K,WAAyB,CAAE,YAAa,2BAAqC,KAAM,EAAS,OAAQ,CAAC,GAAM,IAAkB,QAAS,GAAO,aAAc,CAAC,KAAM,QAClK,sBAAyB,CAAE,YAAa,iCAAqC,KAAM,EAAS,OAAQ,CAAC,GAAM,IAAkB,QAAS,GAAO,aAAc,CAAC,KAAM,QAClK,wBAAyB,CAAE,YAAa,8BAAqC,KAAM,EAAS,OAAQ,CAAC,EAAG,EAAG,EAAG,EAAG,EAAG,GAAS,QAAS,EAAO,aAAc,CAAC,mBAAoB,mBAAoB,mBAAoB,oBAAqB,oBAAqB,uBAEpQ,OAAQ,CACN,aAAoB,CAAE,YAAa,8BAA+B,KAAM,EAAS,OAAQ,CAAC,GAAM,IAAQ,QAAS,GAAO,aAAc,CAAC,KAAM,QAC7I,eAAoB,CAAE,YAAa,mBAA+B,KAAM,EAAS,OAAQ,CAAC,GAAM,IAAQ,QAAS,GAAO,aAAc,CAAC,KAAM,QAC7I,mBAAoB,CAAE,YAAa,uBAA+B,KAAM,EAAS,OAAQ,CAAC,GAAM,IAAQ,QAAS,GAAO,aAAc,CAAC,KAAM,SAE/I,KAAM,CACJ,kBAAmB,CAAE,YAAa,qBAAyC,KAAM,EAAS,OAAQ,CAAC,GAAM,IAAoB,QAAS,GAAQ,aAAc,CAAC,KAAM,QACnK,MAAmB,CAAE,YAAa,QAAyC,KAAM,EAAS,OAAQ,CAAC,QAAS,OAAQ,QAAS,QAAS,OAAQ,aAAc,CAAC,QAAS,OAAQ,kBAC9K,gBAAmB,CAAE,YAAa,wCAAyC,KAAM,EAAS,OAAQ,CAAC,GAAM,IAAoB,QAAS,GAAQ,aAAc,CAAC,KAAM,SAErK,KAAM,CACJ,qBAA+B,CAAE,YAAa,GAAI,KAAM,EAAS,OAAQ,CAAC,GAAM,IAAQ,QAAS,GAAO,aAAc,IACtH,oBAA+B,CAAE,YAAa,GAAI,KAAM,EAAS,OAAQ,CAAC,GAAM,IAAQ,QAAS,GAAO,aAAc,IACtH,8BAA+B,CAAE,YAAa,GAAI,KAAM,EAAS,OAAQ,CAAC,GAAM,IAAQ,QAAS,GAAO,aAAc,IACtH,2BAA+B,CAAE,YAAa,GAAI,KAAM,EAAS,OAAQ,CAAC,GAAM,IAAQ,QAAS,GAAO,aAAc,IACtH,mBAA+B,CAAE,YAAa,GAAI,KAAM,EAAS,OAAQ,CAAC,GAAM,IAAQ,QAAS,GAAO,aAAc,KAExH,QAAS,CACP,mBAAoB,CAAE,YAAa,GAAI,KAAM,EAAS,OAAQ,CAAC,GAAM,IAAQ,QAAS,GAAM,aAAc,IAC1G,iBAAoB,CAAE,YAAa,GAAI,KAAM,EAAS,OAAQ,CAAC,GAAM,IAAQ,QAAS,GAAM,aAAc,IAC1G,eAAoB,CAAE,YAAa,GAAI,KAAM,EAAS,OAAQ,CAAC,GAAM,IAAQ,QAAS,GAAM,aAAc,MAIjG,GAAkB,CAC7B,QAAS,EAAe,QAAQ,QAChC,SAAU,CACR,gBAAsB,EAAe,SAAS,gBAAgB,QAC9D,kBAAsB,EAAe,SAAS,kBAAkB,QAChE,aAAsB,EAAe,SAAS,aAAa,QAC3D,WAAsB,EAAe,SAAS,WAAW,QACzD,SAAsB,EAAe,SAAS,SAAS,QACvD,mBAAsB,EAAe,SAAS,mBAAmB,QACjE,qBAAsB,EAAe,SAAS,qBAAqB,QACnE,qBAAsB,EAAe,SAAS,qBAAqB,QACnE,oBAAsB,EAAe,SAAS,oBAAoB,SAEpE,KAAM,CACJ,oBAAqB,EAAe,KAAK,oBAAoB,QAC7D,gBAAqB,EAAe,KAAK,gBAAgB,QACzD,mBAAqB,EAAe,KAAK,mBAAmB,SAE9D,QAAS,CACP,OAAyB,EAAe,QAAQ,OAAO,QACvD,cAAyB,EAAe,QAAQ,cAAc,QAC9D,cAAyB,EAAe,QAAQ,cAAc,QAC9D,oBAAyB,EAAe,QAAQ,oBAAoB,QACpE,mBAAyB,EAAe,QAAQ,mBAAmB,QACnE,WAAyB,EAAe,QAAQ,WAAW,QAC3D,sBAAyB,EAAe,QAAQ,sBAAsB,QACtE,wBAAyB,EAAe,QAAQ,wBAAwB,SAE1E,OAAQ,CACN,aAAoB,EAAe,OAAO,aAAa,QACvD,eAAoB,EAAe,OAAO,eAAe,QACzD,mBAAoB,EAAe,OAAO,mBAAmB,SAE/D,KAAM,CACJ,kBAAmB,EAAe,KAAK,kBAAkB,QACzD,MAAmB,EAAe,KAAK,MAAM,QAC7C,gBAAmB,EAAe,KAAK,gBAAgB,SAEzD,KAAM,CACJ,qBAA+B,EAAe,KAAK,qBAAqB,QACxE,oBAA+B,EAAe,KAAK,oBAAoB,QACvE,8BAA+B,EAAe,KAAK,8BAA8B,QACjF,2BAA+B,EAAe,KAAK,2BAA2B,QAC9E,mBAA+B,EAAe,KAAK,mBAAmB,SAExE,QAAS,CACP,mBAAoB,EAAe,QAAQ,mBAAmB,QAC9D,iBAAoB,EAAe,QAAQ,iBAAiB,QAC5D,eAAoB,EAAe,QAAQ,eAAe,UASjD,EAAgB,CAC3B,QAAS,CAAE,YAAa,GAAI,KAAM,EAAS,OAAQ,CAAC,EAAG,QAAS,QAAS,EAAG,aAAc,IAC1F,UAAW,CACT,CACE,KAAQ,CAAE,YAAa,WAAoB,KAAM,EAAS,OAAQ,CAAC,EAAG,IAAqB,QAAS,eAAgB,aAAc,IAClI,OAAQ,CAAE,YAAa,mBAAoB,KAAM,EAAS,OAAQ,CAAC,EAAG,GAAI,GAAI,GAAI,GAAI,IAAK,QAAS,GAAgB,aAAc,CAAC,QAAS,SAAU,SAAU,SAAU,SAAU,WACpL,MAAQ,CAAE,YAAa,kBAAoB,KAAM,EAAS,OAAQ,CAAC,EAAG,GAAqB,QAAS,EAAgB,aAAc,CAAC,cAAe,YAEpJ,CACE,KAAQ,CAAE,YAAa,WAAoB,KAAM,EAAS,OAAQ,CAAC,EAAG,IAAqB,QAAS,eAAgB,aAAc,IAClI,OAAQ,CAAE,YAAa,mBAAoB,KAAM,EAAS,OAAQ,CAAC,EAAG,GAAI,GAAI,GAAI,GAAI,IAAK,QAAS,GAAgB,aAAc,CAAC,QAAS,SAAU,SAAU,SAAU,SAAU,WACpL,MAAQ,CAAE,YAAa,kBAAoB,KAAM,EAAS,OAAQ,CAAC,EAAG,GAAqB,QAAS,EAAgB,aAAc,CAAC,cAAe,YAEpJ,CACE,KAAQ,CAAE,YAAa,WAAoB,KAAM,EAAS,OAAQ,CAAC,EAAG,IAAqB,QAAS,eAAgB,aAAc,IAClI,OAAQ,CAAE,YAAa,mBAAoB,KAAM,EAAS,OAAQ,CAAC,EAAG,GAAI,GAAI,GAAI,GAAI,IAAK,QAAS,GAAgB,aAAc,CAAC,QAAS,SAAU,SAAU,SAAU,SAAU,WACpL,MAAQ,CAAE,YAAa,kBAAoB,KAAM,EAAS,OAAQ,CAAC,EAAG,GAAqB,QAAS,EAAgB,aAAc,CAAC,cAAe,YAEpJ,CACE,KAAQ,CAAE,YAAa,WAAoB,KAAM,EAAS,OAAQ,CAAC,EAAG,IAAqB,QAAS,gBAAiB,aAAc,IACnI,OAAQ,CAAE,YAAa,mBAAoB,KAAM,EAAS,OAAQ,CAAC,EAAG,GAAI,GAAI,GAAI,GAAI,IAAK,QAAS,GAAiB,aAAc,CAAC,QAAS,SAAU,SAAU,SAAU,SAAU,WACrL,MAAQ,CAAE,YAAa,kBAAoB,KAAM,EAAS,OAAQ,CAAC,EAAG,GAAqB,QAAS,EAAiB,aAAc,CAAC,cAAe,YAErJ,CACE,KAAQ,CAAE,YAAa,WAAoB,KAAM,EAAS,OAAQ,CAAC,EAAG,IAAqB,QAAS,gBAAiB,aAAc,IACnI,OAAQ,CAAE,YAAa,mBAAoB,KAAM,EAAS,OAAQ,CAAC,EAAG,GAAI,GAAI,GAAI,GAAI,IAAK,QAAS,GAAiB,aAAc,CAAC,QAAS,SAAU,SAAU,SAAU,SAAU,WACrL,MAAQ,CAAE,YAAa,kBAAoB,KAAM,EAAS,OAAQ,CAAC,EAAG,GAAqB,QAAS,EAAiB,aAAc,CAAC,cAAe,YAErJ,CACE,KAAQ,CAAE,YAAa,WAAoB,KAAM,EAAS,OAAQ,CAAC,EAAG,IAAqB,QAAS,gBAAiB,aAAc,IACnI,OAAQ,CAAE,YAAa,mBAAoB,KAAM,EAAS,OAAQ,CAAC,EAAG,GAAI,GAAI,GAAI,GAAI,IAAK,QAAS,GAAiB,aAAc,CAAC,QAAS,SAAU,SAAU,SAAU,SAAU,WACrL,MAAQ,CAAE,YAAa,kBAAoB,KAAM,EAAS,OAAQ,CAAC,EAAG,GAAqB,QAAS,EAAiB,aAAc,CAAC,cAAe,cAK5I,GAAa,CACxB,QAAS,EAAc,QAAQ,QAC/B,UAAW,CACT,CACE,KAAQ,EAAc,UAAU,GAAG,KAAK,QACxC,OAAQ,EAAc,UAAU,GAAG,OAAO,QAC1C,MAAQ,EAAc,UAAU,GAAG,MAAM,SAE3C,CACE,KAAQ,EAAc,UAAU,GAAG,KAAK,QACxC,OAAQ,EAAc,UAAU,GAAG,OAAO,QAC1C,MAAQ,EAAc,UAAU,GAAG,MAAM,SAE3C,CACE,KAAQ,EAAc,UAAU,GAAG,KAAK,QACxC,OAAQ,EAAc,UAAU,GAAG,OAAO,QAC1C,MAAQ,EAAc,UAAU,GAAG,MAAM,SAE3C,CACE,KAAQ,EAAc,UAAU,GAAG,KAAK,QACxC,OAAQ,EAAc,UAAU,GAAG,OAAO,QAC1C,MAAQ,EAAc,UAAU,GAAG,MAAM,SAE3C,CACE,KAAQ,EAAc,UAAU,GAAG,KAAK,QACxC,OAAQ,EAAc,UAAU,GAAG,OAAO,QAC1C,MAAQ,EAAc,UAAU,GAAG,MAAM,SAE3C,CACE,KAAQ,EAAc,UAAU,GAAG,KAAK,QACxC,OAAQ,EAAc,UAAU,GAAG,OAAO,QAC1C,MAAQ,EAAc,UAAU,GAAG,MAAM,WCjM/C,GAAM,IAAQ,AAAY,EAAY,qBAO/B,YAA0B,EAAU,EAC3C,CACE,GAAI,GAAe,EAEnB,SAAkB,EAAU,GAErB,EAEP,WAA2B,EAAgB,EAC3C,CACE,OAAW,KAAO,GAEhB,GAAI,GAAkB,GAAiB,MAAO,GAAe,IAAS,UAAc,MAAO,GAAa,IAAS,SAE/G,EAAkB,EAAe,GAAM,EAAa,YAIhD,EAAa,KAAS,OAExB,AAAI,GAAe,EAAgB,EAAa,GAAM,EAAe,GAAM,IACzE,QAIF,MAAM,IAAI,MAAS,MAAO,GAAe,IAAS,SAAY,SAAW,+BAOnF,YAAwB,EAAU,EAAa,EAAc,EAC7D,CACE,OAAQ,EAAY,UAEb,GACH,GAAK,OAAO,UAAU,KAAkB,IAAW,EAAe,EAAY,OAAO,IAAQ,EAAe,EAAY,OAAO,EAAY,OAAO,OAAS,GAEzJ,UAAM,KAAK,iBAAiB,yBAAgC,OAAkB,8BAAqC,EAAY,OAAO,aAAa,EAAY,OAAO,EAAY,OAAO,OAAS,iCAAiC,EAAY,WAC/O,EAAS,GAAY,EAAY,QAC1B,GAET,UAEG,GACH,GAAK,IAAiB,IAAU,IAAiB,GAE/C,UAAM,KAAK,iBAAiB,yBAAgC,OAAkB,kDAAyD,EAAY,WACnJ,EAAS,GAAY,EAAY,QAC1B,GAET,UAEG,GACH,GAAI,MAAO,IAAiB,SAE1B,UAAM,KAAK,iBAAiB,yBAAgC,OAAkB,iDAAwD,EAAY,WAClJ,EAAS,GAAY,EAAY,QAC1B,GAET,cAGA,UAAM,KAAK,iBAAiB,wBAA+B,EAAY,QAChE,ICxEb,GAAM,GAAY,AAAY,EAAY,WACpC,GAAY,GAEL,EAAM,CAEjB,YAAqB,cACrB,kBAAqB,oBACrB,kBAAqB,oBAErB,YAAqB,cACrB,eAAqB,iBACrB,cAAqB,gBACrB,kBAAqB,oBAKrB,oBAAqB,sBACrB,oBAAqB,sBACrB,eAAqB,iBAErB,aAAqB,gBAGjB,EAAkB,CAEtB,qBAAsB,uBACtB,iBAAsB,mBACtB,cAAsB,gBACtB,gBAAsB,kBACtB,kBAAsB,oBAEtB,mBAAqB,qBACrB,oBAAqB,sBACrB,eAAqB,iBACrB,aAAqB,eACrB,cAAqB,iBAGV,GAAmB,GAAK,GAAK,GAAK,IAOxC,YAAqB,EAC5B,CACE,GAAI,GAEJ,GACA,CACE,EAAU,OAAO,GACjB,GAAM,GAAO,mBACb,SAAQ,QAAQ,EAAM,GACtB,EAAQ,WAAW,GACZ,SAEH,EAAN,CAEE,MAAO,aAAqB,eAE1B,GAAU,OAAS,IAEnB,EAAU,OAAS,MAGnB,EAAU,OAAS,sBAEnB,EAAU,OAAS,+BAElB,GAAW,EAAQ,SAAW,GAS9B,YAAmB,EAAS,EAAW,GAAI,EAAS,GAAiB,EAAO,IACnF,CACE,SAAS,OAAS,GAAG,KAAW,cAAqB,WAAgB,6BAGhE,YAAsB,EAAS,EAAO,IAC7C,CACE,SAAS,OAAS,GAAG,mDAAyD,IAuBzE,YAAkB,EAAS,EAClC,CACE,GACA,CACE,aAAa,QAAQ,EAAS,SAE1B,EAAN,CAEE,EAAM,MAAM,IAST,YAAkB,EAAS,EAAe,KAAM,EAAa,GACpE,CACE,EAAM,IAAI,eAAe,OAAa,OAAkB,KAExD,GAAM,GAAe,aAAa,QAAQ,GACtC,EAAiB,KAErB,GAAI,IAAa,KAEf,MAAI,IAAe,IAAiB,MAClC,EAAU,EAAS,GAEd,EAIP,GACA,CACE,EAAiB,KAAK,MAAM,SAExB,EAAN,CAEE,EAAM,MAAM,GAGR,IAAiB,MACnB,GAAiB,GAIvB,MAAO,GAGF,WAAmB,EAAS,EACnC,CACE,EAAM,IAAI,gBAAgB,OAAa,KAEvC,GACA,CACE,aAAa,QAAQ,EAAS,KAAK,UAAU,UAEzC,EAAN,CAEE,EAAM,MAAM,IAShB,YAAuB,EAAa,EAAa,EACjD,CACE,EAAM,IAAI,4BAA4B,kBAA4B,EAAY,sBAAsB,EAAY,WAEhH,GAAM,GAAiB,CAAE,QAAS,EAAY,SAE9C,UAAU,EAAa,EAAa,GACpC,GAAU,EAAgB,GAEnB,EAGT,YAAmB,EAAa,EAAa,EAC7C,CACE,OAAW,KAAO,GAEhB,AAAI,MAAO,GAAY,IAAS,UAE9B,CAAI,GAAgB,MAAO,GAAY,IAAS,SAE9C,GAAM,IAAI,0BAA0B,KACpC,EAAY,GAAO,IAAK,EAAY,MAAS,EAAY,IACzD,GAAU,EAAY,GAAM,EAAY,GAAM,EAAY,KAI1D,GAAM,IAAI,0BAA0B,KACpC,EAAY,GAAO,IAAK,EAAY,IACpC,GAAU,GAAI,EAAY,GAAM,EAAY,MASpD,YAAmB,EAAgB,EACnC,CACE,OAAW,KAAO,GAEhB,AAAK,IAAO,IAEV,GAAM,IAAI,2BAA2B,MAAS,MAAO,GAAe,IAAS,SAAY,SAAW,eACpG,MAAO,GAAe,IAGpB,MAAO,GAAe,IAAS,UACjC,GAAU,EAAe,GAAM,EAAY,IAOjD,YAAwB,EAAmB,GAC3C,CACE,EAAM,IAAI,qBAAqB,EAAmB,WAAa,gDAE3D,IAAqB,aAAa,QAAQ,EAAgB,iBAAmB,OAE/E,GAAM,IAAI,wCAEV,aAAa,WAAW,EAAgB,sBACxC,aAAa,WAAW,EAAgB,kBACxC,aAAa,WAAW,EAAgB,eACxC,aAAa,WAAW,EAAgB,iBACxC,aAAa,WAAW,EAAgB,mBACxC,GAAa,EAAgB,oBAC7B,GAAa,EAAgB,qBAC7B,GAAa,EAAgB,gBAC7B,GAAa,EAAgB,cAC7B,GAAa,EAAgB,gBAIjC,YAA0B,EAAa,EAAgB,EACvD,CACE,GACA,CAGE,AAAI,AAFyB,GAAqB,EAAgB,GAEvC,GACzB,EAAU,EAAa,SAErB,EAAN,CAEE,SAAM,MAAM,iCAAiC,+BAE7C,EAAU,EAAa,GAEhB,EAGT,MAAO,GAQF,YAAgC,EAAa,EAAkB,KAAM,EAAa,GACzF,CACE,GAAM,GAAa,GAAS,EAAa,EAAiB,GAE1D,GAAK,IAAe,MAAU,IAAoB,MAAU,EAAW,UAAY,OACnF,CACE,GAAI,GAAiB,EAGrB,MAAI,GAAW,QAAU,EAAgB,QAEvC,GAAM,IAAI,GAEV,EAAiB,GAAc,EAAY,EAAiB,GAC5D,EAAU,EAAa,GAGvB,GAAe,IAEf,EAAM,IAAI,IAKV,GAAe,IAGV,GAAiB,EAAa,GAAiB,EAAa,EAAgB,IAGrF,MAAI,KAAoB,KAEtB,GAAM,KAAK,0CAA0C,+BAErD,EAAU,EAAa,GAEhB,GAAiB,EAAa,IAGvC,GAAM,MAAM,+CAA+C,iCAEpD,MAQT,GAAM,IAAmB,CAAC,EAAa,IACvC,CACE,GAAM,GACN,CACE,IAAI,EAAQ,EAAU,EACtB,CAGE,GAAI,IAAY,GAChB,CACE,GAAM,GAAQ,QAAQ,IAAI,EAAQ,EAAU,GAE5C,MAAI,OAAO,IAAU,SACZ,GAAI,OAAM,EAAO,GAEnB,EAGT,EAAM,MAAM,6CAA6C,MAG3D,IAAI,EAAQ,EAAU,EAAU,EAChC,CAGE,GAAI,IAAY,GAChB,CACE,GAAM,GAAW,QAAQ,IAAI,EAAQ,EAAU,GAG/C,MAAI,KAAa,GAEf,SAAQ,IAAI,EAAQ,EAAU,GAC9B,EAAU,EAAa,GACvB,GAAsB,EAAU,EAAU,IAGrC,GAGT,SAAM,MAAM,6CAA6C,KAClD,KAIX,MAAO,IAAI,OAAM,EAAgB,IAQ5B,YAA6B,EAAU,EAC9C,CACE,EAAM,IAAI,uCAAuC,KAE5C,IAAY,KACf,IAAU,GAAY,IAExB,GAAU,GAAU,KAAK,GAG3B,YAA+B,EAAU,EAAU,EACnD,CACE,AAAI,IAAY,KAEd,GAAM,IAAI,wCAAwC,iBAAwB,iBAAwB,KAClG,GAAU,GAAU,QAAQ,GAAY,EAAS,EAAU,KC9Y/D,GAAM,IAAQ,AAAY,EAAY,gBAE3B,EAAW,GACX,EAAW,GAOf,aACP,CACE,GAAM,IAAI,oBACV,EAAW,iBACX,GAAM,IAAI,GAEV,KAGK,aACP,CACE,EAAW,GAAuB,EAAI,YAAa,GAAiB,IACpE,GAAM,IAAI,GC5BZ,WACA,CACE,YAAY,EAAW,EAAoB,GAC3C,CACE,KAAK,QAAe,SAAS,eAAe,GAC5C,KAAK,aAAe,KAAK,QAAQ,cAAc,cAC/C,KAAK,aAAe,KAAK,OACzB,KAAK,OAAe,KAAK,YACzB,KAAK,aAAe,KAAK,OACzB,KAAK,OAAe,KAAK,YAEzB,KAAK,QAAQ,iBAAiB,QAAS,AAAC,GACxC,CACE,GAAO,iBACP,KAAK,OAAO,KAGV,GACF,KAAK,YAGL,YAAa,CAAE,MAAO,MAAK,QAAQ,aACnC,OAAM,EAAO,CAAE,KAAK,aAAa,YAAc,EAEnD,WAAuB,CAAE,MAAQ,MAAK,QAAQ,UAAU,SAAS,cAAgB,GACjF,sBAAuB,CAAE,MAAQ,IAAiB,iBAAkB,KAAK,WAAa,OAGtF,QAAS,EAGT,YAAY,EACZ,CACE,AAAI,KAAK,aAAe,KAAK,wBAE3B,MAAK,aAAa,GAClB,KAAK,aAAa,IAKtB,QAAS,EAGT,aACA,CACE,KAAK,iBC3BF,GAAI,IAAa,KACb,GAAa,KACb,GAAa,KAOjB,YAAc,EACrB,CACE,GAAa,GAAI,IAAiB,4BAA6B,GAG/D,GAAY,GAAI,IAAgB,2BAChC,GAAY,GAAI,IAAe,0BAQjC,oBAA+B,EAC/B,CACE,YAAY,EAAW,EACvB,CACE,MAAM,GACN,KAAK,gBAAkB,EAGzB,QACA,CACE,GAAM,GAAW,KAAK,cAChB,EAAW,OAAO,SAAS,KAAK,QAAQ,uBAAwB,IAGtE,AAAI,EAAS,QAAU,GACrB,GAAU,GAAG,SAAe,EAAS,YAEvC,EAAS,SAAS,gBAAkB,IAAiB,GAAY,QAAU,GAAY,KACvF,GAAU,EAAI,oBAAqB,GAAG,IAAiB,GAAY,QAAU,GAAY,OAAS,GAAkB,GACpH,eAAe,QAAQ,EAAI,YAAa,KAAK,UAAU,EAAS,YAEhE,GAAS,GAAiB,IAG5B,QACA,CACE,KAAK,MAAS,EAAS,SAAS,kBAAoB,GAAY,KAAQ,OAAS,UAGnF,aACA,CACE,GAAM,GAAoB,OAAO,SAAS,KAAK,MAAM,KAC/C,EAAoB,EAAS,UAAU,GAAS,EAAK,gBAAkB,QACvE,EAAqB,IAAc,GACX,SAAS,EAAS,EAAY,IAC9B,EACxB,EAAoB,KAAK,kBACzB,EAAoB,IAAiB,EAAS,YAAiB,EAAS,eACxE,EAAoB,IAAiB,EAAS,eAAiB,EAAS,YACxE,EAAoB,EAAU,aAAiB,GAAc,GAAK,EAExE,MAAO,CACL,QAAS,KAAK,KAAK,EAAc,GACjC,UAAW,CACT,SAAU,GAAW,UACrB,QAAU,GAAW,QACrB,SAAU,GAAW,aAW7B,gBAA6B,EAC7B,CACE,YAAY,EAAW,CAAE,MAAM,GAE/B,QACA,CACE,EAAS,SAAS,SAAY,EAAS,SAAS,WAAa,GAC7D,EAAa,EAAS,SAAS,SAAW,wDAA0D,wDAAyD,GAG/J,QACA,CACE,KAAK,MAAQ,EAAS,SAAS,SAAW,KAAO,MACjD,EAAS,SAAS,SAAW,GAAa,SAAS,KAAM,eAAgB,eAAiB,GAAa,SAAS,KAAM,cAAe,gBACrI,EAAS,SAAS,SAAW,IAAW,UAAU,OAAO,YAAiC,IAAW,UAAU,IAAI,cAIvH,gBAA8B,EAC9B,CACE,YAAY,EAAW,CAAE,MAAM,GAE/B,QACA,CACE,EAAS,QAAQ,cAAiB,EAAS,QAAQ,gBAAkB,GACrE,EAAa,EAAS,QAAQ,cAAgB,+CAAiD,+CAAgD,GAGjJ,QACA,CACE,KAAK,MAAQ,EAAS,QAAQ,cAAgB,KAAO,QChIzD,GAAM,IAAQ,AAAY,EAAY,mBAEzB,EAAQ,CACnB,QAAsB,UACtB,MAAsB,QACtB,cAAsB,eACtB,cAAsB,eACtB,aAAsB,cACtB,YAAsB,aACtB,qBAAsB,qBACtB,WAAsB,YACtB,kBAAsB,mBACtB,kBAAsB,mBACtB,gBAAsB,iBACtB,iBAAsB,kBACtB,iBAAsB,mBAGlB,GAAiB,EACpB,EAAM,SAAuB,CAAE,KAC/B,EAAM,OAAuB,CAAE,KAC/B,EAAM,eAAuB,IAC7B,EAAM,eAAuB,IAC7B,EAAM,cAAuB,IAC7B,EAAM,aAAuB,IAC7B,EAAM,sBAAuB,IAC7B,EAAM,YAAuB,IAC7B,EAAM,mBAAuB,IAC7B,EAAM,iBAAuB,IAC7B,EAAM,kBAAuB,IAC7B,EAAM,kBAAuB,IAC7B,EAAM,mBAAuB,IAQzB,WAAqB,EAAe,EAC3C,CACE,AAAI,IAAiB,KACnB,GAAe,GAAe,KAAK,GAGhC,YAAkB,EAAe,EAAoB,KAAM,EAAwB,KAC1F,CACE,GAAe,GAAe,QAAQ,GACtC,CACE,EAAc,CACZ,MAAU,EACV,KAAU,EACV,SAAU,MAUhB,YAAiB,EACjB,CAEE,GAAsB,EAAc,KAAK,gBAG3C,YAAe,EACf,CACE,GAAM,IAAI,GAEN,GAAe,KAAK,kBACtB,GAAsB,GChFnB,GAAM,GAAQ,CACnB,QAAU,CAAE,GAAK,EAAG,MAAO,iBAC3B,SAAU,CAAE,GAAI,GAAI,MAAO,kBAC3B,QAAU,CAAE,GAAI,GAAI,MAAO,iBAC3B,OAAU,CAAE,GAAI,GAAI,MAAO,gBAC3B,QAAU,CAAE,GAAI,GAAI,MAAO,iBAC3B,OAAU,CAAE,GAAI,GAAI,MAAO,gBAC3B,QAAU,CAAE,GAAI,GAAI,MAAO,kBAQhB,EAAiB,SAAS,EAAgB,EAAgB,SAAU,EAAe,EAAM,SACtG,CACE,GAAM,GAAY,EAAc,cAAc,GACxC,EAAY,EACZ,EAAY,EAAQ,UAE1B,MAAO,IACD,QAAQ,CAAE,MAAO,OACjB,QAAQ,CAAE,MAAO,GAAQ,UAEzB,cAAa,EAAO,CAAE,EAAQ,MAAQ,GAE1C,WAAW,EAAkB,CAAE,MAAO,GAAQ,cAAc,IAC5D,YAAY,EAAO,EAAU,CAAE,EAAQ,iBAAiB,EAAO,IAE/D,YAAY,EAAa,CAAE,EAAU,IAAI,GAAG,IAC5C,eAAe,EAAU,CAAE,EAAU,OAAO,GAAG,IAC/C,YAAY,EAAa,CAAE,EAAU,OAAO,IAE5C,aAAa,EAAkB,CAAE,MAAO,GAAQ,aAAa,IAC7D,aAAa,EAAW,EAAO,CAAE,EAAQ,aAAa,EAAW,IAEjE,YAGF,WAAkB,EAAW,EAAM,SACnC,CAEE,MAAI,GAAM,KAAO,EAAS,GAExB,GAAU,OAAO,EAAM,OACvB,EAAU,IAAI,EAAS,OACvB,EAAQ,EAED,IAGF,KAIE,GAAkB,SAAS,EAAiB,EAAgB,SACzE,CACE,GAAM,GAAW,EAAc,iBAAiB,GAEhD,MAAO,IACD,SAAa,CAAE,MAAO,GAAS,QACnC,WAAW,EAAM,CAAE,EAAS,QAAQ,GAAG,MC5C3C,GAAM,IAAQ,AAAY,EAAY,qBAChC,GAAQ,CAAE,QAAS,IACnB,EAAQ,GAOP,YAAc,EAAc,EACnC,CACE,GAAM,IAAI,UAEV,GAAE,QAAU,EAEZ,GAAM,GAAmB,SAAS,eAAe,qBAEjD,AAAI,IAAqB,KAEvB,GAAK,aAAe,GAAI,GAAe,yBAA0B,GACjE,EAAK,aAAa,cAAgB,EAClC,EAAK,YAAe,GAAI,GAAe,wBAAyB,IAIhE,GAAM,MAAM,6DAGd,GAAM,GAAmB,SAAS,eAAe,qBAEjD,AAAI,IAAqB,KAEvB,GAAK,QAAiB,GAAI,GAAe,4BAA6B,GACtE,EAAK,QAAQ,OAAS,EAAK,QAAQ,WAAW,4BAC9C,EAAK,QAAQ,MAAS,EAAK,QAAQ,WAAW,2BAE9C,EAAK,UAAgB,GAAI,GAAe,8BAA+B,GACvE,EAAK,UAAU,IAAM,EAAK,UAAU,WAAW,OAE/C,EAAK,MAAwB,GAAI,GAAe,0BAA2B,GAC3E,EAAK,MAAM,SAAkB,EAAK,MAAM,WAAW,4BACnD,EAAK,MAAM,SAAkB,EAAK,MAAM,WAAW,4BACnD,EAAK,MAAM,gBAAkB,GAC7B,EAAK,MAAM,gBAAkB,GAE7B,EAAK,WAAa,GAAI,GAAe,gCAAiC,GACtE,EAAK,UAAa,GAAI,GAAe,yBAA0B,GAE/D,EAAK,UAAiB,GAAI,GAAe,+BAAgC,GACzE,EAAK,UAAU,KAAO,EAAK,UAAU,WAAW,uBAEhD,EAAK,UAAY,GAAI,GAAe,yBAA0B,GAE9D,EAAK,OAAc,GAAI,GAAe,2BAA4B,GAClE,EAAK,OAAO,KAAO,EAAK,OAAO,WAAW,uBAE1C,EAAK,QAAU,GAAI,GAAe,4BAA6B,GAE/D,EAAK,KAAY,GAAI,GAAe,yBAA0B,GAC9D,EAAK,KAAK,KAAO,EAAK,KAAK,WAAW,wBAItC,GAAM,MAAM,6DAIT,YAAe,EAAmB,EAAwB,EAAmB,EACpF,CACE,GAAM,IAAI,WAEV,EAAK,aAAa,SAAS,EAAM,SACjC,EAAK,aAAa,YAAY,QAAS,IACvC,EAAK,YAAY,SAAS,EAAM,SAEhC,EAAK,QAAQ,SAAS,EAAM,QAC5B,EAAK,UAAU,SAAS,EAAM,QAC9B,EAAK,MAAM,SAAS,EAAM,QAEtB,EAAS,OAAO,oBAClB,EAAK,UAAU,SAAS,kBAEtB,EAAS,OAAO,gBAClB,EAAK,MAAM,SAAS,kBAEtB,EAAK,WAAW,SAAS,EAAM,SAC/B,EAAK,WAAW,YAAY,QAAS,IAAM,GAAiB,UAE5D,EAAK,UAAU,SAAU,GAAE,QAAQ,kBAAoB,EAAK,EAAM,QAAU,EAAM,UAClF,EAAK,UAAU,YAAY,QAAS,GAEpC,EAAK,UAAU,SAAS,EAAM,QAC9B,EAAK,UAAU,YAAY,QAAS,GAEpC,EAAK,UAAU,SAAU,GAAE,QAAQ,eAAiB,EAAK,EAAM,QAAU,EAAM,UAC/E,EAAK,UAAU,YAAY,QAAS,IAAM,KAE1C,EAAK,OAAO,SAAS,EAAM,SAC3B,EAAK,OAAO,YAAY,QAAS,IAEjC,EAAK,QAAQ,SAAS,EAAM,SAE5B,EAAK,KAAK,SAAS,EAAM,SACzB,EAAK,KAAK,YAAY,QAAS,IAAM,KACrC,KAEA,GAAoB,WAAc,IAClC,GAAoB,aAAc,IAElC,EAAY,EAAM,cAAmB,IACrC,EAAY,EAAM,cAAmB,IACrC,EAAY,EAAM,aAAmB,IACrC,EAAY,EAAM,iBAAmB,IACrC,EAAY,EAAM,iBAAmB,IACrC,EAAY,EAAM,kBAAmB,IAQhC,YAA+B,EACtC,CACE,GAAkB,EAAkB,KAGtC,YAA2B,EAC3B,CACE,EAAK,YAAY,MAAM,UAAY,UAAU,KAGxC,YAAgC,EAAsB,EAAiB,EAC9E,CACE,GAAS,EAAiB,GAG1B,AACE,GADF,AAAI,IAAoB,EACJ,EAEA,EAAwB,GAAkB,MAGzD,YAA2B,EAClC,CACE,GAAI,EAAK,MAAM,gBAAkB,EACjC,CACE,GAAM,GAAoB,EAAM,QAAU,SAAS,gBAAgB,YAAe,IAC5E,EAAkB,KAAK,MAAO,EAAK,MAAM,gBAAkB,EAAmB,KACpF,EAAK,aAAa,cAAc,GAE5B,MAAgB,IAElB,IAAsB,GACtB,GAAS,EAAgB,EAAK,MAAM,mBAU1C,YAAoB,EACpB,CACE,AAAI,EAAK,QAAQ,MAAM,KAAO,EAAM,OAAO,IAEzC,GAAK,QAAQ,SAAS,EAAM,SAC5B,EAAK,UAAU,SAAS,EAAM,SAC9B,EAAK,MAAM,SAAS,EAAM,UAG5B,EAAK,QAAQ,OAAO,YAAc,EAAU,QAAU,GACtD,EAAK,QAAQ,MAAM,YAAe,EAAU,OAAU,GACtD,GAAa,EAAU,WACvB,GAAS,GAAI,IAGf,YAAsB,EACtB,CAEE,AAAI,EAAU,MAAQ,EAAK,UAAU,IAAI,KAEvC,GAAK,UAAU,YAAY,eAAgB,eAAgB,mBAC3D,EAAK,UAAU,SAAS,UAAW,EAAU,OAC7C,EAAK,UAAU,IAAI,IAAM,EAAU,IACnC,EAAK,UAAU,IAAI,SAAS,KAAK,IAAM,EAAK,UAAU,YAAY,aAItE,YAAkB,EAAiB,EACnC,CACE,AAAK,IAAoB,IAAQ,EAAK,MAAM,kBAAoB,EAE9D,GAAK,MAAM,gBAAkB,EAEzB,EAAS,SAAS,WAAa,IACjC,GAAmB,EAAkB,GAEvC,GAAa,EAAK,MAAM,SAAU,IAE1B,IAAoB,IAAQ,EAAK,MAAM,kBAAoB,IAEnE,GAAK,MAAM,SAAS,YAAc,SAGpC,AAAK,IAAoB,IAAQ,EAAK,MAAM,kBAAoB,EAE9D,GAAK,MAAM,gBAAkB,EAC7B,GAAa,EAAK,MAAM,SAAU,IAE1B,IAAoB,IAAQ,EAAK,MAAM,kBAAoB,IAEnE,GAAK,MAAM,SAAS,YAAc,SAItC,YAAsB,EAAS,EAC/B,CACE,GAAM,GAAa,GAAI,MAAK,EAAU,KAAM,cAC5C,EAAQ,YAAe,EAAW,GAAK,GACb,EAAW,MAAM,GAAI,IACrB,EAAW,MAAM,GAAI,IAGjD,aACA,CACE,EAAK,MAAM,SAAS,YAAc,QAClC,EAAK,MAAM,SAAS,YAAc,QAClC,EAAK,MAAM,gBAAkB,EAC7B,EAAK,MAAM,gBAAkB,EAQxB,YACP,CAEE,MAAS,GAAK,UAAU,MAAM,KAAO,EAAM,QAAQ,GAGrD,aACA,CACE,AAAI,EAAK,UAAU,MAAM,KAAO,EAAM,QAAQ,IAC5C,EAAK,UAAU,SAAS,EAAM,QAAQ,OAGnC,aACP,CACE,EAAK,UAAU,YAAY,EAAM,QAAQ,OACzC,EAAK,UAAU,SAAS,EAAM,SAC9B,EAAK,UAAU,KAAK,YAAc,sBAClC,EAAK,UAAU,SAAS,EAAM,SAE9B,GAAW,GAAE,QAAQ,gBAGhB,aACP,CACE,EAAK,UAAU,YAAY,EAAM,QAAQ,OACzC,EAAK,UAAU,SAAS,EAAM,QAC9B,EAAK,UAAU,KAAK,YAAc,qBAG7B,YAAwB,EAC/B,CACE,AAAI,EACF,EAAK,UAAU,YAAY,0BAE3B,EAAK,UAAU,YAAY,0BAGxB,aACP,CACE,GAAM,GAAY,GAAE,QAAQ,eAE5B,YACA,GAAW,GAEJ,EAGF,aACP,CACE,GAAM,GAAY,KAElB,AAAK,MAAgB,IAAW,EAAU,cAAgB,GACxD,EAAK,UAAU,SAAS,EAAM,UAE5B,EAAU,aAAe,EAAU,WACrC,EAAK,UAAU,SAAS,EAAM,SAG3B,aACP,CACE,GAAM,GAAY,KAElB,EAAK,UAAU,SAAS,EAAM,SAE1B,EAAU,cAAgB,EAAU,WACtC,EAAK,UAAU,SAAS,EAAM,UAQ3B,GAAM,IAAS,CAAE,IAAK,EAAG,IAAK,EAAG,IAAK,GAEvC,GAAc,CAClB,CAAE,MAAO,aAAc,KAAM,UAC7B,CAAE,MAAO,aAAc,KAAM,UAC7B,CAAE,MAAO,aAAc,KAAM,eAGxB,aACP,CACE,MAAO,UAAS,EAAK,OAAO,aAAa,qBAGpC,aACP,CACE,GAAM,GAAU,KAAkB,EAAK,GAAY,OAChC,KAAkB,EACnB,EAElB,SAAK,OAAO,aAAa,mBAAoB,GAC7C,EAAK,OAAO,aAAmB,GAAG,GAAY,GAAO,YACrD,EAAK,OAAO,KAAK,YAAc,GAAY,GAAO,KAE3C,GAAY,GAQrB,aACA,CACE,EAAK,KAAK,KAAK,YAAc,EAAS,SAAS,WAAa,aAAe,YAG7E,aACA,CACE,AAAK,MAAgB,IAAW,EAAK,MAAM,kBAAoB,IAAS,EAAK,MAAM,kBAAoB,IAErG,IAAa,EAAK,MAAM,SAAU,EAAS,SAAS,SACd,EAAK,MAAM,gBACV,EAAK,MAAM,gBAAkB,EAAK,MAAM,iBAE/E,GAAa,EAAK,MAAM,SAAU,EAAK,MAAM,kBC1WjD,GAAM,IAAQ,AAAY,EAAY,wBAO/B,YAA8B,EAAc,EACnD,CACE,GAAM,GAAU,EAAa,SAAS,QAAQ,2BAA4B,SAAS,MAEnF,MAAO;AAAA,8BACqB,yDAAmE;AAAA;AAAA,iBAEhF,wBAA8B,WAAqB;AAAA;AAAA,YAK7D,YAA2B,EAClC,CACE,GAAM,GAAkB,EAAM,KAAK,oBAAsB,EAAW,QAC9D,EAAiB,GAAiB,EAAM,MAExC,EAA2B,GAAM,UACF,oEACA,EAAc,IAE7C,EAAoB,EACI,EACA,oEAExB,EAAmB,EACI,YAAY,EAAM,KAAK,oCAAoC,EAAM,KAAK,qBACtE,YAAY,EAAM,kBAAkB,EAAM,KAAK,oCAAoC,EAAM,KAAK,yBAErH,EAAgB,EACI,0GACA,GAE1B,MAAO;AAAA,eACM,EAAM,2BAA2B,EAAc;AAAA,6BACjC,EAAM;AAAA,2BACR,EAAM,KAAK;AAAA,0BACZ,EAAM,KAAK;AAAA,wBACb,EAAM;AAAA,yBACL,EAAM,KAAK;AAAA,kCACF;AAAA,gCACF,EAAc;AAAA;AAAA,gEAEkB,EAAM,QAAQ;AAAA,kEACZ,EAAM,SAAS;AAAA;AAAA,iCAEhD,EAAiB,qBAAuB;AAAA;AAAA,sBAEnD;AAAA;AAAA,yDAEoC,IAAmB,GAAS,sCAAwC;AAAA,YAClH;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,YAMA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,YAUL,YAA8B,EAAW,EAAoB,EAAkB,EACtF,CACE,EAAU,QAAQ,GAClB,CACE,GAAM,GAAe,SAAS,eAAe,EAAM,KAAK,cAAc,GAChE,EAAe,EAAa,aAAa,IAAmB,MAAM,KAClE,EAAe,GAErB,GAAS,QAAQ,GACjB,CACE,GAAM,GAAY,SAAS,GAE3B,GAAiB,aADE,EAAM,KAAK,kBAAoB,EAAU,UAAY,sBACtB,GAAiB,EAAS,IAAI,GAAQ,UAAU,EAAS,IAAI,GAAQ,aAGzH,EAAa,mBAAmB,aAAc,KCrFlD,GAAM,GAAQ,AAAY,EAAY,oBAEhC,EAAI,CACR,aAAe,GAAI,KACnB,cAAe,GAAI,MAQrB,kBAAiC,EAAU,EAC3C,CACE,GAAM,GAAc,SAAS,EAAa,YAAc,GAClD,EAAc,KAAM,IAAY,EAAU,EAAQ,EAAa,SAAS,EAAa,cAE3F,GAAI,IAAc,KAClB,CACE,GAAM,GAAa,GAAI,KACjB,EAAa,GAAI,KACnB,EAAe,GAAqB,EAAc,GAEtD,EAAU,QAAQ,CAAC,EAAO,KAC1B,CACE,EAAM,QAAQ,QAAQ,GAAQ,EAAE,aAAa,IAAI,KAAS,IAAU,EAAU,IAAI,IAClF,EAAM,SAAS,QAAQ,GAAQ,EAAE,cAAc,IAAI,KAAS,IAAU,EAAW,IAAI,IACrF,EAAM,IAAO,KAAK,MAAQ,GAC1B,GAAc,GAAkB,KAGlC,SAAS,eAAe,uBAAuB,mBAAmB,cAAe,GAEjF,EAAM,IAAI,aAAa,EAAU,yBAAyB,EAAE,aAAa,qBAAqB,EAAW,0BAA0B,EAAE,cAAc,SAEnJ,GAAI,GAAkB,KAClB,EAAkB,KAEtB,AAAI,EAAU,KAAO,GACnB,GAAiB,GAAW,UAAY,CAAC,GAAG,GAAY,MAEtD,EAAW,KAAO,GACpB,GAAkB,GAAW,WAAY,CAAC,GAAG,GAAa,MAE5D,GAAM,CAAC,EAAa,GAAgB,KAAM,SAAQ,IAAI,CAAC,EAAgB,IAEvE,MAAI,KAAgB,MAClB,EAAY,QAAQ,GAAS,EAAE,aAAa,IAAI,EAAM,GAAI,CAAE,KAAM,EAAM,KAAM,KAAM,EAAM,QAExF,IAAiB,MACnB,EAAa,QAAQ,GAAS,EAAE,cAAc,IAAI,EAAM,GAAI,CAAE,KAAM,EAAM,KAAM,KAAM,EAAM,QAE9F,GAAqB,EAAW,uBAAyB,wBAA0B,EAAE,cACrF,GAAqB,EAAW,wBAAyB,yBAA0B,EAAE,eAE9E,GAGT,MAAO,GAQT,aACA,CACE,GAAI,GAAgB,GAEpB,MAAI,GAAa,YAAY,SAE3B,GAAgB,8BAA8B,EAAa,YAAY,eAEnE,EAAa,YAAY,eAAiB,MAC5C,IAAiB,iBAAiB,EAAa,YAAY,gBAE7D,EAAM,IAAI,uBAAuB,MAG5B,EAGT,YAAqB,EAAW,GAAI,EAAS,GAAI,EAAO,EAAG,EAAgB,GAC3E,CACE,EAAM,IAAI,6BAA8B,EAAS,SAAW,EAAK,MAAQ,eAAuB,EAAO,SAAW,EAAK,MAAQ,aAAkB,sBAAyB,KAE1K,GAAI,GAAgB,GAEpB,MAAK,GAAS,SAAW,GAAO,EAAO,SAAW,GAChD,GAAgB,GAAG,KAAY,SAAS,OAEnC,MAAM,yBAAyB,SAAqB,cAAiB,0CAAsD,QACjI,KAAK,GAEC,EAAS,GAMP,EAAS,OAJd,GAAM,MAAM,GACL,OAKV,MAAM,GAEL,GAAM,KAAK,GACJ,OAIX,YAAoB,EAAU,EAAS,EAAW,GAClD,CACE,SAAM,IAAI,4BAA4B,gBAAwB,EAAQ,OAAS,EAAK,EAAU,uBAAuB,KAE9G,MAAM,kBAAkB,aAAoB,cAAoB,0BACtE,KAAK,GAEC,EAAS,GAMP,EAAS,OAJd,GAAM,MAAM,GACL,OAKV,MAAM,GAEL,GAAM,KAAK,GACJ,OC9HX,GAAM,IAAQ,AAAY,EAAY,iBAEhC,EAAI,CACR,UAAmB,KACnB,kBAAmB,KACnB,kBAAmB,KACnB,OAAmB,KACnB,eAAmB,KACnB,aAAmB,EAAM,QACzB,kBAAmB,MAQd,YAAc,EACrB,CACE,GAAM,IAAI,UAEV,AAAY,GAAK,GAEjB,EAAE,UAAoB,SAAS,eAAe,aAC9C,EAAE,kBAAoB,GAAI,sBAAqB,GAAkB,CAAE,KAAM,EAAE,YAE3E,EAAE,UAAU,iBAAiB,QAAS,AAAC,GACvC,CACE,GAAM,GAAkB,EAAM,OAAO,QAAQ,iBAC7C,GAAI,IAAoB,KAAM,MAAO,GAAoB,EAAgB,QAAQ,mBAAmB,GAAI,GAAM,IAE9G,GAAM,GAAqB,EAAM,OAAO,QAAQ,4BAChD,GAAI,IAAuB,KAAM,MAAO,IAAkB,EAAmB,QAAQ,oBAErF,GAAM,GAAiB,EAAM,OAAO,QAAQ,wBAC5C,GAAI,IAAmB,KAAM,MAAO,IAAc,EAAe,QAAQ,oBAEzE,GAAM,GAAe,EAAM,OAAO,QAAQ,qBAC1C,GAAI,IAAiB,KAAM,MAAO,IAAY,EAAa,QAAQ,oBAEnE,GAAM,GAAgB,EAAM,OAAO,QAAQ,wBAC3C,GAAI,IAAkB,KAAM,MAAO,IAAiB,EAAc,QAAQ,gCAAiC,IAE3G,GAAM,GAAkB,EAAM,OAAO,QAAQ,0BAC7C,GAAI,IAAoB,KAAM,MAAO,IAAiB,EAAgB,QAAQ,gCAAiC,MAI5G,YAAe,EACtB,CACE,EAAE,OAAS,EACX,EAAE,eAAe,UAAU,IAAI,WAE/B,AAAe,EAAY,AAAe,EAAM,cAAe,IAAM,GAAqB,EAAM,UAChG,AAAe,EAAY,AAAe,EAAM,cAAe,IAAM,GAAqB,EAAM,UAE5F,EAAS,KAAK,oBAChB,KAGJ,YAA0B,EAC1B,CACE,EAAE,kBAAkB,UAAU,EAAE,gBAE3B,KAAK,KAAK,EAAQ,GAAG,kBAAoB,KAAO,MAAS,GAC5D,GAAE,UAAU,UAAa,EAAE,eAAe,UAAY,EAAE,UAAU,aAAgB,EAAE,eAAe,cAQhG,YAAoB,EAC3B,CACE,MAAO,GAAE,UAAU,cAAc,GAG5B,YAAuB,EAC9B,CACE,MAAO,GAAE,UAAU,iBAAiB,GAG/B,YAAsB,EAC7B,CACE,MAAO,UAAS,eAAe,GAG1B,aACP,CACE,MAAO,GAAE,eAGJ,YAAsB,EAC7B,CACE,GAAM,GAAY,EAAQ,aAAa,mBAEvC,MAAI,KAAc,KACT,SAAS,GAEX,EAAW,KAGb,aACP,CACE,GAAI,GAAe,EAAE,iBAAmB,KAClB,EAAE,eAAe,uBACjB,KAEtB,KAAQ,IAAgB,MAAU,GAAa,KAAiB,EAAW,SACzE,EAAc,EAAY,uBAE5B,MAAS,KAAgB,KAAQ,EAAY,GAAK,KAG7C,YAA2B,EAAe,EAAE,eACnD,CACE,GAAI,GAAe,IAAiB,KACd,EAAa,mBACb,GAAW,mBAEjC,KAAQ,IAAgB,MAAU,GAAa,KAAiB,EAAW,SACzE,EAAc,EAAY,mBAE5B,MAAS,KAAgB,KAAQ,EAAY,GAAK,KAG7C,YAAsB,EAC7B,CACE,EAAE,eAAiB,GAAa,GAChC,EAAE,kBAAkB,QAAQ,EAAE,gBAQhC,YAA2B,EAC3B,CACE,GAAM,GAAqB,EAAQ,cAAc,yBAEjD,AAAK,EAAE,oBAAsB,MAAU,EAAE,oBAAsB,GAC7D,GAAE,kBAAkB,MAAM,QAAU,IAEtC,AAAI,EAAmB,MAAM,UAAY,GACvC,EAAmB,MAAM,QAAU,OAEnC,EAAmB,MAAM,QAAU,GAErC,EAAE,kBAAoB,EAGxB,YAAuB,EACvB,CACE,GAAI,EAAE,iBAAmB,KACzB,CACE,GAAM,GAAmB,EAAa,UAAU,IAEhD,GAAgB,GAChB,EAAiB,GAAK,KAAK,MAE3B,AAAI,EAAS,KAAK,qBAAwB,IAAiB,EAAE,eAC3D,GAAY,EAAc,GAAO,IAAM,GAAS,EAAkB,EAAE,eAAgB,aAEpF,GAAS,EAAkB,EAAE,eAAgB,YAE/C,EAAa,uBAAwB,OAIrC,GAAa,sBAAuB,GAIxC,YAAqB,EAAc,EAAY,GAAM,EAAuB,IAAM,GAClF,CACE,GAAI,IAAiB,EAAE,eACvB,CACE,GAAM,GAAoB,EAAa,UAAU,IAC3C,EAAoB,EAAa,uBAEvC,EAAa,iBAAiB,eAAgB,IAC9C,CACE,EAAa,SACb,MAGF,EAAa,UAAU,IAAI,YAEvB,GAEF,EAAa,gBAAiB,EAAG,OAAQ,IACzC,CACE,GAAS,EACC,IAAoB,KAAQ,EAAE,UAAa,EAC3C,IAAoB,KAAQ,aAAe,eAM7D,YAAkB,EAAc,EAAe,EAC/C,CACE,EAAa,UAAU,IAAI,UAC3B,EAAa,cAAc,yBAAyB,MAAM,QAAU,GACpE,EAAa,iBAAiB,eAAgB,IAAM,EAAa,UAAU,OAAO,WAClF,EAAc,sBAAsB,EAAgB,GAGtD,YAA0B,EAAe,EACzC,CACE,GAAM,GAAc,SAAS,EAAc,aAAa,qBAClD,EAAc,EAAkB,EAAa,EAAM,EAAa,EAClE,EAAgB,SAAS,eAAe,kBAAkB,KAC1D,EAAgB,SAEpB,AAAI,IAAgB,MAElB,GAAc,EAAiB,EAAE,UAAU,kBAAoB,EAAE,UAAU,iBAC3E,EAAc,EAAiB,MAAU,OAAO,WAAa,KAAQ,UAAY,SAE5E,IAAmB,IAAW,EAAc,EAAS,UACxD,GAAc,GAAa,yBAG/B,GAAa,eAAe,CAAE,SAAW,EAAS,KAAK,gBAAkB,SAAW,OAAS,MAAO,IAQtG,aACA,CACE,AAAI,GAAS,YAAY,KACrB,EAAS,YAAY,SACrB,EAAS,YAAY,QACrB,EAAS,YAAY,UAElB,EAAS,WAAa,MAAU,EAAS,YAAc,EAAS,UAEnE,GAAE,kBAAoB,SAAS,eAAe,uBAC9C,EAAE,kBAAkB,cAAc,yBAAyB,YAAc,MAAM,EAAS,YAAc,OAAO,EAAS,aACtH,EAAE,kBAAkB,MAAM,QAAU,QACpC,EAAE,kBAAkB,iBAAiB,QAAS,KAKpD,mBACA,CACE,GAAI,GAAe,GAEnB,MAAK,GAAS,YAAc,GAAM,EAAS,UAEzC,IAAmB,IACnB,EAAe,KAAM,IAAW,GAAe,EAAE,UAAW,kBAAmB,GAAe,EAAE,UAAW,iBAC3G,GAAmB,IAEnB,AAAI,EAEF,GAAS,cACT,EAAE,kBAAkB,cAAc,yBAAyB,YAAc,MAAM,EAAS,YAAc,OAAO,EAAS,cAItH,EAAa,2BAA4B,GAAI,QAAS,IAAM,OAI5D,EAAS,aAAe,EAAS,UACnC,GAAE,kBAAkB,MAAM,QAAU,QAE/B,EAGT,YAA4B,EAC5B,CACE,EAAE,kBAAkB,MAAM,cAA6C,EAAkB,OAAU,QACnG,EAAE,kBAAkB,cAAc,oBAAoB,MAAM,QAAW,EAAkB,OAAU,QACnG,EAAE,kBAAkB,cAAc,qBAAqB,MAAM,QAAU,EAAkB,QAAU,OAQrG,YAAyB,EACzB,CACE,EAAQ,UAAU,OAAO,UAAW,EAAM,QAAQ,MAAO,EAAM,QAAQ,MAAO,EAAM,OAAO,OAGtF,YAA8B,EACrC,CACE,AAAI,EAAE,aAAa,KAAO,EAAS,IAEjC,GAAE,aAAe,EAEjB,AAAI,EAAS,KAAO,EAAM,QAAQ,GAEhC,GAAE,eAAe,UAAU,OAAO,EAAM,OAAO,MAAO,EAAM,QAAQ,OACpE,EAAE,eAAe,UAAU,IAAI,EAAM,QAAQ,QAI7C,GAAE,eAAe,UAAU,OAAO,EAAM,QAAQ,OAEhD,AAAI,EAAS,KAAO,EAAM,QAAQ,GAChC,GAAa,EAAE,eAAgB,EAAM,OAAO,MAAO,EAAM,QAAQ,OAEjE,GAAa,EAAE,eAAgB,EAAM,QAAQ,MAAO,EAAM,OAAO,OAEnE,AAAY,GAAmB,EAAS,KAAO,EAAM,QAAQ,MAK5D,YAA2B,EAAa,EAC/C,CACE,GAAgB,EAAE,gBAElB,EAAE,eAAiB,GAAa,GAE5B,IAAmB,IACrB,EAAE,kBAAkB,QAAQ,EAAE,gBAEhC,EAAE,eAAe,UAAU,IAAI,WAG1B,YAAyB,EAChC,CACE,EAAE,eAAe,cAAc,kBAAkB,YAAgB,EACjE,EAAE,eAAe,cAAc,kBAAkB,MAAM,QAAU,QAG5D,aACP,CACE,GAAM,GAAY,EAAE,eAAe,aAAa,yBAEhD,SAAE,OAAO,UAAU,EAAE,eAAe,aAAa,sBACjD,EAAE,OAAO,SAAS,EAAE,eAAe,aAAa,qBAChD,EAAE,OAAO,aAAa,GAEf,ECtWF,GAAM,GAAS,CAAE,GAAI,gBAOrB,aACP,CACE,MAAO;AAAA,eACM,EAAO;AAAA,iBACL,EAAO;AAAA,sBACF,EAAO;AAAA,wBACL,EAAO;AAAA,wBACP,EAAO;AAAA;AAAA,sBAET,EAAO;AAAA;AAAA,YAKtB,YAAoC,EAAkB,EAC7D,CACE,GAAI,GAAW,GAEf,EAAiB,QAAQ,CAAC,EAAO,IACjC,CACE,GAAM,GAAe,EAAM,MAAQ,SAAS,EAAM,QAAgD,kBAC5F,EAAe,EAAM,MAAQ,EAAM,MAAyD,GAC5F,EAAe,EAAM,KAAQ,gCAAgC,EAAM,cAAyB,GAC5F,EAAe,EAAM,KAAQ,sCAAsC,EAAM,iBAAmB,EAAM,QACxG,EAAM,IAAe,cAAc,EAAQ,IAE3C,AAAI,EAAM,QACR,GAAY,YAAY,EAAM,uBAAuB,EAAM,oCAAoC,aAAsB,MAAe,IAAY,UAEhJ,GAAY,eAAe,aAAsB,MAAe,IAAY,YAGhF,EAAc,UAAY,EAGrB,YAA2B,EAAS,EAAa,EACxD,CAGE,MAAO;AAAA;AAAA,0CAFiB,SAAS,EAAQ,aAAa,sBAAwB,EAAW,QAAW,eAAiB;AAAA,oBAKnG,UAAU,EAAQ,aAAa;AAAA;AAAA;AAAA,mBAGhC;AAAA,mCACgB;AAAA;YC/CnC,GAAM,IAAQ,AAAY,EAAY,SAEhC,EAAI,CACR,eAAkB,KAClB,aAAkB,KAClB,QAAkB,EAClB,iBAAkB,IAGd,EAAW,CACf,QAAW,KACX,UAAW,KACX,KAAW,MAQN,YAAmB,EAAY,EAAO,EAAmB,GAAI,EAAyB,IAAM,GAAI,EAAuB,IAAM,GACpI,CACE,YAEA,EAAE,eAAiB,EACnB,EAAE,aAAiB,EACnB,GAAoB,GAEpB,EAAS,UAAU,UAAY,cAAc,IAC7C,EAAS,UAAU,cAAc,IAAI,EAAO,YAAY,UAAY,EACpE,EAAS,QAAQ,UAAU,IAAI,QAC/B,EAAS,QAAQ,iBAAiB,UAAW,IAC7C,EAAS,QAAQ,QACjB,GAAqB,IAErB,EAAE,UAEF,GAAM,IAAI,0BAA0B,EAAE,yBAAyB,cAAuB,KAE/E,EAAO,GAGT,YAAwB,EAAiB,GAChD,CACE,MAAS,KAAmB,EAAE,SAAa,EAAS,YAAc,MAAU,EAAS,QAAQ,UAAU,SAAS,QAG3G,aACP,CACE,SAAS,KAAK,oBAAoB,YAAa,GAAkB,CAAE,QAAS,KAC5E,SAAS,KAAK,oBAAoB,aAAc,IAChD,EAAS,QAAQ,oBAAoB,UAAW,IAChD,EAAS,QAAQ,UAAU,QAAQ,OAAQ,QAGtC,aACP,CACE,MAAO,GAAE,QAGJ,YAAuB,EAC9B,CACE,MAAO,UAAS,eAAe,cAAc,KAGxC,YAA0B,EAAe,EAChD,CACE,AAAI,IAAkB,EAAE,SACtB,GAAS,UAAU,cAAc,IAAI,EAAO,YAAY,UAAY,GAGjE,YAAyB,EAAe,EAC/C,CACE,AAAI,IAAkB,EAAE,SACtB,GAAoB,GAQxB,aACA,CACE,AAAI,EAAS,YAAc,MAEzB,UAAS,KAAK,mBAAmB,YAAa,MAE9C,EAAS,QAAY,SAAS,eAAe,EAAO,IACpD,EAAS,UAAY,SAAS,eAAe,GAAG,EAAO,gBACvD,EAAS,KAAY,EAAS,QAAQ,cAAc,IAAI,EAAO,WAE/D,EAAS,QAAQ,iBAAiB,QAAS,AAAC,GAC5C,CACE,AAAI,EAAM,SAAW,EAAS,SAC5B,OAGJ,EAAS,QAAQ,iBAAiB,eAAgB,IAClD,CACE,AAAI,EAAS,QAAQ,UAAU,SAAS,SAEtC,GAAS,QAAQ,UAAY,GAC7B,GAAqB,OAIzB,EAAS,QAAQ,cAAc,IAAI,EAAO,iBAAiB,iBAAiB,QAAS,KAIzF,YAA6B,EAC7B,CACE,GAA2B,EAAkB,EAAS,MAEtD,EAAiB,QAAQ,GACzB,CACE,AAAI,EAAM,SACR,EAAS,KAAK,cAAc,IAAI,EAAM,OAAO,iBAAiB,QAAS,MAI7E,YAA+B,EAC/B,CACE,AAAI,EAAE,aAAa,KAAW,IAE5B,MACA,WAAW,IAAM,EAAE,eAAe,KAAK,aAAa,iBAAkB,GAAQ,MAIlF,YAAiB,EACjB,CACE,EAAM,kBAEF,EAAM,MAAQ,UAChB,KAGJ,YAA8B,EAC9B,CACE,GAAM,GAAiB,OAAO,WAAa,SAAS,gBAAgB,YAEpE,SAAS,gBAAgB,MAAM,UAAe,EAAmB,SAAW,GAC5E,SAAS,gBAAgB,MAAM,aAAe,EAAmB,GAAG,MAAqB,GACzF,SAAS,eAAe,eAAe,MAAM,aAAe,EAAmB,GAAG,MAAqB,GAEnG,GAAqB,gBAAkB,SAEzC,UAAS,KAAK,iBAAiB,aAAc,IAC7C,SAAS,KAAK,iBAAiB,YAAc,GAAkB,CAAE,QAAS,MAI9E,YAA6B,EAC7B,CACE,GAAM,GAAgB,EAAM,OAAO,QAAQ,iBAAiB,aAAa,aACzE,EAAE,iBAAqB,IAAkB,OAG3C,YAA0B,EAC1B,CACE,AAAI,EAAE,mBAAqB,IACzB,EAAM,iBChJV,GAAM,IAAQ,AAAY,EAAY,iBAEhC,EAAI,CACR,gBAAiB,KACjB,cAAiB,KACjB,cAAiB,EACjB,WAAiB,EACjB,YAAiB,MAQZ,YAAc,EACrB,CACE,EAAE,gBAAkB,EAGtB,aACA,CACE,GAAK,gBAAkB,SAAY,SAAS,eAAe,qBAAuB,KAClF,CACE,GAAM,IAAI,iCAEV,GAAM,GAAM,SAAS,cAAc,UACnC,EAAI,KAAQ,kBACZ,EAAI,GAAQ,kBACZ,EAAI,IAAQ,GAAM,UACF,mGACA,6FAChB,GAAM,GAAiB,SAAS,qBAAqB,UAAU,GAC/D,EAAe,WAAW,aAAa,EAAK,IASzC,aACP,CAEE,KAEA,GAAM,GAAe,GAAW,KAEhC,AAAI,EAAa,OAAS,EAExB,GAAE,cAAgB,GAAU,YAAa,GAAS,KAAc,EAAc,AAAC,GAC/E,CACE,GAAM,GAAc,EAAa,KAAK,GAAS,EAAK,UAAY,GAAY,QAE5E,AAAK,IAAgB,KAAyB,IAAO,IACnD,KAAyB,eAAe,CAAE,SAAW,EAAS,KAAK,gBAAkB,SAAW,OAAS,MAAO,WAEhH,EAAE,gBAAgB,EAAa,GAAM,KAEzC,AAAC,GAEK,EAAM,OAAO,QAAQ,iBAChB,GACA,IAAM,OAAO,UAAU,SAAS,0BAM3C,EAAE,cAAgB,KAElB,KACA,MAIA,EAAa,0BAA2B,GAIrC,YAA2B,EAClC,CACE,GAAI,GAAe,EAAE,eACrB,CACE,GAAiB,EAAE,cAAe,GAAS,IAC3C,KAEA,GAAM,GAAa,GAAc,GAEjC,AAAI,EAAW,aAAa,mBAAqB,KAAyB,GAExE,GAAW,UAAU,OAAO,gBAAiB,cAC7C,EAAW,UAAU,IAAI,GAAG,EAAiB,gBAAkB,gBAC/D,EAAW,MAAQ,GAAG,EAAiB,cAAgB,gBAIvD,IAAgB,EAAE,cAAe,GAAW,IAC5C,OAKN,YAAkB,EAClB,CACE,MAAO,GAAG,EAAiB,UAAY;AAAA;AAAA,6BAEZ,EAAS,SAAS,SAAW,KAAO,mBAGjE,YAAoB,EACpB,CACE,GAAM,GAAe,GACjB,EAAiB,KAErB,EAAa,KAAK,CAChB,QAAS,EAAa,GACtB,MAAS,mBAAmB,EAAiB,gBAAkB,eAC/D,MAAS,GAAG,EAAiB,cAAgB,eAC7C,QAAS,GAAmB,EAAc,oBAAqB,sBAGjE,EAAa,KAAK,CAAE,MAAO,eAAgB,QAAS,YAEpD,OAAS,GAAI,EAAG,EAAI,IAElB,GAAe,GAAa,GAAkB,IAE1C,IAAiB,MAJC,IAOtB,EAAa,KAAK,CAChB,QAAS,EAAa,GACtB,MAAS,kBACT,QAAS,GAAmB,EAAc,oBAAqB,mBAAoB,MAIvF,MAAO,GAGT,aACA,CACE,GAAY,IAAI,EAAE,yCAA0C,QAAS,AAAC,GACtE,CACE,GAAS,SACT,EAAM,OAAO,QAAQ,QAAQ,UAAY,kBAAkB,EAAS,SAAS,SAAW,KAAO,cASnG,aACA,CACE,SAAS,iBAAiB,2BAA2B,QAAQ,AAAC,GAC9D,CACE,AAAI,EAAQ,KAAO,gBAEjB,GAAQ,iBAAiB,YAAa,IACtC,EAAQ,iBAAiB,YAAa,IACtC,EAAQ,iBAAiB,WAAa,IACtC,EAAQ,iBAAiB,OAAa,OAM5C,YAAmB,EACnB,CACE,AAAI,EAAM,OAAO,UAAU,SAAS,0BAClC,EAAM,iBAGV,YAAmB,EACnB,CACE,EAAE,WAAc,EAAM,QACtB,EAAE,YAAc,EAAM,OAAO,QAAQ,6BAA6B,GAClE,EAAM,aAAa,cAAgB,OAGrC,YAAkB,EAClB,CACE,SAAM,iBACN,EAAM,aAAa,WAAa,OACzB,GAGT,YAAkB,EAClB,CACE,EAAM,iBAEN,GAAM,GAAa,EAAM,QAAW,EAAE,WAAc,WAAa,cAG3D,EAAkB,SAAS,eAAe,EAAE,aAC5C,EAAkB,EAAM,OAAO,QAAQ,6BAC7C,EAAgB,sBAAsB,EAAW,GAGjD,GAAM,GAAkB,SAAS,eAAe,EAAgB,aAAa,kBAE7E,MADwB,UAAS,eAAe,EAAgB,aAAa,kBAC7D,sBAAsB,EAAW,GAE1C,GAQT,YAA4B,EAAS,EAAiB,EAAgB,EAAc,GACpF,CACE,GAAM,GAAkB,SAAS,EAAQ,aAAa,sBAAwB,EAAW,QAAW,eAAiB,kBAErH,MAAO;AAAA,+BACsB,EAAc,mBAAqB;AAAA,0CACxB,MAAmB,EAAc,8BAAgC;AAAA,oBACvF,UAAU,EAAQ,aAAa;AAAA;AAAA,mEAEgB,EAAc,6BAA+B;AAAA,mBAC7F,GAAa,EAAS;AAAA,mCACN,GAAa,EAAS;AAAA;AAAA,QAEjD,EAAc,KAAyB;AAAA,YAI/C,aACA,CACE,MAAO;AAAA;AAAA;YC1PT,GAAM,IAAQ,AAAY,EAAY,uBAEzB,GAAc,CACzB,KAAS,EACT,QAAS,EACT,KAAS,GAGE,EAAa,CACxB,KAAY,EACZ,QAAY,EACZ,WAAY,GAGR,EAAW,CACf,QAAS,GACT,KAAS,IAQJ,aACP,CACE,SAAS,QAAW,SAAS,KAAK,aAAa,sBAAwB,UAChE,EAAS,QAGX,aACP,CACE,SAAS,KAAQ,SAAS,KAAK,aAAa,sBAAwB,OAC7D,EAAS,KAGX,aACP,CACE,MAAS,GAAS,UAAY,IAAW,EAAS,OAAS,GAGtD,aAA2B,CAAE,MAAO,GAAS,QAC7C,YAA2B,CAAE,MAAO,GAAS,KAE7C,YAA2B,EAClC,CACE,GAAO,iBACP,GAAU,EAAI,aAAc,QAC5B,GAAS,GAAiB,EAAS,cAG9B,YAAuB,EAAS,EAAmB,GAC1D,CACE,GAAM,IAAI,oBAAoB,yBAA+B,KAEzD,GAEF,gBAAe,QAAQ,EAAI,YAAa,KAAK,UAAU,CAAE,SAAU,EAAkB,QAAS,KAAM,SAAU,KAC9G,GAAS,IASN,YAAwB,EAAU,EACzC,CACE,IAAiB,GAAmB,GAAW,GAAsB,GAGvE,YAAsB,EAAS,EAC/B,CACE,EAAQ,OACR,CACE,IAAU,EACV,KAAU,EACV,SAAW,EAAS,KAAK,gBAAkB,SAAW,SAS1D,YAA4B,EAAU,EACtC,CACE,GAAI,IAAY,EAChB,CACE,GAAI,GAAgB,EAEpB,AAAK,QAAO,cAAgB,GAAO,KAAK,MAAM,OAAO,cAAgB,IACnE,GAAgB,GAAgB,wBAA0B,GAAgB,8BAE5E,GAAa,OAAQ,OAIrB,AAAI,GAAS,KAAK,gBAEhB,KAKA,AADqB,SAAS,eAAe,aAAa,cAAc,mBAAmB,OAC9E,eAAe,CAAE,SAAW,EAAS,KAAK,gBAAkB,SAAW,OAAS,MAAO,WAK1G,YAA+B,EAC/B,CACE,GAAI,EAAS,QAAQ,WACrB,CAEE,GAAM,GAAe,KAAK,MAAM,OAAO,QAAU,SAAS,eAAe,GAAS,wBAAwB,KACpG,EAAe,KAAK,MAAM,OAAO,aACjC,EAAe,EAAsB,EAAY,GAGvD,AAAK,EAAY,EAAe,IAAyB,GACvD,GAAe,EAAsB,KAEvC,GAAa,OAAS,EAAa,GAAe,MAGpD,WAA+B,EAC/B,CACE,MAAQ,GACG,GAAgB,6BAChB,GAAgB,2BAG7B,YACA,CAEE,MAAQ,IAAgB,4BAA6B,SAAS,MAAQ,GASnE,YAA2B,EAClC,CACE,GAAI,KAAmB,EAAM,WAAa,IAAU,OAAO,WAAa,KACxE,CACE,GAAM,GAAY,SAAS,eAAe,aAI1C,GAFA,EAAM,iBAED,EAAM,MAAQ,UAAc,EAAM,MAAQ,WAC/C,CACE,GAAM,GAAa,EAAU,aAAiB,EAAU,aAAe,GAAO,IAE9E,EAAU,SACV,CACE,IAAW,EAAM,MAAQ,SAAY,CAAC,EAAa,EACnD,KAAU,EACV,SAAW,EAAS,KAAK,gBAAkB,SAAW,aAGrD,AAAK,GAAM,MAAQ,QAAY,EAAM,MAAQ,QAEhD,GAAa,EAAa,EAAM,MAAQ,OAAU,EAAI,EAAU,eC7KtE,GAAM,IAAQ,AAAY,EAAY,aAEzB,EAAS,CACpB,IAAO,EACP,IAAK,KAGD,GAAO,CACX,KAAO,EACP,KAAO,EACP,MAAO,GAGH,GAAQ,CACZ,KAAa,EACb,YAAa,EACb,OAAa,GAGT,EAAQ,CACZ,KAAQ,EACR,KAAQ,EACR,OAAQ,GAGJ,GAAS,CACb,cAAiB,GACjB,eAAgB,KAQL,GAAa,AAAC,GAC3B,CACE,GAAM,GAAgB,EAClB,EAAkB,EAAM,KACxB,EAAkB,GAClB,EAAkB,KAClB,EAAkB,KAClB,EAAkB,EAClB,EAAkB,EAClB,EAAkB,GAAK,KACvB,EAAkB,KAClB,EAAkB,EAEtB,MAAO,CACL,UAAW,CAAE,MAAQ,KAAc,EAAM,MACzC,OACA,SACA,OACA,SAGF,WAAc,EAAe,EAAiB,EAAY,KAC1D,CACE,MAAK,KAAc,EAAM,MAAU,GAAI,KAAe,GAEpD,IAAM,IAAI,kBAAkB,GAAM,qBAAqB,GAAM,mBAA+B,eAAuB,EAAgB,cAAc,GAAM,qBAAqB,GAAO,EAAgB,iBAAiB,EAAgB,SAEpO,EAAkB,EAAM,KACxB,EAAkB,EAAS,SAAS,aACpC,EAAkB,EAClB,EAAkB,EAElB,EAAa,UAAU,GAEvB,AAAI,IAAc,KAChB,EAAQ,UAAU,IAElB,EAAQ,YAAY,EAAQ,aAAa,GAAY,GAAM,IAEtD,CACL,cAAe,EAAQ,SAAS,IAAI,EAAc,UAClD,aAAe,EAAQ,SAAS,IAAI,EAAa,YAI9C,KAGT,aACA,CACE,AAAI,IAAc,EAAM,MAEtB,GAAY,EAAM,OAElB,EAAc,YAAY,AAAC,GAC3B,CACE,GAAM,GAAkB,EAAW,QAAU,GAAM,YAAe,GAAO,cAAgB,GAAO,eAChG,EAAyB,GAAuB,GAAkB,IAClE,GAAM,GAAiB,EAAc,cAAgB,EAC/C,EAAiB,EAAiB,EAAiB,IAEzD,AAAI,IAAa,GAAK,KACpB,EAAa,EACN,IAAa,GAAK,OACzB,GAAc,EAAgB,EAAW,OAAU,EAAW,OAAS,GAEzE,GAAM,IAAI,4BAA4B,EAAc,QAAQ,2BAA2B,EAAc,QAAQ,wBAAwB,EAAW,QAAQ,4BAA4B,QAEpL,EAAa,YAAa,EAAW,QAAU,GAAM,YAAe,GAAiB,GAAY,MAKvG,YACA,CACE,GAAM,IAAI,uBAAuB,GAAM,qBAAqB,EAAO,MAE/D,IAAc,EAAM,MAElB,KAAe,IAEjB,eAAc,GACd,EAAa,IAGX,IAAkB,MAEpB,GAAc,QACd,EAAc,OAAO,GAGrB,WAAW,IACX,CACE,EAAc,UAAU,EAAS,SAAS,cAC1C,EAAgB,MAElB,MAGE,IAAiB,MACnB,GAAe,MAEjB,EAAkB,EAAM,KACxB,EAAkB,EAClB,EAAkB,EAClB,EAAkB,GAAK,KACvB,EAAkB,KAClB,EAAkB,GAItB,YAAc,EACd,CACE,AAAI,IAAkB,MACpB,EAAc,KAAK,GAGvB,YAAa,EACb,CAIE,MAHA,GAAgB,EAAQ,QACxB,EAAiB,IAAc,KAAQ,EAAQ,KAAO,EAAQ,cAAc,GAExE,KAAc,eAAiB,EAAa,eASlD,aACA,CACE,EAAc,YAAY,AAAC,GAC3B,CAEE,GAAM,GAAiB,EAAuB,IAAQ,EAChD,EAAgB,GAAY,EAAK,EAAW,EAG5C,EAAa,EAAmB,EAAmB,GAAe,GAClE,GAAc,GAAU,EAAO,IAAO,EAAS,EAAO,IAEtD,GAAgB,KAAK,MAAM,KAAK,KAAK,EAAkB,KACvD,GAAgB,KAAK,MAAM,KAAK,KAAK,EAAmB,GAAkB,MAEhF,AAAK,GAAgB,GAAgB,IAAc,EAAO,KAAS,IAAgB,EAEjF,GAAc,UAAU,EAAO,KAC/B,EAAa,UAAU,GACvB,KAIA,GAAc,UAAU,IACxB,EAAa,UAAU,OAK7B,aACA,CACE,EAAc,YAAY,AAAC,GAC3B,CACE,GAAM,GAAkB,EAAuB,IAAQ,EACjD,EAAgB,KAAK,MAAM,EAAmB,GAAe,IAC7D,EAAgB,EAAkB,EAExC,AAAK,EAAe,GAAgB,EAAgB,EAAO,KAAS,EAAe,EAEjF,GAAc,UAAU,EAAO,KAC/B,EAAa,UAAU,GACvB,KAIA,GAAc,UAAU,GACxB,EAAa,UAAU,QCvN/B,GAAM,IAAQ,AAAY,EAAY,gBAOtC,QACA,CACE,YAAY,EAAS,EAAU,EAC/B,CACE,KAAK,QAAiB,EACtB,KAAK,SAAiB,EACtB,KAAK,eAAiB,EACtB,KAAK,SAAiB,GAEtB,KAAK,SAAW,EAChB,KAAK,OAAW,KAChB,KAAK,MAAW,KAEhB,KAAK,aAAqB,KAC1B,KAAK,eAAqB,eAC1B,KAAK,UAAqB,GAAI,OAC9B,KAAK,UAAU,SAAW,QAG5B,YAAsB,CAAE,MAAO,MAAK,QACpC,aAAsB,CAAE,MAAO,MAAK,SACpC,QAAsB,CAAE,MAAO,MAAK,SACpC,mBAAsB,CAAE,MAAO,MAAK,eAEpC,aAAsB,CAAE,MAAO,MAAK,SACpC,YAAY,EAAU,CAAE,KAAK,SAAW,EAExC,aAAsB,CAAE,MAAO,MAAK,SACpC,YAAY,EAAU,CAAE,KAAK,SAAW,EAExC,WAAsB,CAAE,MAAO,MAAK,OACpC,UAAU,EAAY,CAAE,KAAK,OAAS,EAEtC,UAAsB,CAAE,MAAO,MAAK,MACpC,SAAS,EAAa,CAAE,KAAK,MAAQ,EAErC,iBAAsB,CAAE,MAAO,MAAK,aACpC,mBAAsB,CAAE,MAAO,MAAK,eAEpC,OAAO,EAAe,CAAE,KAAK,eAAe,OAAO,GACnD,UAAU,EAAY,CAAE,KAAK,eAAe,UAAU,GAEtD,aAAa,EACb,CACE,KAAK,aAAiB,EAAU,IAChC,KAAK,eAAiB,EAAU,MAChC,KAAK,UAAU,IAAO,EAAU,MAS7B,gBAAsB,GAC7B,CACE,YAAY,EAAS,EAAU,EAAgB,EAC/C,CACE,MAAM,EAAS,EAAU,GACzB,KAAK,oBAAsB,GAC3B,MAAM,aAAa,GAAiB,IAGtC,OAAQ,CAAE,KAAK,eAAe,aAC9B,MAAQ,CAAE,KAAK,eAAe,YAM9B,gBAAgB,EAChB,CAGE,MAFA,IAAM,IAAI,yCAAyC,KAAK,eAAe,4CAA4C,KAAK,mCAAmC,KAAK,YAE3J,KAAK,eAAe,mBAAqB,IAAQ,KAAK,sBAAwB,IAAQ,KAAK,WAAa,GAE3G,IAAM,KAAK,sDAAsD,KAAK,kBAAkB,KAAK,6BAA6B,KAAK,eAAe,eAAe,2CAE7J,KAAK,SAAW,GAChB,EAAgB,KAAM,KAAK,eAAe,eAEnC,IAGT,MAAK,oBAAsB,KAAK,eAAe,iBAExC,IAGT,KAAK,EACL,CACE,AAAI,KAAK,gBAAgB,KAAqB,IAE5C,CAAI,KAAK,WAAa,GACpB,KAAK,eAAe,YAEpB,EAAgB,KAAM,KAAK,eAAe,gBAIhD,UAAU,EACV,CACE,EAAS,KAAK,eAAe,aAG/B,KAAK,EACL,CACE,AAAI,EACF,KAAK,eAAe,OAEpB,KAAK,eAAe,SAGxB,YAAY,EACZ,CACE,EAAU,KAAK,eAAe,iBAAmB,IAAO,KAAK,YAS1D,gBAAyB,GAChC,CACE,YAAY,EAAS,EAAU,EAAgB,EAC/C,CACE,MAAM,EAAS,EAAU,GACzB,KAAK,QAAU,KAAK,WAAW,GAC/B,KAAK,OAAU,EAAO,IACtB,KAAK,MAAU,GAGjB,WAAW,EACX,CACE,GAAI,EACJ,CAEE,GAAM,GAAiB,AADA,GAAI,KAAI,mBAAmB,IACZ,aAAa,IAAI,OAEvD,GAAI,IAAa,KACjB,CACE,GAAM,GAAgB,EAAS,MAAM,KAC/B,EAAgB,SAAS,cAE/B,OAAS,GAAI,EAAG,EAAI,EAAc,OAAQ,IAExC,GAAI,EAAc,GAAG,gBAAkB,EACrC,MAAO,UAAS,EAAc,EAAI,KAK1C,UAAM,MAAM,mDAAmD,KAAK,YAE7D,KAGT,aAAa,EACb,CACE,KAAK,eAAe,gBAAgB,GACpC,CACE,MAAM,aAAa,GAAoB,IACvC,GAA0B,aAAa,2BAA4B,KAAK,qBAK5E,QAAS,CAAE,MAAO,MAAK,QACvB,OAAS,CAAE,KAAK,eAAe,QAE/B,KAAK,EACL,CAEE,AAAI,KAAK,WAAa,GAEpB,KAAK,eAAe,gBAAgB,GACpC,CACE,AAAI,EAAY,WAAa,GAC3B,KAAK,eAAe,OAEpB,EAAgB,KAAM,EAAY,iBAKtC,EAAgB,KAAM,0BAI1B,MACA,CACE,KAAK,QACL,MAAM,OAAO,GAIf,OAAO,EACP,CACE,MAAM,OAAO,EAAkB,KAGjC,UAAU,EACV,CACE,KAAK,eAAe,UAAU,GAAU,EAAS,IAInD,UAAU,EACV,CACE,AAAI,IAAW,GACb,MAAK,OAAS,GAEX,MAAK,QAAU,IAAW,IAAW,IACxC,MAAM,UAAU,GAGpB,KAAK,EACL,CACE,KAAK,MAAQ,IAEb,AAAI,EACF,KAAK,UAAU,GAEf,KAAK,UAAU,KAAK,QAGxB,YAAY,EACZ,CACE,KAAK,eAAe,YAAY,GAAwB,EAAS,EAAsB,KAAK,aASzF,gBAAuB,GAC9B,CACE,YAAY,EACZ,CACE,MAAM,KAAM,KAAM,GAClB,KAAK,UAAe,EACpB,KAAK,aAAe,EACpB,KAAK,YAAe,MAGlB,WAAkB,CAAE,MAAO,MAAK,eACpC,cAAsB,CAAE,MAAO,MAAK,UACpC,iBAAsB,CAAE,MAAO,MAAK,aACpC,eAAe,EAAO,CAAE,KAAK,YAAc,EAE3C,KAAK,EACL,CAEE,AAAK,KAAK,cAAgB,GAAO,KAAK,eAAe,gBAAkB,EAErE,GAAgB,CAAE,KAAM,wDACxB,KAAK,YAAc,IAInB,KAAK,eAAe,YAIxB,aAAa,EACb,CACE,MAAM,aAAa,GAAiB,uBAAuB,MAG7D,cACA,CACE,MAAO,CACL,aAAc,KAAK,kBACnB,UAAc,KAAK,eACnB,OAAc,KAAK,YACnB,MAAc,KAAK,WACnB,UAAc,CAAE,IAAK,KAAK,kBAAmB,MAAO,KAAK,wBAWzD,GAAkB,CAAE,IAAK,6DAA8D,MAAO,eAAgB,IAAK,IAC5G,GAAsB,sCAE5B,YAA0B,EACjC,CACE,GAAM,GAAiB,EAAe,MAAM,IAE5C,MAAI,KAAmB,KACd,CAAE,IAAK,8BAA8B,EAAe,iBAAkB,MAAO,eAAgB,IAAK,EAAe,IAEnH,GAGT,YAA6B,EAC7B,CACE,GAAM,GAAgB,EAAY,cAAgB,KACzB,EAAY,YACZ,EAAY,KAAK,WAE1C,MAAI,GACK,CAAE,IAAK,EAAc,MAAO,kBAAmB,IAAK,IAEtD,GC7TT,GAAM,GAAQ,AAAY,EAAY,SAEzB,GAAW,EAAM,UAAY,kCAAyC,wBAC7E,GAAkB,EAAM,UAAY,uCAAyC,6BAE7E,GAAgB,EAAM,UACF,8DACA,mDAEpB,GAAoB,GAAI,WAEjB,GAAQ,CACnB,oBAAuB,EACvB,eAAuB,EACvB,sBAAuB,GAGnB,GAAqB,OAAO,WAAW,eAAe,GAAiB,6BACvE,GAAqB,OAAO,WAAW,eAAe,GAAiB,wBACvE,GAAqB,OAAO,WAAW,eAAe,GAAiB,+BAOtE,YAAqB,EAAW,EAAM,EAAU,EAAO,KAC9D,CACE,SAAS,cAAc,IAAY,iBAAiB,EAAM,AAAC,GAAU,EAAS,EAAO,IAKhF,YAAwB,EAAW,EAAM,EAAU,EAAO,KACjE,CAEE,AADoB,SAAS,iBAAiB,GAClC,QAAQ,GAAW,EAAQ,iBAAiB,EAAM,AAAC,GAAU,EAAS,EAAO,KAGpF,YAA0B,EAAM,EAAU,SAAS,gBAC1D,CACE,GAAI,GAAS,iBAAiB,GAAS,iBAAiB,GAExD,MAAI,GAAO,SAAW,EACpB,EAAS,EAAO,QAAQ,OAAQ,IAAI,OAEpC,EAAM,MAAM,oBAAoB,6CAE3B,EAGF,YAAyB,EAAM,EAAU,SAAS,gBACzD,CACE,GAAM,GAAS,GAAiB,EAAM,GAClC,EAAW,IAEf,MAAI,GAAO,SAAW,GACpB,GAAQ,SAAS,IAEf,MAAM,IACR,EAAM,MAAM,mBAAmB,0CAE1B,EAIF,YAAsB,EAC7B,CACE,OAAQ,OAED,IAAM,oBACT,MAAO,IAAiB,YAErB,IAAM,eACT,MAAO,IAAa,YAEjB,IAAM,sBACT,MAAO,IAAmB,QAG9B,MAAO,GAGF,YAAsB,EAAS,EAAa,EACnD,CACE,EAAQ,UAAU,OAAO,GACzB,EAAQ,UAAU,IAAI,GAQxB,GAAM,IAAY,CAChB,IAAK,QACL,IAAK,OACL,IAAK,OACL,IAAK,SACL,IAAK,QACL,IAAK,SACL,IAAK,SACL,IAAK,UAGA,YAAiB,EACxB,CACE,MAAO,QAAO,GAAQ,QAAQ,cAAe,AAAC,GAAM,GAAU,IAGzD,YAAsB,EAAS,EACtC,CACE,GAAM,GAAQ,EAAQ,aAAa,GAEnC,MAAI,KAAU,KACL,GAAQ,GAEV,EAMF,YAAmB,EAC1B,CACE,GAAM,GAAa,GAAkB,gBAAgB,EAAQ,aAK7D,MAAO,AAJY,IAAkB,gBAAgB,EAAU,KAAK,YAAa,aAI/D,KAAK,YAGlB,YAAwB,EAAS,EACxC,CACE,GAAM,GAAQ,EAAQ,aAAa,GAEnC,MAAI,KAAU,KACL,GAAU,GAEZ,EAQF,YAAkB,EACzB,CACE,AAAI,GAAY,EAAQ,MAAM,MAAmB,KAE/C,GAAM,IAAI,+BAA+B,KACzC,OAAO,SAAS,KAAO,GAEhB,IAAY,MAEnB,GAAM,MAAM,iCAAiC,KAC7C,EAAa,2BAA4B,EAAG,SAAU,IAAM,SAAS,WAIlE,YAA0B,EACjC,CACE,MAAO,GAAQ,QAAQ,GAAU,IAG5B,YAA6B,EACpC,CACE,MAAO,GAAQ,QAAQ,GAAe,IAGjC,YAA0B,EACjC,CACE,GAAI,GAEF,GAAI,EAAS,SAAS,kBAAoB,GAAY,MAEpD,GAAI,EAAQ,WAAW,MAAmB,GACxC,MAAO,IAAiB,WAEnB,EAAS,SAAS,kBAAoB,GAAY,SAErD,EAAQ,WAAW,MAAmB,GACxC,MAAO,IAAoB,GAIjC,MAAO,GAGF,YAA0B,EACjC,CACE,MAAI,GAAS,oBAAsB,EAAW,QACrC,GAAiB,EAAS,mBAE5B,CAAE,IAAK,oEAAqE,MAAO,kBAAmB,IAAK,ICxMpH,GAAM,IAAQ,AAAY,EAAY,YAEhC,EAAI,CACR,WAAkB,EAClB,YAAkB,KAClB,WAAkB,KAClB,iBAAkB,GAClB,cAAkB,IAGd,EAAS,CAAE,GAAI,YAEf,GAAW;AAAA,aACJ,EAAO;AAAA,kBACF,EAAO;AAAA,oBACL,EAAO;AAAA,oBACP,EAAO;AAAA,oBACP,EAAO;AAAA;AAAA;AAAA,EAKrB,EAAW,CACf,SAAY,KACZ,WAAY,KACZ,UAAY,MAQP,WAAsB,EAAS,EAAU,EAAG,EAAa,KAAM,EAAsB,KAAM,EAAqB,IAAM,GAC7H,CACE,UAAM,IAAI,mBAAmB,MAAY,WAEzC,KACA,KAEA,EAAS,SAAS,cAAc,IAAI,EAAO,cAAc,UAAY,EACrE,EAAS,SAAS,UAAU,IAAI,QAChC,EAAS,WAAW,MAAM,QAAU,OACpC,EAAE,WAAa,EAEf,AAAK,IAAe,MAAU,IAAwB,KAEpD,GAAE,YAAc,EAChB,EAAS,WAAW,MAAM,QAAU,QACpC,EAAS,WAAW,YAAgB,EACpC,EAAS,WAAW,iBAAiB,QAAS,KAK9C,AAAI,GAAa,GAAM,uBACrB,EAAS,UAAU,MAAM,YAAc,OAEvC,EAAS,UAAU,MAAM,YAAc,OAGvC,IAAY,GAEd,GAAE,iBAAmB,WAAW,IAChC,CACE,EAAS,SAAS,UAAU,IAAI,QAEhC,EAAE,cAAgB,WAAW,IAC7B,CACE,EAAS,SAAS,UAAY,GAC9B,EAAE,cACD,MAEJ,EAAU,MAGN,EAAE,EAAE,WAGN,YAAyB,EAAY,EAC5C,CACE,AAAI,MAEG,GAAE,aAAe,GAAO,EAAE,aAAe,IAE5C,GAAS,SAAS,UAAU,IAAI,QAChC,EAAE,cAAgB,WAAW,IAAO,EAAS,SAAS,UAAY,GAAK,MAU7E,aACA,CACE,AAAI,EAAS,WAAa,MAExB,UAAS,KAAK,mBAAmB,YAAa,IAE9C,EAAS,SAAa,SAAS,eAAe,EAAO,IACrD,EAAS,WAAa,EAAS,SAAS,cAAc,IAAI,EAAO,kBACjE,EAAS,UAAa,EAAS,SAAS,cAAc,IAAI,EAAO,iBAEjE,EAAS,UAAU,iBAAiB,QAAS,IAC7C,CACE,EAAE,aACF,GAAM,OAKZ,aACA,CACE,EAAE,cACF,GAAM,IAGR,aACA,CACE,MAAS,GAAS,WAAa,MACtB,EAAS,SAAS,UAAU,SAAW,GACvC,EAAS,SAAS,UAAU,SAAS,QAGhD,YAAe,EAAe,GAC9B,CACE,AAAI,EAAE,mBAAqB,IAEzB,cAAa,EAAE,kBACf,EAAE,iBAAmB,IAGnB,EAAE,gBAAkB,IAEtB,cAAa,EAAE,eACf,EAAE,cAAgB,IAGhB,EAAS,aAAe,MAC1B,EAAS,WAAW,oBAAoB,QAAS,IAE/C,GACF,EAAS,SAAS,UAAU,OAAO",
  "names": []
}
