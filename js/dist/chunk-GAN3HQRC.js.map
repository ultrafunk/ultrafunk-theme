{
  "version": 3,
  "sources": ["../src/shared/debuglogger.js", "../src/shared/settings/settings.js", "../src/shared/settings/validate-settings.js", "../src/shared/storage.js", "../src/shared/session-data.js", "../src/playback/gallery/crossfade.js", "../src/playback/mediaplayers.js", "../src/shared/utils.js", "../src/shared/snackbar.js", "../src/playback/gallery/single-track-next.js", "../src/shared/element-toggle.js", "../src/playback/playback-events.js", "../src/playback/element-wrappers.js", "../src/playback/playback-controls.js", "../src/shared/element-click.js", "../src/playback/list/list-track-templates.js", "../src/playback/list/list-tracks-rest.js", "../src/playback/list/list-controls.js", "../src/shared/modal-templates.js", "../src/shared/modal.js", "../src/playback/list/up-next-modal.js", "../src/playback/shared-gallery-list.js", "../src/playback/footer-toggles.js"],
  "sourcesContent": ["//\r\n// Debug logging helper classes\r\n//\r\n// https://ultrafunk.com\r\n//\r\n\r\n\r\nconst DEBUG = false;\r\n\r\n\r\n// ************************************************************************************************\r\n// DebugLog parent and child classes\r\n// ************************************************************************************************\r\n\r\nclass DebugLog\r\n{\r\n  constructor(moduleName = 'unknown')\r\n  {\r\n    this.moduleName = padString(moduleName.toUpperCase(), 20, '.');\r\n  }\r\n  \r\n  isDebug()   { return DEBUG;                               }\r\n  warn(data)  { console.warn(`${this.moduleName}:`,  data); }\r\n  error(data) { console.error(`${this.moduleName}:`, data); }\r\n}\r\n\r\nclass DevBuild extends DebugLog\r\n{\r\n  log(data)\r\n  {\r\n    console.log(`${this.moduleName}:`, data);\r\n  }\r\n\r\n  logEventLog(eventLog, eventSource, eventType)\r\n  {\r\n    const entries = [];\r\n    \r\n    for (let i = 0; i < eventLog.length; i++)\r\n    {\r\n      const data = {\r\n        eventSource: this.getKeyForValue(eventSource, eventLog[i].eventSource),\r\n        eventType:   this.getKeyForValue(eventType, eventLog[i].eventType),\r\n        uId:         eventLog[i].uId,\r\n        timeStamp:   eventLog[i].timeStamp,\r\n      };\r\n\r\n      entries.push(data);\r\n    }\r\n    \r\n    this.log(entries);\r\n  }\r\n\r\n  getKeyForValue(object, value)\r\n  {\r\n    return Object.keys(object).find(key => (object[key] === value));\r\n  }\r\n}\r\n\r\nclass ProdBuild extends DebugLog\r\n{\r\n  log()            {}\r\n  logEventLog()    {}\r\n  getKeyForValue() {}\r\n}\r\n\r\n\r\n// ************************************************************************************************\r\n// DebugLog class support functions\r\n// ************************************************************************************************\r\n\r\nexport function newInstance(moduleName)\r\n{\r\n  return ((DEBUG === true)\r\n           ? new DevBuild(moduleName)\r\n           : new ProdBuild(moduleName));\r\n}\r\n\r\nfunction padString(string, maxLength, padChar)\r\n{\r\n  return ((string.length > maxLength)\r\n           ? string.slice(0, maxLength)\r\n           : string.padEnd(maxLength, padChar));\r\n}\r\n\r\nexport function logErrorOnServer(errorCategory, errorData)\r\n{\r\n  const eventAction = errorData.mediaUrl + ' | ' + errorData.mediaTitle;\r\n  \r\n  console.warn(`logErrorOnServer(): ${errorCategory} - ${eventAction}`);\r\n  \r\n  gtag('event', eventAction, // eslint-disable-line no-undef\r\n  {\r\n    event_category: errorCategory,\r\n    event_label:    'Ultrafunk Client Error',\r\n  });\r\n}\r\n", "//\r\n// Schemas and default objects for settings data\r\n//\r\n// https://ultrafunk.com\r\n//\r\n\r\n\r\nconst INTEGER = 1;\r\nconst BOOLEAN = 2;\r\nconst STRING  = 3;\r\n\r\nexport {\r\n  INTEGER as TYPE_INTEGER,\r\n  BOOLEAN as TYPE_BOOLEAN,\r\n  STRING  as TYPE_STRING,\r\n};\r\n\r\nexport const PREF_PLAYER = {\r\n  NONE:    0,\r\n  GALLERY: 1,\r\n  LIST:    2,\r\n};\r\n\r\n\r\n// ************************************************************************************************\r\n// Ultrafunk (user) settings:     Playback, List, Gallery, Mobile and Site\r\n// Ultrafunk (internal) settings: Tips and Banners\r\n// ************************************************************************************************\r\n\r\nconst galleryPerPageValues       = [...Array(22).keys()].map(i => i + 3);\r\nconst galleryPerPageValueStrings = [...Array(22).keys()].map(i => `${i + 3}`);\r\n\r\nexport const settingsSchema = {\r\n  version: { description: '', type: INTEGER, values: [1, 999999], default: 18, valueStrings: [] },\r\n  playback: {\r\n    preferredPlayer:      { description: 'Preferred Player',                type: INTEGER, values: [1, 2],               default: 2,     valueStrings: ['Gallery', 'List'] },\r\n    keyboardShortcuts:    { description: 'Keyboard Shortcuts',              type: BOOLEAN, values: [true, false],        default: true,  valueStrings: ['ON', 'OFF'] },\r\n    masterVolume:         { description: 'Master Volume',                   type: INTEGER, values: [0, 25, 50, 75, 100], default: 100,   valueStrings: ['0%', '25%', '50%', '75%', '100%'] },\r\n    masterMute:           { description: 'Master Mute',                     type: BOOLEAN, values: [true, false],        default: false, valueStrings: ['ON', 'OFF'] },\r\n    autoplay:             { description: 'Autoplay next track',             type: BOOLEAN, values: [true, false],        default: true,  valueStrings: ['ON', 'OFF'] },\r\n    autoExitFullscreen:   { description: 'Exit Fullscreen on next track',   type: BOOLEAN, values: [true, false],        default: true,  valueStrings: ['ON', 'OFF'] },\r\n    timeRemainingWarning: { description: 'Track Time Remaining Warning',    type: BOOLEAN, values: [true, false],        default: true,  valueStrings: ['ON', 'OFF'] },\r\n    timeRemainingSeconds: { description: 'Time Remaining Warning Seconds',  type: INTEGER, values: [30, 60, 90, 120],    default: 60,    valueStrings: ['30 sec', '60 sec', '90 sec', '120 sec'] },\r\n    autoExitFsOnWarning:  { description: 'Exit Fullscreen on Time Warning', type: BOOLEAN, values: [true, false],        default: true,  valueStrings: ['ON', 'OFF'] },\r\n  },\r\n  list: {\r\n    moveTrackOnPlayNext: { description: 'Move Track on Play as Next',        type: BOOLEAN, values: [true, false], default: true, valueStrings: ['ON', 'OFF'] },\r\n    showUpNextModal:     { description: 'Show Up Next Modal',                type: BOOLEAN, values: [true, false], default: true, valueStrings: ['ON', 'OFF'] },\r\n    showLoadMoreTracks:  { description: 'Show \"Load More Tracks...\" prompt', type: BOOLEAN, values: [true, false], default: true, valueStrings: ['ON', 'OFF'] },\r\n  },\r\n  gallery: {\r\n    layout:                  { description: 'Track Layout',                         type: STRING,  values: ['1-column', '2-column', '3-column'],    default: '3-column', valueStrings: ['1 Column', '2 Column', '3 / 4 Column'] },\r\n    fetchNextSingleTrack:    { description: 'Play single tracks without page load', type: BOOLEAN, values: [true, false],           default: true,  valueStrings: ['ON', 'OFF'] },\r\n    tracksPerPage:           { description: 'Tracks Per Page: Search & Shuffle',    type: INTEGER, values: galleryPerPageValues,    default: 12,    valueStrings: galleryPerPageValueStrings },\r\n    autoCrossfade:           { description: 'Auto Crossfade to next track',         type: BOOLEAN, values: [true, false],           default: false, valueStrings: ['ON', 'OFF'] },\r\n    autoCrossfadeLength:     { description: 'Auto Crossfade Length',                type: INTEGER, values: [5, 10, 15, 20, 25, 30], default: 20,    valueStrings: ['5 sec', '10 sec', '15 sec', '20 sec', '25 sec', '30 sec'] },\r\n    autoCrossfadeCurve:      { description: 'Auto Crossfade Curve',                 type: INTEGER, values: [1, 2],                  default: 2,     valueStrings: ['Equal Power', 'Linear'] },\r\n    autoScroll:              { description: 'Autoscroll to next track',             type: BOOLEAN, values: [true, false],           default: true,  valueStrings: ['ON', 'OFF'] },\r\n    animateNowPlayingIcon:   { description: 'Animate Now Playing Track Icon',       type: BOOLEAN, values: [true, false],           default: true,  valueStrings: ['ON', 'OFF'] },\r\n    trackCrossfadeDefPreset: { description: 'Track Crossfade Def. Preset',          type: INTEGER, values: [0, 1, 2, 3, 4, 5],      default: 1,     valueStrings: ['10 sec EqPow (1)', '20 sec EqPow (2)', '30 sec EqPow (3)', '10 sec Linear (4)', '20 sec Linear (5)', '30 sec Linear (6)'] },\r\n  },\r\n  mobile: {\r\n    keepScreenOn:        { description: 'Keep Screen On when playing', type: BOOLEAN, values: [true, false], default: false, valueStrings: ['ON', 'OFF'] },\r\n    showTrackThumbnail:  { description: 'Show Track Thumbnail',        type: BOOLEAN, values: [true, false], default: true,  valueStrings: ['ON', 'OFF'] },\r\n    showTrackTimes:      { description: 'Show Track Times',            type: BOOLEAN, values: [true, false], default: true,  valueStrings: ['ON', 'OFF'] },\r\n    showPrevTrackButton: { description: 'Show Previous Track button',  type: BOOLEAN, values: [true, false], default: true,  valueStrings: ['ON', 'OFF'] },\r\n  },\r\n  site: {\r\n    keyboardShortcuts:   { description: 'Keyboard Shortcuts',                    type: BOOLEAN, values: [true, false],                        default: true,   valueStrings: ['ON', 'OFF'] },\r\n    theme:               { description: 'Theme',                                 type: STRING,  values: ['light', 'dark', 'auto'],            default: 'auto', valueStrings: ['Light', 'Dark', 'Auto / System'] },\r\n    smoothScrolling:     { description: 'Use Smooth Scrolling (where possible)', type: BOOLEAN, values: [true, false],                        default: true,   valueStrings: ['ON', 'OFF'] },\r\n    modalOverlayOpacity: { description: 'Modal overlay opacity',                 type: INTEGER, values: [10, 20, 30, 40, 50, 60, 70, 80, 90], default: 60,     valueStrings: ['10%', '20%', '30%', '40%', '50%', '60%', '70%', '80%', '90%'] },\r\n  },\r\n  experimental: {\r\n    fetchNextSingleTrack: { description: '<b>Gallery Player</b><br>Play single tracks without page reload', type: BOOLEAN, values: [true, false], default: false, valueStrings: ['ON', 'OFF'] },\r\n  },\r\n  tips: {\r\n    showTrackDetailsHint:          { description: '', type: BOOLEAN, values: [true, false], default: true,  valueStrings: [] },\r\n    showUpNextModalHint:           { description: '', type: BOOLEAN, values: [true, false], default: true,  valueStrings: [] },\r\n    showGalleryTrackThumbnailHint: { description: '', type: BOOLEAN, values: [true, false], default: true,  valueStrings: [] },\r\n    showListTrackThumbnailHint:    { description: '', type: BOOLEAN, values: [true, false], default: true,  valueStrings: [] },\r\n    showTrackTimerHint:            { description: '', type: BOOLEAN, values: [true, false], default: true,  valueStrings: [] },\r\n  },\r\n  banners: {\r\n    showFrontpageIntro: { description: '', type: BOOLEAN, values: [true, false], default: true, valueStrings: [] },\r\n    showPremiumIntro:   { description: '', type: BOOLEAN, values: [true, false], default: true, valueStrings: [] },\r\n    showPromoIntro:     { description: '', type: BOOLEAN, values: [true, false], default: true, valueStrings: [] },\r\n  }\r\n};\r\n\r\nexport const defaultSettings = {\r\n  version: settingsSchema.version.default,\r\n  playback: {\r\n    preferredPlayer:      settingsSchema.playback.preferredPlayer.default,\r\n    keyboardShortcuts:    settingsSchema.playback.keyboardShortcuts.default,\r\n    masterVolume:         settingsSchema.playback.masterVolume.default,\r\n    masterMute:           settingsSchema.playback.masterMute.default,\r\n    autoplay:             settingsSchema.playback.autoplay.default,\r\n    autoExitFullscreen:   settingsSchema.playback.autoExitFullscreen.default,\r\n    timeRemainingWarning: settingsSchema.playback.timeRemainingWarning.default,\r\n    timeRemainingSeconds: settingsSchema.playback.timeRemainingSeconds.default,\r\n    autoExitFsOnWarning:  settingsSchema.playback.autoExitFsOnWarning.default,\r\n  },\r\n  list: {\r\n    moveTrackOnPlayNext: settingsSchema.list.moveTrackOnPlayNext.default,\r\n    showUpNextModal:     settingsSchema.list.showUpNextModal.default,\r\n    showLoadMoreTracks:  settingsSchema.list.showLoadMoreTracks.default,\r\n  },\r\n  gallery: {\r\n    layout:                  settingsSchema.gallery.layout.default,\r\n    fetchNextSingleTrack:    settingsSchema.gallery.fetchNextSingleTrack.default,\r\n    tracksPerPage:           settingsSchema.gallery.tracksPerPage.default,\r\n    autoCrossfade:           settingsSchema.gallery.autoCrossfade.default,\r\n    autoCrossfadeLength:     settingsSchema.gallery.autoCrossfadeLength.default,\r\n    autoCrossfadeCurve:      settingsSchema.gallery.autoCrossfadeCurve.default,\r\n    autoScroll:              settingsSchema.gallery.autoScroll.default,\r\n    animateNowPlayingIcon:   settingsSchema.gallery.animateNowPlayingIcon.default,\r\n    trackCrossfadeDefPreset: settingsSchema.gallery.trackCrossfadeDefPreset.default,\r\n  },\r\n  mobile: {\r\n    keepScreenOn:        settingsSchema.mobile.keepScreenOn.default,\r\n    showTrackThumbnail:  settingsSchema.mobile.showTrackThumbnail.default,\r\n    showTrackTimes:      settingsSchema.mobile.showTrackTimes.default,\r\n    showPrevTrackButton: settingsSchema.mobile.showPrevTrackButton.default,\r\n  },\r\n  site: {\r\n    keyboardShortcuts:   settingsSchema.site.keyboardShortcuts.default,\r\n    theme:               settingsSchema.site.theme.default,\r\n    smoothScrolling:     settingsSchema.site.smoothScrolling.default,\r\n    modalOverlayOpacity: settingsSchema.site.modalOverlayOpacity.default,\r\n  },\r\n  experimental: {\r\n    fetchNextSingleTrack: settingsSchema.experimental.fetchNextSingleTrack.default,\r\n  },\r\n  tips: {\r\n    showTrackDetailsHint:          settingsSchema.tips.showTrackDetailsHint.default,\r\n    showUpNextModalHint:           settingsSchema.tips.showUpNextModalHint.default,\r\n    showGalleryTrackThumbnailHint: settingsSchema.tips.showGalleryTrackThumbnailHint.default,\r\n    showListTrackThumbnailHint:    settingsSchema.tips.showListTrackThumbnailHint.default,\r\n    showTrackTimerHint:            settingsSchema.tips.showTrackTimerHint.default,\r\n  },\r\n  banners: {\r\n    showFrontpageIntro: settingsSchema.banners.showFrontpageIntro.default,\r\n    showPremiumIntro:   settingsSchema.banners.showPremiumIntro.default,\r\n    showPromoIntro:     settingsSchema.banners.showPromoIntro.default,\r\n  },\r\n};\r\n\r\n\r\n// ************************************************************************************************\r\n// Presets\r\n// ************************************************************************************************\r\n\r\nexport const presetsSchema = {\r\n  version: { description: '', type: INTEGER, values: [1, 999999], default: 1, valueStrings: [] },\r\n  crossfade: [\r\n    {\r\n      name:   { description: 'Preset 1',         type: STRING,  values: [5, 50],                 default: '10 sec EqPow', valueStrings: [] },\r\n      length: { description: 'Crossfade Length', type: INTEGER, values: [5, 10, 15, 20, 25, 30], default: 10,             valueStrings: ['5 sec', '10 sec', '15 sec', '20 sec', '25 sec', '30 sec'] },\r\n      curve:  { description: 'Crossfade Curve',  type: INTEGER, values: [1, 2],                  default: 1,              valueStrings: ['Equal Power', 'Linear'] },\r\n    },\r\n    {\r\n      name:   { description: 'Preset 2',         type: STRING,  values: [5, 50],                 default: '20 sec EqPow', valueStrings: [] },\r\n      length: { description: 'Crossfade Length', type: INTEGER, values: [5, 10, 15, 20, 25, 30], default: 20,             valueStrings: ['5 sec', '10 sec', '15 sec', '20 sec', '25 sec', '30 sec'] },\r\n      curve:  { description: 'Crossfade Curve',  type: INTEGER, values: [1, 2],                  default: 1,              valueStrings: ['Equal Power', 'Linear'] },\r\n    },\r\n    {\r\n      name:   { description: 'Preset 3',         type: STRING,  values: [5, 50],                 default: '30 sec EqPow', valueStrings: [] },\r\n      length: { description: 'Crossfade Length', type: INTEGER, values: [5, 10, 15, 20, 25, 30], default: 30,             valueStrings: ['5 sec', '10 sec', '15 sec', '20 sec', '25 sec', '30 sec'] },\r\n      curve:  { description: 'Crossfade Curve',  type: INTEGER, values: [1, 2],                  default: 1,              valueStrings: ['Equal Power', 'Linear'] },\r\n    },\r\n    {\r\n      name:   { description: 'Preset 4',         type: STRING,  values: [5, 50],                 default: '10 sec Linear', valueStrings: [] },\r\n      length: { description: 'Crossfade Length', type: INTEGER, values: [5, 10, 15, 20, 25, 30], default: 10,              valueStrings: ['5 sec', '10 sec', '15 sec', '20 sec', '25 sec', '30 sec'] },\r\n      curve:  { description: 'Crossfade Curve',  type: INTEGER, values: [1, 2],                  default: 2,               valueStrings: ['Equal Power', 'Linear'] },\r\n    },\r\n    {\r\n      name:   { description: 'Preset 5',         type: STRING,  values: [5, 50],                 default: '20 sec Linear', valueStrings: [] },\r\n      length: { description: 'Crossfade Length', type: INTEGER, values: [5, 10, 15, 20, 25, 30], default: 20,              valueStrings: ['5 sec', '10 sec', '15 sec', '20 sec', '25 sec', '30 sec'] },\r\n      curve:  { description: 'Crossfade Curve',  type: INTEGER, values: [1, 2],                  default: 2,               valueStrings: ['Equal Power', 'Linear'] },\r\n    },\r\n    {\r\n      name:   { description: 'Preset 6',         type: STRING,  values: [5, 50],                 default: '30 sec Linear', valueStrings: [] },\r\n      length: { description: 'Crossfade Length', type: INTEGER, values: [5, 10, 15, 20, 25, 30], default: 30,              valueStrings: ['5 sec', '10 sec', '15 sec', '20 sec', '25 sec', '30 sec'] },\r\n      curve:  { description: 'Crossfade Curve',  type: INTEGER, values: [1, 2],                  default: 2,               valueStrings: ['Equal Power', 'Linear'] },\r\n    },\r\n  ],\r\n};\r\n\r\nexport const presetList = {\r\n  version: presetsSchema.version.default,\r\n  crossfade: [\r\n    {\r\n      name:   presetsSchema.crossfade[0].name.default,\r\n      length: presetsSchema.crossfade[0].length.default,\r\n      curve:  presetsSchema.crossfade[0].curve.default,\r\n    },\r\n    {\r\n      name:   presetsSchema.crossfade[1].name.default,\r\n      length: presetsSchema.crossfade[1].length.default,\r\n      curve:  presetsSchema.crossfade[1].curve.default,\r\n    },\r\n    {\r\n      name:   presetsSchema.crossfade[2].name.default,\r\n      length: presetsSchema.crossfade[2].length.default,\r\n      curve:  presetsSchema.crossfade[2].curve.default,\r\n    },\r\n    {\r\n      name:   presetsSchema.crossfade[3].name.default,\r\n      length: presetsSchema.crossfade[3].length.default,\r\n      curve:  presetsSchema.crossfade[3].curve.default,\r\n    },\r\n    {\r\n      name:   presetsSchema.crossfade[4].name.default,\r\n      length: presetsSchema.crossfade[4].length.default,\r\n      curve:  presetsSchema.crossfade[4].curve.default,\r\n    },\r\n    {\r\n      name:   presetsSchema.crossfade[5].name.default,\r\n      length: presetsSchema.crossfade[5].length.default,\r\n      curve:  presetsSchema.crossfade[5].curve.default,\r\n    },\r\n  ],\r\n};\r\n", "//\r\n// Validation for playback and site settings\r\n//\r\n// https://ultrafunk.com\r\n//\r\n\r\n\r\nimport * as debugLogger from '../debuglogger.js';\r\n\r\nimport {\r\n  TYPE_INTEGER,\r\n  TYPE_BOOLEAN,\r\n  TYPE_STRING\r\n} from './settings.js';\r\n\r\n\r\n/*************************************************************************************************/\r\n\r\n\r\nconst debug = debugLogger.newInstance('validate-settings');\r\n\r\n\r\n// ************************************************************************************************\r\n// Validation\r\n// ************************************************************************************************\r\n\r\nexport function validateSettings(settings, schema)\r\n{\r\n  let invalidCount = 0;\r\n\r\n  validateRecursive(settings, schema);\r\n\r\n  return invalidCount;\r\n\r\n  function validateRecursive(settingsObject, schemaObject)\r\n  {\r\n    for (const key in settingsObject)\r\n    {\r\n      if (settingsObject && schemaObject && (typeof settingsObject[key] === 'object') && (typeof schemaObject[key] === 'object'))\r\n      {\r\n        validateRecursive(settingsObject[key], schemaObject[key]);\r\n      }\r\n      else\r\n      {\r\n        if (schemaObject[key] !== undefined)\r\n        {\r\n          if (isEntryInvalid(settingsObject, schemaObject[key], settingsObject[key], key))\r\n            invalidCount++;\r\n        }\r\n        else\r\n        {\r\n          throw(`'${key}' ${(typeof settingsObject[key] === 'object') ? 'object' : 'property'} is not in schema`);\r\n        }\r\n      }\r\n    }\r\n  }\r\n}\r\n\r\nfunction isEntryInvalid(settings, schemaEntry, settingValue, entryKey)\r\n{\r\n  switch (schemaEntry.type)\r\n  {\r\n    case TYPE_INTEGER:\r\n      if ((Number.isInteger(settingValue) === false) || (settingValue < schemaEntry.values[0]) || (settingValue > schemaEntry.values[schemaEntry.values.length - 1]))\r\n      {\r\n        debug.warn(`validate() - '${entryKey}' has invalid value: ${settingValue} ('${entryKey}' is type: INTEGER - min: ${schemaEntry.values[0]} - max: ${schemaEntry.values[schemaEntry.values.length - 1]}) -- setting default value: ${schemaEntry.default}`);\r\n        settings[entryKey] = schemaEntry.default;\r\n        return true;\r\n      }\r\n      break;\r\n    \r\n    case TYPE_BOOLEAN:\r\n      if ((settingValue !== true) && (settingValue !== false))\r\n      {\r\n        debug.warn(`validate() - '${entryKey}' has invalid value: ${settingValue} ('${entryKey}' is type: BOOLEAN) -- setting default value: ${schemaEntry.default}`);\r\n        settings[entryKey] = schemaEntry.default;\r\n        return true;\r\n      }\r\n      break;\r\n\r\n    case TYPE_STRING:\r\n      if (typeof settingValue !== 'string')\r\n      {\r\n        debug.warn(`validate() - '${entryKey}' has invalid value: ${settingValue} ('${entryKey}' is type: STRING) -- setting default value: ${schemaEntry.default}`);\r\n        settings[entryKey] = schemaEntry.default;\r\n        return true;\r\n      }\r\n      break;\r\n\r\n    default:\r\n      debug.warn(`validate() - '${entryKey}' has unknown type: ${schemaEntry.type}`);\r\n      return true;\r\n  }\r\n}\r\n\r\n", "//\r\n// Set and get storage values\r\n// Read, write and parse storage JSON data\r\n//\r\n// https://ultrafunk.com\r\n//\r\n\r\n\r\nimport * as debugLogger   from './debuglogger.js';\r\nimport { settingsSchema } from  './settings/settings.js';\r\n\r\nimport {\r\n  validateSettings as validateSettingsDeep\r\n} from './settings/validate-settings.js';\r\n\r\n\r\n/*************************************************************************************************/\r\n\r\n\r\nconst debug     = debugLogger.newInstance('storage');\r\nconst observers = {};\r\n\r\nexport const KEY = {\r\n//sessionStorage keys\r\n  UF_AUTOPLAY:         'uf_autoplay',\r\n  UF_TERMLIST_CACHE:   'uf_termlist_cache',\r\n  UF_TERMLIST_STATE:   'uf_termlist_state',\r\n//localStorage keys\r\n  UF_SETTINGS:         'uf_settings',\r\n  UF_PRESET_LIST:      'uf_preset_list',\r\n  UF_SITE_THEME:       'uf_site_theme',\r\n  UF_GALLERY_LAYOUT:   'uf_gallery_layout',\r\n//document.cookie keys\r\n//Merge all cookies into one cookie (UF_USER_SETTINGS) as a JSON encoded string\r\n//UF_USER_SETTINGS:    'uf_user_settings',\r\n//UF_LIST_PER_PAGE:    'uf_list_per_page',\r\n  UF_GALLERY_PER_PAGE: 'uf_gallery_per_page',\r\n  UF_PREFERRED_PLAYER: 'uf_preferred_player',\r\n  UF_SHUFFLE_UID:      'uf_shuffle_uid',\r\n//Temp document.cookie keys\r\n  UF_RESHUFFLE:        'uf_reshuffle',\r\n};\r\n\r\nconst DEPRECATED_KEYS = {\r\n//localStorage keys\r\n  UF_PLAYBACK_SETTINGS: 'UF_PLAYBACK_SETTINGS',\r\n  UF_SITE_SETTINGS:     'UF_SITE_SETTINGS',\r\n  UF_SITE_THEME:        'UF_SITE_THEME',\r\n  UF_TRACK_LAYOUT:      'UF_TRACK_LAYOUT',\r\n  UF_GALLERY_LAYOUT:    'UF_GALLERY_LAYOUT',\r\n//document.cookie keys\r\n  UF_TRACKS_PER_PAGE:  'UF_TRACKS_PER_PAGE',\r\n  UF_PREFERRED_PLAYER: 'UF_PREFERRED_PLAYER',\r\n  UF_SHUFFLE_UID:      'UF_SHUFFLE_UID',\r\n  UF_RESHUFFLE:        'UF_RESHUFFLE',\r\n  ULTRAFUNK_UID:       'ultrafunk_uid',\r\n};\r\n\r\nexport const YEAR_IN_SECONDS = (60 * 60 * 24 * 365);\r\n\r\n\r\n// ************************************************************************************************\r\n// https://developer.mozilla.org/en-US/docs/Web/API/Web_Storage_API/Using_the_Web_Storage_API\r\n// ************************************************************************************************\r\n\r\nexport function isAvailable(storageType)\r\n{\r\n  let storage;\r\n\r\n  try\r\n  {\r\n    storage = window[storageType];\r\n    const test = '__storage_test__';\r\n    storage.setItem(test, test);\r\n    storage.removeItem(test);\r\n    return true;\r\n  }\r\n  catch(exception)\r\n  {\r\n    return exception instanceof DOMException && (\r\n      // everything except Firefox\r\n      exception.code === 22 ||\r\n      // Firefox\r\n      exception.code === 1014 ||\r\n      // test name field too, because code might not be present\r\n      // everything except Firefox\r\n      exception.name === 'QuotaExceededError' ||\r\n      // Firefox\r\n      exception.name === 'NS_ERROR_DOM_QUOTA_REACHED') &&\r\n      // acknowledge QuotaExceededError only if there's something already stored\r\n      (storage && storage.length !== 0);\r\n  }\r\n}\r\n\r\n\r\n// ************************************************************************************************\r\n// Set and delete cookie key => value pairs\r\n// ************************************************************************************************\r\n\r\nexport function setCookie(keyName, keyValue = '', maxAge = YEAR_IN_SECONDS, path = '/')\r\n{\r\n  document.cookie = `${keyName}=${keyValue}; Max-Age=${maxAge}; Path=${path}; Secure; SameSite=Strict`;\r\n}\r\n\r\nexport function deleteCookie(keyName, path = '/')\r\n{\r\n  document.cookie = `${keyName}=; expires=Thu, 01 Jan 1970 00:00:00 UTC; path=${path}`;\r\n}\r\n\r\n\r\n// ************************************************************************************************\r\n// get / set local storage key => value pairs\r\n// ************************************************************************************************\r\n\r\nexport function getValue(keyName, defaultValue = null, setDefault = false)\r\n{\r\n  const keyValue = localStorage.getItem(keyName);\r\n\r\n  if (keyValue === null)\r\n  {\r\n    if (setDefault && (defaultValue !== null))\r\n      setValue(keyName, defaultValue);\r\n\r\n    return defaultValue;\r\n  }\r\n  \r\n  return keyValue;\r\n}\r\n\r\nexport function setValue(keyName, keyValue)\r\n{\r\n  try\r\n  {\r\n    localStorage.setItem(keyName, keyValue);\r\n  }\r\n  catch(exception)\r\n  {\r\n    debug.error(exception);\r\n  }\r\n}\r\n\r\n\r\n// ************************************************************************************************\r\n// Read (parse) and write (stringify) JSON data from local storage\r\n// ************************************************************************************************\r\n\r\nexport function readJson(keyName, defaultValue = null, setDefault = false)\r\n{\r\n  debug.log(`readJson(): ${keyName} - ${defaultValue} - ${setDefault}`);\r\n  \r\n  const keyValue     = localStorage.getItem(keyName);\r\n  let parsedKeyValue = null;\r\n\r\n  if (keyValue === null)\r\n  {\r\n    if (setDefault && (defaultValue !== null))\r\n      writeJson(keyName, defaultValue);\r\n\r\n    return defaultValue;\r\n  }\r\n  else\r\n  {\r\n    try\r\n    {\r\n      parsedKeyValue = JSON.parse(keyValue);\r\n    }\r\n    catch(exception)\r\n    {\r\n      debug.error(exception);\r\n\r\n      // ToDo: Return error state to specify (for the user) that default settings are used??\r\n      if (defaultValue !== null)\r\n        parsedKeyValue = defaultValue;\r\n    }\r\n  }\r\n\r\n  return parsedKeyValue;\r\n}\r\n\r\nexport function writeJson(keyName, keyData)\r\n{\r\n  debug.log(`writeJson(): ${keyName} - ${keyData}`);\r\n\r\n  try\r\n  {\r\n    localStorage.setItem(keyName, JSON.stringify(keyData));\r\n  }\r\n  catch(exception)\r\n  {\r\n    debug.error(exception);\r\n  }\r\n}\r\n\r\n\r\n// ************************************************************************************************\r\n// Recursive merge and cleanup for settings objects on new version\r\n// ************************************************************************************************\r\n\r\nfunction mergeSettings(oldSettings, newSettings, settingsKey)\r\n{\r\n  debug.log(`mergeSettings(): Merging ${settingsKey} from version ${oldSettings.version} to version ${newSettings.version}`);\r\n\r\n  const mergedSettings = { version: newSettings.version };\r\n\r\n  mergeDeep(oldSettings, newSettings, mergedSettings);\r\n  cleanDeep(mergedSettings, newSettings);\r\n\r\n  return mergedSettings;\r\n}\r\n\r\nfunction mergeDeep(oldSettings, newSettings, destination)\r\n{\r\n  for (const key in newSettings)\r\n  {\r\n    if (typeof newSettings[key] === 'object')\r\n    {\r\n      if (oldSettings && (typeof oldSettings[key] === 'object'))\r\n      {\r\n        debug.log(`mergeDeep() - Merging: ${key}`);\r\n        destination[key] = { ...newSettings[key], ...oldSettings[key] };\r\n        mergeDeep(oldSettings[key], newSettings[key], destination[key]);\r\n      }\r\n      else\r\n      {\r\n        debug.log(`mergeDeep() - Copying: ${key}`);\r\n        destination[key] = { ...newSettings[key] };\r\n        mergeDeep({}, newSettings[key], destination[key]);\r\n      }\r\n    }\r\n  }\r\n}\r\n\r\n//\r\n// Delete all orphaned Settings properties / objects that are no longer in use after merge\r\n//\r\nfunction cleanDeep(mergedSettings, newSettings)\r\n{\r\n  for (const key in mergedSettings)\r\n  {\r\n    if ((key in newSettings) === false)\r\n    {\r\n      debug.log(`cleanDeep() - Deleting: ${key} (${(typeof mergedSettings[key] === 'object') ? 'object' : 'property'})`);\r\n      delete mergedSettings[key];\r\n    }\r\n    \r\n    if (typeof mergedSettings[key] === 'object')\r\n      cleanDeep(mergedSettings[key], newSettings[key]);\r\n  }\r\n}\r\n\r\n//\r\n// Clean up (delete) any localStorage or cookie-data that is no longer in use...\r\n//\r\nfunction cleanupOldData(skipOldDataCheck = false)\r\n{\r\n  debug.log(`cleanupOldData(): ${skipOldDataCheck ? 'Skipping' : 'Performing quick'} old data cleanup check...`);\r\n\r\n  if (skipOldDataCheck || (localStorage.getItem(DEPRECATED_KEYS.UF_SITE_THEME) !== null))\r\n  {\r\n    debug.log(`cleanupOldData(): Running cleanup...`);\r\n\r\n    localStorage.removeItem(DEPRECATED_KEYS.UF_PLAYBACK_SETTINGS);\r\n    localStorage.removeItem(DEPRECATED_KEYS.UF_SITE_SETTINGS);\r\n    localStorage.removeItem(DEPRECATED_KEYS.UF_SITE_THEME);\r\n    localStorage.removeItem(DEPRECATED_KEYS.UF_TRACK_LAYOUT);\r\n    localStorage.removeItem(DEPRECATED_KEYS.UF_GALLERY_LAYOUT);\r\n    deleteCookie(DEPRECATED_KEYS.UF_TRACKS_PER_PAGE);\r\n    deleteCookie(DEPRECATED_KEYS.UF_PREFERRED_PLAYER);\r\n    deleteCookie(DEPRECATED_KEYS.UF_SHUFFLE_UID);\r\n    deleteCookie(DEPRECATED_KEYS.UF_RESHUFFLE);\r\n    deleteCookie(DEPRECATED_KEYS.ULTRAFUNK_UID);\r\n  }\r\n}\r\n\r\nfunction validateSettings(settingsKey, settingsObject, defaultSettings)\r\n{\r\n  try\r\n  {\r\n    const invalidSettingsCount = validateSettingsDeep(settingsObject, settingsSchema);\r\n\r\n    if (invalidSettingsCount > 0)\r\n      writeJson(settingsKey, settingsObject);\r\n  }\r\n  catch(exception)\r\n  {\r\n    debug.error(`validateSettings() exception: ${exception} -- using default settings`);\r\n\r\n    writeJson(settingsKey, defaultSettings);\r\n\r\n    return defaultSettings;\r\n  }\r\n\r\n  return settingsObject;\r\n}\r\n\r\n\r\n// ************************************************************************************************\r\n// Read and write settings proxy\r\n// ************************************************************************************************\r\n\r\nexport function readWriteSettingsProxy(settingsKey, defaultSettings = null, setDefault = false)\r\n{\r\n  const parsedJson = readJson(settingsKey, defaultSettings, setDefault);\r\n\r\n  if ((parsedJson !== null) && (defaultSettings !== null) && (parsedJson.version !== undefined))\r\n  {\r\n    let settingsObject = parsedJson;\r\n    \r\n    // If version is new, perform settings merge, cleanup and deletion of deprecated settings\r\n    if (parsedJson.version < defaultSettings.version)\r\n    {\r\n      debug.log(parsedJson);\r\n\r\n      settingsObject = mergeSettings(parsedJson, defaultSettings, settingsKey);\r\n      writeJson(settingsKey, settingsObject);\r\n\r\n      // Always run cleanup on version update\r\n      cleanupOldData(true);\r\n\r\n      debug.log(settingsObject);\r\n    }\r\n    else\r\n    {\r\n      // Only run cleanup if old data is detected (much quicker)\r\n      cleanupOldData(false);\r\n    }\r\n\r\n    return onSettingsChange(settingsKey, validateSettings(settingsKey, settingsObject, defaultSettings));\r\n  }\r\n\r\n  if (defaultSettings !== null)\r\n  {\r\n    debug.warn(`readWriteSettingsProxy() - Failed for: ${settingsKey} -- using default settings`);\r\n\r\n    writeJson(settingsKey, defaultSettings);\r\n\r\n    return onSettingsChange(settingsKey, defaultSettings);\r\n  }\r\n\r\n  debug.error(`readWriteSettingsProxy() - Fatal error for: ${settingsKey} -- unable to read settings!`);\r\n\r\n  return null;\r\n}\r\n\r\n\r\n// ************************************************************************************************\r\n// Proxy traps (handlers) for settings get and set\r\n// ************************************************************************************************\r\n\r\nconst onSettingsChange = (settingsKey, settingsObject) =>\r\n{ \r\n  const handler =\r\n  {\r\n    get(target, property, receiver)\r\n    {\r\n    //debug.log(`onSettingsChange(): Get property: ${property}`);\r\n      \r\n      if (property in target)\r\n      {      \r\n        const value = Reflect.get(target, property, receiver);\r\n        \r\n        if (typeof value === 'object')\r\n          return new Proxy(value, handler);\r\n\r\n        return value;\r\n      }\r\n\r\n      debug.error(`onSettingsChange(): Get unknown property: ${property}`);\r\n    },\r\n    \r\n    set(target, property, newValue, receiver)\r\n    {\r\n    //debug.log(`onSettingsChange(): Set property: ${property}`);\r\n\r\n      if (property in target)\r\n      {\r\n        const oldValue = Reflect.get(target, property, receiver);\r\n\r\n        // Only update and write data if it has changed\r\n        if (newValue !== oldValue)\r\n        {\r\n          Reflect.set(target, property, newValue);\r\n          writeJson(settingsKey, settingsObject);\r\n          callSettingsObservers(property, oldValue, newValue);\r\n        }\r\n\r\n        return true;\r\n      }\r\n\r\n      debug.error(`onSettingsChange(): Set unknown property: ${property}`);\r\n      return true;\r\n    },\r\n  };\r\n\r\n  return new Proxy(settingsObject, handler);\r\n};\r\n\r\n\r\n// ************************************************************************************************\r\n// Add and call settings observers on property changes\r\n// ************************************************************************************************\r\n\r\nexport function addSettingsObserver(property, observer)\r\n{\r\n  debug.log(`addSettingsObserver() for property: ${property}`);\r\n\r\n  if ((property in observers) === false)\r\n    observers[property] = [];\r\n\r\n  observers[property].push(observer);\r\n}\r\n\r\nfunction callSettingsObservers(property, oldValue, newValue)\r\n{\r\n  if (property in observers)\r\n  {\r\n    debug.log(`callSettingsObserver() for property: ${property} - oldValue: ${oldValue} - newValue: ${newValue}`);\r\n    observers[property].forEach(observer => observer(oldValue, newValue));\r\n  }\r\n}\r\n", "//\r\n// Get session data\r\n//\r\n// https://ultrafunk.com\r\n//\r\n\r\n\r\nimport * as debugLogger    from './debuglogger.js';\r\nimport { defaultSettings } from './settings/settings.js';\r\n\r\nimport {\r\n  KEY,\r\n  readWriteSettingsProxy,\r\n} from './storage.js';\r\n\r\n\r\n/*************************************************************************************************/\r\n\r\n\r\nconst debug = debugLogger.newInstance('session-data');\r\n\r\nexport let response = {};\r\nexport let settings = {};\r\n\r\n\r\n// ************************************************************************************************\r\n//\r\n// ************************************************************************************************\r\n\r\nexport function getSessionData()\r\n{\r\n  debug.log('UF_RESPONSE_DATA');\r\n  response = UF_RESPONSE_DATA; // eslint-disable-line no-undef\r\n  debug.log(response);\r\n\r\n  readSettings();\r\n}\r\n\r\nexport function readSettings()\r\n{\r\n  settings = readWriteSettingsProxy(KEY.UF_SETTINGS, defaultSettings, true);\r\n  debug.log(settings);\r\n}\r\n", "//\r\n// Track to track crossfade module\r\n//\r\n// https://ultrafunk.com\r\n//\r\n\r\n\r\nimport * as debugLogger from '../../shared/debuglogger.js';\r\nimport { settings }     from '../../shared/session-data.js';\r\n\r\n\r\n/*************************************************************************************************/\r\n\r\n\r\nconst debug = debugLogger.newInstance('crossfade');\r\n\r\nexport const VOLUME = {\r\n  MIN:   0,\r\n  MAX: 100,\r\n};\r\n\r\nconst TYPE = {\r\n  NONE:  0,\r\n  AUTO:  1,\r\n  TRACK: 2,\r\n};\r\n\r\nexport { TYPE as CROSSFADE_TYPE };\r\n\r\nconst CURVE = {\r\n  NONE:        0,\r\n  EQUAL_POWER: 1,\r\n  LINEAR:      2,\r\n};\r\n\r\nconst STATE = {\r\n  NONE:   0,\r\n  INIT:   1,\r\n  FADING: 2,\r\n};\r\n\r\nconst config = {\r\n  intervalEqPow:   33, // Milliseconds between each crossfade update event\r\n  intervalLinear: 100,\r\n};\r\n\r\n\r\n// ************************************************************************************************\r\n// Crossfade closure\r\n// ************************************************************************************************\r\n\r\nexport const crossfadeClosure = ((galleryPlayers) =>\r\n{\r\n  const players       = galleryPlayers;\r\n  let fadeState       = STATE.NONE;\r\n  let intervalId      = -1;\r\n  let fadeOutPlayer   = null;\r\n  let fadeInPlayer    = null;\r\n  let fadeLength      = 0;\r\n  let fadeStartVolume = 0;\r\n  let fadeType        = TYPE.NONE;\r\n  let fadePreset      = null;\r\n  let fadeStartTime   = 0;\r\n\r\n  return {\r\n    isFading() { return (fadeState !== STATE.NONE); },\r\n    init,\r\n    start,\r\n    stop,\r\n    mute,\r\n  };\r\n  \r\n  function init(crossfadeType, crossfadePreset, fadeInUid = null)\r\n  {\r\n    if ((fadeState === STATE.NONE) && (set(fadeInUid) === true))\r\n    {\r\n      debug.log(`init() - type: ${debug.getKeyForValue(TYPE, crossfadeType)} - fadeInUid: ${fadeInUid} - preset: ${crossfadePreset.length} sec ${debug.getKeyForValue(CURVE, crossfadePreset.curve)} (Name: ${crossfadePreset.name})`);\r\n  \r\n      fadeState       = STATE.INIT;\r\n      fadeStartVolume = settings.playback.masterVolume;\r\n      fadeType        = crossfadeType;\r\n      fadePreset      = crossfadePreset;\r\n      \r\n      fadeInPlayer.setVolume(0);\r\n  \r\n      if (fadeInUid === null)\r\n        players.nextTrack(true);\r\n      else\r\n        players.jumpToTrack(players.trackFromUid(fadeInUid), true, false);\r\n  \r\n      return {\r\n        fadeOutPlayer: players.indexMap.get(fadeOutPlayer.getUid()),\r\n        fadeInPlayer:  players.indexMap.get(fadeInPlayer.getUid())\r\n      };\r\n    }\r\n  \r\n    return null;\r\n  }\r\n  \r\n  function start()\r\n  {\r\n    if (fadeState === STATE.INIT)\r\n    {\r\n      fadeState = STATE.FADING;\r\n\r\n      fadeOutPlayer.getPosition((positionMilliseconds) =>\r\n      {\r\n        const updateInterval = (fadePreset.curve === CURVE.EQUAL_POWER) ? config.intervalEqPow : config.intervalLinear;\r\n        fadeStartTime        = ((positionMilliseconds + updateInterval) / 1000);\r\n        const timeRemaining  = fadeOutPlayer.getDuration() - fadeStartTime;\r\n        const fadeRemaining  = timeRemaining - (updateInterval / 1000);\r\n  \r\n        if (fadeType === TYPE.AUTO)\r\n          fadeLength = fadeRemaining;\r\n        else if (fadeType === TYPE.TRACK)\r\n          fadeLength = (timeRemaining > fadePreset.length) ? fadePreset.length : fadeRemaining;\r\n  \r\n        debug.log(`start() - fadeStartTime: ${fadeStartTime.toFixed(2)} sec - timeRemaining: ${timeRemaining.toFixed(2)} sec - fadeLength: ${fadeLength.toFixed(2)} sec - updateInterval: ${updateInterval} ms`);\r\n  \r\n        intervalId = setInterval((fadePreset.curve === CURVE.EQUAL_POWER) ? equalPowerFade : linearFade, updateInterval);\r\n      });\r\n    }\r\n  }\r\n  \r\n  function stop()\r\n  {\r\n    debug.log(`stop() - fadeState: ${debug.getKeyForValue(STATE, fadeState)}`);\r\n  \r\n    if (fadeState !== STATE.NONE)\r\n    {\r\n      if (intervalId !== -1)\r\n      {\r\n        clearInterval(intervalId);\r\n        intervalId = -1;\r\n      }\r\n  \r\n      if (fadeOutPlayer !== null)\r\n      {\r\n        fadeOutPlayer.pause();\r\n        fadeOutPlayer.seekTo(0);\r\n  \r\n        // ToDo: Temp fix for: This might POP on fade out end, check if there is a safer way to reset the volume\r\n        setTimeout(() =>\r\n        {\r\n          fadeOutPlayer.setVolume(settings.playback.masterVolume); // ToDo: fadeStartVolume is 0 because of setTimeout()\r\n          fadeOutPlayer = null;\r\n        },\r\n        200);\r\n      }\r\n    \r\n      if (fadeInPlayer !== null)\r\n        fadeInPlayer = null;\r\n    \r\n      fadeState       = STATE.NONE;\r\n      fadeLength      = 0;\r\n      fadeStartVolume = 0;\r\n      fadeType        = TYPE.NONE;\r\n      fadePreset      = null;\r\n      fadeStartTime   = 0;\r\n    }\r\n  }\r\n  \r\n  function mute(setMute)\r\n  {\r\n    if (fadeOutPlayer !== null)\r\n      fadeOutPlayer.mute(setMute);\r\n  }\r\n  \r\n  function set(fadeInUid)\r\n  {\r\n    fadeOutPlayer = players.current;\r\n    fadeInPlayer  = (fadeInUid === null) ? players.next : players.playerFromUid(fadeInUid);\r\n  \r\n    if (fadeOutPlayer.getIsPlayable() && fadeInPlayer.getIsPlayable())\r\n      return true;\r\n  \r\n    return false;\r\n  }\r\n  \r\n  //\r\n  // https://dsp.stackexchange.com/questions/14754/equal-power-crossfade\r\n  //\r\n  function equalPowerFade()\r\n  {\r\n    fadeOutPlayer.getPosition((positionMilliseconds) =>\r\n    {\r\n      // Clamp negative position values\r\n      const position     = ((positionMilliseconds / 1000) - fadeStartTime);\r\n      const fadePosition = (position >= 0) ? position : 0;\r\n  \r\n      // Clamp negative volume values\r\n      const volume     = fadeStartVolume - (fadeStartVolume * (fadePosition / fadeLength));\r\n      const fadeVolume = (volume >= VOLUME.MIN) ? volume : VOLUME.MIN;\r\n  \r\n      const fadeOutVolume = Math.round(Math.sqrt(fadeStartVolume * fadeVolume));\r\n      const fadeInVolume  = Math.round(Math.sqrt(fadeStartVolume * (fadeStartVolume - fadeVolume)));\r\n  \r\n      if ((fadePosition >= fadeLength) && (fadeVolume <= VOLUME.MIN) && (fadeInVolume >= fadeStartVolume))\r\n      {\r\n        fadeOutPlayer.setVolume(VOLUME.MIN);\r\n        fadeInPlayer.setVolume(fadeStartVolume);\r\n        stop();\r\n      }\r\n      else\r\n      {\r\n        fadeOutPlayer.setVolume(fadeOutVolume);\r\n        fadeInPlayer.setVolume(fadeInVolume);\r\n      }\r\n    });\r\n  }\r\n  \r\n  function linearFade()\r\n  {\r\n    fadeOutPlayer.getPosition((positionMilliseconds) =>\r\n    {\r\n      const fadePosition  = ((positionMilliseconds / 1000) - fadeStartTime);\r\n      const fadeInVolume  = Math.round(fadeStartVolume * (fadePosition / fadeLength));\r\n      const fadeOutVolume = fadeStartVolume - fadeInVolume;\r\n  \r\n      if ((fadePosition > fadeLength) && (fadeOutVolume < VOLUME.MIN) && (fadeInVolume > fadeStartVolume))\r\n      {\r\n        fadeOutPlayer.setVolume(VOLUME.MIN);\r\n        fadeInPlayer.setVolume(fadeStartVolume);\r\n        stop();\r\n      }\r\n      else\r\n      {\r\n        fadeOutPlayer.setVolume(fadeOutVolume);\r\n        fadeInPlayer.setVolume(fadeInVolume);\r\n      }\r\n    });\r\n  }\r\n});\r\n", "//\r\n// Embedded media player classes + playlist\r\n//\r\n// https://ultrafunk.com\r\n//\r\n\r\n\r\nimport * as debugLogger from '../shared/debuglogger.js';\r\nimport { VOLUME }       from './gallery/crossfade.js';\r\n\r\n\r\n/*************************************************************************************************/\r\n\r\n\r\nconst debug = debugLogger.newInstance('mediaplayers');\r\n\r\nexport const TRACK_TYPE = {\r\n  NONE:       0,\r\n  YOUTUBE:    1,\r\n  SOUNDCLOUD: 2,\r\n};\r\n\r\n\r\n// ************************************************************************************************\r\n// MediaPlayer parent class\r\n// ************************************************************************************************\r\n\r\nclass MediaPlayer\r\n{\r\n  constructor(trackId, iframeId, embeddedPlayer)\r\n  {\r\n    this.trackType      = TRACK_TYPE.NONE;\r\n    this.trackId        = trackId;\r\n    this.iframeId       = iframeId;\r\n    this.embeddedPlayer = embeddedPlayer;\r\n    this.isPlayable     = true;\r\n\r\n    this.duration = 0;\r\n    this.artist   = null;\r\n    this.title    = null;\r\n\r\n    this.thumbnailSrc       = null;\r\n    this.thumbnailClass     = 'type-default';\r\n    this.thumbnail          = new Image();\r\n    this.thumbnail.decoding = 'async';\r\n  }\r\n\r\n  // Abstract methods to be overriden in child class if needed\r\n  cueTrackById()  {}\r\n  playTrackById() {}\r\n  \r\n  getTrackType()        { return this.trackType;      }\r\n  getTrackId()          { return this.trackId;        }\r\n  getIframeId()         { return this.iframeId;       }\r\n  getUid()              { return this.iframeId;       }\r\n  getEmbeddedPlayer()   { return this.embeddedPlayer; }\r\n\r\n  getIsPlayable()           { return this.isPlayable;       }\r\n  setIsPlayable(isPlayable) { this.isPlayable = isPlayable; }\r\n\r\n  getDuration()         { return this.duration;     }\r\n  setDuration(duration) { this.duration = duration; }\r\n\r\n  getArtist()           { return this.artist;   }\r\n  setArtist(artist)     { this.artist = artist; }\r\n\r\n  getTitle()            { return this.title;  }\r\n  setTitle(title)       { this.title = title; }\r\n\r\n  getThumbnailSrc()     { return this.thumbnailSrc;   }\r\n  getThumbnailClass()   { return this.thumbnailClass; }\r\n\r\n  seekTo(position)      { this.embeddedPlayer.seekTo(position);  }\r\n  setVolume(volume)     { this.embeddedPlayer.setVolume(volume); }\r\n\r\n  setArtistTitle(artist, title)\r\n  {\r\n    this.artist = artist;\r\n    this.title  = title;\r\n  }\r\n\r\n  setThumbnail(thumbnail)\r\n  {\r\n    this.thumbnailSrc   = thumbnail.src;\r\n    this.thumbnailClass = thumbnail.class;\r\n    this.thumbnail.src  = thumbnail.src;\r\n  }\r\n}\r\n\r\n\r\n// ************************************************************************************************\r\n// YouTube child class\r\n// ************************************************************************************************\r\n\r\nexport class YouTube extends MediaPlayer\r\n{\r\n  constructor(trackId, iframeId, embeddedPlayer, videoId)\r\n  {\r\n    super(trackId, iframeId, embeddedPlayer);\r\n    this.trackType = TRACK_TYPE.YOUTUBE;\r\n    super.setThumbnail(getYouTubeImgUrl(videoId));\r\n  }\r\n\r\n  cueTrackById(id)  { this.embeddedPlayer.cueVideoById(id);  }\r\n  playTrackById(id) { this.embeddedPlayer.loadVideoById(id); }\r\n  pause()           { this.embeddedPlayer.pauseVideo();      }\r\n  stop()            { this.embeddedPlayer.stopVideo();       }\r\n\r\n  play(onErrorCallback)\r\n  {\r\n    if (this.isPlayable === true)\r\n      this.embeddedPlayer.playVideo();\r\n    else\r\n      onErrorCallback(this, this.embeddedPlayer.getVideoUrl());\r\n  }\r\n\r\n  getVolume(callback)\r\n  {\r\n    callback(this.embeddedPlayer.getVolume());\r\n  }\r\n\r\n  mute(setMute)\r\n  {\r\n    if (setMute)\r\n      this.embeddedPlayer.mute();\r\n    else\r\n      this.embeddedPlayer.unMute();\r\n  }\r\n\r\n  getPosition(callback)\r\n  {\r\n    callback((this.embeddedPlayer.getCurrentTime() * 1000), this.duration);\r\n  }\r\n}\r\n\r\n\r\n// ************************************************************************************************\r\n// SoundCloud child class\r\n// ************************************************************************************************\r\n\r\nexport class SoundCloud extends MediaPlayer\r\n{\r\n  constructor(trackId, iframeId, embeddedPlayer, iframeSrc)\r\n  {\r\n    super(trackId, iframeId, embeddedPlayer);\r\n    this.trackType = TRACK_TYPE.SOUNDCLOUD;\r\n    this.soundId   = this.getSoundId(iframeSrc);\r\n    this.volume    = VOLUME.MAX;\r\n    this.muted     = false;\r\n  }\r\n\r\n  getSoundId(iframeSrc)\r\n  {\r\n    if (iframeSrc)\r\n    {\r\n      const iframeSrcParts = new URL(decodeURIComponent(iframeSrc));\r\n      const trackUrl       = iframeSrcParts.searchParams.get('url');\r\n      \r\n      if (trackUrl !== null)\r\n      {\r\n        const trackUrlParts = trackUrl.split('/');\r\n        const tracksString  = 'tracks'.toUpperCase();\r\n  \r\n        for (let i = 0; i < trackUrlParts.length; i++)\r\n        {\r\n          if (trackUrlParts[i].toUpperCase() === tracksString)\r\n            return parseInt(trackUrlParts[i + 1]);\r\n        }\r\n      }\r\n    }\r\n    \r\n    debug.error(`MediaPlayer.SoundCloud.getSoundId() failed for: ${this.iframeId}`);\r\n\r\n    return null;\r\n  }\r\n\r\n  setThumbnail(trackThumbnailUrlElement)\r\n  {\r\n    this.embeddedPlayer.getCurrentSound(soundObject =>\r\n    {\r\n      super.setThumbnail(getSoundCloudImgUrl(soundObject));\r\n      trackThumbnailUrlElement?.setAttribute('data-track-thumbnail-url', this.getThumbnailSrc());\r\n    });\r\n  }\r\n\r\n  // Override parent getUid() because SoundCloud provides its own UID\r\n  getUid() { return this.soundId;         }\r\n  pause()  { this.embeddedPlayer.pause(); }\r\n  \r\n  play(onErrorCallback)\r\n  {\r\n    // playable is set to FALSE if the widget fires SC.Widget.Events.ERROR (track does not exist)\r\n    if (this.isPlayable === true)\r\n    {\r\n      this.embeddedPlayer.getCurrentSound(soundObject =>\r\n      {\r\n        if (soundObject.playable === true)\r\n          this.embeddedPlayer.play();\r\n        else\r\n          onErrorCallback(this, soundObject.permalink_url);\r\n      });\r\n    }\r\n    else\r\n    {\r\n      onErrorCallback(this, 'https://soundcloud.com');\r\n    }\r\n  }\r\n  \r\n  stop()\r\n  {\r\n    this.pause();\r\n    super.seekTo(0);\r\n  }\r\n\r\n  // Override parent because SoundCloud seekTo() needs milliseconds instead of just seconds\r\n  seekTo(positionSeconds)\r\n  {\r\n    super.seekTo(positionSeconds * 1000);\r\n  }\r\n  \r\n  getVolume(callback)\r\n  {\r\n    this.embeddedPlayer.getVolume(volume => callback(volume));\r\n  }\r\n\r\n  // Override parent setVolume() because we use it for mute() as well \r\n  setVolume(volume)\r\n  {\r\n    if (volume !== 0)\r\n      this.volume = volume;\r\n\r\n    if ((this.muted === false) || (volume === 0))\r\n      super.setVolume(volume);\r\n  }\r\n\r\n  mute(setMute)\r\n  {\r\n    this.muted = setMute ? true : false;\r\n\r\n    if (setMute)\r\n      this.setVolume(0);\r\n    else\r\n      this.setVolume(this.volume);\r\n  }\r\n\r\n  getPosition(callback)\r\n  {\r\n    this.embeddedPlayer.getPosition(positionMilliseconds => callback(positionMilliseconds, this.duration));\r\n  }\r\n}\r\n\r\n\r\n// ************************************************************************************************\r\n// Playlist child class\r\n// ************************************************************************************************\r\n\r\nexport class Playlist extends MediaPlayer\r\n{\r\n  constructor(embeddedPlayer)\r\n  {\r\n    super(null, null, embeddedPlayer);\r\n    this.trackType    = TRACK_TYPE.YOUTUBE;\r\n    this.numTracks    = 3;\r\n    this.currentTrack = 2;\r\n    this.playerState  = -1; // YT.PlayerState.UNSTARTED\r\n  }\r\n\r\n  get embedded()        { return this.embeddedPlayer; }\r\n  getNumTracks()        { return this.numTracks;      }\r\n  getCurrentTrack()     { return this.currentTrack;   }\r\n  setPlayerState(state) { this.playerState = state;   }\r\n\r\n  play(onErrorCallback)\r\n  {\r\n    //YT.PlayerState.CUED === 5\r\n    if ((this.playerState === 5) && (this.embeddedPlayer.getDuration() === 0))\r\n    {\r\n      onErrorCallback({ data: 'Unable to play track -- No YouTube API error given!' });\r\n      this.playerState = -1; // YT.PlayerState.UNSTARTED\r\n    }\r\n    else\r\n    {\r\n      this.embeddedPlayer.playVideo();\r\n    }\r\n  }\r\n\r\n  setThumbnail(videoId)\r\n  {\r\n    super.setThumbnail(getYouTubeImgUrl(videoId));\r\n  }\r\n\r\n  getTrackData()\r\n  {\r\n    return {\r\n      currentTrack: this.getCurrentTrack(),\r\n      numTracks:    this.getNumTracks(),\r\n      artist:       this.getArtist(),\r\n      title:        this.getTitle(),\r\n      duration:     this.getDuration(),\r\n      thumbnail:    { src: this.getThumbnailSrc(), class: this.getThumbnailClass() },\r\n    };\r\n  }\r\n}\r\n\r\n\r\n// ************************************************************************************************\r\n// MediaPlayer class support functions\r\n// ************************************************************************************************\r\n\r\n// Default / fallback track thumbnail object\r\nconst defThumbnailObj = { src: '/wp-content/themes/ultrafunk/inc/img/photo_filled_grey.png', class: 'type-default', uid: '' };\r\n\r\n// https://webapps.stackexchange.com/a/101153\r\nexport const youTubeVideoIdRegEx = /[0-9A-Za-z_-]{10}[048AEIMQUYcgkosw]/;\r\n\r\nexport function getYouTubeImgUrl(trackSourceUrl)\r\n{\r\n  const youTubeVideoId = trackSourceUrl.match(youTubeVideoIdRegEx);\r\n\r\n  if (youTubeVideoId !== null)\r\n    return { src: `https://img.youtube.com/vi/${youTubeVideoId[0]}/default.jpg`, class: 'type-youtube', uid: youTubeVideoId[0] };\r\n\r\n  return defThumbnailObj;\r\n}\r\n\r\nfunction getSoundCloudImgUrl(soundObject)\r\n{\r\n  const thumbnailSrc = (soundObject.artwork_url !== null)\r\n                         ? soundObject.artwork_url\r\n                         : soundObject.user.avatar_url;\r\n\r\n  if (thumbnailSrc)\r\n    return { src: thumbnailSrc, class: 'type-soundcloud', uid: '' };\r\n\r\n  return defThumbnailObj;\r\n}\r\n", "//\r\n// Shared utility functions\r\n//\r\n// https://ultrafunk.com\r\n//\r\n\r\n\r\nimport * as debugLogger from './debuglogger.js';\r\nimport { settings }     from './session-data.js';\r\nimport { PREF_PLAYER }  from './settings/settings.js';\r\nimport { showSnackbar } from './snackbar.js';\r\n\r\nimport {\r\n  TRACK_TYPE,\r\n  getYouTubeImgUrl,\r\n} from '../playback/mediaplayers.js';\r\n\r\n\r\n/*************************************************************************************************/\r\n\r\n\r\nconst debug = debugLogger.newInstance('utils');\r\n\r\nexport const SITE_URL = debug.isDebug() ? 'https://wordpress.ultrafunk.com'      : 'https://ultrafunk.com';\r\nconst SITE_URL_LIST   = debug.isDebug() ? 'https://wordpress.ultrafunk.com/list' : 'https://ultrafunk.com/list';\r\n\r\nconst validUrlRegEx = debug.isDebug()\r\n                        ? /^https:\\/\\/wordpress\\.ultrafunk\\.com[/?&=%A-Za-z0-9\\-_.~+]*$/\r\n                        : /^https:\\/\\/ultrafunk\\.com[/?&=%A-Za-z0-9\\-_.~+]*$/;\r\n\r\nconst DOMParserInstance = new DOMParser();\r\n\r\nexport const MATCH = {\r\n  SITE_MIN_WIDTH_WIDE:   1,\r\n  SITE_MAX_WIDTH:        2,\r\n  SITE_MAX_WIDTH_MOBILE: 3,\r\n};\r\n\r\nconst siteMinWidthWide   = window.matchMedia(`(min-width: ${getCssPropString('--site-min-width-wide')})`);\r\nconst siteMaxWidth       = window.matchMedia(`(max-width: ${getCssPropString('--site-max-width')})`);\r\nconst siteMaxWidthMobile = window.matchMedia(`(max-width: ${getCssPropString('--site-max-width-mobile')})`);\r\n\r\n\r\n// ************************************************************************************************\r\n// Misc. shared utility functions\r\n// ************************************************************************************************\r\n\r\nexport function addListener(selectors, type, listener)\r\n{\r\n  document.querySelector(selectors)?.addEventListener(type, listener);\r\n}\r\n\r\n// Plain JS function equivalent to jQuery(selectors).eventX();\r\n// Adds event listeners of 'type' to all matching selectors \r\nexport function addListenerAll(selectors, type, listener)\r\n{\r\n  const elementList = document.querySelectorAll(selectors);\r\n  elementList.forEach(element => element.addEventListener(type, listener));\r\n}\r\n\r\nexport function getCssPropString(prop, element = document.documentElement)\r\n{\r\n  let string = getComputedStyle(element).getPropertyValue(prop);\r\n\r\n  if (string.length !== 0)\r\n    string = string.replace(/'|\"/g, '').trim();\r\n  else\r\n    debug.error(`getCssPropString(${prop}): Returned CSS property string is empty`);\r\n\r\n  return string;\r\n}\r\n\r\nexport function getCssPropValue(prop, element = document.documentElement)\r\n{\r\n  const string = getCssPropString(prop, element);\r\n  let value    = NaN;\r\n\r\n  if (string.length !== 0)\r\n    value = parseInt(string);\r\n\r\n  if (isNaN(value))\r\n    debug.error(`getCssPropValue(${prop}): Returned CSS property value is NaN`);\r\n\r\n  return value;\r\n}\r\n\r\n// Match against live CSS media queries defined in style.css\r\nexport function matchesMedia(matchMedia)\r\n{\r\n  switch (matchMedia)\r\n  {\r\n    case MATCH.SITE_MIN_WIDTH_WIDE:\r\n      return siteMinWidthWide.matches;\r\n      \r\n    case MATCH.SITE_MAX_WIDTH:\r\n      return siteMaxWidth.matches;\r\n\r\n    case MATCH.SITE_MAX_WIDTH_MOBILE:\r\n      return siteMaxWidthMobile.matches;\r\n  }\r\n\r\n  return false;\r\n}\r\n\r\nexport function replaceClass(element, removeClass, addClass)\r\n{\r\n  element.classList.remove(removeClass);\r\n  element.classList.add(addClass);\r\n}\r\n\r\nexport function getTimeString(seconds, includeHours = false)\r\n{\r\n  if (Number.isInteger(seconds))\r\n  {\r\n    const timeString = new Date(seconds * 1000).toISOString();\r\n\r\n    return ((seconds > 3600) || includeHours)\r\n      ? timeString.slice(11, 19)\r\n      : timeString.slice(14, 19);\r\n  }\r\n  else\r\n  {\r\n    return includeHours ? '00:00:00' : '00:00';\r\n  }\r\n}\r\n\r\n\r\n// ************************************************************************************************\r\n// https://github.com/janl/mustache.js/blob/master/mustache.js#L59\r\n// ************************************************************************************************\r\n\r\nconst entityMap = {\r\n  '&': '&amp;',\r\n  '<': '&lt;',\r\n  '>': '&gt;',\r\n  '\"': '&quot;',\r\n  \"'\": '&#39;',\r\n  '`': '&#x60;',\r\n  '=': '&#x3D;',\r\n  '/': '&#x2F;',\r\n};\r\n\r\nexport function escHtml(string)\r\n{\r\n  return String(string).replace(/[&<>\"'`=/]/g, (s) => entityMap[s]);\r\n}\r\n\r\nexport function escAttribute(element, attribute)\r\n{\r\n  const value = element.getAttribute(attribute);\r\n\r\n  if (value !== null)\r\n    return escHtml(value);\r\n\r\n  return value;\r\n}\r\n\r\n//\r\n// ToDo: escHtml() + stripHtml()\r\n// Replace with DOMPurify or the HTML Sanitizer API: https://github.com/WICG/sanitizer-api\r\n// Enhance / fix with: https://developer.mozilla.org/en-US/docs/Web/API/Trusted_Types_API\r\n//                     https://github.com/w3c/webappsec-trusted-types\r\n//\r\nexport function stripHtml(string)\r\n{\r\n  const firstPass  = DOMParserInstance.parseFromString(string, 'text/html');\r\n  const secondPass = DOMParserInstance.parseFromString(firstPass.body.textContent, 'text/html');\r\n\r\n//debug.log(`stripHtml(DOMParser): ${secondPass.body.textContent}`);\r\n\r\n  return secondPass.body.textContent;\r\n}\r\n\r\nexport function stripAttribute(element, attribute)\r\n{\r\n  const value = element.getAttribute(attribute);\r\n\r\n  if (value !== null)\r\n    return stripHtml(value);\r\n  \r\n  return value;\r\n}\r\n\r\n\r\n// ************************************************************************************************\r\n// \r\n// ************************************************************************************************\r\n\r\nexport function navToUrl(destUrl)\r\n{\r\n  if (destUrl && (destUrl.match(validUrlRegEx) !== null))\r\n  {\r\n    debug.log(`navToUrl() - Valid destUrl: ${destUrl}`);\r\n    window.location.href = destUrl;\r\n  }\r\n  else if (destUrl !== null)\r\n  {\r\n    debug.error(`navToUrl() - Invalid destUrl: ${destUrl}`);\r\n    showSnackbar('Error navigating to URL!', 0, 'Reload', () => location.reload());\r\n  }\r\n}\r\n\r\nexport function getListPlayerUrl(destUrl)\r\n{\r\n  return destUrl.replace(SITE_URL, SITE_URL_LIST);\r\n}\r\n\r\nexport function getGalleryPlayerUrl(destUrl)\r\n{\r\n  return destUrl.replace(SITE_URL_LIST, SITE_URL);  \r\n}\r\n\r\nexport function getPrefPlayerUrl(destUrl)\r\n{\r\n  if (destUrl)\r\n  {\r\n    if (settings.playback.preferredPlayer === PREF_PLAYER.LIST)\r\n    {\r\n      if (destUrl.startsWith(SITE_URL_LIST) === false)\r\n        return getListPlayerUrl(destUrl);\r\n    }\r\n    else if (settings.playback.preferredPlayer === PREF_PLAYER.GALLERY)\r\n    {\r\n      if (destUrl.startsWith(SITE_URL_LIST) === true)\r\n        return getGalleryPlayerUrl(destUrl);\r\n    }\r\n  }\r\n\r\n  return destUrl;\r\n}\r\n\r\nexport function getThumbnailData(metaData)\r\n{\r\n  if (metaData.track_source_type === TRACK_TYPE.YOUTUBE)\r\n    return getYouTubeImgUrl(metaData.track_source_data);\r\n\r\n  return { src: '/wp-content/themes/ultrafunk/inc/img/sc_thumbnail_placeholder.png', class: 'type-soundcloud', uid: '' };\r\n}\r\n\r\n\r\n// ************************************************************************************************\r\n// \r\n// ************************************************************************************************\r\n\r\nexport const FETCH_ERROR_TYPE = {\r\n  UNKNOWN: 0,\r\n  NETWORK: 1,\r\n};\r\n\r\nexport async function fetchRest(endpoint, query, returnStatus = false, path = '/wp-json/wp/v2/')\r\n{\r\n  debug.log(`fetchRest(): ${path}${endpoint}?${query}`);\r\n\r\n  return fetch(`${path}${endpoint}?${query}`)\r\n  .then(async (response) => \r\n  {\r\n    if (!response.ok)\r\n    {\r\n      debug.warn(response);\r\n\r\n      if (returnStatus)\r\n        return { status: { code: response.status, details: await response.json() }};\r\n\r\n      return null;\r\n    }\r\n\r\n    if (returnStatus)\r\n      return { status: { code: response.status }, data: await response.json() };\r\n    \r\n    return response.json();\r\n  })\r\n  .catch(reason =>\r\n  {\r\n    debug.error(reason);\r\n\r\n    if (returnStatus)\r\n    {\r\n      const errorType = (reason instanceof TypeError) ? FETCH_ERROR_TYPE.NETWORK : FETCH_ERROR_TYPE.UNKNOWN;\r\n      return { status: { code: 0, type: errorType, message: reason.message }};\r\n    }\r\n\r\n    return null;\r\n  });\r\n}\r\n", "//\r\n// Snackbar UI module\r\n//\r\n// https://ultrafunk.com\r\n//\r\n\r\n\r\nimport * as debugLogger        from './debuglogger.js';\r\nimport { MATCH, matchesMedia } from './utils.js';\r\n\r\n\r\n/*************************************************************************************************/\r\n\r\n\r\nconst debug = debugLogger.newInstance('snackbar');\r\n\r\nconst m = {\r\n  snackbarId:    0,\r\n  actionClick:   null,\r\n  afterClose:    null,\r\n  showTimeoutId: -1,\r\n};\r\n\r\nconst config = { id: 'snackbar' };\r\n\r\nconst template = /*html*/ `\r\n  <div id=\"${config.id}\">\r\n    <div class=\"${config.id}-container\">\r\n      <div class=\"${config.id}-message\"></div>\r\n      <div class=\"${config.id}-action-text\"></div>\r\n      <div class=\"${config.id}-close-icon\"><span class=\"material-icons\" title=\"Dismiss\">close</span></div>\r\n    </div>\r\n  </div>\r\n`;\r\n\r\nconst elements = {\r\n  snackbar:   null,\r\n  actionText: null,\r\n  closeIcon:  null,\r\n};\r\n\r\n\r\n// ************************************************************************************************\r\n// \r\n// ************************************************************************************************\r\n\r\nexport function showSnackbar(\r\n  message,\r\n  timeout = 5,\r\n  actionText = null,\r\n  actionClickCallback = null,\r\n  afterCloseCallback = () => {}\r\n)\r\n{\r\n  debug.log(`showSnackbar(): ${message} (${timeout} sec.)`);\r\n\r\n  init();\r\n  reset(false);\r\n\r\n  elements.snackbar.querySelector(`.${config.id}-message`).innerHTML = message;\r\n  elements.snackbar.classList.add('show');\r\n  elements.actionText.style.display = 'none';\r\n  m.afterClose = afterCloseCallback;\r\n\r\n  if ((actionText !== null) && (actionClickCallback !== null))\r\n  {\r\n    m.actionClick = actionClickCallback;\r\n    elements.actionText.style.display = 'block';\r\n    elements.actionText.textContent   = actionText;\r\n    elements.actionText.addEventListener('click', actionTextClick);\r\n  }\r\n  else\r\n  {\r\n    // Fix edge case when actionText is hidden...\r\n    if (matchesMedia(MATCH.SITE_MAX_WIDTH_MOBILE))\r\n      elements.closeIcon.style.paddingLeft = '10px';\r\n    else\r\n      elements.closeIcon.style.paddingLeft = '20px';\r\n  }\r\n\r\n  if (timeout !== 0)\r\n    m.showTimeoutId = setTimeout(() => elements.snackbar.classList.add('hide'), (timeout * 1000));\r\n  \r\n  return ++m.snackbarId;\r\n}\r\n\r\nexport function dismissSnackbar(dismissId = 0)\r\n{\r\n  if (isShowing())\r\n  {\r\n    if ((m.snackbarId === 0) || (m.snackbarId === dismissId))\r\n      elements.snackbar.classList.add('hide');\r\n  }\r\n}\r\n\r\n\r\n// ************************************************************************************************\r\n// \r\n// ************************************************************************************************\r\n\r\nfunction init()\r\n{\r\n  if (elements.snackbar === null)\r\n  {\r\n    document.body.insertAdjacentHTML('beforeend', template);\r\n\r\n    elements.snackbar   = document.getElementById(config.id);\r\n    elements.actionText = elements.snackbar.querySelector(`.${config.id}-action-text`);\r\n    elements.closeIcon  = elements.snackbar.querySelector(`.${config.id}-close-icon`);\r\n    \r\n    elements.snackbar.addEventListener('animationend', () =>\r\n    {\r\n      if (elements.snackbar.classList.contains('hide'))\r\n      {\r\n        reset(true);\r\n        m.afterClose();\r\n      }\r\n    });\r\n\r\n    elements.closeIcon.addEventListener('click', () =>\r\n    {\r\n      reset(true);\r\n      m.afterClose();\r\n    });\r\n  }\r\n}\r\n\r\nfunction actionTextClick()\r\n{\r\n  reset(true);\r\n  m.actionClick();\r\n}\r\n\r\nfunction isShowing()\r\n{\r\n  return ((elements.snackbar !== null)               &&\r\n          (elements.snackbar.classList.length === 1) &&\r\n           elements.snackbar.classList.contains('show'));\r\n}\r\n\r\nfunction reset(hideSnackbar = false)\r\n{\r\n  if (m.showTimeoutId !== -1)\r\n  {\r\n    clearTimeout(m.showTimeoutId);\r\n    m.showTimeoutId = -1;\r\n  }\r\n\r\n  if (elements.actionText !== null)\r\n    elements.actionText.removeEventListener('click', actionTextClick);\r\n\r\n  if (hideSnackbar)\r\n    elements.snackbar.className = '';\r\n}\r\n", "//\n// Play next single gallery track without page reload SPA style...\n//\n// https://ultrafunk.com\n//\n\n\nimport * as debugLogger from '../../shared/debuglogger.js';\nimport { KEY }          from '../../shared/storage.js';\nimport { TRACK_TYPE }   from '../mediaplayers.js';\nimport { showSnackbar } from '../../shared/snackbar.js';\n\nimport {\n  response,\n  settings,\n} from '../../shared/session-data.js';\n\nimport {\n  fetchRest,\n  getThumbnailData,\n} from '../../shared/utils.js';\n\n\n/*************************************************************************************************/\n\n\nconst debug = debugLogger.newInstance('single-track-next');\n\nconst m = {\n  cueOrPlayTrackById: null,\n  startTrackDateTime: null,\n  loadTracksDateTime: null,\n  isNextTrackLoading: false,\n};\n\n\n// ************************************************************************************************\n// Exports\n// ************************************************************************************************\n\nexport function isSingleTrackNext()\n{\n  return (document.body.matches('.single.track') && settings.gallery.fetchNextSingleTrack);\n}\n\nexport function isNextTrackLoading()\n{\n  return m.isNextTrackLoading;\n}\n\nexport function singleTrackNextReady(cueOrPlayTrackByIdCallback)\n{\n  if (isSingleTrackNext())\n  {\n    debug.log('ready()');\n\n    m.cueOrPlayTrackById = cueOrPlayTrackByIdCallback;\n    m.startTrackDateTime = document.querySelector('single-track').getAttribute('data-track-date-time');\n\n    window.addEventListener('popstate', (event) =>\n    {\n      (event.state === null) ? location.reload() : updatePlayerAndPage(event.state, false, false);\n    });\n  }\n}\n\nexport async function playNextSingleTrack(playTrack = false)\n{\n  if (isSingleTrackNext())\n  {\n    m.isNextTrackLoading = true;\n    const restResponse   = await fetchTracks(m.loadTracksDateTime);\n\n    if ((restResponse !== null) && (restResponse.status.code === 200) && (restResponse.data.length > 1))\n    {\n      m.loadTracksDateTime = restResponse.data[0].date;\n      const currentTrack   = restResponse.data[1];\n  \n      debug.log(`playNextSingleTrack() - playTrack: ${playTrack} - trackType: ${debug.getKeyForValue(TRACK_TYPE, currentTrack.meta.track_source_type)} => ${getTrackTitle(currentTrack.meta)}`);\n  \n      if (currentTrack.meta.track_source_type === TRACK_TYPE.YOUTUBE)\n      {\n        updatePlayerAndPage(restResponse.data, playTrack, true);\n      }\n      else\n      {\n        showSnackbar('SoundCloud track, skipping to next', 5, 'Play', () => \n        {\n          sessionStorage.setItem(KEY.UF_AUTOPLAY, JSON.stringify({ autoplay: true, trackId: null, position: 0 }));\n          window.location.href = currentTrack.link;\n        },\n        () => playNextSingleTrack(playTrack));\n      }\n    }\n    else\n    {\n      if (restResponse.status.code !== 200)\n        showSnackbar('Failed to fetch track data!', 10, 'Retry', () => playNextSingleTrack(playTrack));\n    }\n  }\n\n  m.isNextTrackLoading = false;\n}\n\n\n// ************************************************************************************************\n// Support functions\n// ************************************************************************************************\n\nfunction fetchTracks(tracksDateTime)\n{\n  let beforeTrackDateTime = tracksDateTime;\n\n  if (tracksDateTime === null)\n    beforeTrackDateTime = (m.startTrackDateTime !== '') ? m.startTrackDateTime : '3000-01-01T00:00:01'; // Before the year 3000 should be enough for a while...\n\n  if (beforeTrackDateTime !== null)\n    return fetchRest('tracks', `before=${beforeTrackDateTime}&per_page=3&_fields=id,date,link,meta,artists_links,channels_links`, true);\n\n  return null;\n}\n\nfunction getTrackTitle(titleData)\n{\n  return `${titleData.track_artist} - ${titleData.track_title}`;\n}\n\nfunction updatePlayerAndPage(trackData, playTrack = false, pushState = true)\n{\n  const thumbnailData = getThumbnailData(trackData[1].meta);\n\n  m.cueOrPlayTrackById(trackData[1].meta, thumbnailData, playTrack);\n  updatePage(trackData, thumbnailData, pushState);\n}\n\nfunction getTrackNavHtml(isNavPrev, navUrl, trackMeta)\n{\n  const trackArtistTitle = `<b>${trackMeta.track_artist}</b><br>${trackMeta.track_title}`;\n  \n  return /*html*/ `\n    <div class=\"${isNavPrev ? 'nav-previous' : 'nav-next'}\">\n      <a href=\"${navUrl}\" rel=\"${isNavPrev ? 'prev' : 'next'}\">\n        ${isNavPrev ? '<div class=\"prev-track-arrow\">&#10094</div>' : ''}\n        <div class=\"${isNavPrev ? 'prev-track-artist-title' : 'next-track-artist-title'}\">${trackArtistTitle}</div>\n        ${!isNavPrev ? '<div class=\"next-track-arrow\">&#10095</div>' : ''}\n      </a>\n    </div>`;\n}\n\n\n// ************************************************************************************************\n// Update DOM functions\n// ************************************************************************************************\n\nfunction updatePage(trackData, thumbnailData, pushState = true)\n{\n  updateNavLinks(document.querySelector('div.nav-links'), trackData);\n  updateTrackHeader(document.querySelector('header.entry-header'), trackData[1]);\n  updateTrackAttributes(document.querySelector('single-track'), trackData[1], thumbnailData);\n\n  if (pushState)\n    history.pushState(trackData, '', trackData[1].link);\n\n  document.title = getTrackTitle(trackData[1].meta);\n}\n\nfunction updateNavLinks(element, trackData)\n{\n  let trackNavHtml = getTrackNavHtml(true, trackData[0].link, trackData[0].meta);\n  \n  response.prevPage = trackData[0].link;\n  response.nextPage = null;\n  \n  if (trackData.length === 3)\n  {\n    trackNavHtml     += getTrackNavHtml(false, trackData[2].link, trackData[2].meta);\n    response.nextPage = trackData[2].link;\n  }\n\n  element.innerHTML = trackNavHtml;\n}\n\nfunction updateTrackHeader(element, trackData)\n{\n  element.querySelector('h2.entry-title').textContent = getTrackTitle(trackData.meta);\n  element.querySelector('div.entry-meta-artists  .term-links').innerHTML = trackData.artists_links;\n  element.querySelector('div.entry-meta-channels .term-links').innerHTML = trackData.channels_links;\n}\n\nfunction updateTrackAttributes(element, trackData, thumbnailData)\n{\n  const attributes = {\n    'track-type':          trackData.meta.track_source_type,\n    'track-artist':        trackData.meta.track_artist,\n    'track-title':         trackData.meta.track_title,\n    'track-duration':      trackData.meta.track_duration,\n    'track-url':           trackData.link,\n    'track-thumbnail-url': thumbnailData.src,\n    'track-source-uid':    thumbnailData.uid,\n  };\n\n  Object.keys(attributes).forEach(key => element.setAttribute(`data-${key}`, attributes[key]));\n}\n", "//\r\n// ElementToggle UI / Proxy base class\r\n//\r\n// https://ultrafunk.com\r\n//\r\n\r\n\r\nimport { getCssPropString } from \"./utils.js\";\r\n\r\n\r\n/*************************************************************************************************/\r\n\r\n\r\nexport default class ElementToggle\r\n{\r\n  constructor(elementId, updateOnConstruct = true)\r\n  {\r\n    this.element      = document.getElementById(elementId);\r\n    this.valueElement = this.element.querySelector('span.value');\r\n    this.toggleTarget = this.toggle;\r\n    this.toggle       = this.toggleProxy;\r\n    this.updateTarget = this.update;\r\n    this.update       = this.updateProxy;\r\n\r\n    this.element.addEventListener('click', (event) =>\r\n    {\r\n      event?.preventDefault();\r\n      this.toggle(event);\r\n    });\r\n    \r\n    if (updateOnConstruct)\r\n      this.update();\r\n  }\r\n\r\n  get classList()  { return this.element.classList;         }\r\n  set value(value) { this.valueElement.textContent = value; }\r\n\r\n  isEnabled()            { return (this.element.classList.contains('disabled') === false);       }\r\n  pointerEventsEnabled() { return (getCssPropString('pointer-events', this.element) !== 'none'); }\r\n\r\n  // Abstract method to be overriden in child class if needed\r\n  toggle() {}\r\n\r\n  // Proxy for overridden child class method\r\n  toggleProxy(event)\r\n  {\r\n    if (this.isEnabled() && this.pointerEventsEnabled())\r\n    {\r\n      this.toggleTarget(event);\r\n      this.updateTarget(event);\r\n    }\r\n  }\r\n\r\n  // Abstract method to be overriden in child class if needed\r\n  update() {}\r\n\r\n  // Proxy for overridden child class method\r\n  updateProxy()\r\n  {\r\n    this.updateTarget();\r\n  }\r\n}\r\n", "//\r\n// Playback events module\r\n//\r\n// https://ultrafunk.com\r\n//\r\n\r\n\r\nimport * as debugLogger          from '../shared/debuglogger.js';\r\nimport { updateProgressPercent } from './playback-controls.js';\r\n\r\n\r\n/*************************************************************************************************/\r\n\r\n\r\nconst debug = debugLogger.newInstance('playback-events');\r\nexport let hasPlaybackStarted = false;\r\n\r\nexport const EVENT = {\r\n  PLAYBACK_LOADING:     'playbackLoading',\r\n  PLAYBACK_READY:       'playbackReady',\r\n  MEDIA_LOADING:        'mediaLoading',\r\n  MEDIA_PLAYING:        'mediaPlaying',\r\n  MEDIA_PAUSED:         'mediaPaused',\r\n  MEDIA_ENDED:          'mediaEnded',\r\n  MEDIA_CUE_NEXT:       'mediaCueNext',\r\n//MEDIA_CUED:           'mediaCued',\r\n  MEDIA_TIME_REMAINING: 'mediaTimeRemaining',\r\n  MEDIA_UNAVAILABLE:    'mediaUnavailable',\r\n  CONTINUE_AUTOPLAY:    'continueAutoplay',\r\n  RESUME_AUTOPLAY:      'resumeAutoplay',\r\n  AUTOPLAY_BLOCKED:     'autoplayBlocked',\r\n  PLAYBACK_BLOCKED:     'playbackBlocked',\r\n};\r\n\r\nconst eventListeners = {\r\n  [EVENT.PLAYBACK_LOADING]:     [ (event) => updateProgressPercent(event.data.loadingPercent) ],\r\n  [EVENT.PLAYBACK_READY]:       [ playbackReady ],\r\n  [EVENT.MEDIA_LOADING]:        [],\r\n  [EVENT.MEDIA_PLAYING]:        [ () => (hasPlaybackStarted = true) ],\r\n  [EVENT.MEDIA_PAUSED]:         [],\r\n  [EVENT.MEDIA_ENDED]:          [],\r\n  [EVENT.MEDIA_CUE_NEXT]:       [ () => (hasPlaybackStarted = false) ],\r\n//[EVENT.MEDIA_CUED]:           [],\r\n  [EVENT.MEDIA_TIME_REMAINING]: [],\r\n  [EVENT.MEDIA_UNAVAILABLE]:    [],\r\n  [EVENT.CONTINUE_AUTOPLAY]:    [],\r\n  [EVENT.RESUME_AUTOPLAY]:      [],\r\n  [EVENT.AUTOPLAY_BLOCKED]:     [],\r\n  [EVENT.PLAYBACK_BLOCKED]:     [],\r\n};\r\n\r\n\r\n// ************************************************************************************************\r\n// \r\n// ************************************************************************************************\r\n\r\nexport function addListener(playbackEvent, playbackEventListener)\r\n{\r\n  if (playbackEvent in eventListeners)\r\n    eventListeners[playbackEvent].push(playbackEventListener);\r\n}\r\n\r\nexport function dispatch(playbackEvent, playbackEventData = null, playbackEventCallback = null)\r\n{\r\n  eventListeners[playbackEvent].forEach(eventListener =>\r\n  {\r\n    eventListener({\r\n      event:    playbackEvent,\r\n      data:     playbackEventData,\r\n      callback: playbackEventCallback,\r\n    });\r\n  });\r\n}\r\n\r\n\r\n// ************************************************************************************************\r\n// Default event listeners\r\n// ************************************************************************************************\r\n\r\nfunction playbackReady(playbackEvent)\r\n{\r\n  debug.log(playbackEvent);\r\n\r\n  if (playbackEvent?.data.resetProgressBar)\r\n    updateProgressPercent(0);\r\n}\r\n", "//\r\n// HTMLElement convenience wrapper objects\r\n//\r\n// https://ultrafunk.com\r\n//\r\n\r\n\r\nimport { replaceClass } from \"../shared/utils.js\";\r\n\r\n\r\n/*************************************************************************************************/\r\n\r\n\r\nexport const STATE = {\r\n  UNKNOWN:  { ID:  0, CLASS: 'state-unknown'  },\r\n  DISABLED: { ID: 10, CLASS: 'state-disabled' },\r\n  ENABLED:  { ID: 20, CLASS: 'state-enabled'  },\r\n  HIDDEN:   { ID: 30, CLASS: 'state-hidden'   },\r\n  PLAYING:  { ID: 40, CLASS: 'state-playing'  },\r\n  PAUSED:   { ID: 50, CLASS: 'state-paused'   },\r\n  LOADING:  { ID: 60, CLASS: 'state-loading'  },\r\n};\r\n\r\n\r\n// ************************************************************************************************\r\n//\r\n// ************************************************************************************************\r\n\r\nexport const ElementWrapper = function(elmentSelector, parentElement = document, initialState = STATE.DISABLED)\r\n{\r\n  const element   = parentElement.querySelector(elmentSelector);\r\n  let   state     = initialState;\r\n  const classList = element.classList;\r\n\r\n  return {\r\n    get element() { return element;       },\r\n    get state()   { return state;         },\r\n    get style()   { return element.style; },\r\n\r\n    set elementTitle(title) { element.title = title; },\r\n\r\n    getElement(selector)         { return element.querySelector(selector);    },\r\n    addListener(event, listener) { element.addEventListener(event, listener); },\r\n\r\n    addClass(...cssClass)     { classList.add(...cssClass);         },\r\n    removeClass(...cssClass)  { classList.remove(...cssClass);      },\r\n    replaceClass(remove, add) { replaceClass(element, remove, add); },\r\n    toggleClass(cssClass)     { classList.toggle(cssClass);         },\r\n\r\n    getAttribute(attribute)        { return element.getAttribute(attribute); },\r\n    setAttribute(attribute, value) { element.setAttribute(attribute, value); },\r\n\r\n    setState,\r\n  };\r\n\r\n  function setState(newState = STATE.DISABLED)\r\n  {\r\n    // Only update classList and state if they have actually changed...\r\n    if (state.ID !== newState.ID)\r\n    {\r\n      classList.remove(state.CLASS);\r\n      classList.add(newState.CLASS);\r\n      state = newState;\r\n\r\n      return true;\r\n    }\r\n\r\n    return false;\r\n  }\r\n};\r\n\r\nexport const ElementsWrapper = function(elmentsSelector, parentElement = document)\r\n{\r\n  const elements = parentElement.querySelectorAll(elmentsSelector);\r\n\r\n  return {\r\n    get length()     { return elements.length;    },\r\n    forEach(...args) { elements.forEach(...args); },\r\n  };\r\n};\r\n", "//\r\n// Playback UI controls\r\n//\r\n// https://ultrafunk.com\r\n//\r\n\r\n\r\nimport * as debugLogger        from '../shared/debuglogger.js';\r\nimport { settings }            from '../shared/session-data.js';\r\nimport { EVENT, addListener }  from './playback-events.js';\r\nimport { addSettingsObserver } from '../shared/storage.js';\r\n\r\nimport {\r\n  playerType as playerTypeToggle\r\n} from './footer-toggles.js';\r\n\r\nimport {\r\n  STATE,\r\n  ElementWrapper,\r\n} from './element-wrappers.js';\r\n\r\nimport {\r\n  MATCH,\r\n  matchesMedia,\r\n  getTimeString,\r\n} from '../shared/utils.js';\r\n\r\n\r\n/*************************************************************************************************/\r\n\r\n\r\nconst debug = debugLogger.newInstance('playback-controls');\r\nconst m     = { players: {} };\r\nconst ctrl  = {};\r\n\r\n\r\n// ************************************************************************************************\r\n// Set user settings controlled CSS as early as possible before init() call\r\n// ************************************************************************************************\r\n\r\nexport function setPlaybackControlsCss()\r\n{\r\n  ctrl.prevTrack = new ElementWrapper('.playback-prev-control');\r\n  ctrl.playPause = new ElementWrapper('.playback-play-pause-control');\r\n\r\n  if (matchesMedia(MATCH.SITE_MAX_WIDTH_MOBILE))\r\n  {\r\n    debug.log('setPlaybackControlsCss(): MATCH.SITE_MAX_WIDTH_MOBILE');\r\n\r\n    if (settings.mobile.showPrevTrackButton)\r\n      ctrl.prevTrack.addClass('show-on-mobile');\r\n\r\n    if (!settings.mobile.showPrevTrackButton && !settings.mobile.showTrackTimes)\r\n      ctrl.playPause.addClass('mobile-margin-10px');\r\n    else if (settings.mobile.showTrackTimes && !settings.mobile.showPrevTrackButton)\r\n      ctrl.playPause.addClass('mobile-margin-6px');\r\n    else if (settings.mobile.showPrevTrackButton && !settings.mobile.showTrackTimes)\r\n      ctrl.prevTrack.addClass('mobile-margin-3px');\r\n  }\r\n}\r\n\r\n\r\n// ************************************************************************************************\r\n// Init and make ready all controls\r\n// ************************************************************************************************\r\n\r\nexport function init(mediaPlayers, seekClickCallback)\r\n{\r\n  debug.log('init()');\r\n\r\n  m.players = mediaPlayers;\r\n\r\n  const playbackProgress = document.getElementById('progress-controls');\r\n\r\n  if (playbackProgress !== null)\r\n  {\r\n    ctrl.progressSeek = new ElementWrapper('.progress-seek-control', playbackProgress);\r\n    ctrl.progressSeek.clickCallback = seekClickCallback;\r\n    ctrl.progressBar  = new ElementWrapper('.progress-bar-control', playbackProgress);\r\n  }\r\n  else\r\n  {\r\n    debug.error('init(): Unable to getElementById() for #progress-controls');\r\n  }\r\n\r\n  const playbackControls = document.getElementById('playback-controls');\r\n\r\n  if (playbackControls !== null)\r\n  {\r\n    ctrl.details        = new ElementWrapper('.playback-details-control', playbackControls);\r\n    ctrl.details.artist = ctrl.details.getElement('.playback-details-artist');\r\n    ctrl.details.title  = ctrl.details.getElement('.playback-details-title');\r\n    \r\n    ctrl.thumbnail     = new ElementWrapper('.playback-thumbnail-control', playbackControls);\r\n    ctrl.thumbnail.img = ctrl.thumbnail.getElement('img');\r\n    \r\n    ctrl.timer                 = new ElementWrapper('.playback-timer-control', playbackControls);\r\n    ctrl.timer.position        = ctrl.timer.getElement('.playback-timer-position');\r\n    ctrl.timer.duration        = ctrl.timer.getElement('.playback-timer-duration');\r\n    ctrl.timer.positionSeconds = -1; // Make sure initial value is set + shown when track plays\r\n    ctrl.timer.durationSeconds = -1; // Make sure initial value is set + shown when track plays\r\n      \r\n    ctrl.playerType = new ElementWrapper('.playback-player-type-control', playbackControls);\r\n\r\n    ctrl.playPause.icon = ctrl.playPause.getElement('span.material-icons');\r\n    \r\n    ctrl.nextTrack = new ElementWrapper('.playback-next-control', playbackControls);\r\n    \r\n    ctrl.repeat      = new ElementWrapper('.playback-repeat-control', playbackControls);\r\n    ctrl.repeat.icon = ctrl.repeat.getElement('span.material-icons');\r\n    \r\n    ctrl.shuffle = new ElementWrapper('.playback-shuffle-control', playbackControls);\r\n    \r\n    ctrl.mute      = new ElementWrapper('.playback-mute-control', playbackControls);\r\n    ctrl.mute.icon = ctrl.mute.getElement('span.material-icons');\r\n  }\r\n  else\r\n  {\r\n    debug.error('init(): Unable to getElementById() for #playback-controls');\r\n  }\r\n}\r\n\r\nexport function ready(prevClickCallback, playPauseClickCallback, nextClickCallback, muteClickCallback)\r\n{\r\n  debug.log('ready()');\r\n\r\n  ctrl.progressSeek.setState(STATE.ENABLED);\r\n  ctrl.progressSeek.addListener('click', progressSeekClick);\r\n  ctrl.progressBar.setState(STATE.ENABLED);\r\n  \r\n  ctrl.details.setState(STATE.HIDDEN);\r\n  ctrl.thumbnail.setState(STATE.HIDDEN);\r\n  ctrl.timer.setState(STATE.HIDDEN);\r\n\r\n  if (settings.mobile.showTrackThumbnail)\r\n    ctrl.thumbnail.addClass('show-on-mobile');\r\n\r\n  if (settings.mobile.showTrackTimes)\r\n    ctrl.timer.addClass('show-on-mobile');\r\n\r\n  ctrl.playerType.setState(STATE.ENABLED);\r\n  ctrl.playerType.addListener('click', () => playerTypeToggle.toggle());\r\n\r\n  ctrl.prevTrack.setState((m.players.getCurrentTrack() > 1) ? STATE.ENABLED : STATE.DISABLED);\r\n  ctrl.prevTrack.addListener('click', prevClickCallback);\r\n\r\n  ctrl.playPause.setState(STATE.PAUSED);\r\n  ctrl.playPause.addListener('click', playPauseClickCallback);\r\n\r\n  ctrl.nextTrack.setState((m.players.getNumTracks() > 1) ? STATE.ENABLED : STATE.DISABLED);\r\n  ctrl.nextTrack.addListener('click', () => nextClickCallback());\r\n\r\n  ctrl.repeat.setState(STATE.ENABLED);\r\n  ctrl.repeat.addListener('click', toggleRepeat);\r\n\r\n  ctrl.shuffle.setState(STATE.ENABLED);\r\n\r\n  ctrl.mute.setState(STATE.ENABLED);\r\n  ctrl.mute.addListener('click', () => muteClickCallback());\r\n  updateMuteState();\r\n\r\n  addSettingsObserver('autoplay',   updateAutoplayState);\r\n  addSettingsObserver('masterMute', updateMuteState);\r\n\r\n  addListener(EVENT.MEDIA_LOADING,     setLoadState);\r\n  addListener(EVENT.MEDIA_PLAYING,     setPlayState);\r\n  addListener(EVENT.MEDIA_PAUSED ,     setPauseState);\r\n  addListener(EVENT.MEDIA_ENDED,       setMediaEndState);\r\n  addListener(EVENT.MEDIA_CUE_NEXT,    () => updateProgressPercent(0));\r\n  addListener(EVENT.AUTOPLAY_BLOCKED,  setPauseState);\r\n  addListener(EVENT.PLAYBACK_BLOCKED,  setPauseState);\r\n  addListener(EVENT.MEDIA_UNAVAILABLE, setPauseState);\r\n}\r\n\r\n\r\n// ************************************************************************************************\r\n// Progress bar and position seek\r\n// ************************************************************************************************\r\n\r\nexport function updateProgressPercent(progressPercent)\r\n{\r\n  updateProgressBar(progressPercent / 100);\r\n}\r\n\r\nfunction updateProgressBar(scaleX)\r\n{\r\n  ctrl.progressBar.style.transform = `scaleX(${scaleX})`;\r\n}\r\n\r\nexport function updateTimerAndProgress(positionMilliseconds, positionSeconds, durationSeconds)\r\n{\r\n  setTimer(positionSeconds, durationSeconds);\r\n\r\n  // Prevent division by zero\r\n  if (durationSeconds === 0)\r\n    updateProgressBar(0);\r\n  else\r\n    updateProgressBar(positionMilliseconds / (durationSeconds * 1000));\r\n}\r\n\r\nfunction progressSeekClick(event)\r\n{\r\n  if (ctrl.timer.durationSeconds > 0)\r\n  {\r\n    let progressPercent = ((event.clientX / document.documentElement.clientWidth) * 100);\r\n    let seekPosSeconds  = Math.round((ctrl.timer.durationSeconds * progressPercent) / 100);\r\n\r\n    if (!settings.mobile.showPrevTrackButton      &&\r\n        matchesMedia(MATCH.SITE_MAX_WIDTH_MOBILE) &&\r\n        (progressPercent <= 20))\r\n    {\r\n      ctrl.progressSeek.clickCallback(0);\r\n      progressPercent = 0;\r\n      seekPosSeconds  = 0;\r\n    }\r\n    else\r\n    {\r\n      ctrl.progressSeek.clickCallback(seekPosSeconds);\r\n    }\r\n\r\n    if (isPlaying() === false)\r\n    {\r\n      updateProgressPercent(progressPercent);\r\n      setTimer(seekPosSeconds, ctrl.timer.durationSeconds);\r\n    }\r\n  }\r\n}\r\n\r\n\r\n// ************************************************************************************************\r\n// Details (Artist + Title) and track timer\r\n// ************************************************************************************************\r\n\r\nfunction setDetails(trackData)\r\n{\r\n  if (ctrl.details.state.ID === STATE.HIDDEN.ID)\r\n  {\r\n    ctrl.details.setState(STATE.ENABLED);\r\n    ctrl.thumbnail.setState(STATE.ENABLED);\r\n    ctrl.timer.setState(STATE.ENABLED);\r\n    clearTimer(trackData);\r\n  }\r\n\r\n  ctrl.details.artist.textContent = trackData.artist || ''; // Artist will contain the post title if all else fails\r\n  ctrl.details.title.textContent  = trackData.title  || '';\r\n  \r\n  setThumbnail(trackData.thumbnail);\r\n  setTimerDisplayHoursMinutes(trackData.duration);\r\n  setTimer((isPlaying() ? ctrl.timer.positionSeconds : 0), trackData.duration);\r\n}\r\n\r\nfunction setThumbnail(thumbnail)\r\n{\r\n  // Don't set thumbnail again if the image source / URL is unchanged\r\n  if (thumbnail.src !== ctrl.thumbnail.img.src)\r\n  {\r\n    ctrl.thumbnail.removeClass('type-default', 'type-youtube', 'type-soundcloud');\r\n    ctrl.thumbnail.addClass('loading', thumbnail.class);\r\n    ctrl.thumbnail.img.src = thumbnail.src;\r\n    ctrl.thumbnail.img.decode().then(() => ctrl.thumbnail.removeClass('loading'));\r\n  }\r\n}\r\n\r\nfunction setTimerDisplayHoursMinutes(durationSeconds)\r\n{\r\n  (durationSeconds > 3600)\r\n    ? ctrl.timer.replaceClass('display-minutes', 'display-hours')\r\n    : ctrl.timer.replaceClass('display-hours', 'display-minutes');\r\n}\r\n\r\nfunction setTimer(positionSeconds, durationSeconds)\r\n{\r\n  if (ctrl.timer.positionSeconds !== positionSeconds)\r\n  {\r\n    ctrl.timer.positionSeconds = positionSeconds;\r\n\r\n    if (settings.playback.autoplay === false)\r\n      positionSeconds = (durationSeconds - positionSeconds);\r\n    \r\n    ctrl.timer.position.textContent = getTimeString(positionSeconds, (durationSeconds > 3600));\r\n  }\r\n\r\n  if (ctrl.timer.durationSeconds !== durationSeconds)\r\n  {\r\n    ctrl.timer.durationSeconds      = durationSeconds;\r\n    ctrl.timer.duration.textContent = getTimeString(durationSeconds, (durationSeconds > 3600));\r\n  }\r\n}\r\n\r\nfunction clearTimer(trackData)\r\n{\r\n  ctrl.timer.position.textContent = settings.playback.autoplay\r\n    ? (trackData.duration > 3600) ? '00:00:00' : '00:00'\r\n    : getTimeString(trackData.duration, (trackData.duration > 3600));\r\n\r\n  ctrl.timer.duration.textContent = (trackData.duration > 3600) ? '00:00:00' : '00:00';\r\n  ctrl.timer.positionSeconds = -1;\r\n  ctrl.timer.durationSeconds = -1;\r\n}\r\n\r\n\r\n// ************************************************************************************************\r\n// Playback controls (prev, play/pause and next)\r\n// ************************************************************************************************\r\n\r\nexport function isPlaying()\r\n{\r\n  // ToDo: This might not be the best place to save / check playback state...?\r\n  return ((ctrl.playPause.state.ID === STATE.PLAYING.ID) ? true : false);    \r\n}\r\n\r\nfunction setLoadState()\r\n{\r\n  if (ctrl.thumbnail.state.ID === STATE.ENABLED.ID)\r\n    ctrl.thumbnail.addClass(STATE.LOADING.CLASS);\r\n}\r\n\r\nfunction setMediaEndState()\r\n{\r\n  updateProgressBar(0);\r\n  setTimer(0, m.players.getTrackData().duration);\r\n}\r\n\r\nexport function setPlayState()\r\n{\r\n  ctrl.thumbnail.removeClass(STATE.LOADING.CLASS);\r\n  ctrl.playPause.setState(STATE.PLAYING);\r\n  ctrl.playPause.icon.textContent = 'pause_circle_filled';\r\n  ctrl.prevTrack.setState(STATE.ENABLED);\r\n  \r\n  setDetails(m.players.getTrackData());\r\n}\r\n\r\nexport function setPauseState()\r\n{\r\n  ctrl.thumbnail.removeClass(STATE.LOADING.CLASS);\r\n  ctrl.playPause.setState(STATE.PAUSED);\r\n  ctrl.playPause.icon.textContent = 'play_circle_filled';\r\n}\r\n\r\nexport function blinkPlayPause(toggleBlink)\r\n{\r\n  if (toggleBlink)\r\n    ctrl.playPause.toggleClass('time-remaining-warning');\r\n  else\r\n    ctrl.playPause.removeClass('time-remaining-warning');\r\n}\r\n\r\nexport function getSetTrackData()\r\n{\r\n  const trackData = m.players.getTrackData();\r\n\r\n  clearTimer(trackData);\r\n  setDetails(trackData);\r\n\r\n  return trackData;\r\n}\r\n\r\nexport function updatePrevState()\r\n{\r\n  const trackData = getSetTrackData();\r\n  \r\n  if ((isPlaying() === false) && (trackData.currentTrack <= 1))\r\n    ctrl.prevTrack.setState(STATE.DISABLED);\r\n  \r\n  if (trackData.currentTrack < trackData.numTracks)\r\n    ctrl.nextTrack.setState(STATE.ENABLED);\r\n}\r\n\r\nexport function updateNextState()\r\n{\r\n  const trackData = getSetTrackData();\r\n\r\n  ctrl.prevTrack.setState(STATE.ENABLED);\r\n  \r\n  if (trackData.currentTrack >= trackData.numTracks)\r\n    ctrl.nextTrack.setState(STATE.DISABLED);\r\n}\r\n\r\n\r\n// ************************************************************************************************\r\n// Repeat control\r\n// ************************************************************************************************\r\n\r\nexport const REPEAT = { OFF: 0, ALL: 1, ONE: 2 };\r\n\r\nconst repeatModes = [\r\n  { title: 'Repeat Off', icon: 'repeat'     },\r\n  { title: 'Repeat All', icon: 'repeat'     },\r\n  { title: 'Repeat One', icon: 'repeat_one' },\r\n];\r\n\r\nexport function getRepeatMode()\r\n{\r\n  return parseInt(ctrl.repeat.getAttribute('data-repeat-mode'));\r\n}\r\n\r\nexport function toggleRepeat()\r\n{\r\n  const index = ((getRepeatMode() + 1) < repeatModes.length)\r\n                  ? (getRepeatMode() + 1)\r\n                  : 0;\r\n\r\n  ctrl.repeat.setAttribute('data-repeat-mode', index);\r\n  ctrl.repeat.elementTitle     = `${repeatModes[index].title} (r)`;\r\n  ctrl.repeat.icon.textContent = repeatModes[index].icon;\r\n\r\n  return repeatModes[index];\r\n}\r\n\r\n\r\n// ************************************************************************************************\r\n// Set Mute control and Autoplay states\r\n// ************************************************************************************************\r\n\r\nfunction updateMuteState()\r\n{\r\n  ctrl.mute.icon.textContent = settings.playback.masterMute ? 'volume_off' : 'volume_up';\r\n}\r\n\r\nfunction updateAutoplayState()\r\n{\r\n  const position = ctrl.timer.positionSeconds;\r\n  const duration = ctrl.timer.durationSeconds;\r\n\r\n  if ((isPlaying() === false) && (position !== -1) && ((duration !== -1)))\r\n  {\r\n    ctrl.timer.position.textContent = settings.playback.autoplay\r\n      ? getTimeString(position, (duration > 3600))\r\n      : getTimeString((duration - position), (duration > 3600));\r\n\r\n    ctrl.timer.duration.textContent = getTimeString(duration, (duration > 3600));\r\n  }\r\n}\r\n", "//\r\n// HTML Element clicked parent class\r\n//\r\n// https://ultrafunk.com\r\n//\r\n\r\n\r\nexport default class ElementClick\r\n{\r\n  constructor()\r\n  {\r\n    this.event   = null;\r\n    this.element = null;\r\n  }\r\n\r\n  clickHandler(event)\r\n  {\r\n    this.event = event;\r\n    this.elementClicked();\r\n  }\r\n\r\n  clicked(selector)\r\n  {\r\n    this.element = this.event.target.closest(selector);\r\n\r\n    if (this.element !== null)\r\n    {\r\n      this.event.stopImmediatePropagation();\r\n      return true;\r\n    }\r\n    \r\n    return false;\r\n  }\r\n\r\n  closest(selector)\r\n  {\r\n    return this.element.closest(selector);\r\n  }\r\n\r\n  querySelector(selector)\r\n  {\r\n    return this.element.querySelector(selector);\r\n  }\r\n}\r\n", "//\r\n// List player track template functions\r\n//\r\n// https://ultrafunk.com\r\n//\r\n\r\n\r\nimport * as debugLogger from '../../shared/debuglogger.js';\r\nimport { TRACK_TYPE }   from '../mediaplayers.js';\r\n\r\nimport {\r\n  getTimeString,\r\n  getListPlayerUrl,\r\n  getThumbnailData,\r\n  escHtml,\r\n} from '../../shared/utils.js';\r\n\r\n\r\n/*************************************************************************************************/\r\n\r\n\r\nconst debug = debugLogger.newInstance('list-track-templates');\r\n\r\n\r\n// ************************************************************************************************\r\n// \r\n// ************************************************************************************************\r\n\r\nexport function getPageSeparatorHtml(responseData, loadingPage)\r\n{\r\n  const pageUrl = responseData.nextPage.replace(/\\/page\\/(?!0)\\d{1,6}\\//i, `/page/${loadingPage}/`);\r\n\r\n  return /*html*/ `\r\n    <div id=\"tracklist-page-${loadingPage}\" class=\"tracklist-page-separator\" data-page-number=\"${loadingPage}\">\r\n      <span class=\"material-icons arrow-down-button\" title=\"Scroll to next page\">arrow_downward</span>\r\n      <a href=\"${pageUrl}\" title=\"Go to page ${loadingPage}\">Page ${loadingPage} &#9660;</a>\r\n      <span class=\"material-icons arrow-up-button\" title=\"Scroll to previous page\">arrow_upward</span>\r\n    </div>`;\r\n}\r\n\r\nexport function getTrackEntryHtml(track)\r\n{\r\n  const isYouTubeTrack = (track.meta.track_source_type === TRACK_TYPE.YOUTUBE);\r\n  const thumbnailData  = getThumbnailData(track.meta);\r\n  const trackArtist    = escHtml(track.meta.track_artist);\r\n  const trackTitle     = escHtml(track.meta.track_title);\r\n  const trackDuration  = parseInt(track.meta.track_duration);\r\n\r\n  const youTubeTrackThumbnailUrl = debug.isDebug()\r\n                                     ? \"/wp-content/themes/ultrafunk/inc/img/yt_thumbnail_placeholder.png\"\r\n                                     : thumbnailData.src;\r\n\r\n  const trackThumbnailUrl = isYouTubeTrack\r\n                              ? youTubeTrackThumbnailUrl\r\n                              : '/wp-content/themes/ultrafunk/inc/img/sc_thumbnail_placeholder.png';\r\n\r\n  const trackArtistTitle = isYouTubeTrack\r\n                             ? `<span><b>${trackArtist}</b></span><br><span>${trackTitle}</span>`\r\n                             : `<a href=\"${track.link}\"><span><b>${trackArtist}</b></span><br><span>${trackTitle}</span></a>`;\r\n  \r\n  const trackPlayNext = isYouTubeTrack\r\n                          ? `<div class=\"play-next-button\" title=\"Play Next\"><span class=\"material-icons\">playlist_play</span></div>`\r\n                          : '';\r\n\r\n  return /*html*/ `\r\n    <div id=\"${track.uid}\" class=\"track-entry ${thumbnailData.class}\"\r\n      data-track-type=\"${track.meta.track_source_type}\"\r\n      data-track-id=\"track-${track.id}\"\r\n      data-track-artist=\"${trackArtist}\"\r\n      data-track-title=\"${trackTitle}\"\r\n      data-track-duration=\"${trackDuration}\"\r\n      data-track-url=\"${track.link}\"\r\n      data-track-thumbnail-url=\"${trackThumbnailUrl}\"\r\n      data-track-source-uid =\"${thumbnailData.uid}\"\r\n      >\r\n      <div class=\"track-artists-links\" data-track-artist-ids=\"${track.artists.toString()}\"></div>\r\n      <div class=\"track-channels-links\" data-track-channel-ids=\"${track.channels.toString()}\"></div>\r\n      <div class=\"track-details\">\r\n        <div class=\"thumbnail\" ${isYouTubeTrack ? 'title=\"Play Track\"' : 'title=\"SoundCloud Track\"'}>\r\n          <div class=\"thumbnail-overlay\"><div class=\"spinner\"></div></div>\r\n          <img src=\"${trackThumbnailUrl}\" alt=\"\">\r\n        </div>\r\n        <div class=\"artist-title text-nowrap-ellipsis\" ${(isYouTubeTrack === false) ? 'title=\"Link: Play SoundCloud track\"' : ''}>\r\n          ${trackArtistTitle}\r\n        </div>\r\n      </div>\r\n      <div class=\"track-actions\">\r\n        <div class=\"track-message\"></div>\r\n        <div class=\"track-action-buttons\">\r\n          <div class=\"remove-button\" title=\"Remove Track from List\"><span class=\"material-icons\">clear</span></div>\r\n          ${trackPlayNext}\r\n          <div class=\"share-play-button\" title=\"Share Track / Play On\"><span class=\"material-icons\">share</span></div>\r\n          <div class=\"details-button\" title=\"Track Details\"><span class=\"material-icons-outlined\">info</span></div>\r\n        </div>\r\n        <div class=\"track-actions-toggle\" title=\"Show / Hide track actions\"><span class=\"material-icons\">more_horiz</span></div>\r\n      </div>\r\n      <div class=\"track-duration text-nowrap-ellipsis\">${(isYouTubeTrack ? getTimeString(trackDuration) : 'N / A')}</div>\r\n    </div>`;\r\n}\r\n\r\nexport function setTrackMeta(\r\n  trackData,\r\n  trackLinksSelector,\r\n  linkIdsAttribute,\r\n  linksMap,\r\n  isChannels = false\r\n)\r\n{\r\n  trackData.forEach(track =>\r\n  {\r\n    const linksElement = document.getElementById(track.uid).querySelector(trackLinksSelector);\r\n    const linkIds      = linksElement.getAttribute(linkIdsAttribute)?.split(',');\r\n    let   linksHtml    = '';\r\n    let   isVideo      = false;\r\n\r\n    linkIds?.forEach(linkId =>\r\n    {\r\n      const mapKey    = parseInt(linkId);\r\n      const linkClass = (track.meta.track_artist_id === mapKey) ? 'primary' : 'secondary';\r\n      linksHtml      +=`<a class=\"${linkClass}\" href=\"${getListPlayerUrl(linksMap.get(mapKey).link)}\">${linksMap.get(mapKey).name}</a>`;\r\n\r\n      if (isChannels && (linksMap.get(mapKey).name === 'Video'))\r\n        isVideo = true;\r\n    });\r\n\r\n    document.getElementById(track.uid).classList.add(isVideo ? 'is-video' : 'is-audio');\r\n    linksElement.insertAdjacentHTML('afterbegin', linksHtml);\r\n  });\r\n}\r\n", "//\r\n// List player tracks REST data fetch and caching\r\n//\r\n// https://ultrafunk.com\r\n//\r\n\r\n\r\nimport * as debugLogger from '../../shared/debuglogger.js';\r\nimport { fetchRest }    from '../../shared/utils.js';\r\n\r\nimport {\r\n  response as responseData\r\n} from '../../shared/session-data.js';\r\n\r\nimport {\r\n  getPageSeparatorHtml,\r\n  getTrackEntryHtml,\r\n  setTrackMeta,\r\n} from './list-track-templates.js';\r\n\r\n\r\n/*************************************************************************************************/\r\n\r\n\r\nconst debug = debugLogger.newInstance('list-tracks-rest');\r\n\r\nconst m = {\r\n  artistsCache:  new Map(),\r\n  channelsCache: new Map(),\r\n};\r\n\r\n\r\n// ************************************************************************************************\r\n// \r\n// ************************************************************************************************\r\n\r\nexport async function loadTracks(termType, termId)\r\n{\r\n  const loadingPage = parseInt(responseData.currentPage + 1);\r\n  const trackData   = await fetchTracks(termType, termId, loadingPage, parseInt(responseData.listPerPage));\r\n\r\n  if (trackData !== null)\r\n  {\r\n    const artistIds  = new Set();\r\n    const channelIds = new Set();\r\n    let tracksHtml   = getPageSeparatorHtml(responseData, loadingPage);\r\n\r\n    trackData.forEach((track, index) =>\r\n    {\r\n      track.artists.forEach(key => (m.artistsCache.has(key) === false) && artistIds.add(key));\r\n      track.channels.forEach(key => (m.channelsCache.has(key) === false) && channelIds.add(key));\r\n      track.uid = (Date.now() + index);\r\n      tracksHtml += getTrackEntryHtml(track);\r\n    });\r\n\r\n    document.getElementById('tracklist-load-more').insertAdjacentHTML('beforebegin', tracksHtml);\r\n  \r\n    debug.log(`Fetching: ${artistIds.size} artists (cached: ${m.artistsCache.size}) - Fetching: ${channelIds.size} channels (cached: ${m.channelsCache.size})`);\r\n\r\n    let artistsPromise  = null;\r\n    let channelsPromise = null;\r\n    \r\n    if (artistIds.size > 0)\r\n      artistsPromise = fetchTerms('artists',  [...artistIds], 100);\r\n  \r\n    if (channelIds.size > 0)\r\n      channelsPromise = fetchTerms('channels', [...channelIds], 100);\r\n\r\n    const [artistsData, channelsData] = await Promise.all([artistsPromise, channelsPromise]);\r\n\r\n    if (artistsData !== null)\r\n      artistsData.forEach(entry => m.artistsCache.set(entry.id, { name: entry.name, link: entry.link }));\r\n\r\n    if (channelsData !== null)\r\n      channelsData.forEach(entry => m.channelsCache.set(entry.id, { name: entry.name, link: entry.link }));\r\n\r\n    setTrackMeta(trackData, '.track-artists-links',  'data-track-artist-ids',  m.artistsCache,  false);\r\n    setTrackMeta(trackData, '.track-channels-links', 'data-track-channel-ids', m.channelsCache, true);\r\n\r\n    return true;\r\n  }\r\n\r\n  return false;\r\n}\r\n\r\n\r\n// ************************************************************************************************\r\n// Fetch tracks + terms\r\n// ************************************************************************************************\r\n\r\nfunction fetchTracks(termType = '', termId = '', page = 1, tracksPerPage = 25)\r\n{\r\n  debug.log(`fetchTracks() - termType: ${(termType.length === 0) ? 'N/A' : termType} - termId: ${(termId.length === 0) ? 'N/A' : termId} - page: ${page} - tracksPerPage: ${tracksPerPage}`);\r\n\r\n  let params       = '';\r\n  const pagination = `page=${page}&per_page=${tracksPerPage}`;\r\n  const fields     = '&_fields=id,link,artists,channels,meta';\r\n  \r\n  if (responseData.params.channel || responseData.params.artist)\r\n    params = getTermQueryParams(termType, termId);\r\n  else if (responseData.params.shuffle)\r\n    params = getShuffleQueryParams();\r\n  else if (responseData.params.search)\r\n    params = getSearchQueryParams();\r\n\r\n  return fetchRest('tracks', `${params}${pagination}${fields}`);\r\n}\r\n\r\nfunction fetchTerms(termType, termIds, maxItems = 50)\r\n{\r\n  return fetchRest(termType, `include=${termIds}&per_page=${maxItems}&_fields=id,link,name`);\r\n}\r\n\r\nfunction getTermQueryParams(termType, termId)\r\n{\r\n  if ((termType.length !== 0) && (termId.length !== 0))\r\n    return `${termType}=${parseInt(termId)}&`;\r\n\r\n  return '';\r\n}\r\n\r\nfunction getShuffleQueryParams()\r\n{\r\n  let shuffleParams = `shuffle=true&shuffle_type=${responseData.params.shuffle_type}&`;\r\n\r\n  if (responseData.params.shuffle_slug !== null)\r\n    shuffleParams += `shuffle_slug=${responseData.params.shuffle_slug}&`;\r\n\r\n  return shuffleParams;\r\n}\r\n\r\n//\r\n// ToDo: wpessid=4021;\r\n//\r\nfunction getSearchQueryParams()\r\n{\r\n  let searchString   = '';\r\n  const searchParams = new URLSearchParams(window.location.search);\r\n\r\n  if (searchParams.has('s'))\r\n  {\r\n    searchString = encodeURIComponent(searchParams.get('s'));\r\n  //Search string \"R&B\" needs special handling to match \"R&amp;B\"\r\n    searchString = searchString.replace(/r%26b/i, 'r%26amp;b');\r\n  }\r\n\r\n  return `search=${searchString}&orderby=relevance&wpessid=true&`;\r\n}\r\n", "//\r\n// List-player controls module\r\n//\r\n// https://ultrafunk.com\r\n//\r\n\r\n\r\nimport * as debugLogger       from '../../shared/debuglogger.js';\r\nimport * as upNextModal       from './up-next-modal.js';\r\nimport * as playbackEvents    from '../playback-events.js';\r\nimport ElementClick           from '../../shared/element-click.js';\r\nimport { STATE }              from '../element-wrappers.js';\r\nimport { TRACK_TYPE }         from '../mediaplayers.js';\r\nimport { loadTracks }         from './list-tracks-rest.js';\r\nimport { showSnackbar }       from '../../shared/snackbar.js';\r\nimport { response, settings } from '../../shared/session-data.js';\r\n\r\nimport {\r\n  replaceClass,\r\n  stripAttribute,\r\n} from '../../shared/utils.js';\r\n\r\n\r\n/*************************************************************************************************/\r\n\r\n\r\nconst debug = debugLogger.newInstance('list-controls');\r\n\r\nconst m = {\r\n  tracklist:         null,\r\n  tracklistObserver: null,\r\n  tracklistLoadMore: null,\r\n  player:            null,\r\n  trackElement:      null,\r\n  currentState:      STATE.UNKNOWN,\r\n  prevActionButtons: null,\r\n  playerWrapper:     null,\r\n  uiElements:        null,\r\n};\r\n\r\n\r\n// ************************************************************************************************\r\n//\r\n// ************************************************************************************************\r\n\r\nexport function init(setCurrentTrackCallback)\r\n{\r\n  debug.log('init()');\r\n\r\n  upNextModal.init(setCurrentTrackCallback);\r\n\r\n  m.tracklist         = document.getElementById('tracklist');\r\n  m.tracklistObserver = new IntersectionObserver(observerCallback, { root: m.tracklist });\r\n  m.playerWrapper     = document.querySelector('.wp-block-embed__wrapper');\r\n  m.uiElements        = new UiElements(setCurrentTrackCallback);\r\n\r\n  m.tracklist.addEventListener('click', (event) => m.uiElements.clickHandler(event));\r\n}\r\n\r\nexport function ready(player)\r\n{\r\n  m.player = player;\r\n  m.trackElement.classList.add('current');\r\n\r\n  playbackEvents.addListener(playbackEvents.EVENT.MEDIA_LOADING,  () => setCurrentTrackState(STATE.LOADING));\r\n  playbackEvents.addListener(playbackEvents.EVENT.MEDIA_PLAYING,  () => setCurrentTrackState(STATE.PLAYING));\r\n  playbackEvents.addListener(playbackEvents.EVENT.MEDIA_CUE_NEXT, (event) => setNextTrackState(event.data.nextTrackId, event.data.isPointerClick));\r\n\r\n  if (settings.list.showLoadMoreTracks)\r\n    initLoadMoreTracks();\r\n}\r\n\r\nfunction observerCallback(entries)\r\n{\r\n  m.tracklistObserver.unobserve(m.trackElement);\r\n\r\n  if ((Math.ceil(entries[0].intersectionRatio * 100) / 100) !== 1)\r\n    m.tracklist.scrollTop = (m.trackElement.offsetTop - m.tracklist.offsetHeight) + m.trackElement.offsetHeight;    \r\n}\r\n\r\n\r\n// ************************************************************************************************\r\n//\r\n// ************************************************************************************************\r\n\r\nexport function queryTrack(selectors)\r\n{\r\n  return m.tracklist.querySelector(selectors);\r\n}\r\n\r\nexport function queryTrackAll(selectors)\r\n{\r\n  return m.tracklist.querySelectorAll(selectors);\r\n}\r\n\r\nexport function queryTrackId(id)\r\n{\r\n  return document.getElementById(id);\r\n}\r\n\r\nexport function getCurrentTrackElement()\r\n{\r\n  return m.trackElement;\r\n}\r\n\r\nexport function getTrackType(element)\r\n{\r\n  const trackType = element.getAttribute('data-track-type');\r\n\r\n  if (trackType !== null)\r\n    return parseInt(trackType);\r\n  \r\n  return TRACK_TYPE.NONE;\r\n}\r\n\r\nexport function getPrevPlayableId()\r\n{\r\n  let destElement = (m.trackElement !== null)\r\n                      ? m.trackElement.previousElementSibling\r\n                      : null;\r\n\r\n  while ((destElement !== null) && (getTrackType(destElement) !== TRACK_TYPE.YOUTUBE))\r\n    destElement = destElement.previousElementSibling;\r\n\r\n  return ((destElement !== null) ? destElement.id : null);\r\n}\r\n\r\nexport function getNextPlayableId(startElement = m.trackElement)\r\n{\r\n  let destElement = (startElement !== null)\r\n                      ? startElement.nextElementSibling\r\n                      : queryTrack('div.track-entry');\r\n\r\n  while ((destElement !== null) && (getTrackType(destElement) !== TRACK_TYPE.YOUTUBE))\r\n    destElement = destElement.nextElementSibling;\r\n  \r\n  return ((destElement !== null) ? destElement.id : null);\r\n}\r\n\r\nexport function setCuedTrack(trackId)\r\n{\r\n  m.trackElement = queryTrackId(trackId);\r\n  m.tracklistObserver.observe(m.trackElement);\r\n}\r\n\r\n\r\n// ************************************************************************************************\r\n//\r\n// ************************************************************************************************\r\n\r\nclass UiElements extends ElementClick\r\n{\r\n  constructor(setCurrentTrackCallback)\r\n  {\r\n    super();\r\n    this.setCurrentTrack = setCurrentTrackCallback;\r\n  }\r\n\r\n  elementClicked()\r\n  {\r\n    if (this.clicked('div.thumbnail'))\r\n      return this.setCurrentTrack(this.closest('div.track-entry').id, true, true);\r\n  \r\n    if (this.clicked('div.track-actions-toggle'))\r\n      return trackActionsClick(this.closest('div.track-entry'));\r\n  \r\n    if (this.clicked('div.remove-button'))\r\n      return removeClick(this.closest('div.track-entry'));\r\n  \r\n    if (this.clicked('div.play-next-button'))\r\n      return playNextClick(this.closest('div.track-entry'));\r\n  \r\n    if (this.clicked('span.arrow-up-button'))\r\n      return arrowUpDownClick(this.closest('div.tracklist-page-separator'), true);\r\n  \r\n    if (this.clicked('span.arrow-down-button'))\r\n      return arrowUpDownClick(this.closest('div.tracklist-page-separator'), false);      \r\n  }\r\n}\r\n\r\nfunction trackActionsClick(element)\r\n{\r\n  const trackActionButtons = element.querySelector('.track-action-buttons');\r\n\r\n  if ((m.prevActionButtons !== null) && (m.prevActionButtons !== trackActionButtons))\r\n    m.prevActionButtons.style.display = '';\r\n\r\n  if (trackActionButtons.style.display === '')\r\n    trackActionButtons.style.display = 'flex';\r\n  else\r\n    trackActionButtons.style.display = '';\r\n\r\n  m.prevActionButtons = trackActionButtons;\r\n}\r\n\r\nfunction playNextClick(trackElement)\r\n{\r\n  if (m.trackElement !== null)\r\n  {\r\n    const nextTrackElement = trackElement.cloneNode(true);\r\n    \r\n    clearTrackState(nextTrackElement);\r\n    nextTrackElement.id = Date.now();\r\n\r\n    if (settings.list.moveTrackOnPlayNext && (trackElement !== m.trackElement))\r\n      removeClick(trackElement, false, () => addTrack(nextTrackElement, m.trackElement, 'afterend'));\r\n    else\r\n      addTrack(nextTrackElement, m.trackElement, 'afterend'); \r\n\r\n    showSnackbar('Track will play next', 3);\r\n  }\r\n  else\r\n  {\r\n    showSnackbar('Unable to cue track', 3);\r\n  }\r\n}\r\n\r\nfunction removeClick(trackElement, allowUndo = true, animationEndCallback = () => {})\r\n{\r\n  if (trackElement !== m.trackElement)\r\n  {\r\n    const undoRemoveElement = trackElement.cloneNode(true);\r\n    const undoPrevElement   = trackElement.previousElementSibling;\r\n\r\n    trackElement.addEventListener('animationend', () =>\r\n    {\r\n      trackElement.remove();\r\n      animationEndCallback();\r\n    });\r\n    \r\n    trackElement.classList.add('removing');\r\n\r\n    if (allowUndo)\r\n    {\r\n      showSnackbar('Track removed', 4, 'undo', () =>\r\n      {\r\n        addTrack(undoRemoveElement,\r\n                ((undoPrevElement === null) ? m.tracklist  : undoPrevElement),\r\n                ((undoPrevElement === null) ? 'afterbegin' : 'afterend'));\r\n      });\r\n    }\r\n  }\r\n}\r\n\r\nfunction addTrack(trackElement, targetElement, insertPosition)\r\n{\r\n  trackElement.classList.add('adding');\r\n  trackElement.querySelector('.track-action-buttons').style.display = '';\r\n  trackElement.addEventListener('animationend', () => trackElement.classList.remove('adding'));\r\n  targetElement.insertAdjacentElement(insertPosition, trackElement);\r\n}\r\n\r\nfunction arrowUpDownClick(targetElement, isArrowUpClick)\r\n{\r\n  const pageNumber  = parseInt(targetElement.getAttribute('data-page-number'));\r\n  const gotoPageNum = isArrowUpClick ? (pageNumber - 1) : (pageNumber + 1);\r\n  let gotoElement   = document.getElementById(`tracklist-page-${gotoPageNum}`);\r\n  let blockOption   = 'center';\r\n\r\n  if (gotoElement === null)\r\n  {\r\n    gotoElement = isArrowUpClick ? m.tracklist.firstElementChild : m.tracklist.lastElementChild;\r\n    blockOption = isArrowUpClick ? 'end' : ((window.innerWidth > 1350) ? 'nearest' : 'center');\r\n\r\n    if ((isArrowUpClick === false) && (gotoPageNum > response.maxPages))\r\n      gotoElement = gotoElement?.previousElementSibling;\r\n  }\r\n\r\n  gotoElement?.scrollIntoView({ behavior: (settings.site.smoothScrolling ? 'smooth' : 'auto'), block: blockOption });\r\n}\r\n\r\n\r\n// ************************************************************************************************\r\n//\r\n// ************************************************************************************************\r\n\r\nfunction initLoadMoreTracks()\r\n{\r\n  if (response.params.all     ||\r\n      response.params.channel ||\r\n      response.params.artist  ||\r\n      response.params.shuffle ||\r\n      response.params.search)\r\n  {\r\n    if ((response.nextPage !== null) && (response.currentPage < response.maxPages))\r\n    {\r\n      m.tracklistLoadMore = document.getElementById('tracklist-load-more');\r\n      m.tracklistLoadMore.querySelector('.load-more-title span').textContent = ` ( ${response.currentPage + 1} / ${response.maxPages} )`;\r\n      m.tracklistLoadMore.style.display = 'block';\r\n      m.tracklistLoadMore.addEventListener('click', loadMoreTracks);\r\n    }\r\n  }\r\n}\r\n\r\nexport async function loadMoreTracks()\r\n{\r\n  let tracksLoaded = false;\r\n  \r\n  if ((response.currentPage + 1) <= response.maxPages)\r\n  {\r\n    setIsLoadingTracks(true);\r\n    tracksLoaded = await loadTracks(stripAttribute(m.tracklist, 'data-term-type'), stripAttribute(m.tracklist, 'data-term-id'));\r\n    setIsLoadingTracks(false);\r\n\r\n    if (tracksLoaded)\r\n    {\r\n      response.currentPage++;\r\n      m.tracklistLoadMore.querySelector('.load-more-title span').textContent = ` ( ${response.currentPage + 1} / ${response.maxPages} )`;\r\n    }\r\n    else\r\n    {\r\n      showSnackbar('Load more tracks failed!', 10, 'Retry', () => loadMoreTracks());\r\n    }\r\n  }\r\n  \r\n  if (response.currentPage >= response.maxPages)\r\n    m.tracklistLoadMore.style.display = 'none';\r\n\r\n  return tracksLoaded;\r\n}\r\n\r\nfunction setIsLoadingTracks(isLoadingTracks)\r\n{\r\n  m.tracklistLoadMore.style.pointerEvents                              = isLoadingTracks ? 'none'  : 'unset';\r\n  m.tracklistLoadMore.querySelector('.load-more-title').style.display  = isLoadingTracks ? 'none'  : 'block';\r\n  m.tracklistLoadMore.querySelector('.load-more-loader').style.display = isLoadingTracks ? 'block' : 'none';\r\n}\r\n\r\n\r\n// ************************************************************************************************\r\n//\r\n// ************************************************************************************************\r\n\r\nfunction clearTrackState(element)\r\n{\r\n  element.classList.remove('current', STATE.LOADING.CLASS, STATE.PLAYING.CLASS, STATE.PAUSED.CLASS);\r\n}\r\n\r\nexport function setCurrentTrackState(newState)\r\n{\r\n  if (m.currentState.ID !== newState.ID)\r\n  {\r\n    m.currentState = newState;\r\n\r\n    if (newState.ID === STATE.LOADING.ID)\r\n    {\r\n      m.trackElement.classList.remove(STATE.PAUSED.CLASS, STATE.PLAYING.CLASS);\r\n      m.trackElement.classList.add(STATE.LOADING.CLASS);\r\n    }\r\n    else\r\n    {\r\n      m.trackElement.classList.remove(STATE.LOADING.CLASS);\r\n    \r\n      if (newState.ID === STATE.PLAYING.ID)\r\n        replaceClass(m.trackElement, STATE.PAUSED.CLASS, STATE.PLAYING.CLASS);\r\n      else\r\n        replaceClass(m.trackElement, STATE.PLAYING.CLASS, STATE.PAUSED.CLASS);\r\n\r\n      upNextModal.updateUpNextModal((newState.ID === STATE.PLAYING.ID) ? true : false);\r\n    }\r\n  }\r\n}\r\n\r\nfunction setPlayerAspectRatio()\r\n{\r\n  if (m.trackElement.classList.contains('is-video'))\r\n    m.playerWrapper.classList.replace('aspect-ratio-1_1', 'aspect-ratio-16_9');\r\n  else\r\n    m.playerWrapper.classList.replace('aspect-ratio-16_9', 'aspect-ratio-1_1');\r\n}\r\n\r\nexport function setNextTrackState(nextTrackId, isPointerClick)\r\n{\r\n  clearTrackState(m.trackElement);\r\n\r\n  m.trackElement = queryTrackId(nextTrackId);\r\n\r\n  if (isPointerClick === false)\r\n    m.tracklistObserver.observe(m.trackElement);\r\n\r\n  m.trackElement.classList.add('current');\r\n}\r\n\r\nexport function setTrackMessage(message)\r\n{\r\n  m.trackElement.querySelector('.track-message').textContent   = message;\r\n  m.trackElement.querySelector('.track-message').style.display = 'block';\r\n}\r\n\r\nexport function updateTrackDetails()\r\n{\r\n  const sourceUid = m.trackElement.getAttribute('data-track-source-uid');\r\n  \r\n  m.player.setArtistTitle(m.trackElement.getAttribute('data-track-artist'), m.trackElement.getAttribute('data-track-title'));\r\n  m.player.setDuration(parseInt(m.trackElement.getAttribute('data-track-duration')));\r\n  m.player.setThumbnail(sourceUid);\r\n  setPlayerAspectRatio();\r\n\r\n  return sourceUid;\r\n}\r\n", "//\r\n// Modal dialog template functions\r\n//\r\n// https://ultrafunk.com\r\n//\r\n\r\n\r\nimport { TRACK_TYPE } from '../playback/mediaplayers.js';\r\n\r\n\r\n/*************************************************************************************************/\r\n\r\n\r\nexport const config = { id: 'modal-dialog' };\r\n\r\n\r\n// ************************************************************************************************\r\n//\r\n// ************************************************************************************************\r\n\r\nexport function getTemplateHtml()\r\n{\r\n  return /*html*/ `\r\n    <div id=\"${config.id}-overlay\" tabindex=\"-1\">\r\n      <div id=\"${config.id}-container\">\r\n        <div class=\"${config.id}-header\">\r\n          <div class=\"${config.id}-title\"></div>\r\n          <div class=\"${config.id}-close-icon\"><span class=\"material-icons\" title=\"Dismiss (esc)\">close</span></div>\r\n        </div>\r\n        <div class=\"${config.id}-body\"></div>\r\n        <div class=\"${config.id}-footer\"><div class=\"modal-dialog-close-button\" title=\"Dismiss (esc)\">Close</div></div>\r\n      </div>\r\n    </div>`;\r\n}\r\n\r\nexport function getSingleChoiceListHtml(singleChoiceList)\r\n{\r\n  let html = '';\r\n\r\n  singleChoiceList.forEach((entry, index) =>\r\n  {\r\n    const entryClass   = entry.class ? `modal-${entry.class}`                                       : 'modal-icon-text';\r\n    const entryTitle   = entry.title ? entry.title                                                  : '';\r\n    const entryIcon    = entry.icon  ? `<span class=\"material-icons\">${entry.icon}</span>`          : '';\r\n    const entryContent = entry.icon  ? `<span class=\"text-nowrap-ellipsis\">${entry.content}</span>` : entry.content;\r\n    entry.uid          = `modal-item-${index + 1}`;\r\n  \r\n    if (entry.clickId)\r\n      html += `<div id=\"${entry.uid}\" data-click-id=\"${entry.clickId}\" class=\"modal-click-item ${entryClass}\" title=\"${entryTitle}\">${entryIcon}${entryContent}</div>`;\r\n    else\r\n      html += `<div class=\"${entryClass}\" title=\"${entryTitle}\">${entryIcon}${entryContent}</div>`;\r\n  });\r\n\r\n  return html;\r\n}\r\n\r\nexport function getModalTrackHtml(element, trackArtist, trackTitle)\r\n{\r\n  const trackTypeClass = (parseInt(element.getAttribute('data-track-type')) === TRACK_TYPE.YOUTUBE) ? 'type-youtube' : 'type-soundcloud';\r\n\r\n  return /*html*/ `\r\n    <div class=\"modal-track\">\r\n      <div class=\"modal-track-thumbnail ${trackTypeClass}\">\r\n        <img src=\"${encodeURI(element.getAttribute('data-track-thumbnail-url'))}\">\r\n      </div>\r\n      <div class=\"modal-track-artist-title\">\r\n        <span><b>${trackArtist}</b></span><br>\r\n        <span class=\"light-text\">${trackTitle}</span>\r\n      </div>\r\n    </div>`;\r\n}\r\n", "//\r\n// Modal dialog UI module\r\n//\r\n// https://ultrafunk.com\r\n//\r\n\r\n\r\nimport * as debugLogger from './debuglogger.js';\r\nimport { settings }     from './session-data.js';\r\n\r\nimport {\r\n  config,\r\n  getTemplateHtml,\r\n  getSingleChoiceListHtml,\r\n} from './modal-templates.js';\r\n\r\n\r\n/*************************************************************************************************/\r\n\r\n\r\nconst debug = debugLogger.newInstance('modal');\r\n\r\nconst m = {\r\n  onEntryClicked:   null,\r\n  onClickClose:     null,\r\n  modalId:          0,\r\n  isOverflowY:      false,\r\n  ignoreTouchMove:  false,\r\n  isTouchDraggable: false,\r\n};\r\n\r\nconst elements = {\r\n  overlay:   null,\r\n  container: null,\r\n  body:      null,\r\n};\r\n\r\n\r\n// ************************************************************************************************\r\n//\r\n// ************************************************************************************************\r\n\r\nexport function showModal(\r\n  modalTitle = 'Modal Title',\r\n  modalBody  = 'Modal Body',\r\n  modalType  = null,\r\n  onEntryClickedCallback = () => {},\r\n  onClickCloseCallback = () => true\r\n)\r\n{\r\n  init();\r\n  \r\n  if (Array.isArray(modalBody) && (modalBody.length > 0))\r\n    setSingleChoiceList(modalBody);\r\n  else\r\n    elements.body.innerHTML = modalBody;  \r\n\r\n  m.onEntryClicked = onEntryClickedCallback;\r\n  m.onClickClose   = onClickCloseCallback;\r\n\r\n  elements.container.classList = `modal-type-${(modalType !== null) ? modalType : 'default'}`;\r\n  elements.container.querySelector(`.${config.id}-title`).innerHTML = modalTitle;\r\n\r\n  elements.overlay.style.backgroundColor = `rgba(0, 0, 0, ${Math.round(10 * (settings.site.modalOverlayOpacity / 100)) / 10})`;\r\n  elements.overlay.classList.add('show');\r\n  elements.overlay.addEventListener('keydown', keyDown);\r\n  elements.overlay.focus();\r\n\r\n  disablePageScrolling(true);\r\n\r\n  m.modalId++;\r\n\r\n  debug.log(`showModal() - modalId: ${m.modalId} - modalType: ${(modalType !== null) ? modalType : 'default'} - modalTitle: ${modalTitle}`);\r\n\r\n  return `${config.id}-container`;\r\n}\r\n\r\nexport function isShowingModal(showingModalId = -1)\r\n{\r\n  return ((showingModalId === m.modalId) && (elements.container !== null) && (elements.overlay.classList.contains('show')));\r\n}\r\n\r\nexport function closeModal()\r\n{\r\n  document.body.removeEventListener('touchmove', touchMove, { passive: false });\r\n  document.body.removeEventListener('touchstart', touchStart);\r\n  elements.overlay.removeEventListener('keydown', keyDown);\r\n  elements.overlay.classList.replace('show', 'hide');\r\n}\r\n\r\nexport function getModalId()\r\n{\r\n  return m.modalId;\r\n}\r\n\r\nexport function getModalEntry(entryNum)\r\n{\r\n  return document.getElementById(`modal-item-${entryNum}`);\r\n}\r\n\r\nexport function updateModalTitle(updateModalId, updateTitle)\r\n{\r\n  if (updateModalId === m.modalId)\r\n    elements.container.querySelector(`.${config.id}-title`).innerHTML = updateTitle;\r\n}\r\n\r\nexport function updateModalBody(updateModalId, updateSingleChoiceList)\r\n{\r\n  if (updateModalId === m.modalId)\r\n    setSingleChoiceList(updateSingleChoiceList);\r\n}\r\n\r\n\r\n// ************************************************************************************************\r\n//\r\n// ************************************************************************************************\r\n\r\nfunction init()\r\n{\r\n  if (elements.container === null)\r\n  {\r\n    document.body.insertAdjacentHTML('beforeend', getTemplateHtml());\r\n    \r\n    elements.overlay   = document.getElementById(`${config.id}-overlay`);\r\n    elements.container = document.getElementById(`${config.id}-container`);\r\n    elements.body      = elements.overlay.querySelector(`.${config.id}-body`);\r\n\r\n    elements.overlay.addEventListener('click', (event) =>\r\n    {\r\n      if (event.target === elements.overlay)\r\n        closeModal();\r\n    });\r\n\r\n    elements.overlay.addEventListener('animationend', () =>\r\n    {\r\n      if (elements.overlay.classList.contains('hide'))\r\n      {\r\n        elements.overlay.className = '';\r\n        disablePageScrolling(false);\r\n      }\r\n    });\r\n\r\n    elements.overlay.querySelector(`.${config.id}-close-icon`).addEventListener('click', closeModal);\r\n    elements.overlay.querySelector(`.${config.id}-close-button`).addEventListener('click', closeModal);\r\n  }\r\n}\r\n\r\nfunction setSingleChoiceList(singleChoiceList)\r\n{\r\n  elements.body.innerHTML = getSingleChoiceListHtml(singleChoiceList);\r\n  \r\n  singleChoiceList.forEach(entry =>\r\n  {\r\n    if (entry.clickId)\r\n      elements.body.querySelector(`#${entry.uid}`).addEventListener('click', singleChoiceListClick);\r\n  });\r\n}\r\n\r\nfunction singleChoiceListClick(event)\r\n{\r\n  if (m.onClickClose(event) === true)\r\n  {\r\n    closeModal();\r\n    setTimeout(() => m.onEntryClicked(this.getAttribute('data-click-id'), event), 150);\r\n  }\r\n}\r\n\r\nfunction keyDown(event)\r\n{\r\n  event.stopPropagation();\r\n\r\n  if (event.key === 'Escape')\r\n    closeModal();\r\n}\r\n\r\nfunction disablePageScrolling(disableScrolling)\r\n{\r\n  const scrollbarWidth = window.innerWidth - document.documentElement.clientWidth;\r\n  \r\n  document.documentElement.style.overflowY                  = disableScrolling ? 'hidden'              : '';\r\n  document.documentElement.style.paddingRight               = disableScrolling ? `${scrollbarWidth}px` : '';\r\n  document.getElementById('site-header').style.paddingRight = disableScrolling ? `${scrollbarWidth}px` : '';\r\n\r\n  if (disableScrolling && ('ontouchstart' in window))\r\n  {\r\n    document.body.addEventListener('touchstart', touchStart);\r\n    document.body.addEventListener('touchmove',  touchMove, { passive: false });\r\n  }\r\n}\r\n\r\nfunction touchStart(event)\r\n{\r\n  m.isOverflowY      = (elements.container.scrollHeight > elements.container.clientHeight);\r\n  m.ignoreTouchMove  = (true   === event.target.classList.contains('modal-ignore-touchmove'));\r\n  m.isTouchDraggable = ('true' === event.target.closest('.modal-draggable-entry')?.getAttribute('draggable'));\r\n}\r\n\r\nfunction touchMove(event)\r\n{\r\n  if (m.isOverflowY)\r\n    return;\r\n\r\n  if ((m.isTouchDraggable === false) || m.ignoreTouchMove)\r\n    event.preventDefault();\r\n}\r\n", "//\r\n// List-player Up Next modal module\r\n//\r\n// https://ultrafunk.com\r\n//\r\n\r\n\r\nimport * as debugLogger from '../../shared/debuglogger.js';\r\nimport { autoplay }     from '../footer-toggles.js';\r\nimport { settings }     from '../../shared/session-data.js';\r\nimport { isPlaying }    from '../playback-controls.js';\r\nimport { TRACK_TYPE }   from '../mediaplayers.js';\r\nimport { showSnackbar } from '../../shared/snackbar.js';\r\n\r\nimport {\r\n  addListener,\r\n  escAttribute,\r\n  getTimeString,\r\n} from '../../shared/utils.js';\r\n\r\nimport {\r\n  queryTrackId,\r\n  getNextPlayableId,\r\n  getCurrentTrackElement,\r\n} from './list-controls.js';\r\n\r\nimport {\r\n  showModal,\r\n  isShowingModal,\r\n  getModalId,\r\n  getModalEntry,\r\n  updateModalTitle,\r\n  updateModalBody,\r\n} from '../../shared/modal.js';\r\n\r\n\r\n/*************************************************************************************************/\r\n\r\n\r\nconst debug = debugLogger.newInstance('up-next-modal');\r\n\r\nconst m = {\r\n  setCurrentTrack: null,\r\n  modalDialogId:   null,\r\n  upNextModalId:   0,\r\n  dragStartY:      0,\r\n  dragEntryId:     null,\r\n};\r\n\r\n\r\n// ************************************************************************************************\r\n//\r\n// ************************************************************************************************\r\n\r\nexport function init(setCurrentTrackCallback)\r\n{\r\n  m.setCurrentTrack = setCurrentTrackCallback;\r\n}\r\n\r\nfunction loadDragDropTouch()\r\n{\r\n  if (('ontouchstart' in window) && (document.getElementById('drag-drop-touch') === null))\r\n  {\r\n    debug.log('Loading drag-drop-touch.js...');\r\n\r\n    const tag = document.createElement('script');\r\n    tag.type  = 'text/javascript';\r\n    tag.id    = 'drag-drop-touch';\r\n    tag.src   = debug.isDebug()\r\n                  ? 'https://wordpress.ultrafunk.com/wp-content/themes/ultrafunk/inc/js/drag-drop-touch.js?ver=1.44.13'\r\n                  : 'https://ultrafunk.com/wp-content/themes/ultrafunk/inc/js/drag-drop-touch.min.js?ver=1.44.13';\r\n    const firstScriptTag = document.getElementsByTagName('script')[0];\r\n    firstScriptTag.parentNode.insertBefore(tag, firstScriptTag);\r\n  }\r\n}\r\n\r\n\r\n// ************************************************************************************************\r\n//\r\n// ************************************************************************************************\r\n\r\nexport function showUpNextModal()\r\n{\r\n  // Only load this dependency IF we actually need it...\r\n  loadDragDropTouch();\r\n\r\n  const modalEntries = getEntries(isPlaying());\r\n\r\n  if (modalEntries.length > 2)\r\n  {\r\n    m.modalDialogId = showModal(getTitle(isPlaying()), modalEntries, 'tracklist', (clickedId) =>\r\n    {\r\n      const nextTrackId = modalEntries.find(item => (item.clickId === clickedId)).clickId;\r\n\r\n      if ((nextTrackId === getCurrentTrackElement().id) && isPlaying())\r\n        getCurrentTrackElement().scrollIntoView({ behavior: (settings.site.smoothScrolling ? 'smooth' : 'auto'), block: 'center' });\r\n      else\r\n        m.setCurrentTrack(nextTrackId, true, false);\r\n    },\r\n    (event) => \r\n    {\r\n      if (event.target.closest('#modal-item-1'))\r\n        return true;\r\n      else if (event.target.classList.contains('modal-track-thumbnail'))\r\n        return true;\r\n\r\n      return false;\r\n    });\r\n\r\n    m.upNextModalId = getModalId();\r\n\r\n    addTitleListener();\r\n    addDragDropListeners();\r\n  }\r\n  else\r\n  {\r\n    showSnackbar('No more tracks to play!', 5);\r\n  }\r\n}\r\n\r\nexport function updateUpNextModal(isPlayingTrack)\r\n{\r\n  if (isShowingModal(m.upNextModalId))\r\n  {\r\n    updateModalTitle(m.upNextModalId, getTitle(isPlayingTrack));\r\n    addTitleListener();\r\n  \r\n    const modalEntry = getModalEntry(1);\r\n  \r\n    if (modalEntry.getAttribute('data-click-id') === getCurrentTrackElement().id)\r\n    {\r\n      modalEntry.classList.remove('playing-track', 'cued-track');\r\n      modalEntry.classList.add(`${isPlayingTrack ? 'playing-track' : 'cued-track'}`);\r\n      modalEntry.title = `${isPlayingTrack ? 'Go To Track' : 'Play Track'}`;\r\n    }\r\n    else\r\n    {\r\n      updateModalBody(m.upNextModalId, getEntries(isPlayingTrack));\r\n      addDragDropListeners();\r\n    }\r\n  }\r\n}\r\n\r\nfunction getTitle(isPlayingTrack)\r\n{\r\n  return /*html*/ `${isPlayingTrack ? 'Playing' : 'Cued'}\r\n            <span class=\"light-text lowercase-text toggle-element\" title=\"Toggle Autoplay\">\r\n            Autoplay is <b>${settings.playback.autoplay ? 'On' : 'Off'}</b></span>`;\r\n}\r\n\r\nfunction getEntries(isPlayingTrack)\r\n{\r\n  const modalEntries = [];\r\n  let trackElement   = getCurrentTrackElement();\r\n\r\n  modalEntries.push({\r\n    clickId: trackElement.id,\r\n    class:   `tracklist-entry ${isPlayingTrack ? 'playing-track' : 'cued-track'}`,\r\n    title:   `${isPlayingTrack ? 'Go To Track' : 'Play Track'}`,\r\n    content: getUpNextTrackHtml(trackElement, 'data-track-artist', 'data-track-title'),\r\n  });\r\n\r\n  modalEntries.push({ class: 'header-entry', content: 'Up Next' });\r\n\r\n  for (let i = 0; i < 10; i++)\r\n  {\r\n    trackElement = queryTrackId(getNextPlayableId(trackElement));\r\n\r\n    if (trackElement === null)\r\n      break;\r\n\r\n    modalEntries.push({\r\n      clickId: trackElement.id,\r\n      class:   'tracklist-entry',\r\n      content: getUpNextTrackHtml(trackElement, 'data-track-artist', 'data-track-title', true),\r\n    });\r\n  }\r\n\r\n  return modalEntries;\r\n}\r\n\r\nfunction addTitleListener()\r\n{\r\n  addListener(`#${m.modalDialogId} .modal-dialog-title span`, 'click', (event) => \r\n  {\r\n    autoplay.toggle();\r\n    event.target.closest('span').innerHTML = `Autoplay is <b>${settings.playback.autoplay ? 'On' : 'Off'}</b>`;\r\n  });\r\n}\r\n\r\n\r\n// ************************************************************************************************\r\n//\r\n// ************************************************************************************************\r\n\r\nfunction addDragDropListeners()\r\n{\r\n  document.querySelectorAll('.modal-tracklist-entry')?.forEach((element) =>\r\n  {\r\n    if (element.id !== 'modal-item-1')\r\n    {\r\n      element.addEventListener('mousedown', mouseDown);\r\n      element.addEventListener('dragstart', dragStart);\r\n      element.addEventListener('dragover',  dragOver);\r\n      element.addEventListener('drop',      dragDrop);\r\n    }\r\n  });\r\n}\r\n\r\n// Disable drag & drop for track play button (modal-track-thumbnail)\r\nfunction mouseDown(event)\r\n{\r\n  if (event.target.classList.contains('modal-track-thumbnail'))\r\n    event.preventDefault();\r\n}\r\n\r\nfunction dragStart(event)\r\n{\r\n  m.dragStartY  = event.clientY;\r\n  m.dragEntryId = event.target.closest('div.modal-tracklist-entry').id;\r\n  event.dataTransfer.effectAllowed = 'move';\r\n}\r\n\r\nfunction dragOver(event)\r\n{\r\n  event.preventDefault();\r\n  event.dataTransfer.dropEffect = 'move';\r\n  return false;\r\n}\r\n\r\nfunction dragDrop(event)\r\n{\r\n  event.preventDefault();\r\n\r\n  const insertPos = (event.clientY  > m.dragStartY) ? 'afterend' : 'beforebegin';\r\n  \r\n  // Modal tracks drag & drop reorder\r\n  const modalDragSource = document.getElementById(m.dragEntryId);\r\n  const modalDropTarget = event.target.closest('div.modal-tracklist-entry');\r\n  modalDropTarget.insertAdjacentElement(insertPos, modalDragSource);\r\n\r\n  // List player tracks drag & drop reorder = sync track lists\r\n  const listTrackSource = document.getElementById(modalDragSource.getAttribute('data-click-id'));\r\n  const listTrackTarget = document.getElementById(modalDropTarget.getAttribute('data-click-id'));\r\n  listTrackTarget.insertAdjacentElement(insertPos, listTrackSource);\r\n\r\n  return false;\r\n}\r\n\r\n\r\n// ************************************************************************************************\r\n//\r\n// ************************************************************************************************\r\n\r\nfunction getUpNextTrackHtml(element, trackArtistAttr, trackTitleAttr, isDraggable = false)\r\n{\r\n  const trackTypeClass = (parseInt(element.getAttribute('data-track-type')) === TRACK_TYPE.YOUTUBE) ? 'type-youtube' : 'type-soundcloud';\r\n\r\n  return /*html*/ `\r\n    <div class=\"modal-track ${isDraggable ? 'modal-draggable-entry' : ''}\" ${isDraggable ? 'draggable=\"true\"' : ''}>\r\n      <div class=\"modal-track-thumbnail modal-ignore-touchmove ${trackTypeClass}\" ${isDraggable ? 'title=\"Click to Play Track\"' : ''}>\r\n        <img src=\"${encodeURI(element.getAttribute('data-track-thumbnail-url'))}\">\r\n      </div>\r\n      <div class=\"modal-track-artist-title text-nowrap-ellipsis\" ${isDraggable ? 'title=\"Drag to Move Track\"' : ''}>\r\n        <span><b>${escAttribute(element, trackArtistAttr)}</b></span><br>\r\n        <span class=\"light-text\">${escAttribute(element, trackTitleAttr)}</span>\r\n      </div>\r\n      <div class=\"modal-track-duration text-nowrap-ellipsis\" ${isDraggable ? 'title=\"Drag to Move Track\"' : ''}>\r\n        ${getTimeString(parseInt(element.getAttribute('data-track-duration')))}\r\n      </div>\r\n      ${isDraggable ? getModalTrackButtons() : ''}\r\n    </div>`;\r\n}\r\n\r\nfunction getModalTrackButtons()\r\n{\r\n  return /*html*/ `\r\n    <div class=\"modal-track-buttons\">\r\n      <div class=\"drag-drop-button\" title=\"Drag to Move Track\"><span class=\"material-icons\">drag_handle</span></div>\r\n    </div>`;\r\n}\r\n", "//\r\n// Shared gallery and list-player functionality\r\n//\r\n// https://ultrafunk.com\r\n//\r\n\r\n\r\nimport * as debugLogger       from '../shared/debuglogger.js';\r\nimport { KEY, setCookie }     from '../shared/storage.js';\r\nimport { showUpNextModal }    from './list/up-next-modal.js';\r\nimport { response, settings } from '../shared/session-data.js';\r\n\r\nimport {\r\n  getCssPropValue,\r\n  getPrefPlayerUrl,\r\n  navToUrl,\r\n} from '../shared/utils.js';\r\n\r\n\r\n/*************************************************************************************************/\r\n\r\n\r\nconst debug = debugLogger.newInstance('shared-gallery-list');\r\n\r\nexport const PLAYER_TYPE = {\r\n  NONE:    0,\r\n  GALLERY: 1,\r\n  LIST:    2,\r\n};\r\n\r\nconst isPlayer = {\r\n  gallery: false,\r\n  list:    false,\r\n};\r\n\r\n\r\n// ************************************************************************************************\r\n//\r\n// ************************************************************************************************\r\n\r\nexport function hasGalleryPlayer()\r\n{\r\n  isPlayer.gallery = (document.body.getAttribute('data-player-type') === 'gallery');\r\n  return isPlayer.gallery;\r\n}\r\n\r\nexport function hasListPlayer()\r\n{\r\n  isPlayer.list = (document.body.getAttribute('data-player-type') === 'list');\r\n  return isPlayer.list;\r\n}\r\n\r\nexport function noPlayback()\r\n{\r\n  return ((isPlayer.gallery === false) && (isPlayer.list === false));\r\n}\r\n\r\nexport function isGalleryPlayer() { return isPlayer.gallery; }\r\nexport function isListPlayer()    { return isPlayer.list;    }\r\n\r\nexport function shuffleClickNavTo(event)\r\n{\r\n  event?.preventDefault();\r\n  setCookie(KEY.UF_RESHUFFLE, 'true');\r\n  navToUrl(getPrefPlayerUrl(response.shufflePath));\r\n}\r\n\r\nexport function autoplayNavTo(destUrl, continueAutoplay = false)\r\n{\r\n  debug.log(`autoplayNavTo(): ${destUrl} - continueAutoplay: ${continueAutoplay}`);\r\n  \r\n  if (destUrl)\r\n  {\r\n    sessionStorage.setItem(KEY.UF_AUTOPLAY, JSON.stringify({ autoplay: continueAutoplay, trackId: null, position: 0 }));\r\n    navToUrl(destUrl);\r\n  }\r\n}\r\n\r\n\r\n// ************************************************************************************************\r\n//\r\n// ************************************************************************************************\r\n\r\nexport function playerScrollTo(trackId = 0)\r\n{\r\n  isListPlayer() ? listPlayerScrollTo(trackId) : galleryPlayerScrollTo(trackId);\r\n}\r\n\r\nfunction scrollToYPos(element, destYPos)\r\n{\r\n  element.scroll(\r\n  {\r\n    top:      destYPos,\r\n    left:     0,\r\n    behavior: (settings.site.smoothScrolling ? 'smooth' : 'auto'),\r\n  });\r\n}\r\n\r\n\r\n// ************************************************************************************************\r\n//\r\n// ************************************************************************************************\r\n\r\nfunction listPlayerScrollTo(trackId = 0)\r\n{\r\n  if (trackId === 0)\r\n  {\r\n    let scrollDestPos = 0;\r\n\r\n    if ((window.pageYOffset === 0) || (Math.round(window.pageYOffset) <= 1))\r\n      scrollDestPos = getCssPropValue('--site-header-height') - getCssPropValue('--site-header-height-down');\r\n  \r\n    scrollToYPos(window, scrollDestPos);\r\n  }\r\n  else\r\n  {\r\n    if (settings.list.showUpNextModal)\r\n    {\r\n      showUpNextModal();\r\n    }\r\n    else\r\n    {\r\n      const trackElement = document.getElementById('tracklist').querySelector(`[data-track-id=\"${trackId}\"]`);\r\n      trackElement.scrollIntoView({ behavior: (settings.site.smoothScrolling ? 'smooth' : 'auto'), block: 'center' });\r\n    }\r\n  }\r\n}\r\n\r\nfunction galleryPlayerScrollTo(trackId)\r\n{\r\n  if (settings.gallery.autoScroll)\r\n  {\r\n    // Actual functional 'offsetTop' calculation: https://stackoverflow.com/a/52477551\r\n    const offsetTop    = Math.round(window.scrollY + document.getElementById(trackId).getBoundingClientRect().top);\r\n    const scrollTop    = Math.round(window.pageYOffset); // Don't want float results that can cause jitter\r\n    let   headerHeight = getScrollHeaderHeight(offsetTop > scrollTop);\r\n\r\n    // If we get obscured by the sticky header menu, recalculate headerHeight to account for that\r\n    if ((scrollTop + headerHeight + getContentMarginTop()) > offsetTop)\r\n      headerHeight = getScrollHeaderHeight(false);\r\n\r\n    scrollToYPos(window, (offsetTop - (headerHeight + getContentMarginTop())));\r\n  }\r\n\r\n  function getScrollHeaderHeight(isScrollDown)\r\n  {\r\n    return (isScrollDown\r\n             ? getCssPropValue('--site-header-height-down')\r\n             : getCssPropValue('--site-header-height-up'));\r\n  }\r\n  \r\n  function getContentMarginTop()\r\n  {\r\n    // -1 because of fractional pixels on HiDPI displays (iframe bottom 1 px would show on top)\r\n    return (getCssPropValue('--site-content-margin-top', document.body) - 1);\r\n  }\r\n}\r\n\r\n\r\n// ************************************************************************************************\r\n//\r\n// ************************************************************************************************\r\n\r\nexport function playerOnKeyScroll(event)\r\n{\r\n  if (isListPlayer() && (event.shiftKey === true) && (window.innerWidth > 1350))\r\n  {\r\n    const tracklist = document.getElementById('tracklist');\r\n\r\n    event.preventDefault();\r\n\r\n    if ((event.key === 'PageUp') || (event.key === 'PageDown'))\r\n    {\r\n      const scrollByPx = tracklist.offsetHeight - ((tracklist.offsetHeight * 10)  / 100);\r\n\r\n      tracklist.scrollBy(\r\n      {\r\n        top:      (event.key === 'PageUp') ? -scrollByPx : scrollByPx,\r\n        left:     0,\r\n        behavior: (settings.site.smoothScrolling ? 'smooth' : 'auto'),\r\n      });\r\n    }\r\n    else if ((event.key === 'Home') || (event.key === 'End'))\r\n    {\r\n      scrollToYPos(tracklist, ((event.key === 'Home') ? 0 : tracklist.scrollHeight));\r\n    }\r\n  }\r\n}\r\n", "//\r\n// Interaction footer toggle controls\r\n//\r\n// https://ultrafunk.com\r\n//\r\n\r\n\r\nimport ElementToggle          from '../shared/element-toggle.js';\r\nimport { showSnackbar }       from '../shared/snackbar.js';\r\nimport { response, settings } from '../shared/session-data.js';\r\n\r\nimport {\r\n  replaceClass,\r\n  getPrefPlayerUrl,\r\n  navToUrl,\r\n} from '../shared/utils.js';\r\n\r\nimport {\r\n  PLAYER_TYPE,\r\n  isListPlayer,\r\n} from './shared-gallery-list.js';\r\n\r\nimport {\r\n  KEY,\r\n  YEAR_IN_SECONDS,\r\n  setCookie,\r\n} from '../shared/storage.js';\r\n\r\n\r\n/*************************************************************************************************/\r\n\r\n\r\nexport let playerType = null;\r\nexport let crossfade  = null;\r\nexport let autoplay   = null;\r\n\r\n\r\n// ************************************************************************************************\r\n//\r\n// ************************************************************************************************\r\n\r\nexport function init(getPlayerStatus)\r\n{\r\n  playerType = new PlayerTypeToggle('footer-player-type-toggle', getPlayerStatus);\r\n\r\n  // Init crossfade before autoplay because autoplay can disable crossfade in update()\r\n  crossfade = new CrossfadeToggle('footer-crossfade-toggle');\r\n  autoplay  = new AutoplayToggle('footer-autoplay-toggle');\r\n}\r\n\r\n\r\n// ************************************************************************************************\r\n// Footer player type toggle: Gallery or List\r\n// ************************************************************************************************\r\n\r\nclass PlayerTypeToggle extends ElementToggle\r\n{\r\n  constructor(elementId, getPlayerStatus)\r\n  {\r\n    super(elementId);\r\n    this.getPlayerStatus = getPlayerStatus;\r\n  }\r\n  \r\n  toggle()\r\n  {\r\n    const isPagedRegEx = /\\/page\\/(?!0)\\d{1,6}/;\r\n    const destData     = this.getDestData();\r\n    const sourceUrl    = window.location.href;\r\n    let destUrl        = null;\r\n  \r\n    // Add destination pagination or remove pagination if needed\r\n    if ((destData.pageNum > 1) && (sourceUrl.match(isPagedRegEx) !== null))\r\n    {\r\n      destUrl = sourceUrl.replace(isPagedRegEx, `/page/${destData.pageNum}`);\r\n    }\r\n    else if (destData.pageNum > 1)\r\n    {\r\n      const url = new URL(decodeURIComponent(sourceUrl));\r\n      destUrl   = `${url.origin}${url.pathname}page/${destData.pageNum}/${url.search}`;\r\n    }\r\n    else\r\n    {\r\n      destUrl = sourceUrl.replace(isPagedRegEx, '');\r\n    }\r\n\r\n    settings.playback.preferredPlayer = isListPlayer() ? PLAYER_TYPE.GALLERY : PLAYER_TYPE.LIST;\r\n    setCookie(KEY.UF_PREFERRED_PLAYER, `${isListPlayer() ? PLAYER_TYPE.GALLERY : PLAYER_TYPE.LIST}`, (YEAR_IN_SECONDS * 5));\r\n    sessionStorage.setItem(KEY.UF_AUTOPLAY, JSON.stringify(destData.trackData));\r\n\r\n    navToUrl(getPrefPlayerUrl(destUrl));\r\n  }\r\n\r\n  update()\r\n  {\r\n    this.value = (settings.playback.preferredPlayer === PLAYER_TYPE.LIST) ? 'List' : 'Gallery';\r\n  }\r\n  \r\n  getDestData()\r\n  {\r\n    const urlParts          = window.location.href.split('/');\r\n    const pageIndex         = urlParts.findIndex(part => (part.toLowerCase() === 'page'));\r\n    const currentPage       = (pageIndex !== -1)\r\n                                ? parseInt(urlParts[pageIndex + 1])\r\n                                : 1;\r\n    const trackData         = this.getPlayerStatus();\r\n    const tracksPerPageFrom = isListPlayer() ? response.listPerPage    : response.galleryPerPage;\r\n    const tracksPerPageTo   = isListPlayer() ? response.galleryPerPage : response.listPerPage;\r\n    const trackOffset       = trackData.currentTrack + ((currentPage - 1) * tracksPerPageFrom);\r\n  \r\n    return {\r\n      pageNum: Math.ceil(trackOffset / tracksPerPageTo),\r\n      trackData: {\r\n        autoplay: trackData?.isPlaying,\r\n        trackId:  trackData?.trackId,\r\n        position: trackData?.position,\r\n      }\r\n    };\r\n  }\r\n}\r\n\r\n\r\n// ************************************************************************************************\r\n// Footer autoplay and crossfade toggles\r\n// ************************************************************************************************\r\n\r\nclass AutoplayToggle extends ElementToggle\r\n{\r\n  toggle()\r\n  {\r\n    settings.playback.autoplay = (settings.playback.autoplay === true) ? false : true;\r\n    \r\n    showSnackbar(settings.playback.autoplay\r\n      ? 'Autoplay enabled (<b>Shift</b> + <b>A</b> to disable)'\r\n      : 'Autoplay disabled (<b>Shift</b> + <b>A</b> to enable)', 5);\r\n  }\r\n\r\n  update()\r\n  {\r\n    this.value = settings.playback.autoplay ? 'ON' : 'OFF';\r\n    \r\n    settings.playback.autoplay\r\n      ? replaceClass(document.body, 'autoplay-off', 'autoplay-on')\r\n      : replaceClass(document.body, 'autoplay-on', 'autoplay-off');\r\n    \r\n    settings.playback.autoplay\r\n      ? crossfade?.classList.remove('disabled')\r\n      : crossfade?.classList.add('disabled');\r\n  }\r\n}\r\n\r\nclass CrossfadeToggle extends ElementToggle\r\n{\r\n  toggle()\r\n  {\r\n    settings.gallery.autoCrossfade = (settings.gallery.autoCrossfade === true) ? false : true;\r\n    \r\n    showSnackbar(settings.gallery.autoCrossfade\r\n      ? 'Auto Crossfade enabled (<b>x</b> to disable)'\r\n      : 'Auto Crossfade disabled (<b>x</b> to enable)', 5);\r\n  }\r\n\r\n  update()\r\n  {\r\n    this.value = settings.gallery.autoCrossfade ? 'ON' : 'OFF';\r\n  }\r\n}\r\n"],
  "mappings": "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",
  "names": []
}
