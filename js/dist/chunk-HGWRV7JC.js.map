{
  "version": 3,
  "sources": ["../src/config.js", "../src/shared/debuglogger.js", "../src/settings/settings.js", "../src/settings/validate-settings.js", "../src/shared/storage.js", "../src/shared/session-data.js", "../src/playback/common/mediaplayer.js", "../src/shared/utils.js", "../src/shared/modal-templates.js", "../src/shared/modal.js", "../src/shared/snackbar.js", "../src/shared/element-toggle.js", "../src/playback/list/list-playback.js", "../src/shared/element-click.js", "../src/playback/common/element-wrappers.js", "../src/shared/fetch-rest.js", "../src/playback/list/list-track-templates.js", "../src/playback/list/list-tracks-rest.js", "../src/shared/clipboard.js", "../src/shared/share-modal.js", "../src/playback/list/track-search.js", "../src/site/nav-search.js", "../src/playback/common/track-modals.js", "../src/playback/list/list-controls.js", "../src/playback/common/playback-timer.js", "../src/playback/list/list-playback-timer.js", "../src/playback/list/local-tracks.js", "../src/playback/gallery/crossfade.js", "../src/playback/list/list-players.js", "../src/playback/common/eventlogger.js", "../src/playback/list/embedded-players.js", "../src/playback/list/up-next-modal.js", "../src/playback/common/shared-gallery-list.js", "../src/site/footer-toggles.js", "../src/playback/common/playback-controls.js", "../src/playback/common/playback-events.js", "../src/playback/gallery/single-track-fetch.js"],
  "sourcesContent": ["//\r\n// Ultrafunk theme JavaScript configuration\r\n//\r\n// https://ultrafunk.com\r\n//\r\n\r\n\r\n\r\n// Automatically updated on 'npm run build-dev' or 'npm run build-prod'\r\nexport const IS_PROD_BUILD = true;\r\nexport const IS_DEBUG      = false;\r\n\r\n\r\n\r\n/**************************************************************************************************************************/\r\n\r\n\r\nexport const VERSION = '1.48.16';\r\n\r\nexport const ULTRAFUNK_THEME_URI = IS_PROD_BUILD\r\n                                     ? 'https://ultrafunk.com/wp-content/themes/ultrafunk'\r\n                                     : 'https://wordpress.ultrafunk.com/wp-content/themes/ultrafunk';\r\n\r\nexport const THEME_ENV = {\r\n  'siteUrl':                            IS_PROD_BUILD ? 'https://ultrafunk.com' : 'https://wordpress.ultrafunk.com',\r\n  'channelVideosId':                    IS_PROD_BUILD ?  899 :  875,\r\n  'searchArtistTitleId':                IS_PROD_BUILD ? 4751 : 4122,\r\n  'searchArtistTitleArtistsId':         IS_PROD_BUILD ? 4764 : 4134,\r\n  'searchArtistTitleChannelsId':        IS_PROD_BUILD ? 5127 : 4185,\r\n  'searchArtistTitleArtistsChannelsId': IS_PROD_BUILD ? 5128 : 4186,\r\n  'defaultTrackThumbnail':              ULTRAFUNK_THEME_URI + '/inc/img/photo_filled_grey.png',\r\n  'defaultYTThumbnail':                 ULTRAFUNK_THEME_URI + '/inc/img/yt_thumbnail_placeholder.png',\r\n  'defaultSCThumbnail':                 ULTRAFUNK_THEME_URI + '/inc/img/sc_thumbnail_placeholder.png',\r\n  'defaultLTThumbnail':                 ULTRAFUNK_THEME_URI + '/inc/img/lt_thumbnail_placeholder.png',\r\n  'defaultLTImagePlaceholder':          ULTRAFUNK_THEME_URI + '/inc/img/lt_image_placeholder.png',\r\n};\r\n", "//\r\n// Debug logging helper classes & functions\r\n//\r\n// https://ultrafunk.com\r\n//\r\n\r\n\r\nimport {\r\n  IS_DEBUG,\r\n  THEME_ENV,\r\n} from '../config.js';\r\n\r\n\r\n// ************************************************************************************************\r\n// DebugLog parent and child classes\r\n// ************************************************************************************************\r\n\r\nexport function newDebugLogger(moduleName)\r\n{\r\n  return (IS_DEBUG ? new DevBuild(moduleName) : new ProdBuild(moduleName));\r\n}\r\n\r\nclass DebugLog\r\n{\r\n  constructor(moduleName = 'unknown')\r\n  {\r\n    this.moduleName = (moduleName.length > 20)\r\n      ? moduleName.slice(0, 20).toUpperCase()\r\n      : moduleName.padEnd(20, '.').toUpperCase();\r\n  }\r\n\r\n  warn(data)  { console.warn(`${this.moduleName}:`,  data); }\r\n  error(data) { console.error(`${this.moduleName}:`, data); }\r\n}\r\n\r\nclass DevBuild extends DebugLog\r\n{\r\n  log(data)\r\n  {\r\n    console.log(`${this.moduleName}:`, data);\r\n  }\r\n\r\n  getKeyForValue(object, value)\r\n  {\r\n    return Object.keys(object).find(key => (object[key] === value));\r\n  }\r\n}\r\n\r\nclass ProdBuild extends DebugLog\r\n{\r\n  log() {}\r\n  getKeyForValue() {}\r\n}\r\n\r\n\r\n// ************************************************************************************************\r\n// Measure JavaScript startup execution time\r\n// ************************************************************************************************\r\n\r\nlet executionStart = 0;\r\nlet executionStop  = 0;\r\n\r\nexport function measureStartupExecutionTime()\r\n{\r\n  executionStart = performance.now();\r\n}\r\n\r\nexport const logCss = `\r\n  background-color: rgb(30, 60, 120);\r\n  padding: 2px 5px`;\r\n\r\nexport function logStartupExecutionTime()\r\n{\r\n  executionStop = performance.now();\r\n  console.log(`%cJavaScript startup execution time: ${(Math.round((executionStop - executionStart) * 100) / 100)} ms. for ${THEME_ENV.siteUrl}`, logCss);\r\n}\r\n", "//\r\n// Schemas and default objects for settings data\r\n//\r\n// https://ultrafunk.com\r\n//\r\n\r\n\r\nconst INTEGER = 1;\r\nconst BOOLEAN = 2;\r\nconst STRING  = 3;\r\n\r\nexport {\r\n  INTEGER as TYPE_INTEGER,\r\n  BOOLEAN as TYPE_BOOLEAN,\r\n  STRING  as TYPE_STRING,\r\n};\r\n\r\nexport const PREF_PLAYER = {\r\n  NONE:    0,\r\n  GALLERY: 1,\r\n  LIST:    2,\r\n};\r\n\r\n\r\n// ************************************************************************************************\r\n// Ultrafunk (user) settings: Playback, List, Gallery, Mobile and Site (+ Experimental)\r\n// Other Ultrafunk settings:  Internal\r\n// ************************************************************************************************\r\n\r\nconst masterVolumeValues         = [ 5,    10,    15,    20,    25,    30,    35,    40,    45,    50,    55,    60,    65,    70,    75,    80,    85,    90,    95,    100  ];\r\nconst masterVolumeValueStrings   = ['5%', '10%', '15%', '20%', '25%', '30%', '35%', '40%', '45%', '50%', '55%', '60%', '65%', '70%', '75%', '80%', '85%', '90%', '95%', '100%'];\r\n\r\nconst listPerPageValues          = [ 10,   15,   20,   25,   30,   35,   40,   45,   50 ];\r\nconst listPerPageValueStrings    = ['10', '15', '20', '25', '30', '35', '40', '45', '50'];\r\n\r\nconst galleryPerPageValues       = [ 4,   6,   8,   10,   12,   14,   16,   18,   20,   22,   24 ];\r\nconst galleryPerPageValueStrings = ['4', '6', '8', '10', '12', '14', '16', '18', '20', '22', '24'];\r\n\r\nexport const settingsSchema = {\r\n  version: { description: '', type: INTEGER, values: [1, 999999], default: 39, valueStrings: [] },\r\n  playback: {\r\n    preferredPlayer:      { description: 'Preferred Player',                type: INTEGER, values: [1, 2],               default: 2,     valueStrings: ['Gallery', 'List'] },\r\n    keyboardShortcuts:    { description: 'Keyboard Shortcuts',              type: BOOLEAN, values: [true, false],        default: true,  valueStrings: ['ON', 'OFF'] },\r\n    masterVolume:         { description: 'Master Volume',                   type: INTEGER, values: masterVolumeValues,   default: 100,   valueStrings: masterVolumeValueStrings },\r\n    masterMute:           { description: 'Master Mute',                     type: BOOLEAN, values: [true, false],        default: false, valueStrings: ['ON', 'OFF'] },\r\n    pauseOnPlayerChange:  { description: 'Pause others on player change',   type: BOOLEAN, values: [true, false],        default: true,  valueStrings: ['ON', 'OFF'] },\r\n    autoplay:             { description: 'Autoplay next track',             type: BOOLEAN, values: [true, false],        default: true,  valueStrings: ['ON', 'OFF'] },\r\n    autoExitFullscreen:   { description: 'Exit Fullscreen on next track',   type: BOOLEAN, values: [true, false],        default: true,  valueStrings: ['ON', 'OFF'] },\r\n    timeRemainingWarning: { description: 'Track Time Remaining Warning',    type: BOOLEAN, values: [true, false],        default: true,  valueStrings: ['ON', 'OFF'] },\r\n    timeRemainingSeconds: { description: 'Time Remaining Warning Seconds',  type: INTEGER, values: [30, 60, 90, 120],    default: 60,    valueStrings: ['30 sec', '60 sec', '90 sec', '120 sec'] },\r\n    autoExitFsOnWarning:  { description: 'Exit Fullscreen on Time Warning', type: BOOLEAN, values: [true, false],        default: true,  valueStrings: ['ON', 'OFF'] },\r\n  },\r\n  list: {\r\n    realtimeTrackSearch:   { description: 'Show realtime Track Search results',     type: BOOLEAN, values: [true, false],     default: true,  valueStrings: ['ON', 'OFF'] },\r\n    maxTrackSearchResults: { description: 'Max number of Track Search results',     type: INTEGER, values: [12, 24, 36, 48],  default: 24,    valueStrings: ['12', '24', '36', '48'] },\r\n    queryAllTrackArtists:  { description: 'Track Search: Query all Track Artists',  type: BOOLEAN, values: [true, false],     default: true,  valueStrings: ['ON', 'OFF'] },\r\n    queryAllTrackChannels: { description: 'Track Search: Query all Track Channels', type: BOOLEAN, values: [true, false],     default: true,  valueStrings: ['ON', 'OFF'] },\r\n    moveTrackOnPlayNext:   { description: 'Move Track on Play as Next',             type: BOOLEAN, values: [true, false],     default: true,  valueStrings: ['ON', 'OFF'] },\r\n    showUpNextModal:       { description: 'Show Up Next Modal',                     type: BOOLEAN, values: [true, false],     default: true,  valueStrings: ['ON', 'OFF'] },\r\n    showLoadMoreTracks:    { description: 'Show \"Load More Tracks...\" prompt',      type: BOOLEAN, values: [true, false],     default: true,  valueStrings: ['ON', 'OFF'] },\r\n    tracksPerPage:         { description: 'Tracks Per Page: Search & Shuffle',      type: INTEGER, values: listPerPageValues, default: 25,    valueStrings: listPerPageValueStrings },\r\n    enableLocalPlayback:   { description: 'Enable local (device) tracks playback',  type: BOOLEAN, values: [true, false],     default: false, valueStrings: ['ON', 'OFF'] },\r\n  },\r\n  gallery: {\r\n    layout:                  { description: 'Track Layout',                         type: STRING,  values: ['1-column', '2-column', '3-column'],    default: '3-column', valueStrings: ['1 Column', '2 Column', '3 / 4 Column'] },\r\n    fetchSingleTracks:       { description: 'Play single tracks without page load', type: BOOLEAN, values: [true, false],           default: true,  valueStrings: ['ON', 'OFF'] },\r\n    tracksPerPage:           { description: 'Tracks Per Page: Search & Shuffle',    type: INTEGER, values: galleryPerPageValues,    default: 12,    valueStrings: galleryPerPageValueStrings },\r\n    autoCrossfade:           { description: 'Auto Crossfade to next track',         type: BOOLEAN, values: [true, false],           default: false, valueStrings: ['ON', 'OFF'] },\r\n    autoCrossfadeLength:     { description: 'Auto Crossfade Length',                type: INTEGER, values: [5, 10, 15, 20, 25, 30], default: 20,    valueStrings: ['5 sec', '10 sec', '15 sec', '20 sec', '25 sec', '30 sec'] },\r\n    autoCrossfadeCurve:      { description: 'Auto Crossfade Curve',                 type: INTEGER, values: [1, 2],                  default: 2,     valueStrings: ['Equal Power', 'Linear'] },\r\n    autoScroll:              { description: 'Autoscroll to next track',             type: BOOLEAN, values: [true, false],           default: true,  valueStrings: ['ON', 'OFF'] },\r\n    animateNowPlayingIcon:   { description: 'Animate Now Playing Track Icon',       type: BOOLEAN, values: [true, false],           default: true,  valueStrings: ['ON', 'OFF'] },\r\n    trackCrossfadeDefPreset: { description: 'Track Crossfade Def. Preset',          type: INTEGER, values: [0, 1, 2, 3, 4, 5],      default: 1,     valueStrings: ['10 sec EqPow (1)', '20 sec EqPow (2)', '30 sec EqPow (3)', '10 sec Linear (4)', '20 sec Linear (5)', '30 sec Linear (6)'] },\r\n  },\r\n  mobile: {\r\n    keepScreenOn:        { description: 'Keep Screen On when playing', type: BOOLEAN, values: [true, false], default: false, valueStrings: ['ON', 'OFF'] },\r\n    showTrackThumbnail:  { description: 'Show Track Thumbnail',        type: BOOLEAN, values: [true, false], default: true,  valueStrings: ['ON', 'OFF'] },\r\n    showTrackTimes:      { description: 'Show Track Times',            type: BOOLEAN, values: [true, false], default: true,  valueStrings: ['ON', 'OFF'] },\r\n    showPrevTrackButton: { description: 'Show Previous Track button',  type: BOOLEAN, values: [true, false], default: true,  valueStrings: ['ON', 'OFF'] },\r\n  },\r\n  site: {\r\n    keyboardShortcuts:   { description: 'Keyboard Shortcuts',                    type: BOOLEAN, values: [true, false],                        default: true,   valueStrings: ['ON', 'OFF'] },\r\n    theme:               { description: 'Theme',                                 type: STRING,  values: ['light', 'dark', 'black', 'auto'],   default: 'auto', valueStrings: ['Light', 'Dark', 'Black', 'Auto / System'] },\r\n    smoothScrolling:     { description: 'Use Smooth Scrolling (where possible)', type: BOOLEAN, values: [true, false],                        default: true,   valueStrings: ['ON', 'OFF'] },\r\n    overlayOpacity:      { description: 'Overlay opacity',                       type: INTEGER, values: [10, 20, 30, 40, 50, 60, 70, 80, 90], default: 60,     valueStrings: ['10%', '20%', '30%', '40%', '50%', '60%', '70%', '80%', '90%'] },\r\n    snackbarMessageLog:  { description: 'Enable Snackbar message log',           type: BOOLEAN, values: [true, false],                        default: false,  valueStrings: ['ON', 'OFF'] },\r\n  },\r\n  internal: {\r\n  //showSiteInfoOnLoad: { description: '', type: BOOLEAN, values: [true, false], default: true, valueStrings: [] },\r\n  },\r\n  experimental: {\r\n  //enableLocalPlayback:  { description: '<b>List Player</b><br>Enable local (device) track playback',      type: BOOLEAN, values: [true, false], default: false, valueStrings: ['ON', 'OFF'] },\r\n  //enableDjPlayer:       { description: '<b>List Player</b><br>Enable DJ Player testing',                  type: BOOLEAN, values: [true, false], default: false, valueStrings: ['ON', 'OFF'] },\r\n  //realtimeTrackSearch:  { description: '<b>List Player</b><br>Show realtime track search results',        type: BOOLEAN, values: [true, false], default: false, valueStrings: ['ON', 'OFF'] },\r\n  //fetchNextSingleTrack: { description: '<b>Gallery Player</b><br>Play single tracks without page reload', type: BOOLEAN, values: [true, false], default: false, valueStrings: ['ON', 'OFF'] },\r\n  },\r\n};\r\n\r\nexport const defaultSettings = {\r\n  version: settingsSchema.version.default,\r\n  playback: {\r\n    preferredPlayer:      settingsSchema.playback.preferredPlayer.default,\r\n    keyboardShortcuts:    settingsSchema.playback.keyboardShortcuts.default,\r\n    masterVolume:         settingsSchema.playback.masterVolume.default,\r\n    masterMute:           settingsSchema.playback.masterMute.default,\r\n    pauseOnPlayerChange:  settingsSchema.playback.pauseOnPlayerChange.default,\r\n    autoplay:             settingsSchema.playback.autoplay.default,\r\n    autoExitFullscreen:   settingsSchema.playback.autoExitFullscreen.default,\r\n    timeRemainingWarning: settingsSchema.playback.timeRemainingWarning.default,\r\n    timeRemainingSeconds: settingsSchema.playback.timeRemainingSeconds.default,\r\n    autoExitFsOnWarning:  settingsSchema.playback.autoExitFsOnWarning.default,\r\n  },\r\n  list: {\r\n    realtimeTrackSearch:   settingsSchema.list.realtimeTrackSearch.default,\r\n    maxTrackSearchResults: settingsSchema.list.maxTrackSearchResults.default,\r\n    queryAllTrackArtists:  settingsSchema.list.queryAllTrackArtists.default,\r\n    queryAllTrackChannels: settingsSchema.list.queryAllTrackChannels.default,\r\n    moveTrackOnPlayNext:   settingsSchema.list.moveTrackOnPlayNext.default,\r\n    showUpNextModal:       settingsSchema.list.showUpNextModal.default,\r\n    showLoadMoreTracks:    settingsSchema.list.showLoadMoreTracks.default,\r\n    tracksPerPage:         settingsSchema.list.tracksPerPage.default,\r\n    enableLocalPlayback:   settingsSchema.list.enableLocalPlayback.default,\r\n  },\r\n  gallery: {\r\n    layout:                  settingsSchema.gallery.layout.default,\r\n    fetchSingleTracks:       settingsSchema.gallery.fetchSingleTracks.default,\r\n    tracksPerPage:           settingsSchema.gallery.tracksPerPage.default,\r\n    autoCrossfade:           settingsSchema.gallery.autoCrossfade.default,\r\n    autoCrossfadeLength:     settingsSchema.gallery.autoCrossfadeLength.default,\r\n    autoCrossfadeCurve:      settingsSchema.gallery.autoCrossfadeCurve.default,\r\n    autoScroll:              settingsSchema.gallery.autoScroll.default,\r\n    animateNowPlayingIcon:   settingsSchema.gallery.animateNowPlayingIcon.default,\r\n    trackCrossfadeDefPreset: settingsSchema.gallery.trackCrossfadeDefPreset.default,\r\n  },\r\n  mobile: {\r\n    keepScreenOn:        settingsSchema.mobile.keepScreenOn.default,\r\n    showTrackThumbnail:  settingsSchema.mobile.showTrackThumbnail.default,\r\n    showTrackTimes:      settingsSchema.mobile.showTrackTimes.default,\r\n    showPrevTrackButton: settingsSchema.mobile.showPrevTrackButton.default,\r\n  },\r\n  site: {\r\n    keyboardShortcuts:   settingsSchema.site.keyboardShortcuts.default,\r\n    theme:               settingsSchema.site.theme.default,\r\n    smoothScrolling:     settingsSchema.site.smoothScrolling.default,\r\n    overlayOpacity:      settingsSchema.site.overlayOpacity.default,\r\n    snackbarMessageLog:  settingsSchema.site.snackbarMessageLog.default,\r\n  },\r\n  internal: {\r\n  //showSiteInfoOnLoad: settingsSchema.internal.showSiteInfoOnLoad.default,\r\n  },\r\n  experimental: {\r\n  //enableLocalPlayback:  settingsSchema.experimental.enableLocalPlayback.default,\r\n  //enableDjPlayer:       settingsSchema.experimental.enableDjPlayer.default,\r\n  //realtimeTrackSearch:  settingsSchema.experimental.realtimeTrackSearch.default,\r\n  //fetchNextSingleTrack: settingsSchema.experimental.fetchNextSingleTrack.default,\r\n  },\r\n};\r\n\r\nexport const settingsDescriptions = {\r\n  playback: {\r\n    pauseOnPlayerChange: \"Pause all ultrafunk.com playback in other browser tabs and windows when starting track playback in a new player.\",\r\n  },\r\n  site: {\r\n    snackbarMessageLog: \"The 15 last snackbar (toast) messages shown on ultrafunk.com are stored with a timestamp and can be viewed by pressing <b>v</b>.\",\r\n  }\r\n};\r\n\r\n\r\n// ************************************************************************************************\r\n// Presets\r\n// ************************************************************************************************\r\n\r\nexport const presetsSchema = {\r\n  version: { description: '', type: INTEGER, values: [1, 999999], default: 1, valueStrings: [] },\r\n  crossfade: [\r\n    {\r\n      name:   { description: 'Preset 1',         type: STRING,  values: [5, 50],                 default: '10 sec EqPow', valueStrings: [] },\r\n      length: { description: 'Crossfade Length', type: INTEGER, values: [5, 10, 15, 20, 25, 30], default: 10,             valueStrings: ['5 sec', '10 sec', '15 sec', '20 sec', '25 sec', '30 sec'] },\r\n      curve:  { description: 'Crossfade Curve',  type: INTEGER, values: [1, 2],                  default: 1,              valueStrings: ['Equal Power', 'Linear'] },\r\n    },\r\n    {\r\n      name:   { description: 'Preset 2',         type: STRING,  values: [5, 50],                 default: '20 sec EqPow', valueStrings: [] },\r\n      length: { description: 'Crossfade Length', type: INTEGER, values: [5, 10, 15, 20, 25, 30], default: 20,             valueStrings: ['5 sec', '10 sec', '15 sec', '20 sec', '25 sec', '30 sec'] },\r\n      curve:  { description: 'Crossfade Curve',  type: INTEGER, values: [1, 2],                  default: 1,              valueStrings: ['Equal Power', 'Linear'] },\r\n    },\r\n    {\r\n      name:   { description: 'Preset 3',         type: STRING,  values: [5, 50],                 default: '30 sec EqPow', valueStrings: [] },\r\n      length: { description: 'Crossfade Length', type: INTEGER, values: [5, 10, 15, 20, 25, 30], default: 30,             valueStrings: ['5 sec', '10 sec', '15 sec', '20 sec', '25 sec', '30 sec'] },\r\n      curve:  { description: 'Crossfade Curve',  type: INTEGER, values: [1, 2],                  default: 1,              valueStrings: ['Equal Power', 'Linear'] },\r\n    },\r\n    {\r\n      name:   { description: 'Preset 4',         type: STRING,  values: [5, 50],                 default: '10 sec Linear', valueStrings: [] },\r\n      length: { description: 'Crossfade Length', type: INTEGER, values: [5, 10, 15, 20, 25, 30], default: 10,              valueStrings: ['5 sec', '10 sec', '15 sec', '20 sec', '25 sec', '30 sec'] },\r\n      curve:  { description: 'Crossfade Curve',  type: INTEGER, values: [1, 2],                  default: 2,               valueStrings: ['Equal Power', 'Linear'] },\r\n    },\r\n    {\r\n      name:   { description: 'Preset 5',         type: STRING,  values: [5, 50],                 default: '20 sec Linear', valueStrings: [] },\r\n      length: { description: 'Crossfade Length', type: INTEGER, values: [5, 10, 15, 20, 25, 30], default: 20,              valueStrings: ['5 sec', '10 sec', '15 sec', '20 sec', '25 sec', '30 sec'] },\r\n      curve:  { description: 'Crossfade Curve',  type: INTEGER, values: [1, 2],                  default: 2,               valueStrings: ['Equal Power', 'Linear'] },\r\n    },\r\n    {\r\n      name:   { description: 'Preset 6',         type: STRING,  values: [5, 50],                 default: '30 sec Linear', valueStrings: [] },\r\n      length: { description: 'Crossfade Length', type: INTEGER, values: [5, 10, 15, 20, 25, 30], default: 30,              valueStrings: ['5 sec', '10 sec', '15 sec', '20 sec', '25 sec', '30 sec'] },\r\n      curve:  { description: 'Crossfade Curve',  type: INTEGER, values: [1, 2],                  default: 2,               valueStrings: ['Equal Power', 'Linear'] },\r\n    },\r\n  ],\r\n};\r\n\r\nexport const presetList = {\r\n  version: presetsSchema.version.default,\r\n  crossfade: [\r\n    {\r\n      name:   presetsSchema.crossfade[0].name.default,\r\n      length: presetsSchema.crossfade[0].length.default,\r\n      curve:  presetsSchema.crossfade[0].curve.default,\r\n    },\r\n    {\r\n      name:   presetsSchema.crossfade[1].name.default,\r\n      length: presetsSchema.crossfade[1].length.default,\r\n      curve:  presetsSchema.crossfade[1].curve.default,\r\n    },\r\n    {\r\n      name:   presetsSchema.crossfade[2].name.default,\r\n      length: presetsSchema.crossfade[2].length.default,\r\n      curve:  presetsSchema.crossfade[2].curve.default,\r\n    },\r\n    {\r\n      name:   presetsSchema.crossfade[3].name.default,\r\n      length: presetsSchema.crossfade[3].length.default,\r\n      curve:  presetsSchema.crossfade[3].curve.default,\r\n    },\r\n    {\r\n      name:   presetsSchema.crossfade[4].name.default,\r\n      length: presetsSchema.crossfade[4].length.default,\r\n      curve:  presetsSchema.crossfade[4].curve.default,\r\n    },\r\n    {\r\n      name:   presetsSchema.crossfade[5].name.default,\r\n      length: presetsSchema.crossfade[5].length.default,\r\n      curve:  presetsSchema.crossfade[5].curve.default,\r\n    },\r\n  ],\r\n};\r\n", "//\r\n// Validation for playback and site settings\r\n//\r\n// https://ultrafunk.com\r\n//\r\n\r\n\r\nimport { newDebugLogger } from '../shared/debuglogger.js';\r\n\r\nimport {\r\n  TYPE_INTEGER,\r\n  TYPE_BOOLEAN,\r\n  TYPE_STRING\r\n} from './settings.js';\r\n\r\n\r\n/*************************************************************************************************/\r\n\r\n\r\nconst debug = newDebugLogger('validate-settings');\r\n\r\n\r\n// ************************************************************************************************\r\n// Validation\r\n// ************************************************************************************************\r\n\r\nexport function validateSettings(settings, schema)\r\n{\r\n  let invalidCount = 0;\r\n\r\n  validateRecursive(settings, schema);\r\n\r\n  return invalidCount;\r\n\r\n  function validateRecursive(settingsObject, schemaObject)\r\n  {\r\n    for (const key in settingsObject)\r\n    {\r\n      if (settingsObject                            &&\r\n          schemaObject                              &&\r\n          (typeof settingsObject[key] === 'object') &&\r\n          (settingsObject[key]        !== null)     &&\r\n          (typeof schemaObject[key]   === 'object'))\r\n      {\r\n        validateRecursive(settingsObject[key], schemaObject[key]);\r\n      }\r\n      else\r\n      {\r\n        if (schemaObject[key] !== undefined)\r\n        {\r\n          if (isEntryInvalid(settingsObject, schemaObject[key], settingsObject[key], key))\r\n            invalidCount++;\r\n        }\r\n        else\r\n        {\r\n          throw(`'${key}' ${(typeof settingsObject[key] === 'object') ? 'object' : 'property'} is not in schema`);\r\n        }\r\n      }\r\n    }\r\n  }\r\n}\r\n\r\nfunction isEntryInvalid(settings, schemaEntry, settingValue, entryKey)\r\n{\r\n  switch (schemaEntry.type)\r\n  {\r\n    case TYPE_INTEGER:\r\n      if ((Number.isInteger(settingValue) === false) || (settingValue < schemaEntry.values[0]) || (settingValue > schemaEntry.values[schemaEntry.values.length - 1]))\r\n      {\r\n        debug.warn(`validate() - '${entryKey}' has invalid value: ${settingValue} ('${entryKey}' is type: INTEGER - min: ${schemaEntry.values[0]} - max: ${schemaEntry.values[schemaEntry.values.length - 1]}) -- setting default value: ${schemaEntry.default}`);\r\n        settings[entryKey] = schemaEntry.default;\r\n        return true;\r\n      }\r\n      break;\r\n\r\n    case TYPE_BOOLEAN:\r\n      if ((settingValue !== true) && (settingValue !== false))\r\n      {\r\n        debug.warn(`validate() - '${entryKey}' has invalid value: ${settingValue} ('${entryKey}' is type: BOOLEAN) -- setting default value: ${schemaEntry.default}`);\r\n        settings[entryKey] = schemaEntry.default;\r\n        return true;\r\n      }\r\n      break;\r\n\r\n    case TYPE_STRING:\r\n      if (typeof settingValue !== 'string')\r\n      {\r\n        debug.warn(`validate() - '${entryKey}' has invalid value: ${settingValue} ('${entryKey}' is type: STRING) -- setting default value: ${schemaEntry.default}`);\r\n        settings[entryKey] = schemaEntry.default;\r\n        return true;\r\n      }\r\n      break;\r\n\r\n    default:\r\n      debug.warn(`validate() - '${entryKey}' has unknown type: ${schemaEntry.type}`);\r\n      return true;\r\n  }\r\n}\r\n", "//\r\n// Set and get storage values\r\n// Read, write and parse storage JSON data\r\n//\r\n// https://ultrafunk.com\r\n//\r\n\r\n\r\nimport { newDebugLogger } from './debuglogger.js';\r\nimport { settingsSchema } from  '../settings/settings.js';\r\n\r\nimport {\r\n  validateSettings as validateSettingsDeep\r\n} from '../settings/validate-settings.js';\r\n\r\n\r\n/*************************************************************************************************/\r\n\r\n\r\nconst debug     = newDebugLogger('storage');\r\nconst observers = {};\r\n\r\nexport const KEY = {\r\n//sessionStorage keys\r\n  UF_AUTOPLAY:         'uf_autoplay',\r\n  UF_TERMLIST_CACHE:   'uf_termlist_cache',\r\n  UF_TERMLIST_STATE:   'uf_termlist_state',\r\n//localStorage keys\r\n  UF_SETTINGS:         'uf_settings',\r\n  UF_PRESET_LIST:      'uf_preset_list',\r\n  UF_SITE_THEME:       'uf_site_theme',\r\n  UF_GALLERY_LAYOUT:   'uf_gallery_layout',\r\n  UF_MESSAGE_LOGS:     'uf_message_logs',\r\n//document.cookie keys\r\n//ToDo: Merge all cookies into one cookie (UF_USER_SETTINGS) as a JSON encoded string?\r\n//UF_USER_SETTINGS:    'uf_user_settings',\r\n  UF_GALLERY_PER_PAGE: 'uf_gallery_per_page',\r\n  UF_LIST_PER_PAGE:    'uf_list_per_page',\r\n  UF_PREFERRED_PLAYER: 'uf_preferred_player',\r\n  UF_SHUFFLE_UID:      'uf_shuffle_uid',\r\n//Temp document.cookie keys\r\n  UF_RESHUFFLE:        'uf_reshuffle',\r\n};\r\n\r\nconst DEPRECATED_KEYS = {\r\n//localStorage keys\r\n  UF_PLAYBACK_SETTINGS: 'UF_PLAYBACK_SETTINGS',\r\n  UF_SITE_SETTINGS:     'UF_SITE_SETTINGS',\r\n  UF_SITE_THEME:        'UF_SITE_THEME',\r\n  UF_TRACK_LAYOUT:      'UF_TRACK_LAYOUT',\r\n  UF_GALLERY_LAYOUT:    'UF_GALLERY_LAYOUT',\r\n//document.cookie keys\r\n  UF_TRACKS_PER_PAGE:  'UF_TRACKS_PER_PAGE',\r\n  UF_PREFERRED_PLAYER: 'UF_PREFERRED_PLAYER',\r\n  UF_SHUFFLE_UID:      'UF_SHUFFLE_UID',\r\n  UF_RESHUFFLE:        'UF_RESHUFFLE',\r\n  ULTRAFUNK_UID:       'ultrafunk_uid',\r\n};\r\n\r\nexport const YEAR_IN_SECONDS = (60 * 60 * 24 * 365);\r\n\r\n\r\n// ************************************************************************************************\r\n// Set and delete cookie key => value pairs\r\n// ************************************************************************************************\r\n\r\nexport function setCookie(keyName, keyValue = '', maxAge = YEAR_IN_SECONDS, path = '/')\r\n{\r\n  document.cookie = `${keyName}=${keyValue}; Max-Age=${maxAge}; Path=${path}; Secure; SameSite=Strict`;\r\n}\r\n\r\nexport function deleteCookie(keyName, path = '/')\r\n{\r\n  document.cookie = `${keyName}=; expires=Thu, 01 Jan 1970 00:00:00 UTC; path=${path}`;\r\n}\r\n\r\n\r\n// ************************************************************************************************\r\n// get / set local storage key => value pairs\r\n// ************************************************************************************************\r\n\r\n/*\r\nexport function getValue(keyName, defaultValue = null, setDefault = false)\r\n{\r\n  const keyValue = localStorage.getItem(keyName);\r\n\r\n  if (keyValue === null)\r\n  {\r\n    if (setDefault && (defaultValue !== null))\r\n      setValue(keyName, defaultValue);\r\n\r\n    return defaultValue;\r\n  }\r\n\r\n  return keyValue;\r\n}\r\n*/\r\n\r\nexport function setValue(keyName, keyValue)\r\n{\r\n  try\r\n  {\r\n    localStorage.setItem(keyName, keyValue);\r\n  }\r\n  catch(exception)\r\n  {\r\n    debug.error(exception);\r\n  }\r\n}\r\n\r\n\r\n// ************************************************************************************************\r\n// Read (parse) and write (stringify) JSON data from local storage\r\n// ************************************************************************************************\r\n\r\nexport function readJson(keyName, defaultValue = null, setDefault = false)\r\n{\r\n  debug.log(`readJson(): ${keyName} - ${defaultValue} - ${setDefault}`);\r\n\r\n  const keyValue     = localStorage.getItem(keyName);\r\n  let parsedKeyValue = null;\r\n\r\n  if (keyValue === null)\r\n  {\r\n    if (setDefault && (defaultValue !== null))\r\n      writeJson(keyName, defaultValue);\r\n\r\n    return defaultValue;\r\n  }\r\n  else\r\n  {\r\n    try\r\n    {\r\n      parsedKeyValue = JSON.parse(keyValue);\r\n    }\r\n    catch(exception)\r\n    {\r\n      debug.error(exception);\r\n\r\n      // ToDo: Return error state to specify (for the user) that default settings are used??\r\n      if (defaultValue !== null)\r\n        parsedKeyValue = defaultValue;\r\n    }\r\n  }\r\n\r\n  return parsedKeyValue;\r\n}\r\n\r\nexport function writeJson(keyName, keyData)\r\n{\r\n  debug.log(`writeJson(): ${keyName} - ${keyData}`);\r\n\r\n  try\r\n  {\r\n    localStorage.setItem(keyName, JSON.stringify(keyData));\r\n  }\r\n  catch(exception)\r\n  {\r\n    debug.error(exception);\r\n  }\r\n}\r\n\r\n\r\n// ************************************************************************************************\r\n// Recursive merge and cleanup for settings objects on new version\r\n// ************************************************************************************************\r\n\r\nfunction mergeSettings(oldSettings, newSettings, settingsKey)\r\n{\r\n  debug.log(`mergeSettings(): Merging ${settingsKey} from version ${oldSettings.version} to version ${newSettings.version}`);\r\n\r\n  const mergedSettings = { version: newSettings.version };\r\n\r\n  mergeDeep(oldSettings, newSettings, mergedSettings);\r\n  cleanDeep(mergedSettings, newSettings);\r\n\r\n  return mergedSettings;\r\n}\r\n\r\nfunction mergeDeep(oldSettings, newSettings, destination)\r\n{\r\n  for (const key in newSettings)\r\n  {\r\n    if (typeof newSettings[key] === 'object')\r\n    {\r\n      if (oldSettings && (typeof oldSettings[key] === 'object'))\r\n      {\r\n        debug.log(`mergeDeep() - Merging: ${key}`);\r\n        destination[key] = { ...newSettings[key], ...oldSettings[key] };\r\n        mergeDeep(oldSettings[key], newSettings[key], destination[key]);\r\n      }\r\n      else\r\n      {\r\n        debug.log(`mergeDeep() - Copying: ${key}`);\r\n        destination[key] = { ...newSettings[key] };\r\n        mergeDeep({}, newSettings[key], destination[key]);\r\n      }\r\n    }\r\n  }\r\n}\r\n\r\n//\r\n// Delete all orphaned Settings properties / objects that are no longer in use after merge\r\n//\r\nfunction cleanDeep(mergedSettings, newSettings)\r\n{\r\n  for (const key in mergedSettings)\r\n  {\r\n    if ((key in newSettings) === false)\r\n    {\r\n      debug.log(`cleanDeep() - Deleting: ${key} (${(typeof mergedSettings[key] === 'object') ? 'object' : 'property'})`);\r\n      delete mergedSettings[key];\r\n    }\r\n\r\n    if (typeof mergedSettings[key] === 'object')\r\n      cleanDeep(mergedSettings[key], newSettings[key]);\r\n  }\r\n}\r\n\r\n//\r\n// Clean up (delete) any localStorage or cookie-data that is no longer in use...\r\n//\r\nexport function cleanupOldData(skipOldDataCheck = false)\r\n{\r\n  debug.log(`cleanupOldData(): ${skipOldDataCheck ? 'Skipping' : 'Performing quick'} old data cleanup check...`);\r\n\r\n  if (skipOldDataCheck || (localStorage.getItem(DEPRECATED_KEYS.UF_SITE_THEME) !== null))\r\n  {\r\n    debug.log(`cleanupOldData(): Running cleanup...`);\r\n\r\n    localStorage.removeItem(DEPRECATED_KEYS.UF_PLAYBACK_SETTINGS);\r\n    localStorage.removeItem(DEPRECATED_KEYS.UF_SITE_SETTINGS);\r\n    localStorage.removeItem(DEPRECATED_KEYS.UF_SITE_THEME);\r\n    localStorage.removeItem(DEPRECATED_KEYS.UF_TRACK_LAYOUT);\r\n    localStorage.removeItem(DEPRECATED_KEYS.UF_GALLERY_LAYOUT);\r\n    deleteCookie(DEPRECATED_KEYS.UF_TRACKS_PER_PAGE);\r\n    deleteCookie(DEPRECATED_KEYS.UF_PREFERRED_PLAYER);\r\n    deleteCookie(DEPRECATED_KEYS.UF_SHUFFLE_UID);\r\n    deleteCookie(DEPRECATED_KEYS.UF_RESHUFFLE);\r\n    deleteCookie(DEPRECATED_KEYS.ULTRAFUNK_UID);\r\n  }\r\n}\r\n\r\nfunction validateSettings(settingsKey, settingsObject, defaultSettings)\r\n{\r\n  try\r\n  {\r\n    const invalidSettingsCount = validateSettingsDeep(settingsObject, settingsSchema);\r\n\r\n    if (invalidSettingsCount > 0)\r\n      writeJson(settingsKey, settingsObject);\r\n  }\r\n  catch(exception)\r\n  {\r\n    debug.error(`validateSettings() exception: ${exception} -- using default settings`);\r\n\r\n    writeJson(settingsKey, defaultSettings);\r\n\r\n    return defaultSettings;\r\n  }\r\n\r\n  return settingsObject;\r\n}\r\n\r\n\r\n// ************************************************************************************************\r\n// Read and write settings proxy\r\n// ************************************************************************************************\r\n\r\nexport function readWriteSettingsProxy(settingsKey, defaultSettings = null, setDefault = false)\r\n{\r\n  const parsedJson = readJson(settingsKey, defaultSettings, setDefault);\r\n\r\n  if ((parsedJson !== null) && (defaultSettings !== null) && (parsedJson.version !== undefined))\r\n  {\r\n    let settingsObject = parsedJson;\r\n\r\n    // If version is new, perform settings merge, cleanup and deletion of deprecated settings\r\n    if (parsedJson.version < defaultSettings.version)\r\n    {\r\n      debug.log(parsedJson);\r\n\r\n      settingsObject = mergeSettings(parsedJson, defaultSettings, settingsKey);\r\n      writeJson(settingsKey, settingsObject);\r\n\r\n      // Always run cleanup on version update\r\n      cleanupOldData(true);\r\n\r\n      debug.log(settingsObject);\r\n    }\r\n    else\r\n    {\r\n      // Only run cleanup if old data is detected (much quicker)\r\n      cleanupOldData(false);\r\n    }\r\n\r\n    return onSettingsChange(settingsKey, validateSettings(settingsKey, settingsObject, defaultSettings));\r\n  }\r\n\r\n  if (defaultSettings !== null)\r\n  {\r\n    debug.warn(`readWriteSettingsProxy() - Failed for: ${settingsKey} -- using default settings`);\r\n\r\n    writeJson(settingsKey, defaultSettings);\r\n\r\n    return onSettingsChange(settingsKey, defaultSettings);\r\n  }\r\n\r\n  debug.error(`readWriteSettingsProxy() - Fatal error for: ${settingsKey} -- unable to read settings!`);\r\n\r\n  return null;\r\n}\r\n\r\n\r\n// ************************************************************************************************\r\n// Proxy traps (handlers) for settings get and set\r\n// ************************************************************************************************\r\n\r\nconst onSettingsChange = (settingsKey, settingsObject) =>\r\n{\r\n  const handler =\r\n  {\r\n    get(target, property, receiver)\r\n    {\r\n    //debug.log(`onSettingsChange(): Get property: ${property}`);\r\n\r\n      if (property in target)\r\n      {\r\n        const value = Reflect.get(target, property, receiver);\r\n\r\n        if (typeof value === 'object')\r\n          return new Proxy(value, handler);\r\n\r\n        return value;\r\n      }\r\n\r\n      debug.error(`onSettingsChange(): Get unknown property: ${property}`);\r\n    },\r\n\r\n    set(target, property, newValue, receiver)\r\n    {\r\n    //debug.log(`onSettingsChange(): Set property: ${property}`);\r\n\r\n      if (property in target)\r\n      {\r\n        const oldValue = Reflect.get(target, property, receiver);\r\n\r\n        // Only update and write data if it has changed\r\n        if (newValue !== oldValue)\r\n        {\r\n          Reflect.set(target, property, newValue);\r\n          writeJson(settingsKey, settingsObject);\r\n          callSettingsObservers(property, oldValue, newValue);\r\n        }\r\n\r\n        return true;\r\n      }\r\n\r\n      debug.error(`onSettingsChange(): Set unknown property: ${property}`);\r\n      return true;\r\n    },\r\n  };\r\n\r\n  return new Proxy(settingsObject, handler);\r\n};\r\n\r\n\r\n// ************************************************************************************************\r\n// Add and call settings observers on property changes\r\n// ************************************************************************************************\r\n\r\nexport function addSettingsObserver(property, observer)\r\n{\r\n  debug.log(`addSettingsObserver() for property: ${property}`);\r\n\r\n  if ((property in observers) === false)\r\n    observers[property] = [];\r\n\r\n  observers[property].push(observer);\r\n}\r\n\r\nfunction callSettingsObservers(property, oldValue, newValue)\r\n{\r\n  if (property in observers)\r\n  {\r\n    debug.log(`callSettingsObserver() for property: ${property} - oldValue: ${oldValue} - newValue: ${newValue}`);\r\n    observers[property].forEach(observer => observer(oldValue, newValue));\r\n  }\r\n}\r\n", "//\r\n// Get session data\r\n//\r\n// https://ultrafunk.com\r\n//\r\n\r\n\r\nimport { newDebugLogger }  from './debuglogger.js';\r\nimport { defaultSettings } from '../settings/settings.js';\r\n\r\nimport {\r\n  KEY,\r\n  readWriteSettingsProxy,\r\n} from './storage.js';\r\n\r\n\r\n/*************************************************************************************************/\r\n\r\n\r\nconst debug = newDebugLogger('session-data');\r\n\r\nexport let response = {};\r\nexport let settings = {};\r\n\r\n\r\n// ************************************************************************************************\r\n//\r\n// ************************************************************************************************\r\n\r\nexport function getSessionData()\r\n{\r\n  debug.log('UF_ResponseData');\r\n  response = UF_ResponseData; // eslint-disable-line no-undef\r\n  debug.log(response);\r\n\r\n  readSettings();\r\n}\r\n\r\nexport function readSettings()\r\n{\r\n  settings = readWriteSettingsProxy(KEY.UF_SETTINGS, defaultSettings, true);\r\n  debug.log(settings);\r\n}\r\n", "//\r\n// MediaPlayer base class\r\n//\r\n// https://ultrafunk.com\r\n//\r\n\r\n\r\nimport {\r\n  IS_PROD_BUILD,\r\n  THEME_ENV,\r\n} from '../../config.js';\r\n\r\n\r\n/*************************************************************************************************/\r\n\r\n\r\nexport const TRACK_TYPE = {\r\n  NONE:       0,\r\n  YOUTUBE:    1,\r\n  SOUNDCLOUD: 2,\r\n  LOCAL:      3,\r\n};\r\n\r\n\r\n// ************************************************************************************************\r\n// Class definition\r\n// ************************************************************************************************\r\n\r\nexport class MediaPlayer\r\n{\r\n  #trackType;\r\n  #trackId        = null;\r\n  #iframeId       = null;\r\n  #embeddedPlayer = null;\r\n  #sourceUid      = null;\r\n  #isPlayable     = true;\r\n  #isCued         = false;\r\n\r\n  duration       = 0;\r\n  artist         = null;\r\n  title          = null;\r\n  thumbnailSrc   = THEME_ENV.defaultTrackThumbnail;\r\n  thumbnailClass = 'track-type-default';\r\n\r\n  constructor(trackType, trackId, iframeId, embeddedPlayer)\r\n  {\r\n    this.#trackType      = trackType;\r\n    this.#trackId        = trackId;\r\n    this.#iframeId       = iframeId;\r\n    this.#embeddedPlayer = embeddedPlayer;\r\n\r\n    this.thumbnail          = new Image();\r\n    this.thumbnail.decoding = 'async';\r\n  }\r\n\r\n  getTrackType()    { return this.#trackType;      }\r\n  getTrackId()      { return this.#trackId;        }\r\n  getIframeId()     { return this.#iframeId;       }\r\n  get embedded()    { return this.#embeddedPlayer; }\r\n  getSourceUid()    { return this.#sourceUid;      }\r\n  setSourceUid(uid) { this.#sourceUid = uid;       }\r\n\r\n  isPlayable()              { return this.#isPlayable;       }\r\n  setIsPlayable(isPlayable) { this.#isPlayable = isPlayable; }\r\n\r\n  isCued()          { return this.#isCued;   }\r\n  setIsCued(isCued) { this.#isCued = isCued; }\r\n\r\n  getDuration()         { return this.duration;     }\r\n  setDuration(duration) { this.duration = duration; }\r\n\r\n  getArtist()       { return this.artist;   }\r\n  setArtist(artist) { this.artist = artist; }\r\n\r\n  getTitle()      { return this.title;  }\r\n  setTitle(title) { this.title = title; }\r\n\r\n  getThumbnailSrc()   { return this.thumbnailSrc;   }\r\n  getThumbnailClass() { return this.thumbnailClass; }\r\n\r\n  // YouTube and SoundCloud players have the exact same functions for seekTo() and setVolume()\r\n  seekTo(position)  { this.#embeddedPlayer.seekTo(position);  }\r\n  setVolume(volume) { this.#embeddedPlayer.setVolume(volume); }\r\n\r\n  setArtistAndTitle(artist, title)\r\n  {\r\n    this.artist = artist;\r\n    this.title  = title;\r\n  }\r\n\r\n  setThumbnail(thumbnail)\r\n  {\r\n    this.thumbnailSrc   = thumbnail.src;\r\n    this.thumbnailClass = thumbnail.class;\r\n    this.thumbnail.src  = thumbnail.src;\r\n  }\r\n}\r\n\r\n\r\n// ************************************************************************************************\r\n// MediaPlayer support functions\r\n// ************************************************************************************************\r\n\r\n// Default / fallback track thumbnail object\r\nconst defThumbnailObj = { src: THEME_ENV.defaultTrackThumbnail, class: 'track-type-default', uid: '' };\r\n\r\n// https://webapps.stackexchange.com/a/101153\r\nconst youTubeVideoIdRegEx = /[0-9A-Za-z_-]{10}[048AEIMQUYcgkosw]/;\r\n\r\nexport function getYouTubeThumbnailUrl(trackSourceUrl)\r\n{\r\n  const youTubeVideoId = trackSourceUrl.match(youTubeVideoIdRegEx);\r\n\r\n  if (youTubeVideoId !== null)\r\n    return { src: `https://i.ytimg.com/vi/${youTubeVideoId[0]}/default.jpg`, class: 'track-type-youtube', uid: youTubeVideoId[0] };\r\n\r\n  return defThumbnailObj;\r\n}\r\n\r\nexport function getSoundCloudThumbnailUrl(soundObject)\r\n{\r\n  const thumbnailSrc = (soundObject.artwork_url !== null)\r\n                         ? soundObject.artwork_url\r\n                         : soundObject.user.avatar_url;\r\n\r\n  if (thumbnailSrc)\r\n    return { src: thumbnailSrc, class: 'track-type-soundcloud', uid: '' };\r\n\r\n  return defThumbnailObj;\r\n}\r\n\r\nexport function getThumbnailData(metaData)\r\n{\r\n  if (metaData.track_source_type === TRACK_TYPE.YOUTUBE)\r\n  {\r\n    const thumbnailData = getYouTubeThumbnailUrl(metaData.track_source_data);\r\n\r\n    if (IS_PROD_BUILD === false)\r\n      thumbnailData.src = THEME_ENV.defaultYTThumbnail;\r\n\r\n    return thumbnailData;\r\n  }\r\n\r\n  if (metaData.track_source_type === TRACK_TYPE.SOUNDCLOUD)\r\n    return { src: THEME_ENV.defaultSCThumbnail, class: 'track-type-soundcloud', uid: metaData.track_source_data };\r\n\r\n  if (metaData.track_source_type === TRACK_TYPE.LOCAL)\r\n    return { src: THEME_ENV.defaultLTThumbnail, class: 'track-type-local', uid: metaData.track_source_data };\r\n}\r\n\r\nexport function getDataTrackType(element)\r\n{\r\n  const trackType = element.getAttribute('data-track-type');\r\n\r\n  if (trackType !== null)\r\n    return parseInt(trackType);\r\n\r\n  return TRACK_TYPE.NONE;\r\n}\r\n\r\nexport function getDataTrackTypeFromId(elementId)\r\n{\r\n  return getDataTrackType(document.getElementById(elementId));\r\n}\r\n\r\nconst trackTypeClasses = [\r\n  'track-type-default',\r\n  'track-type-youtube',\r\n  'track-type-soundcloud',\r\n  'track-type-local',\r\n];\r\n\r\nexport function getTrackTypeClass(element)\r\n{\r\n  return trackTypeClasses[getDataTrackType(element)];\r\n}\r\n", "//\r\n// Shared utility functions\r\n//\r\n// https://ultrafunk.com\r\n//\r\n\r\n\r\nimport { newDebugLogger } from './debuglogger.js';\r\nimport { settings }       from './session-data.js';\r\nimport { PREF_PLAYER }    from '../settings/settings.js';\r\nimport { showSnackbar }   from './snackbar.js';\r\n\r\nimport {\r\n  IS_PROD_BUILD,\r\n  THEME_ENV,\r\n} from '../config.js';\r\n\r\n\r\n/*************************************************************************************************/\r\n\r\n\r\nconst debug = newDebugLogger('utils');\r\n\r\nconst SITE_URL_LIST = `${THEME_ENV.siteUrl}/list`;\r\n\r\nconst validUrlRegEx = IS_PROD_BUILD\r\n                        ? /^https:\\/\\/ultrafunk\\.com[/?&=%A-Za-z0-9\\-_.~+]*$/\r\n                        : /^https:\\/\\/wordpress\\.ultrafunk\\.com[/?&=%A-Za-z0-9\\-_.~+]*$/;\r\n\r\nconst DOMParserInstance = new DOMParser();\r\n\r\nexport const MATCH = {\r\n  SITE_MIN_WIDTH_WIDE:   1,\r\n  SITE_MAX_WIDTH:        2,\r\n  SITE_MAX_WIDTH_MOBILE: 3,\r\n};\r\n\r\nconst siteMinWidthWide   = window.matchMedia(`(min-width: ${getCssPropString('--site-min-width-wide')})`);\r\nconst siteMaxWidth       = window.matchMedia(`(max-width: ${getCssPropString('--site-max-width')})`);\r\nconst siteMaxWidthMobile = window.matchMedia(`(max-width: ${getCssPropString('--site-max-width-mobile')})`);\r\n\r\n\r\n// ************************************************************************************************\r\n// Misc. shared DOM utility functions\r\n// ************************************************************************************************\r\n\r\nexport function addListener(selectors, type, listener)\r\n{\r\n  document.querySelector(selectors)?.addEventListener(type, listener);\r\n}\r\n\r\n// Plain JS function equivalent to jQuery(selectors).eventX();\r\n// Adds event listeners of 'type' to all matching selectors\r\nexport function addListenerAll(selectors, type, listener)\r\n{\r\n  const elementList = document.querySelectorAll(selectors);\r\n  elementList.forEach(element => element.addEventListener(type, listener));\r\n}\r\n\r\nexport function getCssPropString(prop, element = document.documentElement)\r\n{\r\n  let string = getComputedStyle(element).getPropertyValue(prop);\r\n\r\n  if (string.length !== 0)\r\n    string = string.replace(/'|\"/g, '').trim();\r\n  else\r\n    debug.error(`getCssPropString(${prop}): Returned CSS property string is empty`);\r\n\r\n  return string;\r\n}\r\n\r\nexport function getCssPropValue(prop, element = document.documentElement)\r\n{\r\n  const string = getCssPropString(prop, element);\r\n  let value    = NaN;\r\n\r\n  if (string.length !== 0)\r\n    value = parseInt(string);\r\n\r\n  if (isNaN(value))\r\n    debug.error(`getCssPropValue(${prop}): Returned CSS property value is NaN`);\r\n\r\n  return value;\r\n}\r\n\r\n// Match against live CSS media queries defined in style.css\r\nexport function matchesMedia(matchMedia)\r\n{\r\n  switch (matchMedia)\r\n  {\r\n    case MATCH.SITE_MIN_WIDTH_WIDE:\r\n      return siteMinWidthWide.matches;\r\n\r\n    case MATCH.SITE_MAX_WIDTH:\r\n      return siteMaxWidth.matches;\r\n\r\n    case MATCH.SITE_MAX_WIDTH_MOBILE:\r\n      return siteMaxWidthMobile.matches;\r\n  }\r\n\r\n  return false;\r\n}\r\n\r\nexport function replaceClass(element, removeClass, addClass)\r\n{\r\n  element.classList.remove(removeClass);\r\n  element.classList.add(addClass);\r\n}\r\n\r\nexport function getScrollBehavior()\r\n{\r\n  return (settings.site.smoothScrolling ? 'smooth' : 'auto');\r\n}\r\n\r\nexport function getOverlayOpacityCssValue()\r\n{\r\n  return `rgba(0, 0, 0, ${Math.round(10 * (settings.site.overlayOpacity / 100)) / 10})`;\r\n}\r\n\r\n\r\n// ************************************************************************************************\r\n// https://github.com/janl/mustache.js/blob/master/mustache.js#L59\r\n// ************************************************************************************************\r\n\r\nconst entityMap = {\r\n  '&': '&amp;',\r\n  '<': '&lt;',\r\n  '>': '&gt;',\r\n  '\"': '&quot;',\r\n  \"'\": '&#39;',\r\n  '`': '&#x60;',\r\n  '=': '&#x3D;',\r\n  '/': '&#x2F;',\r\n};\r\n\r\nexport function escHtml(string)\r\n{\r\n  return String(string).replace(/[&<>\"'`=/]/g, (s) => entityMap[s]);\r\n}\r\n\r\nexport function escAttribute(element, attribute)\r\n{\r\n  const value = element.getAttribute(attribute);\r\n\r\n  if (value !== null)\r\n    return escHtml(value);\r\n\r\n  return value;\r\n}\r\n\r\n//\r\n// ToDo: escHtml() + stripHtml()\r\n// Replace with DOMPurify or the HTML Sanitizer API: https://github.com/WICG/sanitizer-api\r\n// Enhance / fix with: https://developer.mozilla.org/en-US/docs/Web/API/Trusted_Types_API\r\n//                     https://github.com/w3c/webappsec-trusted-types\r\n//\r\nexport function stripHtml(string)\r\n{\r\n  const firstPass  = DOMParserInstance.parseFromString(string, 'text/html');\r\n  const secondPass = DOMParserInstance.parseFromString(firstPass.body.textContent, 'text/html');\r\n\r\n//debug.log(`stripHtml(DOMParser): ${secondPass.body.textContent}`);\r\n\r\n  return secondPass.body.textContent;\r\n}\r\n\r\nexport function stripAttribute(element, attribute)\r\n{\r\n  const value = element.getAttribute(attribute);\r\n\r\n  if (value !== null)\r\n    return stripHtml(value);\r\n\r\n  return value;\r\n}\r\n\r\n\r\n// ************************************************************************************************\r\n//\r\n// ************************************************************************************************\r\n\r\nexport function navToUrl(destUrl)\r\n{\r\n  if (destUrl && (destUrl.match(validUrlRegEx) !== null))\r\n  {\r\n    debug.log(`navToUrl() - Valid destUrl: ${destUrl}`);\r\n    window.location.href = destUrl;\r\n  }\r\n  else if (destUrl !== null)\r\n  {\r\n    debug.error(`navToUrl() - Invalid destUrl: ${destUrl}`);\r\n\r\n    showSnackbar({\r\n      message: 'Error navigating to URL!',\r\n      duration: 0,\r\n      actionText: 'Reload',\r\n      actionClickCallback: () => location.reload(),\r\n    });\r\n  }\r\n}\r\n\r\nexport function getListPlayerUrl(destUrl)\r\n{\r\n  return destUrl.replace(THEME_ENV.siteUrl, SITE_URL_LIST);\r\n}\r\n\r\nexport function getGalleryPlayerUrl(destUrl)\r\n{\r\n  return destUrl.replace(SITE_URL_LIST, THEME_ENV.siteUrl);\r\n}\r\n\r\nexport function getPrefPlayerUrl(destUrl)\r\n{\r\n  if (destUrl)\r\n  {\r\n    if (settings.playback.preferredPlayer === PREF_PLAYER.LIST)\r\n    {\r\n      if (destUrl.startsWith(SITE_URL_LIST) === false)\r\n        return getListPlayerUrl(destUrl);\r\n    }\r\n    else if (settings.playback.preferredPlayer === PREF_PLAYER.GALLERY)\r\n    {\r\n      if (destUrl.startsWith(SITE_URL_LIST) === true)\r\n        return getGalleryPlayerUrl(destUrl);\r\n    }\r\n  }\r\n\r\n  return destUrl;\r\n}\r\n\r\nexport function linkClickUsePrefPlayer(event)\r\n{\r\n  if (event.target.matches('a'))\r\n  {\r\n    event.preventDefault();\r\n    navToUrl(getPrefPlayerUrl(event.target.href));\r\n  }\r\n}\r\n\r\nexport function getTimeString(seconds, includeHours = false)\r\n{\r\n  if (Number.isInteger(seconds))\r\n  {\r\n    const timeString = new Date(seconds * 1000).toISOString();\r\n\r\n    return ((seconds > 3600) || includeHours)\r\n      ? timeString.slice(11, 19)\r\n      : timeString.slice(14, 19);\r\n  }\r\n  else\r\n  {\r\n    return includeHours ? '00:00:00' : '00:00';\r\n  }\r\n}\r\n\r\n// ************************************************************************************************\r\n// https://stackoverflow.com/a/18650828\r\n// ************************************************************************************************\r\n\r\nexport function getReadableBytesSize(bytes, decimals = 2)\r\n{\r\n  if (!+bytes)\r\n    return '0 Bytes';\r\n\r\n  const k = 1024;\r\n  const dm = decimals < 0 ? 0 : decimals;\r\n  const sizes = ['Bytes', 'KB', 'MB', 'GB', 'TB', 'PB', 'EB', 'ZB', 'YB'];\r\n\r\n  const i = Math.floor(Math.log(bytes) / Math.log(k));\r\n\r\n  return `${parseFloat((bytes / Math.pow(k, i)).toFixed(dm))} ${sizes[i]}`;\r\n}\r\n\r\nexport function isPointerTypeTouch(event)\r\n{\r\n  // (event.mozInputSource === 5) is MOZ_SOURCE_TOUCH\r\n  return ((event.pointerType === 'touch') || (event.mozInputSource === 5));\r\n}\r\n\r\n\r\n// ************************************************************************************************\r\n// Allow / Deny keyboard shortcuts event handling closure\r\n// ************************************************************************************************\r\n\r\nexport const keyboardShortcuts = ((keyboardShortcutsSetting) =>\r\n{\r\n  let allow = keyboardShortcutsSetting;\r\n\r\n  document.addEventListener('allowKeyboardShortcuts', () =>\r\n  {\r\n    if (keyboardShortcutsSetting)\r\n      allow = true;\r\n  });\r\n\r\n  document.addEventListener('denyKeyboardShortcuts', () =>\r\n  {\r\n    if (keyboardShortcutsSetting)\r\n      allow = false;\r\n  });\r\n\r\n  return {\r\n    allow() { return allow; },\r\n  };\r\n});\r\n\r\nexport function isControlKey(key)\r\n{\r\n  return ((key === 'ArrowLeft')  ||\r\n          (key === 'ArrowRight') ||\r\n          (key === 'Home')       ||\r\n          (key === 'End')        ||\r\n          (key === 'Shift'));\r\n}\r\n", "//\r\n// Modal dialog template functions\r\n//\r\n// https://ultrafunk.com\r\n//\r\n\r\n\r\nimport { getTrackTypeClass } from '../playback/common/mediaplayer.js';\r\n\r\n\r\n// ************************************************************************************************\r\n//\r\n// ************************************************************************************************\r\n\r\nexport function getTemplateHtml()\r\n{\r\n  return /*html*/ `\r\n    <div id=\"modal-dialog-overlay\" tabindex=\"-1\">\r\n      <div id=\"modal-dialog-container\">\r\n        <div class=\"modal-dialog-header\">\r\n          <div class=\"modal-dialog-title\"></div>\r\n          <button type=\"button\" class=\"modal-dialog-close-icon\"><span class=\"material-icons\" title=\"Dismiss (esc)\">close</span></button>\r\n        </div>\r\n        <div class=\"modal-dialog-body\"></div>\r\n        <div class=\"modal-dialog-footer\"><button type=\"button\" class=\"modal-dialog-close-button\" title=\"Dismiss (esc)\">Close</button></div>\r\n      </div>\r\n    </div>`;\r\n}\r\n\r\nexport function getModalListHtml(modalList, modalItemsCount = 0)\r\n{\r\n  let html = '';\r\n  const entryColumnsClass = (modalItemsCount >= 10) ? 'modal-2-columns' : '';\r\n\r\n  modalList.forEach((entry, index) =>\r\n  {\r\n    let   entryClass      = entry.class      ? `modal-${entry.class}`                                                            : 'modal-icon-text';\r\n          entryClass      = entry.state      ? `${entryClass} state-${entry.state}`                                              : entryClass;\r\n    const entryTitle      = entry.title      ? entry.title                                                                       : '';\r\n    const entryIcon       = entry.icon       ? `<span class=\"material-icons default-icon\">${entry.icon}</span>`                  : '';\r\n    const hoverTitle      = entry.hoverTitle ?  `title=\"${entry.hoverTitle}\"`                                                    : '';\r\n    const entryHoverIcon  = entry.hoverIcon  ? `<span class=\"material-icons hover-icon\" ${hoverTitle}>${entry.hoverIcon}</span>` : '';\r\n    const modalItemIcons  = entry.hoverIcon  ? `<div class=\"modal-item-icons\">${entryIcon}${entryHoverIcon}</div>`               : entryIcon;\r\n    const entryContent    = entry.icon       ? `<span class=\"text-nowrap-ellipsis\">${entry.content}</span>`                      : entry.content;\r\n    const entryLinkTarget = entry.linkTarget ? `target=\"${entry.linkTarget}\"`                                                    : '';\r\n    entry.uid             = `modal-item-${index + 1}`;\r\n\r\n    if (entry.link)\r\n    {\r\n      const clickId = entry?.clickId ? `data-click-id=\"${entry.clickId}\"` : '';\r\n      html += `<a id=\"${entry.uid}\" ${clickId} href=\"${entry.link}\" ${entryLinkTarget} class=\"modal-click-item ${entryClass} ${entryColumnsClass}\" title=\"${entryTitle}\">${modalItemIcons}${entryContent}</a>`;\r\n    }\r\n    else if (entry.clickId)\r\n    {\r\n      html += `<div id=\"${entry.uid}\" data-click-id=\"${entry.clickId}\" class=\"modal-click-item ${entryClass} ${entryColumnsClass}\" title=\"${entryTitle}\">${modalItemIcons}${entryContent}</div>`;\r\n    }\r\n    else\r\n    {\r\n      html += `<div class=\"${entryClass}\" title=\"${entryTitle}\">${modalItemIcons}${entryContent}</div>`;\r\n    }\r\n  });\r\n\r\n  return html;\r\n}\r\n\r\nexport function getModalTrackHtml(element, trackArtist, trackTitle)\r\n{\r\n  return /*html*/ `\r\n    <div class=\"modal-track\">\r\n      <div class=\"modal-track-thumbnail ${getTrackTypeClass(element)}\">\r\n        <img src=\"${encodeURI(element.getAttribute('data-track-thumbnail-url'))}\">\r\n      </div>\r\n      <div class=\"modal-track-artist-title\">\r\n        <span><b>${trackArtist}</b></span><br>\r\n        <span class=\"light-text\">${trackTitle}</span>\r\n      </div>\r\n    </div>`;\r\n}\r\n", "//\r\n// Modal dialog UI module\r\n//\r\n// https://ultrafunk.com\r\n//\r\n\r\n\r\nimport { newDebugLogger } from './debuglogger.js';\r\nimport { getOverlayOpacityCssValue } from './utils.js';\r\n\r\nimport {\r\n  getTemplateHtml,\r\n  getModalListHtml,\r\n} from './modal-templates.js';\r\n\r\n\r\n/*************************************************************************************************/\r\n\r\n\r\nconst debug = newDebugLogger('modal');\r\n\r\nconst m = {\r\n  onClickClose:        null,\r\n  onClickEntry:        null,\r\n  onCloseFocusElement: null,\r\n  modalId:             0,\r\n  clickItemsCount:     0,\r\n  isOverflowY:         false,\r\n  ignoreTouchMove:     false,\r\n  isTouchDraggable:    false,\r\n};\r\n\r\nconst elements = {\r\n  overlay:   null,\r\n  container: null,\r\n  body:      null,\r\n};\r\n\r\n\r\n// ************************************************************************************************\r\n//\r\n// ************************************************************************************************\r\n\r\nexport function showModal({\r\n  modalType  = 'default',\r\n  modalTitle = 'Modal Title',\r\n  modalBody  = null,\r\n  modalList  = [],\r\n  onClickCloseCallback = () => true,\r\n  onClickEntryCallback = () => {},\r\n  onCloseFocusElement  = null,\r\n} = {})\r\n{\r\n  const isModalList = ((modalList.length > 0) && (modalBody === null));\r\n\r\n  debug.log(`showModal() - modalId: ${m.modalId + 1} - modalType: ${modalType} (${isModalList ? 'list' : 'body'}) - modalTitle: ${modalTitle}`);\r\n\r\n  initElements();\r\n  resetState();\r\n\r\n  m.onClickClose        = onClickCloseCallback;\r\n  m.onClickEntry        = onClickEntryCallback;\r\n  m.onCloseFocusElement = onCloseFocusElement;\r\n  m.clickItemsCount     = 0;\r\n\r\n  if (isModalList)\r\n    setModalList(modalList, modalType);\r\n  else\r\n    elements.body.innerHTML = modalBody;\r\n\r\n  elements.container.classList = `modal-type-${modalType}`;\r\n  elements.container.classList.add((m.clickItemsCount > 10) ? 'modal-click-items-2-columns' : 'modal-click-items-1-column');\r\n  elements.container.querySelector('.modal-dialog-title').innerHTML = modalTitle;\r\n\r\n  elements.overlay.style.backgroundColor = getOverlayOpacityCssValue();\r\n  elements.overlay.classList.add('show');\r\n  elements.overlay.addEventListener('keydown', keyDown);\r\n  elements.overlay.focus();\r\n\r\n  disablePageScrolling(true);\r\n\r\n  return ++m.modalId;\r\n}\r\n\r\nexport function isShowingModal(showingModalId = -1)\r\n{\r\n  return ((showingModalId === m.modalId) &&\r\n          (elements.container !== null)  &&\r\n          (elements.overlay.classList.contains('show')));\r\n}\r\n\r\nexport function getModalRootElement()\r\n{\r\n  return elements.container;\r\n}\r\n\r\nexport function getModalEntry(entryNum)\r\n{\r\n  return document.getElementById(`modal-item-${entryNum}`);\r\n}\r\n\r\nexport function updateModalTitle(updateModalId, updateTitle)\r\n{\r\n  if (updateModalId === m.modalId)\r\n    elements.container.querySelector('.modal-dialog-title').innerHTML = updateTitle;\r\n}\r\n\r\nexport function updateModalList(updateModalId, modalList)\r\n{\r\n  if (updateModalId === m.modalId)\r\n    setModalList(modalList);\r\n}\r\n\r\n\r\n// ************************************************************************************************\r\n//\r\n// ************************************************************************************************\r\n\r\nfunction initElements()\r\n{\r\n  if (elements.container === null)\r\n  {\r\n    document.body.insertAdjacentHTML('beforeend', getTemplateHtml());\r\n\r\n    elements.overlay   = document.getElementById('modal-dialog-overlay');\r\n    elements.container = document.getElementById('modal-dialog-container');\r\n    elements.body      = elements.container.querySelector('.modal-dialog-body');\r\n\r\n    elements.overlay.addEventListener('click', (event) =>\r\n    {\r\n      if (event.target === elements.overlay)\r\n        resetState();\r\n    });\r\n\r\n    elements.container.querySelector('.modal-dialog-close-icon').addEventListener('click', resetState);\r\n    elements.container.querySelector('.modal-dialog-close-button').addEventListener('click', resetState);\r\n  }\r\n}\r\n\r\nfunction resetState()\r\n{\r\n  if (isShowingModal(m.modalId))\r\n  {\r\n    document.body.removeEventListener('touchmove', touchMove, { passive: false });\r\n    document.body.removeEventListener('touchstart', touchStart);\r\n    elements.overlay.removeEventListener('keydown', keyDown);\r\n    elements.overlay.className = '';\r\n    disablePageScrolling(false);\r\n    m.onCloseFocusElement?.focus();\r\n  }\r\n}\r\n\r\nfunction setModalList(modalList, modalType = 'default')\r\n{\r\n  if (modalType === 'track-details')\r\n    modalList.forEach(item => (item.link && m.clickItemsCount++));\r\n\r\n  elements.body.innerHTML = getModalListHtml(modalList, m.clickItemsCount);\r\n  elements.body.addEventListener('click', modalListClick);\r\n}\r\n\r\nfunction modalListClick(event)\r\n{\r\n  const clickedEntryElement = event.target.closest('.modal-click-item');\r\n\r\n  if (clickedEntryElement && (m.onClickClose(event) === true))\r\n  {\r\n    const entryClickId = clickedEntryElement?.getAttribute('data-click-id');\r\n\r\n    resetState();\r\n\r\n    if (entryClickId)\r\n      m.onClickEntry(entryClickId, event);\r\n  }\r\n}\r\n\r\nfunction keyDown(event)\r\n{\r\n  event.stopPropagation();\r\n\r\n  if (event.key === 'Escape')\r\n    resetState();\r\n}\r\n\r\nfunction disablePageScrolling(disableScrolling)\r\n{\r\n  if (disableScrolling)\r\n  {\r\n    document.body.classList.add('scrolling-disabled');\r\n\r\n    if ('ontouchstart' in window)\r\n    {\r\n      document.body.addEventListener('touchstart', touchStart);\r\n      document.body.addEventListener('touchmove',  touchMove, { passive: false });\r\n    }\r\n  }\r\n  else\r\n  {\r\n    document.body.classList.remove('scrolling-disabled');\r\n  }\r\n}\r\n\r\nfunction touchStart(event)\r\n{\r\n  m.isOverflowY      = (elements.container.scrollHeight > elements.container.clientHeight);\r\n  m.ignoreTouchMove  = (true   === event.target.classList.contains('modal-ignore-touchmove'));\r\n  m.isTouchDraggable = ('true' === event.target.closest('.modal-draggable-entry')?.getAttribute('draggable'));\r\n}\r\n\r\nfunction touchMove(event)\r\n{\r\n  if (m.isOverflowY)\r\n    return;\r\n\r\n  if ((m.isTouchDraggable === false) || m.ignoreTouchMove)\r\n    event.preventDefault();\r\n}\r\n", "//\r\n// Snackbar UI module\r\n//\r\n// https://ultrafunk.com\r\n//\r\n\r\n\r\nimport { newDebugLogger }      from './debuglogger.js';\r\nimport { showModal }           from './modal.js';\r\nimport { settings }            from './session-data.js';\r\nimport { KEY }                 from './storage.js';\r\nimport { MATCH, matchesMedia } from './utils.js';\r\n\r\n\r\n/*************************************************************************************************/\r\n\r\n\r\nconst debug = newDebugLogger('snackbar');\r\n\r\nconst m = {\r\n  snackbarId:    0,\r\n  actionClick:   null,\r\n  afterClose:    null,\r\n  showTimeoutId: -1,\r\n  messageLog:    [],\r\n};\r\n\r\nconst template = /*html*/ `\r\n  <div id=\"snackbar\">\r\n    <div class=\"snackbar-container\">\r\n      <div class=\"snackbar-message\"></div>\r\n      <button type=\"button\" class=\"snackbar-action-text\"></button>\r\n      <button type=\"button\" class=\"snackbar-close-icon\"><span class=\"material-icons\" title=\"Dismiss\">close</span></button>\r\n    </div>\r\n  </div>\r\n`;\r\n\r\nconst elements = {\r\n  snackbar:   null,\r\n  actionText: null,\r\n  closeIcon:  null,\r\n};\r\n\r\n\r\n// ************************************************************************************************\r\n//\r\n// ************************************************************************************************\r\n\r\nexport function showSnackbar({\r\n  message = 'Snackbar Message',\r\n  duration = 5,\r\n  actionText = null,\r\n  actionClickCallback = () => {},\r\n  afterCloseCallback  = () => {},\r\n  backgroundColorCssVal = 'var(--snackbar-background-color)',\r\n} = {})\r\n{\r\n  debug.log(`showSnackbar(): ${message} (${(duration !== 0) ? `Duration: ${duration} sec.` : 'Duration: infinite'})`);\r\n\r\n  initElements();\r\n  resetState(false);\r\n\r\n  if (settings.site.snackbarMessageLog)\r\n    writeLog(message);\r\n\r\n  elements.snackbar.querySelector('.snackbar-message').innerHTML = message;\r\n  elements.snackbar.querySelector('.snackbar-container').style = `background-color: ${backgroundColorCssVal};`;\r\n  elements.snackbar.classList.add('show');\r\n  elements.actionText.style.display = 'none';\r\n  m.afterClose = afterCloseCallback;\r\n\r\n  if (actionText !== null)\r\n  {\r\n    m.actionClick = actionClickCallback;\r\n    elements.actionText.style.display = 'block';\r\n    elements.actionText.textContent   = actionText;\r\n    elements.actionText.addEventListener('click', actionTextClick);\r\n  }\r\n  else\r\n  {\r\n    // Fix edge case when actionText is hidden...\r\n    if (matchesMedia(MATCH.SITE_MAX_WIDTH_MOBILE))\r\n      elements.closeIcon.style.paddingLeft = '10px';\r\n    else\r\n      elements.closeIcon.style.paddingLeft = '20px';\r\n  }\r\n\r\n  if (duration !== 0)\r\n    m.showTimeoutId = setTimeout(() => elements.snackbar.classList.add('hide'), (duration * 1000));\r\n\r\n  return ++m.snackbarId;\r\n}\r\n\r\nexport function isShowingSnackbar()\r\n{\r\n  return ((elements.snackbar !== null)               &&\r\n          (elements.snackbar.classList.length === 1) &&\r\n           elements.snackbar.classList.contains('show'));\r\n}\r\n\r\nexport function dismissSnackbar(dismissId = 0)\r\n{\r\n  if (isShowingSnackbar())\r\n  {\r\n    if ((m.snackbarId === 0) || (m.snackbarId === dismissId))\r\n      elements.snackbar.classList.add('hide');\r\n  }\r\n}\r\n\r\n\r\n// ************************************************************************************************\r\n//\r\n// ************************************************************************************************\r\n\r\nfunction initElements()\r\n{\r\n  if (elements.snackbar === null)\r\n  {\r\n    document.body.insertAdjacentHTML('beforeend', template);\r\n\r\n    elements.snackbar   = document.getElementById('snackbar');\r\n    elements.actionText = elements.snackbar.querySelector('.snackbar-action-text');\r\n    elements.closeIcon  = elements.snackbar.querySelector('.snackbar-close-icon');\r\n\r\n    elements.snackbar.addEventListener('animationend', () =>\r\n    {\r\n      if (elements.snackbar.classList.contains('hide'))\r\n      {\r\n        resetState(true);\r\n        m.afterClose();\r\n      }\r\n    });\r\n\r\n    elements.closeIcon.addEventListener('click', () =>\r\n    {\r\n      resetState(true);\r\n      m.afterClose();\r\n    });\r\n  }\r\n}\r\n\r\nfunction actionTextClick()\r\n{\r\n  resetState(true);\r\n  m.actionClick();\r\n}\r\n\r\nfunction resetState(hideSnackbar = false)\r\n{\r\n  if (m.showTimeoutId !== -1)\r\n  {\r\n    clearTimeout(m.showTimeoutId);\r\n    m.showTimeoutId = -1;\r\n  }\r\n\r\n  if (elements.actionText !== null)\r\n    elements.actionText.removeEventListener('click', actionTextClick);\r\n\r\n  if (hideSnackbar)\r\n    elements.snackbar.className = '';\r\n}\r\n\r\n\r\n// ************************************************************************************************\r\n//\r\n// ************************************************************************************************\r\n\r\nfunction writeLog(message)\r\n{\r\n  readLog();\r\n\r\n  if (m.messageLog.length >= 15)\r\n    m.messageLog.shift();\r\n\r\n  m.messageLog.push({ timestamp: Date.now(), message: message });\r\n\r\n  localStorage.setItem(KEY.UF_MESSAGE_LOGS, JSON.stringify({ snackbarLog: m.messageLog }));\r\n}\r\n\r\nfunction readLog()\r\n{\r\n  if (m.messageLog.length === 0)\r\n  {\r\n    const messageLogs = JSON.parse(localStorage.getItem(KEY.UF_MESSAGE_LOGS));\r\n\r\n    if ((messageLogs !== null) && (messageLogs.snackbarLog !== undefined))\r\n      m.messageLog = messageLogs.snackbarLog;\r\n  }\r\n}\r\n\r\nexport function showSnackbarLog()\r\n{\r\n  readLog();\r\n\r\n  if (m.messageLog.length > 0)\r\n  {\r\n    const tableHeader = /*html*/\r\n      `<table>\r\n        <tr>\r\n          <td><b>Date</b></td>\r\n          <td class=\"spacer\"></td>\r\n          <td><b>Time</b></td>\r\n          <td class=\"spacer\"></td>\r\n          <td><b>Message</b></td>\r\n        </tr>`;\r\n\r\n    let htmlTable = tableHeader;\r\n\r\n    m.messageLog.forEach((entry) =>\r\n    {\r\n      htmlTable += /*html*/\r\n        `<tr>\r\n          <td class=\"normal-text nowrap\">${new Date(entry.timestamp).toDateString().slice(4, 10)}</td>\r\n          <td class=\"spacer\"></td>\r\n          <td class=\"normal-text nowrap\">${new Date(entry.timestamp).toTimeString().slice(0, 5)}</td>\r\n          <td class=\"spacer\"></td>\r\n          <td>${entry.message}</td>\r\n        </tr>`;\r\n    });\r\n\r\n    showModal({ modalTitle: 'Snackbar Message Log', modalBody: htmlTable + '</table>' });\r\n  }\r\n  else\r\n  {\r\n    showModal({ modalTitle: 'Snackbar Message Log', modalBody: '<p>The snackbar message log is currently empty...</p>' });\r\n  }\r\n}\r\n", "//\r\n// ElementToggle UI / Proxy base class\r\n//\r\n// https://ultrafunk.com\r\n//\r\n\r\n\r\nimport { getCssPropString } from './utils.js';\r\n\r\n\r\n/*************************************************************************************************/\r\n\r\n\r\nexport class ElementToggle\r\n{\r\n  #element      = null;\r\n  #valueElement = null;\r\n  #toggleTarget = null;\r\n  #updateTarget = null;\r\n\r\n  constructor(elementId, updateOnConstruct = true)\r\n  {\r\n    this.#element      = document.getElementById(elementId);\r\n    this.#valueElement = this.#element.querySelector('span.value');\r\n    this.#toggleTarget = this.toggle;\r\n    this.toggle        = this.toggleProxy;\r\n    this.#updateTarget = this.update;\r\n    this.update        = this.updateProxy;\r\n\r\n    this.#element.addEventListener('click', (event) =>\r\n    {\r\n      event?.preventDefault();\r\n      this.toggle(event);\r\n    });\r\n\r\n    if (updateOnConstruct)\r\n      this.update();\r\n  }\r\n\r\n  #isEnabled()            { return (this.#element.classList.contains('disabled') === false);       }\r\n  #pointerEventsEnabled() { return (getCssPropString('pointer-events', this.#element) !== 'none'); }\r\n\r\n  get element()    { return this.#element;                   }\r\n  get classList()  { return this.#element.classList;         }\r\n  set value(value) { this.#valueElement.textContent = value; }\r\n\r\n  // Placeholder method to be overriden in child class if needed\r\n  // eslint-disable-next-line no-unused-vars\r\n  toggle(event) {}\r\n\r\n  // Proxy for overridden child class method\r\n  toggleProxy(event)\r\n  {\r\n    if (this.#isEnabled() && this.#pointerEventsEnabled())\r\n    {\r\n      this.#toggleTarget(event);\r\n      this.#updateTarget(event);\r\n    }\r\n  }\r\n\r\n  // Placeholder method to be overriden in child class if needed\r\n  // eslint-disable-next-line no-unused-vars\r\n  update(event) {}\r\n\r\n  // Proxy for overridden child class method\r\n  updateProxy()\r\n  {\r\n    this.#updateTarget();\r\n  }\r\n}\r\n", "//\r\n// List playback module\r\n//\r\n// https://ultrafunk.com\r\n//\r\n\r\n\r\nimport * as playbackControls  from '../common/playback-controls.js';\r\nimport * as listControls      from './list-controls.js';\r\nimport * as playbackEvents    from '../common/playback-events.js';\r\nimport { newDebugLogger }     from '../../shared/debuglogger.js';\r\nimport { KEY }                from '../../shared/storage.js';\r\nimport { STATE }              from '../common/element-wrappers.js';\r\nimport { response, settings } from '../../shared/session-data.js';\r\nimport { initTrackSearch }    from './track-search.js';\r\nimport { playbackTimer }      from './list-playback-timer.js';\r\n\r\nimport {\r\n  eventLog as embeddedPlayersEventLog,\r\n  initEmbeddedPlayers,\r\n} from './embedded-players.js';\r\n\r\nimport {\r\n  MATCH,\r\n  matchesMedia,\r\n} from '../../shared/utils.js';\r\n\r\nimport {\r\n  showSnackbar,\r\n  dismissSnackbar,\r\n} from '../../shared/snackbar.js';\r\n\r\nimport {\r\n  TRACK_TYPE,\r\n  getDataTrackTypeFromId,\r\n} from '../common/mediaplayer.js';\r\n\r\nimport {\r\n  playerScrollTo,\r\n  autoplayNavTo,\r\n} from '../common/shared-gallery-list.js';\r\n\r\n\r\n/*************************************************************************************************/\r\n\r\n\r\nconst debug = newDebugLogger('list-playback');\r\n\r\nconst m = {\r\n  eventLog:          null,\r\n  players:           null,\r\n  autoplayData:      null,\r\n  currentTrackId:    null,\r\n  firstStatePlaying: true,\r\n  currentSnackbarId: 0,\r\n};\r\n\r\n\r\n// ************************************************************************************************\r\n//\r\n// ************************************************************************************************\r\n\r\nexport function init()\r\n{\r\n  debug.log('init()');\r\n\r\n  m.eventLog = embeddedPlayersEventLog;\r\n\r\n  listControls.init();\r\n  initTrackSearch();\r\n  setInitialTrack();\r\n  initEmbeddedPlayers(m.autoplayData, m.currentTrackId, getDataTrackTypeFromId(m.currentTrackId));\r\n}\r\n\r\nfunction setInitialTrack()\r\n{\r\n  m.currentTrackId = listControls.getNextPlayableId();\r\n  m.autoplayData   = JSON.parse(sessionStorage.getItem(KEY.UF_AUTOPLAY));\r\n  sessionStorage.removeItem(KEY.UF_AUTOPLAY);\r\n\r\n  if ((m.autoplayData !== null) && (m.autoplayData.trackId !== null))\r\n  {\r\n    const trackElement = listControls.queryTrack(`[data-track-id=\"${m.autoplayData.trackId}\"]`);\r\n\r\n    if (trackElement !== null)\r\n      m.currentTrackId = trackElement.id;\r\n    else\r\n      showSnackbar({ message: 'Unable to cue track (not found)', duration: 5 });\r\n  }\r\n\r\n  listControls.setInitialTrack(m.currentTrackId);\r\n\r\n  const trackTypeString = debug.getKeyForValue(TRACK_TYPE, getDataTrackTypeFromId(m.currentTrackId));\r\n  debug.log(`setInitialTrack() - trackType: ${trackTypeString} - currentTrackId: ${m.currentTrackId} - autoplayData: ${(m.autoplayData !== null) ? JSON.stringify(m.autoplayData) : 'N/A'}`);\r\n}\r\n\r\n\r\n// ************************************************************************************************\r\n//\r\n// ************************************************************************************************\r\n\r\nexport function setCurrentTrack(nextTrackId, playTrack = true, isPointerClick = false)\r\n{\r\n  const nextTrackType = getDataTrackTypeFromId(nextTrackId);\r\n\r\n  debug.log(`setCurrentTrack() - nextTrackType: ${debug.getKeyForValue(TRACK_TYPE, nextTrackType)} - nextTrackId: ${nextTrackId} - playTrack: ${playTrack} - isPointerClick: ${isPointerClick}`);\r\n\r\n  if (nextTrackId === m.currentTrackId)\r\n  {\r\n    togglePlayPause();\r\n  }\r\n  else\r\n  {\r\n    if (playbackControls.isPlaying() && (m.players.current.getTrackType() !== nextTrackType))\r\n      m.players.current.stop();\r\n\r\n    m.currentTrackId = nextTrackId;\r\n\r\n    if (m.players.current.getTrackType() !== nextTrackType)\r\n    {\r\n      m.players.setCurrentPlayer(nextTrackType);\r\n      listControls.showTrackTypePlayer(nextTrackType);\r\n    }\r\n\r\n    playbackEvents.dispatch(playbackEvents.EVENT.MEDIA_CUE_TRACK, { trackId: nextTrackId, isPointerClick: isPointerClick });\r\n    cueOrPlayCurrentTrack(playTrack);\r\n  }\r\n}\r\n\r\nasync function cueOrPlayCurrentTrack(playTrack, positionSeconds = 0)\r\n{\r\n  const trackUid = listControls.getCurrentTrackElement().getAttribute('data-track-source-uid');\r\n\r\n  debug.log(`cueOrPlayCurrentTrack() - trackId: ${m.currentTrackId} (trackUid = \"${trackUid}\") - playTrack: ${playTrack} - position: ${positionSeconds}`);\r\n\r\n  listControls.updateTrackDetails(m.players.current);\r\n  playbackControls.updateTrackData(positionSeconds);\r\n\r\n  m.players.current.resetState();\r\n\r\n  if (playTrack)\r\n  {\r\n    if (await m.players.current.playTrackById(trackUid, positionSeconds))\r\n      listControls.setCurrentTrackState(STATE.PLAYING, true);\r\n  }\r\n  else\r\n  {\r\n    if (await m.players.current.cueTrackById(trackUid, positionSeconds))\r\n      listControls.setCurrentTrackState(STATE.PAUSED, true);\r\n\r\n    if (positionSeconds !== 0)\r\n      playbackControls.updateTimerAndProgress((positionSeconds * 1000), positionSeconds, m.players.current.getDuration());\r\n  }\r\n}\r\n\r\n\r\n// ************************************************************************************************\r\n//\r\n// ************************************************************************************************\r\n\r\nexport function play()\r\n{\r\n  m.players.current.play();\r\n}\r\n\r\nexport function pause()\r\n{\r\n  m.players.current.pause();\r\n}\r\n\r\nexport function togglePlayPause()\r\n{\r\n  if (m.currentTrackId === null)\r\n    setCurrentTrack(listControls.queryTrack('div.track-entry.current').id);\r\n  else\r\n    playbackControls.isPlaying() ? pause() : play();\r\n}\r\n\r\nexport function setVolume()\r\n{\r\n  m.players.current.setVolume(settings.playback.masterVolume);\r\n}\r\n\r\nexport function toggleMute()\r\n{\r\n  settings.playback.masterMute = (settings.playback.masterMute === true) ? false : true;\r\n  settings.playback.masterMute ? m.players.current.mute() : m.players.current.unMute();\r\n}\r\n\r\nexport function prevTrack()\r\n{\r\n  const prevTrackId = listControls.getPrevPlayableId();\r\n\r\n  m.players.current.getPosition((position) =>\r\n  {\r\n    if ((prevTrackId !== null) && (position <= 5))\r\n    {\r\n      setCurrentTrack(prevTrackId, playbackControls.isPlaying());\r\n    }\r\n    else if (position !== 0)\r\n    {\r\n      m.players.current.seekTo(0);\r\n      playbackControls.updateTimerAndProgress(0, 0, m.players.current.getDuration());\r\n    }\r\n  });\r\n}\r\n\r\nexport function nextTrack()\r\n{\r\n  const nextTrackId = listControls.getNextPlayableId();\r\n\r\n  if (nextTrackId !== null)\r\n    setCurrentTrack(nextTrackId, playbackControls.isPlaying());\r\n}\r\n\r\nexport async function advanceToNextTrack(autoplay = false, isPlaybackError = false)\r\n{\r\n  const repeatMode  = isPlaybackError ? playbackControls.REPEAT.OFF : playbackControls.getRepeatMode();\r\n  const nextTrackId = listControls.getNextPlayableId();\r\n\r\n  debug.log(`advanceToNextTrack() - autoplay: ${autoplay} - isPlaybackError: ${isPlaybackError} - nextTrackId: ${nextTrackId} - repeatMode: ${debug.getKeyForValue(playbackControls.REPEAT, repeatMode)}`);\r\n\r\n  if (autoplay && (repeatMode === playbackControls.REPEAT.ONE))\r\n  {\r\n    m.players.current.seekTo(0);\r\n    m.players.current.play();\r\n  }\r\n  else if (autoplay && (nextTrackId === null) && (repeatMode === playbackControls.REPEAT.ALL))\r\n  {\r\n    setCurrentTrack(listControls.getNextPlayableId(null)); // getNextPlayableId(null) means the nextTrackId will come from the top of the playlist\r\n    playerScrollTo(0);\r\n  }\r\n  else\r\n  {\r\n    if (nextTrackId === null)\r\n    {\r\n      if (settings.list.showLoadMoreTracks)\r\n      {\r\n        const tracksLoaded = await listControls.loadMoreTracks();\r\n\r\n        if (autoplay && tracksLoaded)\r\n          setCurrentTrack(listControls.getNextPlayableId());\r\n      }\r\n      else\r\n      {\r\n        autoplayNavTo(response.nextPage, autoplay);\r\n      }\r\n    }\r\n    else\r\n    {\r\n      autoplay ? setCurrentTrack(nextTrackId) : listControls.setCurrentTrackState(STATE.PAUSED);\r\n    }\r\n  }\r\n}\r\n\r\nexport function skipToNextTrack()\r\n{\r\n  if (playbackControls.isPlaying() === false)\r\n  {\r\n    m.eventLog.add(m.eventLog.SOURCE.ULTRAFUNK, m.eventLog.EVENT.RESUME_AUTOPLAY);\r\n    advanceToNextTrack(true, true);\r\n  }\r\n}\r\n\r\nexport function stopSkipToNextTrack()\r\n{\r\n  m.currentTrackId = null;\r\n  listControls.setCurrentTrackState(STATE.PAUSED);\r\n}\r\n\r\nexport function getStatus(getCurrentTrackNum = false)\r\n{\r\n  let currentTrackElement = null;\r\n\r\n  (m.currentTrackId !== null)\r\n    ? currentTrackElement = listControls.queryTrackId(m.currentTrackId)\r\n    : currentTrackElement = listControls.queryTrack('div.track-entry.current');\r\n\r\n  if (currentTrackElement !== null)\r\n  {\r\n    let currentTrackIndex = 0;\r\n\r\n    if (getCurrentTrackNum)\r\n    {\r\n      const allTracksList = listControls.queryTrackAll('div.track-entry');\r\n      currentTrackIndex = Array.prototype.indexOf.call(allTracksList, currentTrackElement);\r\n      debug.log(`getStatus() - currentTrackNum: ${currentTrackIndex + 1} - trackId: ${currentTrackElement.getAttribute('data-track-id')}`);\r\n    }\r\n\r\n    const playerElementIds = [ '', 'youtube-player', 'soundcloud-player', 'local-player' ];\r\n\r\n    const status = {\r\n      isPlaying:      playbackControls.isPlaying(),\r\n      currentTrack:   (currentTrackIndex + 1),\r\n      trackType:      m.players.current.getTrackType(),\r\n      position:       0,\r\n      numTracks:      1,\r\n      trackId:        currentTrackElement.getAttribute('data-track-id'),\r\n      trackElementId: currentTrackElement.id,\r\n      playerId:       playerElementIds[m.players.current.getTrackType()],\r\n    };\r\n\r\n    if (getCurrentTrackNum)\r\n    {\r\n      return new Promise((resolve) =>\r\n      {\r\n        m.players.current.getPosition((positionSeconds) =>\r\n        {\r\n          status.position = Math.round(positionSeconds);\r\n          resolve(status);\r\n        });\r\n      });\r\n    }\r\n\r\n    return status;\r\n  }\r\n\r\n  return { isPlaying: false, currentTrack: 1, position: 0, trackId: 0 };\r\n}\r\n\r\n\r\n// ************************************************************************************************\r\n//\r\n// ************************************************************************************************\r\n\r\nexport function onEmbeddedPlayersReady(players, initialTrackType)\r\n{\r\n  debug.log(`onEmbeddedPlayersReady(): ${debug.getKeyForValue(TRACK_TYPE, initialTrackType)}`);\r\n\r\n  m.players = players;\r\n\r\n  playbackEvents.addListener(playbackEvents.EVENT.MEDIA_PLAYING,     onMediaPlaying);\r\n  playbackEvents.addListener(playbackEvents.EVENT.MEDIA_ENDED,       () => advanceToNextTrack(settings.playback.autoplay));\r\n  playbackEvents.addListener(playbackEvents.EVENT.MEDIA_UNAVAILABLE, onMediaUnavailable);\r\n  playbackEvents.addListener(playbackEvents.EVENT.AUTOPLAY_BLOCKED,  onAutoplayBlocked);\r\n\r\n  playbackControls.ready(prevTrack, togglePlayPause, nextTrack, toggleMute);\r\n  playbackEvents.dispatch(playbackEvents.EVENT.PLAYBACK_LOADING, { loadingPercent: 66 });\r\n\r\n  playbackTimer.ready(m.players);\r\n  listControls.ready();\r\n\r\n  m.players.setCurrentPlayer(initialTrackType);\r\n  listControls.showTrackTypePlayer(initialTrackType);\r\n\r\n  playbackEvents.dispatch(playbackEvents.EVENT.PLAYBACK_READY, { resetProgressBar: false });\r\n  cueOrPlayCurrentTrack((m.autoplayData?.autoplay === true), (m.autoplayData?.position ?? 0));\r\n}\r\n\r\nfunction onMediaPlaying()\r\n{\r\n  dismissSnackbar(m.currentSnackbarId);\r\n\r\n  if (m.firstStatePlaying)\r\n  {\r\n    m.firstStatePlaying = false;\r\n\r\n    setTimeout(() =>\r\n    {\r\n      if (settings.playback.autoplay        &&\r\n          playbackControls.isPlaying()      &&\r\n          (Math.round(window.scrollY) <= 1) &&\r\n          matchesMedia(MATCH.SITE_MAX_WIDTH_MOBILE))\r\n      {\r\n        playerScrollTo(0);\r\n      }\r\n    },\r\n    6000);\r\n  }\r\n}\r\n\r\nfunction onMediaUnavailable()\r\n{\r\n  if (m.players.current.isCued() === false)\r\n  {\r\n    playbackControls.updateProgressPercent(0);\r\n    listControls.setTrackMessage('Error!');\r\n\r\n    showSnackbar({\r\n      message: 'Unable to play track, skipping to next',\r\n      duration: 5,\r\n      actionText: 'Stop',\r\n      actionClickCallback: stopSkipToNextTrack,\r\n      afterCloseCallback:  skipToNextTrack,\r\n    });\r\n  }\r\n}\r\n\r\nfunction onAutoplayBlocked()\r\n{\r\n  listControls.setCurrentTrackState(STATE.PAUSED);\r\n\r\n  m.currentSnackbarId = showSnackbar({\r\n    message: 'Autoplay blocked, Play to continue',\r\n    duration: 0,\r\n    actionText: 'play',\r\n    actionClickCallback: () => play(),\r\n  });\r\n}\r\n", "//\r\n// HTML Element clicked parent class\r\n//\r\n// https://ultrafunk.com\r\n//\r\n\r\n\r\nimport {\r\n  addListener,\r\n  addListenerAll,\r\n} from './utils.js';\r\n\r\n\r\n/*************************************************************************************************/\r\n\r\n\r\nexport class ElementClick\r\n{\r\n  #event   = null;\r\n  #element = null;\r\n\r\n  constructor(selectors, addToAllMatching = false)\r\n  {\r\n    if (addToAllMatching)\r\n      addListenerAll(selectors, 'click', (event) => this.#clickHandler(event));\r\n    else\r\n      addListener(selectors, 'click', (event) => this.#clickHandler(event));\r\n  }\r\n\r\n  #clickHandler(event)\r\n  {\r\n    this.#event = event;\r\n    this.elementClicked();\r\n  }\r\n\r\n  get element() { return this.#element; }\r\n  get event()   { return this.#event;   }\r\n\r\n  // Placeholder method to be overriden in child class if needed\r\n  elementClicked() {}\r\n\r\n  clicked(selector)\r\n  {\r\n    this.#element = this.#event.target.closest(selector);\r\n\r\n    if (this.#element !== null)\r\n    {\r\n      this.#event.stopImmediatePropagation();\r\n      return true;\r\n    }\r\n\r\n    return false;\r\n  }\r\n\r\n  closest(selector)\r\n  {\r\n    return this.#element.closest(selector);\r\n  }\r\n\r\n  querySelector(selector)\r\n  {\r\n    return this.#element.querySelector(selector);\r\n  }\r\n}\r\n", "//\r\n// HTMLElement convenience wrapper objects\r\n//\r\n// https://ultrafunk.com\r\n//\r\n\r\n\r\nimport { replaceClass } from '../../shared/utils.js';\r\n\r\n\r\n/*************************************************************************************************/\r\n\r\n\r\nexport const STATE = {\r\n  UNKNOWN:  { ID:  0, CLASS: 'state-unknown'  },\r\n  HIDDEN:   { ID: 10, CLASS: 'state-hidden'   },\r\n  DISABLED: { ID: 20, CLASS: 'state-disabled' },\r\n  ENABLED:  { ID: 30, CLASS: 'state-enabled'  },\r\n  PLAYING:  { ID: 40, CLASS: 'state-playing'  },\r\n  PAUSED:   { ID: 50, CLASS: 'state-paused'   },\r\n  LOADING:  { ID: 60, CLASS: 'state-loading'  },\r\n};\r\n\r\n\r\n// ************************************************************************************************\r\n//\r\n// ************************************************************************************************\r\n\r\nexport const ElementWrapper = function(elmentSelector, parentElement = document, initialState = STATE.DISABLED)\r\n{\r\n  const element   = parentElement.querySelector(elmentSelector);\r\n  let   state     = initialState;\r\n  const classList = element.classList;\r\n\r\n  return {\r\n    get element() { return element;       },\r\n    get state()   { return state;         },\r\n    get style()   { return element.style; },\r\n\r\n    getElement(selector)         { return element.querySelector(selector);    },\r\n    addListener(event, listener) { element.addEventListener(event, listener); },\r\n\r\n    addClass(...cssClass)     { classList.add(...cssClass);         },\r\n    removeClass(...cssClass)  { classList.remove(...cssClass);      },\r\n    replaceClass(remove, add) { replaceClass(element, remove, add); },\r\n    toggleClass(cssClass)     { classList.toggle(cssClass);         },\r\n\r\n    getAttribute(attribute)        { return element.getAttribute(attribute); },\r\n    setAttribute(attribute, value) { element.setAttribute(attribute, value); },\r\n\r\n    setState,\r\n  };\r\n\r\n  function setState(newState = STATE.DISABLED)\r\n  {\r\n    // Only update classList and state if they have actually changed...\r\n    if (state.ID !== newState.ID)\r\n    {\r\n      classList.remove(state.CLASS);\r\n      classList.add(newState.CLASS);\r\n      state = newState;\r\n\r\n      return true;\r\n    }\r\n\r\n    return false;\r\n  }\r\n};\r\n\r\nexport const ElementsWrapper = function(elmentsSelector, parentElement = document)\r\n{\r\n  const elements = parentElement.querySelectorAll(elmentsSelector);\r\n\r\n  return {\r\n    get length()      { return elements.length;     },\r\n    forEach(callback) { elements.forEach(callback); },\r\n  };\r\n};\r\n", "//\r\n// JavaScript async fetch() wrapper with timeout and better result data + details\r\n//\r\n// https://ultrafunk.com\r\n//\r\n\r\n\r\nimport { newDebugLogger } from './debuglogger.js';\r\n\r\n\r\n/*************************************************************************************************/\r\n\r\n\r\nconst debug = newDebugLogger('fetch-rest');\r\n\r\nexport const HTTP_RESPONSE = {\r\n  OK: 200,\r\n};\r\n\r\nexport const FETCH_ERROR = {\r\n  UNKNOWN: 0,\r\n  NETWORK: 1,\r\n  TIMEOUT: 2,\r\n};\r\n\r\n\r\n// ************************************************************************************************\r\n//\r\n// ************************************************************************************************\r\n\r\nexport function fetchRest({\r\n  path     = '/wp-json/wp/v2/',\r\n  endpoint = null,\r\n  id       = null,\r\n  query    = null,\r\n  timeoutSeconds = 10,\r\n} = {})\r\n{\r\n  let restRequest = path;\r\n\r\n  if ((endpoint !== null) && (id !== null))\r\n    restRequest += `${endpoint}/${parseInt(id)}`;\r\n  else if (endpoint !== null)\r\n    restRequest += endpoint;\r\n\r\n  if (query !== null)\r\n    restRequest += `?${query}`;\r\n\r\n  debug.log(`\"${restRequest}\" - timeout: ${timeoutSeconds} sec.`);\r\n\r\n  const controller = new AbortController();\r\n  setTimeout(() => controller.abort(), (timeoutSeconds * 1000));\r\n\r\n  return fetch(restRequest, { signal: controller.signal })\r\n  .then(async (response) =>\r\n  {\r\n    if (!response.ok)\r\n    {\r\n      debug.warn(response);\r\n      return { status: { code: response.status, details: await response.json() }, data: [] };\r\n    }\r\n\r\n    return { status: { code: response.status }, data: await response.json() };\r\n  })\r\n  .catch(exception =>\r\n  {\r\n    debug.error(exception);\r\n    return { status: { code: 0, errorType: getFetchErrorType(exception), errorMessage: exception.message }, data: [] };\r\n  });\r\n}\r\n\r\nfunction getFetchErrorType(error)\r\n{\r\n  if (error instanceof TypeError)\r\n    return FETCH_ERROR.NETWORK;\r\n\r\n  if (error instanceof DOMException)\r\n    return FETCH_ERROR.TIMEOUT;\r\n\r\n  return FETCH_ERROR.UNKNOWN;\r\n}\r\n", "//\r\n// List player track template functions\r\n//\r\n// https://ultrafunk.com\r\n//\r\n\r\n\r\nimport { THEME_ENV } from '../../config.js';\r\n\r\nimport {\r\n  TRACK_TYPE,\r\n  getThumbnailData,\r\n} from '../common/mediaplayer.js';\r\n\r\nimport {\r\n  getTimeString,\r\n  getListPlayerUrl,\r\n  escHtml,\r\n} from '../../shared/utils.js';\r\n\r\n\r\n// ************************************************************************************************\r\n//\r\n// ************************************************************************************************\r\n\r\nexport function getPageSeparatorHtml(responseData, loadingPage)\r\n{\r\n  const pageUrl = responseData.nextPage.replace(/\\/page\\/(?!0)\\d{1,6}\\//i, `/page/${loadingPage}/`);\r\n\r\n  return /*html*/ `\r\n    <div id=\"tracklist-page-${loadingPage}\" class=\"tracklist-page-separator\" data-page-number=\"${loadingPage}\">\r\n      <button type=\"button\" class=\"material-icons arrow-down-button\" title=\"Scroll to next page\">arrow_downward</button>\r\n      <button type=\"button\" class=\"material-icons arrow-last-button\" title=\"Scroll to Last Track\">vertical_align_bottom</button>\r\n      <a href=\"${pageUrl}\" title=\"Go to page ${loadingPage}\">Page ${loadingPage} &#9660;</a>\r\n      <button type=\"button\" class=\"material-icons arrow-first-button\" title=\"Scroll to First Track\">vertical_align_top</button>\r\n      <button type=\"button\" class=\"material-icons arrow-up-button\" title=\"Scroll to previous page\">arrow_upward</button>\r\n    </div>`;\r\n}\r\n\r\nexport function getTrackEntryHtml(track, density = 'default')\r\n{\r\n  const thumbnailData     = getThumbnailData(track.meta);\r\n  const trackArtist       = escHtml(track.meta.track_artist);\r\n  const trackTitle        = escHtml(track.meta.track_title);\r\n  const trackDuration     = parseInt(track.meta.track_duration);\r\n  const isAudioVideoClass = track.channels.includes(THEME_ENV.channelVideosId) ? 'is-video' : 'is-audio';\r\n\r\n  return /*html*/ `\r\n    <div id=\"${track.uid}\" class=\"track-entry ${density}-density ${thumbnailData.class} ${isAudioVideoClass}\"\r\n      data-track-type=\"${track.meta.track_source_type}\"\r\n      data-track-id=\"track-${track.id}\"\r\n      data-track-artist=\"${trackArtist}\"\r\n      data-track-title=\"${trackTitle}\"\r\n      data-track-duration=\"${trackDuration}\"\r\n      data-track-url=\"${track.link}\"\r\n      data-track-thumbnail-url=\"${thumbnailData.src}\"\r\n      data-track-source-uid =\"${thumbnailData.uid}\"\r\n      >\r\n      <div class=\"track-artists-links\" data-track-artist-ids=\"${track.artists.toString()}\">${track.artists_links  ?? ''}</div>\r\n      <div class=\"track-channels-links\" data-track-channel-ids=\"${track.channels.toString()}\">${track.channels_links ?? ''}</div>\r\n      <div class=\"track-details\">\r\n        <button type=\"button\" class=\"thumbnail\" title=\"Play Track\">\r\n          <div class=\"thumbnail-overlay\"><div class=\"spinner\"></div></div>\r\n          <img src=\"${thumbnailData.src}\" alt=\"\">\r\n        </button>\r\n        <div class=\"artist-title text-nowrap-ellipsis\"><span><b>${trackArtist}</b></span><br><span>${trackTitle}</span></div>\r\n      </div>\r\n      <div class=\"track-actions\">\r\n        <div class=\"track-message\"></div>\r\n        <div class=\"track-action-buttons\">\r\n          <button type=\"button\" class=\"remove-button\" title=\"Remove Track from List\"><span class=\"material-icons\">close</span></button>\r\n          <button type=\"button\" class=\"play-next-button\" title=\"Play Next\"><span class=\"material-icons\">playlist_play</span></button>\r\n          <button type=\"button\" class=\"share-play-button\" title=\"Share Track / Play On\"><span class=\"material-icons\">share</span></button>\r\n          <button type=\"button\" class=\"details-button\" title=\"Track Details\"><span class=\"material-icons-outlined\">info</span></button>\r\n        </div>\r\n        <button type=\"button\" class=\"track-actions-toggle\" title=\"Show / Hide track actions\"><span class=\"material-icons\">more_horiz</span></button>\r\n      </div>\r\n      <div class=\"track-duration text-nowrap-ellipsis\" title=\"Track duration\">${((track.meta.track_source_type === TRACK_TYPE.YOUTUBE) ? getTimeString(trackDuration) : 'N / A')}</div>\r\n    </div>`;\r\n}\r\n\r\nexport function setTrackMeta(\r\n  trackData,\r\n  trackLinksSelector,\r\n  linkIdsAttribute,\r\n  linksMap,\r\n)\r\n{\r\n  trackData.forEach(track =>\r\n  {\r\n    const linksElement = document.getElementById(track.uid).querySelector(trackLinksSelector);\r\n    const linkIds      = linksElement.getAttribute(linkIdsAttribute)?.split(',');\r\n    let   linksHtml    = '';\r\n\r\n    linkIds?.forEach(linkId =>\r\n    {\r\n      const mapKey    = parseInt(linkId);\r\n      const linkClass = (track.meta.track_artist_id === mapKey) ? 'primary' : 'secondary';\r\n      linksHtml      +=`<a class=\"${linkClass}\" href=\"${getListPlayerUrl(linksMap.get(mapKey).link)}\">${linksMap.get(mapKey).name}</a>`;\r\n    });\r\n\r\n    linksElement.insertAdjacentHTML('afterbegin', linksHtml);\r\n  });\r\n}\r\n", "//\r\n// List player tracks REST data fetch and caching\r\n//\r\n// https://ultrafunk.com\r\n//\r\n\r\n\r\nimport { newDebugLogger } from '../../shared/debuglogger.js';\r\n\r\nimport {\r\n  HTTP_RESPONSE,\r\n  fetchRest,\r\n} from '../../shared/fetch-rest.js';\r\n\r\nimport {\r\n  response as responseData\r\n} from '../../shared/session-data.js';\r\n\r\nimport {\r\n  getPageSeparatorHtml,\r\n  getTrackEntryHtml,\r\n  setTrackMeta,\r\n} from './list-track-templates.js';\r\n\r\n\r\n/*************************************************************************************************/\r\n\r\n\r\nconst debug = newDebugLogger('list-tracks-rest');\r\n\r\nconst m = {\r\n  artistsCache:  new Map(),\r\n  channelsCache: new Map(),\r\n};\r\n\r\n\r\n// ************************************************************************************************\r\n//\r\n// ************************************************************************************************\r\n\r\nexport async function loadTracks(termType, termId)\r\n{\r\n  const loadingPage  = parseInt(responseData.currentPage + 1);\r\n  const restResponse = await fetchTracks(termType, termId, loadingPage, parseInt(responseData.listPerPage));\r\n\r\n  if (restResponse.status.code === HTTP_RESPONSE.OK)\r\n  {\r\n    const trackData  = restResponse.data;\r\n    const artistIds  = new Set();\r\n    const channelIds = new Set();\r\n    let tracksHtml   = getPageSeparatorHtml(responseData, loadingPage);\r\n\r\n    trackData.forEach((track, index) =>\r\n    {\r\n      track.artists.forEach(key => (m.artistsCache.has(key) === false) && artistIds.add(key));\r\n      track.channels.forEach(key => (m.channelsCache.has(key) === false) && channelIds.add(key));\r\n      track.uid = `track-${(Date.now() + index)}`;\r\n      tracksHtml += getTrackEntryHtml(track);\r\n    });\r\n\r\n    document.getElementById('tracklist-load-more-button').insertAdjacentHTML('beforebegin', tracksHtml);\r\n\r\n    debug.log(`Fetching: ${artistIds.size} artists (${m.artistsCache.size} cached) - Fetching: ${channelIds.size} channels (${m.channelsCache.size} cached)`);\r\n\r\n    let artistsPromise  = null;\r\n    let channelsPromise = null;\r\n\r\n    if (artistIds.size > 0)\r\n      artistsPromise = fetchTerms('artists',  [...artistIds], 100);\r\n\r\n    if (channelIds.size > 0)\r\n      channelsPromise = fetchTerms('channels', [...channelIds], 100);\r\n\r\n    const [artistsRestResponse, channelsRestResponse] = await Promise.all([artistsPromise, channelsPromise]);\r\n\r\n    if ((artistsRestResponse !== null) && (artistsRestResponse.status.code === HTTP_RESPONSE.OK))\r\n      artistsRestResponse.data.forEach(entry => m.artistsCache.set(entry.id, { name: entry.name, link: entry.link }));\r\n\r\n    if ((channelsRestResponse !== null) && (channelsRestResponse.status.code === HTTP_RESPONSE.OK))\r\n      channelsRestResponse.data.forEach(entry => m.channelsCache.set(entry.id, { name: entry.name, link: entry.link }));\r\n\r\n    setTrackMeta(trackData, '.track-artists-links',  'data-track-artist-ids',  m.artistsCache);\r\n    setTrackMeta(trackData, '.track-channels-links', 'data-track-channel-ids', m.channelsCache);\r\n\r\n    return true;\r\n  }\r\n\r\n  return false;\r\n}\r\n\r\n\r\n// ************************************************************************************************\r\n// Fetch tracks + terms\r\n// ************************************************************************************************\r\n\r\nfunction fetchTracks(termType = '', termId = '', page = 1, tracksPerPage = 25)\r\n{\r\n  debug.log(`fetchTracks() - termType: ${(termType.length === 0) ? 'N/A' : termType} - termId: ${(termId.length === 0) ? 'N/A' : termId} - page: ${page} - tracksPerPage: ${tracksPerPage}`);\r\n\r\n  let params       = '';\r\n  const pagination = `page=${page}&per_page=${tracksPerPage}`;\r\n  const fields     = '&_fields=id,link,artists,channels,meta';\r\n\r\n  if ((responseData.get.list_player === 'channel') || (responseData.get.list_player === 'artist'))\r\n    params = getTermQueryParams(termType, termId);\r\n  else if (responseData.get.list_player === 'shuffle')\r\n    params = getShuffleQueryParams();\r\n  else if (responseData.get.list_player === 'search')\r\n    params = getSearchQueryParams();\r\n\r\n  return fetchRest({\r\n    endpoint: 'tracks',\r\n    query:    `${params}${pagination}${fields}`\r\n  });\r\n}\r\n\r\nfunction fetchTerms(termType, termIds, maxItems = 50)\r\n{\r\n  return fetchRest({\r\n    endpoint: termType,\r\n    query:    `include=${termIds}&per_page=${maxItems}&_fields=id,link,name`\r\n  });\r\n}\r\n\r\nfunction getTermQueryParams(termType, termId)\r\n{\r\n  if ((termType.length !== 0) && (termId.length !== 0))\r\n  {\r\n    let termParams = `${termType}=${parseInt(termId)}&`;\r\n\r\n    if (responseData.filter?.taxonomy && responseData.filter?.taxonomy_id)\r\n      termParams += `tax_relation=AND&${responseData.filter.taxonomy}=${responseData.filter.taxonomy_id}&`;\r\n\r\n    return termParams;\r\n  }\r\n\r\n  return '';\r\n}\r\n\r\nfunction getShuffleQueryParams()\r\n{\r\n  let shuffleParams = `shuffle=true&shuffle_type=${responseData.get.shuffle_type}&`;\r\n\r\n  if (responseData.get.shuffle_slug !== null)\r\n    shuffleParams += `shuffle_slug=${responseData.get.shuffle_slug}&`;\r\n\r\n  return shuffleParams;\r\n}\r\n\r\n//\r\n// ToDo: wpessid=4021;\r\n//\r\nfunction getSearchQueryParams()\r\n{\r\n  let searchString   = '';\r\n  const searchParams = new URLSearchParams(window.location.search);\r\n\r\n  if (searchParams.has('s'))\r\n  {\r\n    searchString = searchParams.get('s').replaceAll(\"'\", \" \");                                    // Replace ' with space for better term search results...\r\n    searchString = encodeURIComponent(searchString).replaceAll(/(?<!%20)%26(?!%20)/g, '%26amp;'); // Encode %26 (&) without any spaces (%20) as %26amp; for better term search results...\r\n  }\r\n\r\n  return `search=${searchString}&orderby=relevance&wpessid=true&`;\r\n}\r\n", "//\r\n// Clipboard handling module\r\n//\r\n// https://ultrafunk.com\r\n//\r\n\r\n\r\nimport { newDebugLogger } from './debuglogger.js';\r\nimport { showModal }      from './modal.js';\r\nimport { showSnackbar }   from './snackbar.js';\r\n\r\n\r\n/*************************************************************************************************/\r\n\r\n\r\nconst debug = newDebugLogger('clipboard');\r\n\r\n\r\n// ************************************************************************************************\r\n// Exports\r\n// ************************************************************************************************\r\n\r\nexport function copyTextToClipboard(clipboardText, contentDescription = 'Content')\r\n{\r\n  if (navigator.clipboard && hasClipboardWritePermission())\r\n  {\r\n    navigator.clipboard.writeText(clipboardText).then(() =>\r\n    {\r\n      debug.log(`copyTextToClipboard() success for: ${clipboardText} - type: ${contentDescription}`);\r\n      showSnackbar({ message: `${contentDescription} copied to clipboard`, duration: 3 });\r\n    },\r\n    (reason) =>\r\n    {\r\n      onClipboardWriteError(reason, clipboardText, contentDescription);\r\n    });\r\n  }\r\n  else\r\n  {\r\n    // Handle navigator.clipboard not properly supported on WebKit / Safari yet...\r\n    if (copyTextToClipboardExecCommand(clipboardText))\r\n    {\r\n      debug.log(`copyTextToClipboardExecCommand() success for: ${clipboardText} - type: ${contentDescription}`);\r\n      showSnackbar({ message: `${contentDescription} copied to clipboard`, duration: 3 });\r\n    }\r\n    else\r\n    {\r\n      onClipboardWriteError(`document.execCommand('copy') for \"${clipboardText}\" failed!`, clipboardText, contentDescription);\r\n    }\r\n  }\r\n}\r\n\r\n\r\n// ************************************************************************************************\r\n// Internals\r\n// ************************************************************************************************\r\n\r\nfunction hasClipboardWritePermission()\r\n{\r\n  try\r\n  {\r\n    if (navigator.permissions.query)\r\n      return true;\r\n  }\r\n  catch(exception)\r\n  {\r\n    debug.log(`hasClipboardWritePermission(): ${exception}`);\r\n  }\r\n\r\n  return false;\r\n}\r\n\r\nfunction copyTextToClipboardExecCommand(clipboardText)\r\n{\r\n  const element = document.createElement('textarea');\r\n\r\n  document.body.appendChild(element);\r\n  element.textContent = clipboardText;\r\n  element.select();\r\n  const isCopied = document.execCommand('copy');\r\n  document.body.removeChild(element);\r\n\r\n  return isCopied;\r\n}\r\n\r\nfunction onClipboardWriteError(logError, clipboardText, contentDescription)\r\n{\r\n  debug.error(`copyTextToClipboard() error: ${logError}`);\r\n\r\n  const modalBodyHtml = /*html*/ `\r\n    <style>\r\n      .modal-dialog-body p.modal-clipboard-content {\r\n        padding: 10px 15px;\r\n        border-radius: var(--dialog-border-radius);\r\n        background-color: var(--list-row-odd-color);\r\n      }\r\n    </style>\r\n    <p class=\"modal-clipboard-error\">Failed to write ${contentDescription} to the clipboard, please copy the text below:</p>\r\n    <p class=\"modal-clipboard-content\">${clipboardText}</p>`;\r\n\r\n  showModal({ modalTitle: 'Copy to Clipboard error!', modalBody: modalBodyHtml });\r\n}\r\n\r\n/*\r\n\r\n//const canWriteToClipboard = await hasClipboardWritePermission();\r\n\r\nasync function hasClipboardWritePermission()\r\n{\r\n  try\r\n  {\r\n    return navigator.permissions.query({ name: 'clipboard-write' })\r\n    .then(async (result) =>\r\n    {\r\n      return (result.state === 'granted');\r\n    })\r\n    .catch((exception) =>\r\n    {\r\n      debug.log(`hasClipboardWritePermission(): ${exception}`);\r\n      return false;\r\n    });\r\n  }\r\n  catch(exception)\r\n  {\r\n    debug.log(`hasClipboardWritePermission(): ${exception}`);\r\n  }\r\n\r\n  return false;\r\n}\r\n*/\r\n", "//\r\n// Share modal\r\n//\r\n// https://ultrafunk.com\r\n//\r\n\r\n\r\nimport { showModal }           from './modal.js';\r\nimport { TRACK_TYPE }          from '../playback/common/mediaplayer.js';\r\nimport { copyTextToClipboard } from './clipboard.js';\r\n\r\n\r\n// ************************************************************************************************\r\n// Share Modal Dialog closure\r\n// ************************************************************************************************\r\n\r\nconst shareModalClosure = (() =>\r\n{\r\n  const filterBodyTextRegEx = /\\s{1,}[\\u002D\\u00B7\\u2013]\\s{1,}/i;\r\n  let title, bodyText, filterBodyText, bodyHtml, url, urlType, trackType, trackSourceUid, verb, icon, onCloseFocusElement;\r\n\r\n  return {\r\n    show,\r\n  };\r\n\r\n  function show(args)\r\n  {\r\n    ({\r\n      title          = 'Share / Play Track',\r\n      bodyText       = null,\r\n      filterBodyText = false,\r\n      bodyHtml       = null,\r\n      url            = null,\r\n      urlType        = 'Link',\r\n      trackType      = null,\r\n      trackSourceUid = null,\r\n      verb           = 'Play',\r\n      icon           = 'link',\r\n      onCloseFocusElement = null,\r\n    } = args);\r\n\r\n    return showModal({\r\n      modalTitle: title,\r\n      modalList:  getModalList(),\r\n      modalType:  'share',\r\n      onClickEntryCallback: () => copyTextToClipboard(url, urlType),\r\n      onCloseFocusElement: onCloseFocusElement,\r\n    });\r\n  }\r\n\r\n  function getModalList()\r\n  {\r\n    const mailtoLink = `mailto:?subject=${encodeURIComponent(`Ultrafunk ${urlType}: ${bodyText}`)}&body=${encodeURI(url)}%0d%0a`;\r\n\r\n    const searchString = filterBodyText\r\n      ? encodeURIComponent(bodyText.replace(filterBodyTextRegEx, ' '))\r\n      : encodeURIComponent(bodyText);\r\n\r\n    // If input device is touch, Spotify needs a different search link\r\n    const spotifyLink = (window.matchMedia('(pointer: coarse)').matches)\r\n      ? `https://open.spotify.com/search/results/${searchString}`\r\n      : `https://open.spotify.com/search/${searchString}`;\r\n\r\n    const youTubeLink = (trackType === TRACK_TYPE.YOUTUBE)\r\n      ? `https://music.youtube.com/watch?v=${trackSourceUid}`\r\n      : `https://music.youtube.com/search?q=${searchString}`;\r\n\r\n    const modalList = [\r\n      { icon: 'content_copy', content: '<b>Copy Link</b> to Clipboard',   clickId: 'copyToClipboardId' },\r\n      { icon: 'share',        content: '<b>Share</b> on Email',           link: mailtoLink             },\r\n      { icon: 'search',       content: '<b>Search</b> on Google',         link: `https://www.google.com/search?q=${searchString}`,        linkTarget: '_blank' },\r\n      { icon: icon,           content: `<b>${verb}</b> on Amazon Music`,  link: `https://music.amazon.com/search/${searchString}`,        linkTarget: '_blank' },\r\n      { icon: icon,           content: `<b>${verb}</b> on Apple Music`,   link: `https://music.apple.com/ca/search?term=${searchString}`, linkTarget: '_blank' },\r\n      { icon: icon,           content: `<b>${verb}</b> on SoundCloud`,    link: `https://${trackSourceUid}`,                              linkTarget: '_blank' },\r\n      { icon: icon,           content: `<b>${verb}</b> on Spotify`,       link: spotifyLink,                                              linkTarget: '_blank' },\r\n      { icon: icon,           content: `<b>${verb}</b> on YouTube Music`, link: youTubeLink,                                              linkTarget: '_blank' },\r\n    ];\r\n\r\n    if (trackType === TRACK_TYPE.LOCAL)\r\n    {\r\n      modalList[0].state = 'disabled';\r\n      modalList[1].state = 'disabled';\r\n    }\r\n\r\n    if (trackType !== TRACK_TYPE.SOUNDCLOUD)\r\n      delete modalList[5];\r\n\r\n    if (bodyHtml !== null)\r\n      modalList.unshift({ class: 'track-share-entry', content: bodyHtml });\r\n\r\n    return modalList;\r\n  }\r\n});\r\n\r\nexport const shareModal = shareModalClosure();\r\n", "//\r\n// List-player realtime track search module\r\n//\r\n// https://ultrafunk.com\r\n//\r\n\r\n\r\nimport { newDebugLogger, logCss } from '../../shared/debuglogger.js';\r\nimport { THEME_ENV }              from '../../config.js';\r\nimport { settings }               from '../../shared/session-data.js';\r\nimport { navSearch }              from '../../site/nav-search.js';\r\nimport { ElementClick }           from '../../shared/element-click.js';\r\nimport { showSnackbar }           from '../../shared/snackbar.js';\r\nimport { getTrackEntryHtml }      from './list-track-templates.js';\r\nimport { getCurrentTrackElement } from './list-controls.js';\r\nimport { setCurrentTrack }        from './list-playback.js';\r\nimport { isShowingModal }         from '../../shared/modal.js';\r\n\r\nimport {\r\n  showTrackDetails,\r\n  showTrackSharePlay,\r\n} from '../common/track-modals.js';\r\n\r\nimport {\r\n  HTTP_RESPONSE,\r\n  fetchRest,\r\n} from '../../shared/fetch-rest.js';\r\n\r\nimport {\r\n  isControlKey,\r\n  escHtml,\r\n  isPointerTypeTouch,\r\n} from '../../shared/utils.js';\r\n\r\n\r\n/*************************************************************************************************/\r\n\r\n\r\nconst debug = newDebugLogger('track-search');\r\n\r\nconst m = {\r\n  debounceKeyup:      null,\r\n  uiElements:         null,\r\n  searchField:        null,\r\n  trackSearchResults: null,\r\n  resultsTracklist:   null,\r\n  resultsCache:       new Map(),\r\n  prevSearchString:   '',\r\n  modalId:            -1,\r\n};\r\n\r\nconst minSearchStringLength = 3;\r\n\r\n\r\n// ************************************************************************************************\r\n//\r\n// ************************************************************************************************\r\n\r\nexport function initTrackSearch()\r\n{\r\n  debug.log('init()');\r\n\r\n  if (settings.list.realtimeTrackSearch)\r\n  {\r\n    m.debounceKeyup      = debounceKeyup(showSearchResults, 250);\r\n    m.uiElements         = new uiElements('#track-search-results .results-tracklist');\r\n    m.searchField        = document.querySelector('#site-search-container .search-field');\r\n    m.trackSearchResults = document.getElementById('track-search-results');\r\n    m.resultsTracklist   = m.trackSearchResults.querySelector('.results-tracklist');\r\n\r\n    window.addEventListener('load', () =>\r\n    {\r\n      m.searchField.addEventListener('keyup',  (event) => m.debounceKeyup(event, m.searchField.value.toLowerCase()));\r\n      m.searchField.addEventListener('search', () => showSearchResults(m.searchField.value.toLowerCase()));\r\n\r\n      // \"Preload\" track search results if this is a serch results page\r\n      if ((m.searchField.value !== '') && (m.searchField.value.length >= minSearchStringLength))\r\n        showSearchResults(m.searchField.value.toLowerCase());\r\n\r\n      // ToDo: This does not work on Firefox...\r\n      window.addEventListener('blur', () =>\r\n      {\r\n        if (isTrackSearchResultsVisible() && (document.activeElement?.id === 'youtube-player'))\r\n          navSearch.hide();\r\n      });\r\n    });\r\n  }\r\n}\r\n\r\nexport function setTrackSearchResultsVisible(isSearchVisible)\r\n{\r\n  if (m.trackSearchResults === null)\r\n    return;\r\n\r\n  if (isSearchVisible)\r\n  {\r\n    m.trackSearchResults.style.display = (m.searchField.value.length >= minSearchStringLength) ? 'block' : 'none';\r\n    document.addEventListener('click', onClickCloseSearch, { capture: true });\r\n  }\r\n  else\r\n  {\r\n    m.trackSearchResults.style.display = 'none';\r\n    document.removeEventListener('click', onClickCloseSearch, { capture: true });\r\n  }\r\n}\r\n\r\nfunction onClickCloseSearch(event)\r\n{\r\n  if ((m.searchField.contains(event.target)       === false) &&\r\n      (m.resultsTracklist.contains(event.target)  === false) &&\r\n      (event.target.closest('.nav-search-toggle') === null)  &&\r\n      (isShowingModal(m.modalId)                  === false))\r\n  {\r\n    navSearch.hide();\r\n  }\r\n}\r\n\r\nexport function isTrackSearchResultsVisible()\r\n{\r\n  return (m.trackSearchResults?.style.display === 'block');\r\n}\r\n\r\nfunction debounceKeyup(callback, delayMilliseconds)\r\n{\r\n  let delayTimerId = 0;\r\n\r\n  return function(event, searchString)\r\n  {\r\n    clearTimeout(delayTimerId);\r\n\r\n    if (isControlKey(event.key))\r\n      return;\r\n\r\n    if ((searchString.length >= minSearchStringLength) && (m.resultsCache.get(searchString) === undefined))\r\n    {\r\n      if (m.resultsCache.size === 0)\r\n        m.trackSearchResults.style.display = 'block';\r\n\r\n      delayTimerId = setTimeout(() => callback(searchString), delayMilliseconds);\r\n    }\r\n    else\r\n    {\r\n      callback(searchString);\r\n    }\r\n  };\r\n}\r\n\r\n\r\n// ************************************************************************************************\r\n// Handle UI events\r\n// ************************************************************************************************\r\n\r\nclass uiElements extends ElementClick\r\n{\r\n  elementClicked()\r\n  {\r\n    if (this.clicked('button.thumbnail'))\r\n      return playTrackClick(this.closest('div.track-entry'));\r\n\r\n    if (this.clicked('div.artist-title'))\r\n      return showTrackDetailsTouch(this.event, this.closest('div.track-entry'));\r\n\r\n    if (this.clicked('button.play-next-button'))\r\n      return playNextClick(this.closest('div.track-entry'));\r\n\r\n    if (this.clicked('button.share-play-button'))\r\n      return m.modalId = showTrackSharePlay(this.closest('div.track-entry'), m.searchField);\r\n\r\n    if (this.clicked('button.details-button'))\r\n      return m.modalId = showTrackDetails(this.closest('div.track-entry'), m.searchField);\r\n  }\r\n}\r\n\r\nfunction playTrackClick(element)\r\n{\r\n  setCurrentTrack(insertResultTrack(element).id, true, false);\r\n  navSearch.hide();\r\n}\r\n\r\nfunction showTrackDetailsTouch(event, element)\r\n{\r\n  if (isPointerTypeTouch(event))\r\n    m.modalId = showTrackDetails(element, m.searchField);\r\n}\r\n\r\nfunction playNextClick(element)\r\n{\r\n  insertResultTrack(element);\r\n  showSnackbar({ message: 'Track will play next', duration: 5, actionText: 'details', actionClickCallback: () =>  showTrackDetails(element) });\r\n  navSearch.hide();\r\n}\r\n\r\nfunction insertResultTrack(element)\r\n{\r\n  const insertElement = element.cloneNode(true);\r\n\r\n  insertElement.id = `track-${Date.now()}`;\r\n  insertElement.classList.replace('compact-density', 'default-density');\r\n  insertElement.classList.add('adding');\r\n  insertElement.addEventListener('animationend', () => insertElement.classList.remove('adding'));\r\n\r\n  getCurrentTrackElement()?.insertAdjacentElement('afterend', insertElement);\r\n\r\n  return insertElement;\r\n}\r\n\r\n\r\n// ************************************************************************************************\r\n//\r\n// ************************************************************************************************\r\n\r\nexport async function showSearchResults(searchString)\r\n{\r\n  const searchStart = performance.now();\r\n  let fetchRestTime = 0;\r\n\r\n  if (searchString.length < minSearchStringLength)\r\n  {\r\n    m.searchField.autocomplete = 'on';\r\n    m.trackSearchResults.style.display = 'none';\r\n    m.prevSearchString = '';\r\n  }\r\n  else\r\n  {\r\n    if ((searchString !== m.prevSearchString) && (m.resultsCache.get(searchString) === undefined))\r\n    {\r\n      m.searchField.autocomplete = 'off';\r\n      m.prevSearchString = searchString;\r\n\r\n      fetchRestTime = await showRestResults(searchString);\r\n    }\r\n    else if (searchString !== m.prevSearchString)\r\n    {\r\n      const cachedResult = m.resultsCache.get(searchString);\r\n\r\n      m.searchField.autocomplete = 'off';\r\n      m.prevSearchString = searchString;\r\n\r\n      if ((cachedResult.status.code === HTTP_RESPONSE.OK) && (cachedResult.data.length !== 0))\r\n        setResultsHtml(cachedResult);\r\n      else\r\n        showResultsMessage(getNoMatchesMessage(searchString));\r\n\r\n      debug.log(`showSearchResults() from cache for: '${searchString}' - Cached Results: ${m.resultsCache.size}`);\r\n    }\r\n\r\n    if ((m.trackSearchResults.style.display === 'none') && navSearch.isVisible())\r\n      m.trackSearchResults.style.display = 'block';\r\n  }\r\n\r\n  // Free up some memory... (1000 entries is about 10 MB)\r\n  if (m.resultsCache.size > 1000)\r\n    m.resultsCache.clear();\r\n\r\n  const searchStop = performance.now();\r\n\r\n  // ToDo: Over 500 ms., log REST search performance for production, this will be removed in the future...\r\n  if ((searchStop - searchStart) > 500)\r\n    console.log(`%cTrack search for ${searchTypeString[getSearchTypeId()]}: ${Math.ceil(searchStop - searchStart)} ms. (fetch: ${Math.ceil(fetchRestTime)} ms.) for ${THEME_ENV.siteUrl}`, logCss);\r\n}\r\n\r\nasync function showRestResults(searchString)\r\n{\r\n  const replacedSearchString = searchString.replaceAll(\"'\", \" \");                                                     // Replace ' with space for better term search results...\r\n  const encodedSearchString  = encodeURIComponent(replacedSearchString).replaceAll(/(?<!%20)%26(?!%20)/g, '%26amp;'); // Encode %26 (&) without any spaces (%20) as %26amp; for better term search results...\r\n  const searchParams = `search=${encodedSearchString}&orderby=relevance&per_page=${settings.list.maxTrackSearchResults + 1}&wpessid=${getSearchTypeId()}&`;\r\n  const fetchStart   = performance.now();\r\n\r\n  const restResponse = await fetchRest({\r\n    endpoint: 'tracks',\r\n    query:    `${searchParams}_fields=id,link,artists,channels,meta,artists_links,channels_links`,\r\n  });\r\n\r\n  const fetchStop = performance.now();\r\n\r\n  if ((restResponse.status.code === HTTP_RESPONSE.OK) && (restResponse.data.length >= 1))\r\n  {\r\n    m.resultsCache.set(searchString, restResponse);\r\n    setResultsHtml(restResponse);\r\n\r\n    debug.log(`showRestResults(): '${searchString}' (${restResponse.data.length} matches) - Cached Results: ${m.resultsCache.size}`);\r\n  }\r\n  else\r\n  {\r\n    if (restResponse.status.code !== HTTP_RESPONSE.OK)\r\n    {\r\n      showResultsMessage('Failed to fetch search results!');\r\n    }\r\n    else if ((restResponse.status.code === HTTP_RESPONSE.OK) && (restResponse.data.length === 0))\r\n    {\r\n      m.resultsCache.set(searchString, restResponse);\r\n      showResultsMessage(getNoMatchesMessage(searchString));\r\n    }\r\n  }\r\n\r\n  return (fetchStop - fetchStart);\r\n}\r\n\r\nconst searchTypeString = {\r\n  [THEME_ENV.searchArtistTitleId]:                'Artist - Title',\r\n  [THEME_ENV.searchArtistTitleArtistsId]:         'Artist - Title + Artists',\r\n  [THEME_ENV.searchArtistTitleChannelsId]:        'Artist - Title + Channels',\r\n  [THEME_ENV.searchArtistTitleArtistsChannelsId]: 'Artist - Title + Artists + Channels',\r\n};\r\n\r\nfunction getSearchTypeId()\r\n{\r\n  if (settings.list.queryAllTrackArtists && settings.list.queryAllTrackChannels)\r\n    return THEME_ENV.searchArtistTitleArtistsChannelsId;\r\n  else if (settings.list.queryAllTrackArtists)\r\n    return THEME_ENV.searchArtistTitleArtistsId;\r\n  else if (settings.list.queryAllTrackChannels)\r\n    return THEME_ENV.searchArtistTitleChannelsId;\r\n\r\n  return THEME_ENV.searchArtistTitleId;\r\n}\r\n\r\nfunction setResultsHtml(restResponse)\r\n{\r\n  let tracksHtml = '';\r\n\r\n  restResponse.data.forEach((track, index) =>\r\n  {\r\n    if (index < settings.list.maxTrackSearchResults)\r\n    {\r\n      track.uid   = `track-${(Date.now() + index)}`;\r\n      tracksHtml += getTrackEntryHtml(track, 'compact');\r\n    }\r\n  });\r\n\r\n  if (restResponse.data.length > settings.list.maxTrackSearchResults)\r\n  {\r\n    tracksHtml += `\r\n      <div class=\"max-results text-nowrap-ellipsis\">\r\n        More than ${settings.list.maxTrackSearchResults} hits, refine query or&nbsp;<a href=\"/list/search/?s=${encodeURIComponent(m.searchField.value)}\"><b>show all results</b></a>\r\n      </div>`;\r\n  }\r\n\r\n  m.resultsTracklist.innerHTML = tracksHtml;\r\n\r\n  // Sometimes yield (setTimeout(0)) is needed for scrolling to actually happen... But why?\r\n  setTimeout(() => { m.trackSearchResults.querySelector('.track-results-container').scrollTop = 0; }, 0);\r\n}\r\n\r\nfunction getNoMatchesMessage(searchString)\r\n{\r\n  const separator = '&nbsp;&nbsp;&nbsp;&#10095;&#10095;&nbsp;&nbsp;&nbsp;';\r\n  return `0 tracks match <b>${escHtml(searchString)}</b>${separator}<a href=\"/?s=${encodeURIComponent(searchString)}\">Search Site</a>`;\r\n}\r\n\r\nfunction showResultsMessage(message)\r\n{\r\n  m.resultsTracklist.innerHTML = '<div class=\"results-message text-nowrap-ellipsis\"></div>';\r\n  m.resultsTracklist.querySelector('div.results-message').innerHTML = message;\r\n}\r\n", "//\r\n// Ultrafunk site nav-search\r\n//\r\n// https://ultrafunk.com\r\n//\r\n\r\n\r\nimport * as utils from '../shared/utils.js';\r\n\r\nimport {\r\n  isTrackSearchResultsVisible,\r\n  setTrackSearchResultsVisible,\r\n} from '../playback/list/track-search.js';\r\n\r\n\r\n// ************************************************************************************************\r\n// Main navigation search handling closure\r\n// ************************************************************************************************\r\n\r\nconst navSearchClosure = (() =>\r\n{\r\n  const allowKeyboardShortcutsEvent = new Event('allowKeyboardShortcuts');\r\n  const denyKeyboardShortcutsEvent  = new Event('denyKeyboardShortcuts');\r\n  let siteHeader = null, searchContainer = null, searchField = null;\r\n  let isVisible = false;\r\n\r\n  return {\r\n    isVisible() { return isVisible; },\r\n    init,\r\n    toggle,\r\n    show,\r\n    hide,\r\n  };\r\n\r\n  function init()\r\n  {\r\n    siteHeader      = document.getElementById('site-header');\r\n    searchContainer = document.getElementById('site-search-container');\r\n    searchField     = searchContainer.querySelector('.search-field');\r\n\r\n    utils.addListenerAll('.nav-search-toggle', 'click', toggle);\r\n\r\n    // To prevent extra 'blur' event before 'click' event\r\n    utils.addListenerAll('.nav-search-toggle', 'mousedown', (event) => event.preventDefault());\r\n\r\n    // Hide nav search bar on focus loss\r\n    searchField.addEventListener('blur', () =>\r\n    {\r\n      if (isTrackSearchResultsVisible() === false)\r\n        hide();\r\n    });\r\n\r\n    // Hide nav search bar on ESC\r\n    searchField.addEventListener('keydown', (event) =>\r\n    {\r\n      if ((event.key === 'Escape') && isVisible)\r\n      {\r\n        event.stopPropagation();\r\n        hide();\r\n      }\r\n    });\r\n  }\r\n\r\n  function toggle()\r\n  {\r\n    isVisible ? hide() : show();\r\n  }\r\n\r\n  function show(searchString = null)\r\n  {\r\n    if (searchString !== null)\r\n      searchField.value = searchString;\r\n\r\n    if (hasVisibleSearchContainer())\r\n    {\r\n      if (isVisible === false)\r\n        setNavSearchProps(true);\r\n\r\n      searchField.focus();\r\n      searchField.setSelectionRange(9999, 9999);\r\n    }\r\n  }\r\n\r\n  function hide()\r\n  {\r\n    if (isVisible)\r\n      setNavSearchProps(false);\r\n  }\r\n\r\n  function hasVisibleSearchContainer()\r\n  {\r\n    if (searchContainer.style.display.length === 0)\r\n    {\r\n      // Has no visible site header at all, bail out...\r\n      if (siteHeader.offsetHeight === 0)\r\n        return false;\r\n\r\n      // Is mobile with no visible navbar, bail out...\r\n      if (utils.matchesMedia(utils.MATCH.SITE_MAX_WIDTH_MOBILE))\r\n      {\r\n        if ((siteHeader.querySelector('.navbar-container-mobile-top').offsetHeight === 0) &&\r\n            (siteHeader.querySelector('.navbar-container-mobile-up').offsetHeight  === 0))\r\n        {\r\n          return false;\r\n        }\r\n      }\r\n\r\n      return true;\r\n    }\r\n\r\n    return false;\r\n  }\r\n\r\n  function setNavSearchProps(showHide)\r\n  {\r\n    isVisible = showHide;\r\n\r\n    isVisible ? document.dispatchEvent(denyKeyboardShortcutsEvent)\r\n              : document.dispatchEvent(allowKeyboardShortcutsEvent);\r\n\r\n    isVisible ? document.getElementById('playback-controls').classList.add('hide')\r\n              : document.getElementById('playback-controls').classList.remove('hide');\r\n\r\n    searchContainer.style.display = isVisible ? 'flex' : '';\r\n    setTrackSearchResultsVisible(isVisible);\r\n\r\n    document.querySelectorAll('button.nav-search-toggle span').forEach((element) =>\r\n    {\r\n      element.textContent = isVisible ? 'close' : 'search';\r\n    });\r\n  }\r\n});\r\n\r\nexport const navSearch = navSearchClosure();\r\n", "//\r\n// Track modals module\r\n//\r\n// https://ultrafunk.com\r\n//\r\n\r\nimport { getModalTrackHtml }   from '../../shared/modal-templates.js';\r\nimport { shareModal }          from '../../shared/share-modal.js';\r\nimport { copyTextToClipboard } from '../../shared/clipboard.js';\r\nimport { navSearch }           from '../../site/nav-search.js';\r\nimport { showSearchResults }   from '../list/track-search.js';\r\nimport { isListPlayer }        from './shared-gallery-list.js';\r\n\r\nimport {\r\n  TRACK_TYPE,\r\n  getDataTrackType,\r\n} from './mediaplayer.js';\r\n\r\nimport {\r\n  showModal,\r\n  getModalRootElement,\r\n} from '../../shared/modal.js';\r\n\r\nimport {\r\n  stripAttribute,\r\n  getPrefPlayerUrl,\r\n  getTimeString,\r\n  getReadableBytesSize,\r\n} from '../../shared/utils.js';\r\n\r\n\r\n// ************************************************************************************************\r\n//\r\n// ************************************************************************************************\r\n\r\nexport function showTrackSharePlay(element, onCloseFocusElement = null)\r\n{\r\n  const trackArtist = stripAttribute(element, 'data-track-artist');\r\n  const trackTitle  = stripAttribute(element, 'data-track-title');\r\n\r\n  const modalId = shareModal.show({\r\n    bodyText:       `${trackArtist} - ${trackTitle}`,\r\n    filterBodyText: true,\r\n    bodyHtml:       getModalTrackHtml(element, trackArtist, trackTitle),\r\n    url:            stripAttribute(element, 'data-track-url'),\r\n    urlType:        'Track Link',\r\n    trackType:      getDataTrackType(element),\r\n    trackSourceUid: stripAttribute(element, 'data-track-source-uid'),\r\n    onCloseFocusElement: onCloseFocusElement,\r\n  });\r\n\r\n  setTrackThumbnailClick(`${trackArtist} - ${trackTitle}`);\r\n\r\n  return modalId;\r\n}\r\n\r\nexport function showTrackDetails(element, onCloseFocusElement = null)\r\n{\r\n  const trackArtist   = stripAttribute(element, 'data-track-artist');\r\n  const trackTitle    = stripAttribute(element, 'data-track-title');\r\n  const trackDuration = parseInt(element.getAttribute('data-track-duration'));\r\n  const modalEntries  = [];\r\n\r\n  modalEntries.push({\r\n    class:   'track-details-entry',\r\n    content: getModalTrackHtml(element, trackArtist, trackTitle),\r\n  });\r\n\r\n  const modalTitle = `Track Details<span class=\"light-text lowercase-text\">${((trackDuration > 0) ? getTimeString(trackDuration) : 'duration N/A')}</span>`;\r\n\r\n  if (getDataTrackType(element) === TRACK_TYPE.LOCAL)\r\n    getLocalTrackDetails(element, modalEntries);\r\n  else\r\n    getTrackDetails(element, modalEntries);\r\n\r\n  const modalId = showModal({\r\n    modalTitle: modalTitle,\r\n    modalList:  modalEntries,\r\n    modalType:  'track-details',\r\n    onCloseFocusElement: onCloseFocusElement,\r\n    onClickEntryCallback: (entryClickId, event) => onIconClickTrackSearch(event),\r\n  });\r\n\r\n  setTrackThumbnailClick(`${trackArtist} - ${trackTitle}`);\r\n\r\n  return modalId;\r\n}\r\n\r\nfunction getLocalTrackDetails(element, modalEntries)\r\n{\r\n  modalEntries.push({ class: 'header-entry', content: 'Filename' });\r\n  modalEntries.push({ class: 'default-text', content: `${stripAttribute(element, 'data-track-file-name')}` });\r\n  modalEntries.push({ class: 'header-entry', content: 'Type' });\r\n  modalEntries.push({ class: 'default-text', content: `On device ${stripAttribute(element, 'data-track-file-type')} audio file` });\r\n  modalEntries.push({ class: 'header-entry', content: 'Size' });\r\n  modalEntries.push({ class: 'default-text', content: getReadableBytesSize(parseInt(element.getAttribute('data-track-file-size'))) });\r\n}\r\n\r\nfunction getTrackDetails(element, modalEntries)\r\n{\r\n  const artists  = element.querySelector('.track-artists-links').querySelectorAll('a');\r\n  const channels = element.querySelector('.track-channels-links').querySelectorAll('a');\r\n\r\n  modalEntries.push({ class: 'header-entry', content: 'Artists' });\r\n\r\n  artists.forEach(item =>\r\n  {\r\n    modalEntries.push({\r\n      class:     `hover-icon-text ${item.classList[0] ?? ''}`,\r\n      title:     'Go to Artist',\r\n      content:   item.innerText,\r\n      link:      getPrefPlayerUrl(item.href),\r\n      icon:      'link',\r\n      hoverIcon: 'search',\r\n      hoverTitle: `Search for ${item.innerText}`,\r\n      clickId:   element.id,\r\n    });\r\n  });\r\n\r\n  modalEntries.push({ class: 'header-entry', content: 'Channels' });\r\n\r\n  channels.forEach(item =>\r\n  {\r\n    modalEntries.push({\r\n      class:     `hover-icon-text`,\r\n      title:     'Go to Channel',\r\n      content:   item.innerText,\r\n      link:      getPrefPlayerUrl(item.href),\r\n      icon:      'link',\r\n      hoverIcon: 'search',\r\n      hoverTitle: `Search for ${item.innerText}`,\r\n      clickId:   element.id,\r\n    });\r\n  });\r\n\r\n  const trackType = (getDataTrackType(element) === TRACK_TYPE.YOUTUBE) ? 'YouTube' : 'SoundCloud';\r\n  const trackLink = (getDataTrackType(element) === TRACK_TYPE.YOUTUBE)\r\n    ? encodeURI(`https://music.youtube.com/watch?v=${element.getAttribute('data-track-source-uid')}`)\r\n    : encodeURI(`https://${element.getAttribute('data-track-source-uid')}`);\r\n\r\n  modalEntries.push({ class: 'header-entry', content: 'Type / Source Link' });\r\n  modalEntries.push({ content: `${trackType} track`, link: trackLink, icon: 'link', linkTarget: '_blank', title: `Link to ${trackType} track` });\r\n}\r\n\r\nfunction onIconClickTrackSearch(event)\r\n{\r\n  if (event.target.closest('div.modal-item-icons'))\r\n  {\r\n    event.preventDefault();\r\n    const searchString = event.target.closest('a')?.querySelector('span.text-nowrap-ellipsis').textContent;\r\n    navSearch.show(searchString);\r\n\r\n    if (isListPlayer())\r\n      showSearchResults(searchString.toLowerCase());\r\n  }\r\n}\r\n\r\nfunction setTrackThumbnailClick(artistTitle)\r\n{\r\n  getModalRootElement().querySelector('.modal-track .modal-track-thumbnail').title = 'Click / tap to Copy Artist & Title';\r\n  getModalRootElement().querySelector('img')?.addEventListener('click', () => copyTextToClipboard(artistTitle, 'Artist &amp Title'));\r\n}\r\n", "//\r\n// List-player controls module\r\n//\r\n// https://ultrafunk.com\r\n//\r\n\r\n\r\nimport * as playbackEvents    from '../common/playback-events.js';\r\nimport * as utils             from '../../shared/utils.js';\r\nimport { newDebugLogger }     from '../../shared/debuglogger.js';\r\nimport { ElementClick }       from '../../shared/element-click.js';\r\nimport { STATE }              from '../common/element-wrappers.js';\r\nimport { loadTracks }         from './list-tracks-rest.js';\r\nimport { showSnackbar }       from '../../shared/snackbar.js';\r\nimport { response, settings } from '../../shared/session-data.js';\r\nimport { updateUpNextModal }  from './up-next-modal.js';\r\n\r\nimport {\r\n  setCurrentTrack,\r\n  togglePlayPause,\r\n} from './list-playback.js';\r\n\r\nimport {\r\n  TRACK_TYPE,\r\n  getDataTrackType,\r\n} from '../common/mediaplayer.js';\r\n\r\nimport {\r\n  showTrackDetails,\r\n  showTrackSharePlay,\r\n} from '../common/track-modals.js';\r\n\r\n\r\n/*************************************************************************************************/\r\n\r\n\r\nconst debug = newDebugLogger('list-controls');\r\n\r\nconst m = {\r\n  tracklist:            null,\r\n  tracklistObserver:    null,\r\n  tracklistLoadMore:    null,\r\n  trackElement:         null,\r\n  currentState:         STATE.UNKNOWN,\r\n  prevActionButtons:    null,\r\n  youTubePlayerWrapper: null,\r\n  uiElements:           null,\r\n  localContainer:       null,\r\n  localPlayerTimeoutId: 0,\r\n};\r\n\r\n\r\n// ************************************************************************************************\r\n//\r\n// ************************************************************************************************\r\n\r\nexport function init()\r\n{\r\n  debug.log('init()');\r\n\r\n  m.tracklist            = document.getElementById('tracklist');\r\n  m.tracklistObserver    = new IntersectionObserver(observerCallback, { root: m.tracklist });\r\n  m.youTubePlayerWrapper = document.querySelector('#list-players-container .youtube-container .wp-block-embed__wrapper');\r\n  m.uiElements           = new UiElements('#tracklist');\r\n  m.localContainer       = document.querySelector('.embedded-container.local-container');\r\n}\r\n\r\nexport function ready()\r\n{\r\n  m.trackElement.classList.add('current');\r\n\r\n  playbackEvents.addListener(playbackEvents.EVENT.MEDIA_LOADING,   ()      => setCurrentTrackState(STATE.LOADING));\r\n  playbackEvents.addListener(playbackEvents.EVENT.MEDIA_PLAYING,   ()      => setCurrentTrackState(STATE.PLAYING));\r\n  playbackEvents.addListener(playbackEvents.EVENT.MEDIA_PAUSED,    ()      => setCurrentTrackState(STATE.PAUSED));\r\n  playbackEvents.addListener(playbackEvents.EVENT.MEDIA_CUE_TRACK, (event) => setNextTrackState(event.data.trackId, event.data.isPointerClick));\r\n\r\n  if (settings.list.showLoadMoreTracks)\r\n    initLoadMoreTracks();\r\n\r\n  if (settings.list.enableLocalPlayback)\r\n  {\r\n    utils.addListener('#local-player-image', 'click', (event) =>\r\n    {\r\n      togglePlayPause();\r\n      showLocalPlayerInfoAndControls(event);\r\n    });\r\n  }\r\n}\r\n\r\nfunction observerCallback(entries)\r\n{\r\n  m.tracklistObserver.unobserve(m.trackElement);\r\n\r\n  if ((Math.ceil(entries[0].intersectionRatio * 100) / 100) !== 1)\r\n    m.tracklist.scrollTop = (m.trackElement.offsetTop - m.tracklist.offsetHeight) + m.trackElement.offsetHeight;\r\n}\r\n\r\n\r\n// ************************************************************************************************\r\n//\r\n// ************************************************************************************************\r\n\r\nexport function queryTrack(selectors)\r\n{\r\n  return m.tracklist.querySelector(selectors);\r\n}\r\n\r\nexport function queryTrackAll(selectors)\r\n{\r\n  return m.tracklist.querySelectorAll(selectors);\r\n}\r\n\r\nexport function queryTrackId(id)\r\n{\r\n  return document.getElementById(id);\r\n}\r\n\r\nexport function getCurrentTrackElement()\r\n{\r\n  return m.trackElement;\r\n}\r\n\r\nexport function getPrevPlayableId()\r\n{\r\n  let destElement = (m.trackElement !== null)\r\n                      ? m.trackElement.previousElementSibling\r\n                      : null;\r\n\r\n  while ((destElement !== null) && (getDataTrackType(destElement) === TRACK_TYPE.NONE))\r\n    destElement = destElement.previousElementSibling;\r\n\r\n  return ((destElement !== null) ? destElement.id : null);\r\n}\r\n\r\nexport function getNextPlayableId(startElement = m.trackElement)\r\n{\r\n  let destElement = (startElement !== null)\r\n                      ? startElement.nextElementSibling\r\n                      : queryTrack('div.track-entry');\r\n\r\n  while ((destElement !== null) && (getDataTrackType(destElement) === TRACK_TYPE.NONE))\r\n    destElement = destElement.nextElementSibling;\r\n\r\n  return ((destElement !== null) ? destElement.id : null);\r\n}\r\n\r\nexport function setInitialTrack(trackId)\r\n{\r\n  m.trackElement = queryTrackId(trackId);\r\n  m.tracklistObserver.observe(m.trackElement);\r\n}\r\n\r\nexport function showTrackTypePlayer(trackType)\r\n{\r\n  debug.log(`showTrackTypePlayer(): ${debug.getKeyForValue(TRACK_TYPE, trackType)}`);\r\n\r\n  document.querySelector('.embedded-container.placeholder-container').style.display = 'none';\r\n  document.querySelector('.embedded-container.youtube-container').style.display     = (trackType === TRACK_TYPE.YOUTUBE)    ? 'block' : '';\r\n  document.querySelector('.embedded-container.soundcloud-container').style.display  = (trackType === TRACK_TYPE.SOUNDCLOUD) ? 'block' : '';\r\n  m.localContainer.style.display                                                    = (trackType === TRACK_TYPE.LOCAL)      ? 'block' : '';\r\n}\r\n\r\nexport function showLocalPlayerInfoAndControls(event)\r\n{\r\n  if (utils.isPointerTypeTouch(event))\r\n  {\r\n    const artistTitle = m.localContainer.querySelector('.artist-title-container');\r\n    const audioPlayer = m.localContainer.querySelector('audio');\r\n\r\n    artistTitle.style.display = 'unset';\r\n    audioPlayer.style.display = 'unset';\r\n\r\n    if (m.localPlayerTimeoutId !== 0)\r\n      clearTimeout(m.localPlayerTimeoutId);\r\n\r\n    m.localPlayerTimeoutId = setTimeout(() =>\r\n    {\r\n      artistTitle.style.display = '';\r\n      audioPlayer.style.display = '';\r\n      m.localPlayerTimeoutId    = 0;\r\n    },\r\n    5000);\r\n  }\r\n}\r\n\r\n\r\n// ************************************************************************************************\r\n//\r\n// ************************************************************************************************\r\n\r\nclass UiElements extends ElementClick\r\n{\r\n  elementClicked()\r\n  {\r\n    if (this.clicked('button.thumbnail'))\r\n      return setCurrentTrack(this.closest('div.track-entry').id, true, true);\r\n\r\n    if (this.clicked('button.track-actions-toggle'))\r\n      return trackActionsClick(this.closest('div.track-entry'));\r\n\r\n    if (this.clicked('button.remove-button'))\r\n      return removeClick(this.closest('div.track-entry'));\r\n\r\n    if (this.clicked('button.play-next-button'))\r\n      return playNextClick(this.closest('div.track-entry'));\r\n\r\n    if (this.clicked('button.share-play-button'))\r\n      return showTrackSharePlay(this.closest('div.track-entry'));\r\n\r\n    if (this.clicked('button.details-button'))\r\n      return showTrackDetails(this.closest('div.track-entry'));\r\n\r\n    if (this.clicked('button.arrow-up-button') || this.clicked('button.arrow-down-button'))\r\n      return arrowUpDownClick(this.closest('div.tracklist-page-separator'), this.clicked('button.arrow-up-button'));\r\n\r\n    if (this.clicked('button.arrow-first-button') || this.clicked('button.arrow-last-button'))\r\n      return arrowFirstLastClick(this.clicked('button.arrow-first-button'));\r\n  }\r\n}\r\n\r\nfunction trackActionsClick(element)\r\n{\r\n  const trackActionButtons = element.querySelector('.track-action-buttons');\r\n\r\n  if ((m.prevActionButtons !== null) && (m.prevActionButtons !== trackActionButtons))\r\n    m.prevActionButtons.style.display = '';\r\n\r\n  if (trackActionButtons.style.display === '')\r\n    trackActionButtons.style.display = 'flex';\r\n  else\r\n    trackActionButtons.style.display = '';\r\n\r\n  m.prevActionButtons = trackActionButtons;\r\n}\r\n\r\nfunction playNextClick(trackElement)\r\n{\r\n  if (m.trackElement !== null)\r\n  {\r\n    const nextTrackElement = trackElement.cloneNode(true);\r\n\r\n    clearTrackState(nextTrackElement);\r\n    nextTrackElement.id = `track-${Date.now()}`;\r\n\r\n    if (settings.list.moveTrackOnPlayNext && (trackElement !== m.trackElement))\r\n      removeClick(trackElement, false, () => addTrack(nextTrackElement, m.trackElement, 'afterend'));\r\n    else\r\n      addTrack(nextTrackElement, m.trackElement, 'afterend');\r\n\r\n    showSnackbar({ message: 'Track will play next', duration: 5, actionText: 'details', actionClickCallback: () =>  showTrackDetails(nextTrackElement) });\r\n  }\r\n  else\r\n  {\r\n    showSnackbar({message: 'Unable to cue track', duration: 3 });\r\n  }\r\n}\r\n\r\nfunction removeClick(trackElement, allowUndo = true, animationEndCallback = () => {})\r\n{\r\n  if (trackElement !== m.trackElement)\r\n  {\r\n    const undoRemoveElement = trackElement.cloneNode(true);\r\n    const undoPrevElement   = trackElement.previousElementSibling;\r\n\r\n    trackElement.addEventListener('animationend', () =>\r\n    {\r\n      trackElement.remove();\r\n      animationEndCallback();\r\n    });\r\n\r\n    trackElement.classList.add('removing');\r\n\r\n    if (allowUndo)\r\n    {\r\n      showSnackbar({\r\n        message: 'Track removed',\r\n        duration: 4,\r\n        actionText: 'undo',\r\n        actionClickCallback: () =>\r\n        {\r\n          addTrack(undoRemoveElement,\r\n                  ((undoPrevElement === null) ? m.tracklist  : undoPrevElement),\r\n                  ((undoPrevElement === null) ? 'afterbegin' : 'afterend'));\r\n        },\r\n      });\r\n    }\r\n  }\r\n}\r\n\r\nfunction addTrack(trackElement, targetElement, insertPosition)\r\n{\r\n  trackElement.classList.add('adding');\r\n  trackElement.querySelector('.track-action-buttons').style.display = '';\r\n  trackElement.addEventListener('animationend', () => trackElement.classList.remove('adding'));\r\n  targetElement.insertAdjacentElement(insertPosition, trackElement);\r\n}\r\n\r\nfunction arrowUpDownClick(targetElement, isArrowUpClick)\r\n{\r\n  const pageNumber  = parseInt(targetElement.getAttribute('data-page-number'));\r\n  const gotoPageNum = isArrowUpClick ? (pageNumber - 1) : (pageNumber + 1);\r\n  let gotoElement   = document.getElementById(`tracklist-page-${gotoPageNum}`);\r\n  let blockOption   = 'center';\r\n\r\n  if (gotoElement === null)\r\n  {\r\n    gotoElement = isArrowUpClick ? m.tracklist.firstElementChild : document.getElementById('tracklist-load-more-button');\r\n    blockOption = isArrowUpClick ? 'end' : ((window.innerWidth > 1350) ? 'nearest' : 'center');\r\n\r\n    if ((isArrowUpClick === false) && (gotoPageNum > response.maxPages))\r\n      gotoElement = gotoElement?.previousElementSibling;\r\n  }\r\n\r\n  gotoElement?.scrollIntoView({ behavior: utils.getScrollBehavior(), block: blockOption });\r\n}\r\n\r\nfunction arrowFirstLastClick(isArrowFirstClick)\r\n{\r\n  if (isArrowFirstClick)\r\n  {\r\n    if (window.innerWidth > 1350)\r\n      m.tracklist.firstElementChild.scrollIntoView({ behavior: utils.getScrollBehavior(), block: 'center' });\r\n    else\r\n      window.scroll({ top: 0, left: 0, behavior: utils.getScrollBehavior() });\r\n  }\r\n  else\r\n  {\r\n    const allTracks = queryTrackAll('.track-entry');\r\n    allTracks[allTracks.length - 1].scrollIntoView({ behavior: utils.getScrollBehavior(), block: 'center' });\r\n  }\r\n}\r\n\r\n\r\n// ************************************************************************************************\r\n//\r\n// ************************************************************************************************\r\n\r\nfunction initLoadMoreTracks()\r\n{\r\n  if (response.get.list_player === 'all'     ||\r\n      response.get.list_player === 'channel' ||\r\n      response.get.list_player === 'artist'  ||\r\n      response.get.list_player === 'shuffle' ||\r\n      response.get.list_player === 'search')\r\n  {\r\n    if ((response.nextPage !== null) && (response.currentPage < response.maxPages))\r\n    {\r\n      m.tracklistLoadMore = document.getElementById('tracklist-load-more-button');\r\n      m.tracklistLoadMore.querySelector('.load-more-title span').textContent = ` ( ${response.currentPage + 1} / ${response.maxPages} )`;\r\n      m.tracklistLoadMore.style.display = 'block';\r\n      m.tracklistLoadMore.addEventListener('click', loadMoreTracks);\r\n    }\r\n  }\r\n}\r\n\r\nexport async function loadMoreTracks()\r\n{\r\n  let tracksLoaded = false;\r\n\r\n  if ((response.currentPage + 1) <= response.maxPages)\r\n  {\r\n    setIsLoadingTracks(true);\r\n    tracksLoaded = await loadTracks(utils.stripAttribute(m.tracklist, 'data-term-type'), utils.stripAttribute(m.tracklist, 'data-term-id'));\r\n    setIsLoadingTracks(false);\r\n\r\n    if (tracksLoaded)\r\n    {\r\n      response.currentPage++;\r\n      m.tracklistLoadMore.querySelector('.load-more-title span').textContent = ` ( ${response.currentPage + 1} / ${response.maxPages} )`;\r\n    }\r\n    else\r\n    {\r\n      showSnackbar({\r\n        message: 'Load more tracks failed!',\r\n        duration: 30,\r\n        actionText: 'Retry',\r\n        actionClickCallback: () => loadMoreTracks(),\r\n      });\r\n    }\r\n  }\r\n\r\n  if ((response.currentPage >= response.maxPages) && (tracksLoaded === true))\r\n    m.tracklistLoadMore.style.display = 'none';\r\n\r\n  return tracksLoaded;\r\n}\r\n\r\nfunction setIsLoadingTracks(isLoadingTracks)\r\n{\r\n  m.tracklistLoadMore.style.pointerEvents                              = isLoadingTracks ? 'none'  : 'unset';\r\n  m.tracklistLoadMore.querySelector('.load-more-title').style.display  = isLoadingTracks ? 'none'  : 'block';\r\n  m.tracklistLoadMore.querySelector('.load-more-loader').style.display = isLoadingTracks ? 'block' : 'none';\r\n}\r\n\r\n\r\n// ************************************************************************************************\r\n//\r\n// ************************************************************************************************\r\n\r\nfunction clearTrackState(element)\r\n{\r\n  element.classList.remove('current', STATE.LOADING.CLASS, STATE.PLAYING.CLASS, STATE.PAUSED.CLASS);\r\n}\r\n\r\nexport function setCurrentTrackState(newState, isTrackChange = false)\r\n{\r\n  if ((m.currentState.ID !== newState.ID) || isTrackChange)\r\n  {\r\n    m.currentState = newState;\r\n\r\n    if (newState.ID === STATE.LOADING.ID)\r\n    {\r\n      m.trackElement.classList.remove(STATE.PAUSED.CLASS, STATE.PLAYING.CLASS);\r\n      m.trackElement.classList.add(STATE.LOADING.CLASS);\r\n    }\r\n    else\r\n    {\r\n      m.trackElement.classList.remove(STATE.LOADING.CLASS);\r\n\r\n      if (newState.ID === STATE.PLAYING.ID)\r\n        utils.replaceClass(m.trackElement, STATE.PAUSED.CLASS, STATE.PLAYING.CLASS);\r\n      else\r\n        utils.replaceClass(m.trackElement, STATE.PLAYING.CLASS, STATE.PAUSED.CLASS);\r\n\r\n      updateUpNextModal(newState.ID === STATE.PLAYING.ID);\r\n    }\r\n  }\r\n}\r\n\r\n//\r\n// ToDo: This only works for YouTube tracks since they are the only track type that can change aspect ration for now...\r\n//\r\nfunction setPlayerAspectRatio()\r\n{\r\n  if (m.trackElement.classList.contains('is-video'))\r\n    m.youTubePlayerWrapper.classList.replace('aspect-ratio-1_1', 'aspect-ratio-16_9');\r\n  else\r\n    m.youTubePlayerWrapper.classList.replace('aspect-ratio-16_9', 'aspect-ratio-1_1');\r\n}\r\n\r\nexport function setNextTrackState(nextTrackId, isPointerClick)\r\n{\r\n  clearTrackState(m.trackElement);\r\n\r\n  m.trackElement = queryTrackId(nextTrackId);\r\n\r\n  if (isPointerClick === false)\r\n    m.tracklistObserver.observe(m.trackElement);\r\n\r\n  m.trackElement.classList.add('current');\r\n}\r\n\r\nexport function setTrackMessage(message)\r\n{\r\n  m.trackElement.querySelector('.track-message').textContent   = message;\r\n  m.trackElement.querySelector('.track-message').style.display = 'block';\r\n}\r\n\r\nfunction setLocalPlayerDetails(player)\r\n{\r\n  if (settings.list.enableLocalPlayback)\r\n  {\r\n    if (player.getTrackType() === TRACK_TYPE.LOCAL)\r\n    {\r\n      const artistTitle = (player.getTitle().length !== 0)\r\n        ? `<b>${utils.escHtml(player.getArtist())}</b> - ${utils.escHtml(player.getTitle())}`\r\n        : utils.escHtml(player.getArtist());\r\n\r\n      m.localContainer.querySelector('.artist-title').innerHTML = artistTitle;\r\n      document.getElementById('local-player-image').src = encodeURI(m.trackElement.getAttribute('data-track-image-url'));\r\n    }\r\n  }\r\n}\r\n\r\nexport function updateTrackDetails(player)\r\n{\r\n  player.setArtistAndTitle(m.trackElement.getAttribute('data-track-artist'), m.trackElement.getAttribute('data-track-title'));\r\n  player.setDuration(parseInt(m.trackElement.getAttribute('data-track-duration')));\r\n  player.setThumbnail(m.trackElement);\r\n  setLocalPlayerDetails(player);\r\n  setPlayerAspectRatio();\r\n}\r\n", "//\r\n// PlaybackTimer base class\r\n//\r\n// https://ultrafunk.com\r\n//\r\n\r\n\r\nimport { settings } from '../../shared/session-data.js';\r\nimport { timeRemainingWarningBlink } from './playback-controls.js';\r\n\r\nimport {\r\n  EVENT,\r\n  dispatch,\r\n  addListener,\r\n} from './playback-events.js';\r\n\r\n\r\n/*************************************************************************************************/\r\n\r\n\r\nexport class PlaybackTimer\r\n{\r\n  #intervalId     = -1;\r\n  #lastPosSeconds = 0;\r\n  playedSeconds   = 0;\r\n  isVisible       = true;\r\n\r\n  config = {\r\n    updateTimerInterval: 250, // Milliseconds between each timer event\r\n    maxBufferingDelay:   3,   // VERY rough estimate of \"max\" network buffering delay in seconds\r\n    minPlayedSeconds:    3,   //\r\n  };\r\n\r\n  init()\r\n  {\r\n    document.addEventListener('visibilitychange', () =>\r\n    {\r\n      this.isVisible = (document.visibilityState === 'visible');\r\n    });\r\n\r\n    addListener(EVENT.MEDIA_PLAYING,     () => this.start());\r\n    addListener(EVENT.MEDIA_PAUSED,      () => this.stop());\r\n    addListener(EVENT.MEDIA_ENDED,       () => this.stop());\r\n    addListener(EVENT.MEDIA_CUE_TRACK,   () => this.stop());\r\n    addListener(EVENT.MEDIA_UNAVAILABLE, () => this.stop());\r\n    addListener(EVENT.AUTOPLAY_BLOCKED,  () => this.stop());\r\n  }\r\n\r\n  // Abstract methods to override in child class(es)\r\n  updateTimer() {}\r\n  updateVolumeMute() {}\r\n\r\n  start()\r\n  {\r\n    this.stop();\r\n    this.#intervalId = setInterval(() => this.updateTimer(), this.config.updateTimerInterval);\r\n  }\r\n\r\n  stop()\r\n  {\r\n    if (this.#intervalId !== -1)\r\n    {\r\n      clearInterval(this.#intervalId);\r\n      this.#intervalId = -1;\r\n    }\r\n\r\n    this.#lastPosSeconds = 0;\r\n    this.playedSeconds   = 0;\r\n\r\n    timeRemainingWarningBlink(false);\r\n  }\r\n\r\n  updateOncePerSecond(positionSeconds, durationSeconds)\r\n  {\r\n    if (this.#lastPosSeconds !== positionSeconds)\r\n    {\r\n      this.#lastPosSeconds = positionSeconds;\r\n      this.playedSeconds++;\r\n      this.updateVolumeMute();\r\n\r\n      if ((settings.playback.autoplay === false) && settings.playback.timeRemainingWarning)\r\n      {\r\n        const remainingSeconds = durationSeconds - positionSeconds;\r\n\r\n        if (remainingSeconds <= settings.playback.timeRemainingSeconds)\r\n        {\r\n          timeRemainingWarningBlink(true);\r\n          dispatch(EVENT.MEDIA_TIME_REMAINING, { timeRemainingSeconds: remainingSeconds });\r\n        }\r\n        else\r\n        {\r\n          timeRemainingWarningBlink(false);\r\n        }\r\n      }\r\n    }\r\n  }\r\n}\r\n", "//\r\n// List playback timer child class\r\n//\r\n// https://ultrafunk.com\r\n//\r\n\r\n\r\nimport { PlaybackTimer }            from '../common/playback-timer.js';\r\nimport { updateVolumeMuteSettings } from '../common/shared-gallery-list.js';\r\n\r\nimport {\r\n  isPlaying,\r\n  updateTimerAndProgress\r\n} from '../common/playback-controls.js';\r\n\r\n\r\n/*************************************************************************************************/\r\n\r\n\r\nclass ListPlaybackTimer extends PlaybackTimer\r\n{\r\n  #players = null;\r\n\r\n  #updateCallback(positionSecondsDecimal, durationSeconds)\r\n  {\r\n    if (positionSecondsDecimal !== undefined)\r\n    {\r\n      const positionSeconds = Math.round(positionSecondsDecimal);\r\n\r\n      updateTimerAndProgress((positionSecondsDecimal * 1000), positionSeconds, durationSeconds);\r\n\r\n      if ((positionSeconds > 0) && (durationSeconds > 0))\r\n        super.updateOncePerSecond(positionSeconds, durationSeconds);\r\n    }\r\n  }\r\n\r\n  ready(players)\r\n  {\r\n    super.init();\r\n    this.#players = players;\r\n  }\r\n\r\n  updateTimer()\r\n  {\r\n    if (this.isVisible && isPlaying())\r\n      this.#players.current.getPosition((position, duration) => this.#updateCallback(position, duration));\r\n  }\r\n\r\n  updateVolumeMute()\r\n  {\r\n    if ((this.playedSeconds >= this.config.minPlayedSeconds) && isPlaying())\r\n      this.#players.current.getVolume((volume) => updateVolumeMuteSettings(volume, this.#players.current.isMuted()));\r\n  }\r\n}\r\n\r\nexport const playbackTimer = new ListPlaybackTimer();\r\n", "//\r\n// Local (device) tracks loading and controls\r\n//\r\n// https://ultrafunk.com\r\n//\r\n\r\n\r\nimport { showSnackbar }      from '../../shared/snackbar.js';\r\nimport { TRACK_TYPE }        from '../common/mediaplayer.js';\r\nimport { getTrackEntryHtml } from './list-track-templates.js';\r\nimport { queryTrackAll }     from './list-controls.js';\r\n\r\nimport {\r\n  newDebugLogger,\r\n  logCss,\r\n} from '../../shared/debuglogger.js';\r\n\r\nimport {\r\n  VERSION,\r\n  ULTRAFUNK_THEME_URI,\r\n  THEME_ENV,\r\n} from '../../config.js';\r\n\r\nimport {\r\n  addListener,\r\n  escHtml,\r\n  stripHtml,\r\n} from '../../shared/utils.js';\r\n\r\n\r\n/*************************************************************************************************/\r\n\r\n\r\nconst debug = newDebugLogger('local-tracks');\r\n\r\nconst m = {\r\n  jsmediatags: null,\r\n  addTracksStartTime: 0,\r\n  addTracksHtmlTime:  0,\r\n};\r\n\r\nconst tracklistLocalHtml = /*html*/ `\r\n  <div id=\"tracklist-local\">\r\n    <label for=\"select-local-files\">Add local tracks:</label>\r\n    <input id=\"select-local-files\" type=\"file\" accept=\"audio/*\" multiple />\r\n    <button id=\"clear-local-tracks\" type=\"button\">Clear Tracks</button>\r\n  </div>`;\r\n\r\n\r\n// ************************************************************************************************\r\n//\r\n// ************************************************************************************************\r\n\r\nexport function initLocalTracks()\r\n{\r\n  debug.log('init()');\r\n\r\n  document.getElementById('tracklist').insertAdjacentHTML(\"beforeend\", tracklistLocalHtml);\r\n\r\n  addListener('#select-local-files', 'change', (event) => getSelectedFiles(event.target.files));\r\n  addListener('#select-local-files', 'cancel', (event) => getSelectedFiles(event.target.files));\r\n  addListener('#clear-local-tracks', 'click',  clearLocalTracks);\r\n}\r\n\r\n\r\n// ************************************************************************************************\r\n//\r\n// ************************************************************************************************\r\n\r\nfunction getSelectedFiles(filesList)\r\n{\r\n  if (filesList.length === 0)\r\n  {\r\n    showSnackbar({ message: 'No tracks selected', duration: 3 });\r\n  }\r\n  else\r\n  {\r\n    showSnackbar({ message: `Adding ${filesList.length} local ${(filesList.length === 1) ? 'track' : 'tracks'}...`, duration: 4 });\r\n\r\n    m.addTracksStartTime = performance.now();\r\n\r\n    if (m.jsmediatags === null)\r\n      loadJsMediaTagsScript(() => setTracksMetadata(filesList, inserLocalTracksHtml(filesList)));\r\n    else\r\n      setTracksMetadata(filesList, inserLocalTracksHtml(filesList));\r\n  }\r\n}\r\n\r\nfunction loadJsMediaTagsScript(onLoadedCallback)\r\n{\r\n  debug.log(`loadJsMediaTagsScript(): ${ULTRAFUNK_THEME_URI}/inc/js/jsmediatags.min.js?ver=${VERSION}`);\r\n\r\n  const scriptTag      = document.createElement('script');\r\n  const firstScriptTag = document.getElementsByTagName('script')[0];\r\n\r\n  scriptTag.type = 'text/javascript';\r\n  scriptTag.id   = 'js-media-tags';\r\n  scriptTag.src  = `${ULTRAFUNK_THEME_URI}/inc/js/jsmediatags.min.js?ver=${VERSION}`;\r\n\r\n  firstScriptTag.parentNode.insertBefore(scriptTag, firstScriptTag);\r\n\r\n  scriptTag.onload = () =>\r\n  {\r\n    m.jsmediatags = window.jsmediatags;\r\n    onLoadedCallback();\r\n  };\r\n}\r\n\r\nfunction clearLocalTracks()\r\n{\r\n  queryTrackAll('div.track-entry.track-type-local')?.forEach(trackElement =>\r\n  {\r\n    if (trackElement.classList.contains('current') === false)\r\n    {\r\n      const trackBlobUrl      = trackElement.getAttribute('data-track-url');\r\n      const trackImageBlobUrl = trackElement.getAttribute('data-track-image-url');\r\n\r\n      if (trackBlobUrl !== null)\r\n        URL.revokeObjectURL(trackBlobUrl);\r\n\r\n      if ((trackImageBlobUrl !== null) && (trackImageBlobUrl.startsWith('blob:')))\r\n        URL.revokeObjectURL(trackImageBlobUrl);\r\n\r\n      trackElement.remove();\r\n    }\r\n  });\r\n\r\n  showSnackbar({ message: 'Local tracks removed', duration: 3 });\r\n}\r\n\r\nfunction logPerfTime(filesCount)\r\n{\r\n  const addTracksStop = performance.now();\r\n  console.log(`%cAdded ${filesCount} local track(s) in ${Math.ceil(addTracksStop - m.addTracksStartTime)} ms. (insert HTML: ${Math.ceil(m.addTracksHtmlTime - m.addTracksStartTime)} ms.) for ${THEME_ENV.siteUrl}`, logCss);\r\n}\r\n\r\n\r\n// ************************************************************************************************\r\n//\r\n// ************************************************************************************************\r\n\r\nfunction inserLocalTracksHtml(filesList)\r\n{\r\n  const tracksUid = [];\r\n  let index       = 0;\r\n  let tracksHtml  = '';\r\n\r\n  for (const file of filesList)\r\n  {\r\n    const trackUri = encodeURI(URL.createObjectURL(file));\r\n\r\n    tracksUid.push(`track-${(Date.now() + index)}`);\r\n\r\n    tracksHtml += getTrackEntryHtml(\r\n    {\r\n      uid: tracksUid[index++],\r\n      id: 'local',\r\n      link: trackUri,\r\n      artists: [],\r\n      channels: [],\r\n      meta: {\r\n        track_source_type: TRACK_TYPE.LOCAL,\r\n        track_source_data: trackUri,\r\n        track_artist: 'Loading...',\r\n        track_title: '',\r\n        track_duration: 0,\r\n      }\r\n    });\r\n  }\r\n\r\n  document.getElementById('tracklist').insertAdjacentHTML(\"beforeend\", tracksHtml);\r\n  m.addTracksHtmlTime = performance.now();\r\n\r\n  return tracksUid;\r\n}\r\n\r\nfunction setTracksMetadata(filesList, tracksUid)\r\n{\r\n  let index = 0;\r\n  let processedTracks = 0;\r\n\r\n  for (const file of filesList)\r\n  {\r\n    const trackElement  = document.getElementById(tracksUid[index++]);\r\n    const fileName      = stripHtml(escHtml(file.name));\r\n    const fileExtIndex  = fileName.lastIndexOf('.');\r\n    const fileNameNoExt = (fileExtIndex !== -1) ? fileName.slice(0, fileExtIndex) : fileName;\r\n    const fileType      = (fileExtIndex !== -1) ? fileName.slice(fileExtIndex + 1).toUpperCase() : file.type;\r\n\r\n    trackElement.setAttribute('data-track-image-url', THEME_ENV.defaultLTImagePlaceholder);\r\n    trackElement.setAttribute('data-track-file-name', fileName);\r\n    trackElement.setAttribute('data-track-file-type', fileType);\r\n    trackElement.setAttribute('data-track-file-size', file.size);\r\n\r\n    m.jsmediatags.read(file,\r\n    {\r\n      onSuccess: (mediaTags) =>\r\n      {\r\n        if (Object.keys(mediaTags.tags).length !== 0)\r\n          setTrackArtistTitle(mediaTags.tags, trackElement, fileNameNoExt);\r\n        else\r\n          setFallbackTrackArtistTitle(trackElement, fileNameNoExt);\r\n\r\n        if (++processedTracks === filesList.length)\r\n          logPerfTime(filesList.length);\r\n      },\r\n      onError: () =>\r\n      {\r\n        setFallbackTrackArtistTitle(trackElement, fileNameNoExt);\r\n\r\n        if (++processedTracks === filesList.length)\r\n          logPerfTime(filesList.length);\r\n      }\r\n    });\r\n  }\r\n}\r\n\r\nfunction setTrackArtistTitle(tags, trackElement, fileNameNoExt)\r\n{\r\n  if ((tags.artist === undefined) && (tags.title === undefined))\r\n  {\r\n    setFallbackTrackArtistTitle(trackElement, fileNameNoExt);\r\n  }\r\n  else\r\n  {\r\n    let artist = fileNameNoExt;\r\n    let title  = fileNameNoExt;\r\n\r\n    if ((tags.artist !== undefined) && (tags.artist.length !== 0))\r\n      artist = stripHtml(tags.artist);\r\n\r\n    if ((tags.title !== undefined) && (tags.title.length !== 0))\r\n      title = stripHtml(tags.title);\r\n\r\n    trackElement.setAttribute('data-track-artist', artist);\r\n    trackElement.setAttribute('data-track-title',  title);\r\n    trackElement.querySelector('div.artist-title').innerHTML = `<span><b>${artist}</b></span><br><span>${title}</span>`;\r\n\r\n    setTrackImages(tags, trackElement);\r\n  }\r\n}\r\n\r\nfunction setFallbackTrackArtistTitle(trackElement, fileNameNoExt)\r\n{\r\n  trackElement.setAttribute('data-track-artist', fileNameNoExt);\r\n  trackElement.querySelector('div.artist-title').innerHTML = `<span><b>${fileNameNoExt}</b></span>`;\r\n}\r\n\r\nasync function setTrackImages(tags, trackElement)\r\n{\r\n  if (tags.picture !== undefined)\r\n  {\r\n    const trackImage = new Image();\r\n    const imageBlob  = new Blob([new Uint8Array(tags.picture.data).buffer], { type: tags.picture.format });\r\n    const imageUrl   = encodeURI(URL.createObjectURL(imageBlob));\r\n\r\n    trackImage.src = imageUrl;\r\n    await trackImage.decode();\r\n\r\n    trackElement.querySelector('button.thumbnail img').src = imageUrl;\r\n    trackElement.setAttribute('data-track-thumbnail-url', imageUrl);\r\n    trackElement.setAttribute('data-track-image-url', imageUrl);\r\n  }\r\n}\r\n", "//\r\n// Track to track crossfade module\r\n//\r\n// https://ultrafunk.com\r\n//\r\n\r\n\r\nimport { newDebugLogger } from '../../shared/debuglogger.js';\r\nimport { settings }       from '../../shared/session-data.js';\r\n\r\n\r\n/*************************************************************************************************/\r\n\r\n\r\nconst debug = newDebugLogger('crossfade');\r\n\r\nexport const VOLUME = {\r\n  MIN:   0,\r\n  MAX: 100,\r\n};\r\n\r\nconst TYPE = {\r\n  NONE:  0,\r\n  AUTO:  1,\r\n  TRACK: 2,\r\n};\r\n\r\nexport { TYPE as CROSSFADE_TYPE };\r\n\r\nconst CURVE = {\r\n  NONE:        0,\r\n  EQUAL_POWER: 1,\r\n  LINEAR:      2,\r\n};\r\n\r\nconst STATE = {\r\n  NONE:   0,\r\n  INIT:   1,\r\n  FADING: 2,\r\n};\r\n\r\nconst stoppedIntervalId = -1;\r\n\r\nconst config = {\r\n  intervalEqPow:   33, // Milliseconds between each crossfade update event\r\n  intervalLinear: 100,\r\n};\r\n\r\n\r\n// ************************************************************************************************\r\n// Crossfade closure\r\n// ************************************************************************************************\r\n\r\nexport const crossfadeClosure = ((galleryPlayers) =>\r\n{\r\n  const players       = galleryPlayers;\r\n  let fadeState       = STATE.NONE;\r\n  let intervalId      = stoppedIntervalId;\r\n  let fadeOutPlayer   = null;\r\n  let fadeInPlayer    = null;\r\n  let fadeLength      = 0;\r\n  let fadeStartVolume = 0;\r\n  let fadeType        = TYPE.NONE;\r\n  let fadePreset      = null;\r\n  let fadeStartTime   = 0;\r\n\r\n  return {\r\n    isFading() { return (fadeState !== STATE.NONE); },\r\n    init,\r\n    start,\r\n    stop,\r\n    mute,\r\n  };\r\n\r\n  function init(crossfadeType, crossfadePreset, fadeInUid = null)\r\n  {\r\n    if ((fadeState === STATE.NONE) && (setFadeOutInPlayers(fadeInUid) === true))\r\n    {\r\n      debug.log(`init() - type: ${debug.getKeyForValue(TYPE, crossfadeType)} - fadeInUid: ${fadeInUid} - preset: ${crossfadePreset.length} sec ${debug.getKeyForValue(CURVE, crossfadePreset.curve)} (Name: ${crossfadePreset.name})`);\r\n\r\n      fadeState       = STATE.INIT;\r\n      fadeStartVolume = settings.playback.masterVolume;\r\n      fadeType        = crossfadeType;\r\n      fadePreset      = crossfadePreset;\r\n\r\n      fadeInPlayer.setVolume(0);\r\n\r\n      return true;\r\n    }\r\n\r\n    return false;\r\n  }\r\n\r\n  function start()\r\n  {\r\n    if (fadeState === STATE.INIT)\r\n    {\r\n      fadeState = STATE.FADING;\r\n\r\n      fadeOutPlayer.getPosition((positionMilliseconds) =>\r\n      {\r\n        const updateInterval = (fadePreset.curve === CURVE.EQUAL_POWER) ? config.intervalEqPow : config.intervalLinear;\r\n        fadeStartTime        = ((positionMilliseconds + updateInterval) / 1000);\r\n        const timeRemaining  = fadeOutPlayer.getDuration() - fadeStartTime;\r\n        const fadeRemaining  = timeRemaining - (updateInterval / 100);\r\n\r\n        if (fadeType === TYPE.AUTO)\r\n          fadeLength = fadeRemaining;\r\n        else if (fadeType === TYPE.TRACK)\r\n          fadeLength = (timeRemaining > fadePreset.length) ? fadePreset.length : fadeRemaining;\r\n\r\n        debug.log(`start() - fadeStartTime: ${fadeStartTime.toFixed(2)} sec - timeRemaining: ${timeRemaining.toFixed(2)} sec - fadeLength: ${fadeLength.toFixed(2)} sec - updateInterval: ${updateInterval} ms`);\r\n\r\n        intervalId = setInterval((fadePreset.curve === CURVE.EQUAL_POWER) ? equalPowerFade : linearFade, updateInterval);\r\n      });\r\n    }\r\n  }\r\n\r\n  function stop()\r\n  {\r\n    debug.log(`stop() - fadeState: ${debug.getKeyForValue(STATE, fadeState)}`);\r\n\r\n    if (fadeState !== STATE.NONE)\r\n    {\r\n      if (intervalId !== stoppedIntervalId)\r\n      {\r\n        clearInterval(intervalId);\r\n        intervalId = stoppedIntervalId;\r\n      }\r\n\r\n      if (fadeOutPlayer !== null)\r\n      {\r\n        fadeOutPlayer.pause();\r\n        fadeOutPlayer.seekTo(0);\r\n\r\n        // ToDo: Temp fix for: This might POP on fade out end, check if there is a safer way to reset the volume\r\n        setTimeout(() =>\r\n        {\r\n          fadeOutPlayer.setVolume(settings.playback.masterVolume); // ToDo: fadeStartVolume is 0 because of setTimeout()\r\n          fadeOutPlayer = null;\r\n        },\r\n        250);\r\n      }\r\n\r\n      if (fadeInPlayer !== null)\r\n      {\r\n        // If crossfade is stopped before completion, set fade-in player volume to its crossfade completion value\r\n        fadeInPlayer.setVolume(fadeStartVolume);\r\n        fadeInPlayer = null;\r\n      }\r\n\r\n      fadeState       = STATE.NONE;\r\n      fadeLength      = 0;\r\n      fadeStartVolume = 0;\r\n      fadeType        = TYPE.NONE;\r\n      fadePreset      = null;\r\n      fadeStartTime   = 0;\r\n    }\r\n  }\r\n\r\n  function mute(setMute)\r\n  {\r\n    if (fadeOutPlayer !== null)\r\n      fadeOutPlayer.mute(setMute);\r\n  }\r\n\r\n  function setFadeOutInPlayers(fadeInUid)\r\n  {\r\n    fadeOutPlayer = players.current;\r\n    fadeInPlayer  = (fadeInUid === null) ? players.next : players.playerFromIframeId(fadeInUid);\r\n\r\n    if (fadeOutPlayer.isPlayable() && fadeInPlayer.isPlayable())\r\n      return true;\r\n\r\n    return false;\r\n  }\r\n\r\n  //\r\n  // https://dsp.stackexchange.com/questions/14754/equal-power-crossfade\r\n  //\r\n  function equalPowerFade()\r\n  {\r\n    fadeOutPlayer.getPosition((positionMilliseconds) =>\r\n    {\r\n      // SoundCloud getPosition() is async so the interval timer can be stopped before this is called, if so, just bail out...\r\n      if (intervalId === stoppedIntervalId)\r\n        return;\r\n\r\n      // Clamp negative position values\r\n      const position     = ((positionMilliseconds / 1000) - fadeStartTime);\r\n      const fadePosition = (position >= 0) ? position : 0;\r\n\r\n      // Clamp negative volume values\r\n      const volume     = fadeStartVolume - (fadeStartVolume * (fadePosition / fadeLength));\r\n      const fadeVolume = (volume >= VOLUME.MIN) ? volume : VOLUME.MIN;\r\n\r\n      const fadeOutVolume = Math.round(Math.sqrt(fadeStartVolume * fadeVolume));\r\n      const fadeInVolume  = Math.round(Math.sqrt(fadeStartVolume * (fadeStartVolume - fadeVolume)));\r\n\r\n      if ((fadePosition >= fadeLength) && (fadeVolume <= VOLUME.MIN) && (fadeInVolume >= fadeStartVolume))\r\n      {\r\n        fadeOutPlayer.setVolume(VOLUME.MIN);\r\n        fadeInPlayer.setVolume(fadeStartVolume);\r\n        stop();\r\n      }\r\n      else\r\n      {\r\n        fadeOutPlayer.setVolume(fadeOutVolume);\r\n        fadeInPlayer.setVolume(fadeInVolume);\r\n      }\r\n    });\r\n  }\r\n\r\n  function linearFade()\r\n  {\r\n    fadeOutPlayer.getPosition((positionMilliseconds) =>\r\n    {\r\n      // SoundCloud getPosition() is async so the interval timer can be stopped before this is called, if so, just bail out...\r\n      if (intervalId === stoppedIntervalId)\r\n        return;\r\n\r\n      const fadePosition  = ((positionMilliseconds / 1000) - fadeStartTime);\r\n      const fadeInVolume  = Math.round(fadeStartVolume * (fadePosition / fadeLength));\r\n      const fadeOutVolume = fadeStartVolume - fadeInVolume;\r\n\r\n      if ((fadePosition > fadeLength) && (fadeOutVolume < VOLUME.MIN) && (fadeInVolume > fadeStartVolume))\r\n      {\r\n        fadeOutPlayer.setVolume(VOLUME.MIN);\r\n        fadeInPlayer.setVolume(fadeStartVolume);\r\n        stop();\r\n      }\r\n      else\r\n      {\r\n        fadeOutPlayer.setVolume(fadeOutVolume);\r\n        fadeInPlayer.setVolume(fadeInVolume);\r\n      }\r\n    });\r\n  }\r\n});\r\n", "//\r\n// List player classes\r\n//\r\n// https://ultrafunk.com\r\n//\r\n\r\n\r\nimport { VOLUME }    from \"../gallery/crossfade.js\";\r\nimport { THEME_ENV } from \"../../config.js\";\r\n\r\nimport {\r\n  onSoundCloudPlayerStateChange,\r\n  onLocalPlayerStateChange,\r\n  onPlayerError,\r\n} from \"./embedded-players.js\";\r\n\r\nimport {\r\n  TRACK_TYPE,\r\n  MediaPlayer,\r\n  getYouTubeThumbnailUrl,\r\n  getSoundCloudThumbnailUrl,\r\n} from \"../common/mediaplayer.js\";\r\n\r\n\r\n// ************************************************************************************************\r\n// YouTube player class\r\n// ************************************************************************************************\r\n\r\nclass YouTubePlayer extends MediaPlayer\r\n{\r\n  #playerError = -1;\r\n\r\n  constructor(embeddedPlayer)\r\n  {\r\n    super(TRACK_TYPE.YOUTUBE, null, null, embeddedPlayer);\r\n  }\r\n\r\n  setPlayerError(errorNum) { this.#playerError = errorNum; }\r\n\r\n  resetState()\r\n  {\r\n    this.#playerError = -1;\r\n    this.setIsCued(false);\r\n  }\r\n\r\n  cueTrackById(sourceUid, positionSeconds = 0)\r\n  {\r\n    this.embedded.cueVideoById(sourceUid, positionSeconds);\r\n    this.setIsCued(true);\r\n\r\n    return true;\r\n  }\r\n\r\n  playTrackById(sourceUid, positionSeconds = 0)\r\n  {\r\n    this.embedded.loadVideoById(sourceUid, positionSeconds);\r\n    this.setIsCued(false);\r\n\r\n    return true;\r\n  }\r\n\r\n  play()\r\n  {\r\n    this.setIsCued(false);\r\n\r\n    if (this.#playerError !== -1)\r\n    {\r\n      onPlayerError(TRACK_TYPE.YOUTUBE, this.#playerError);\r\n      this.#playerError = -1;\r\n    }\r\n    else\r\n    {\r\n      this.embedded.playVideo();\r\n    }\r\n  }\r\n\r\n  pause()   { this.embedded.pauseVideo();     }\r\n  stop()    { this.embedded.stopVideo();      }\r\n  mute()    { this.embedded.mute();           }\r\n  unMute()  { this.embedded.unMute();         }\r\n  isMuted() { return this.embedded.isMuted(); }\r\n\r\n  getVolume(callback)\r\n  {\r\n    callback(this.embedded.getVolume());\r\n  }\r\n\r\n  getPosition(callback)\r\n  {\r\n    callback(this.embedded.getCurrentTime(), this.duration);\r\n  }\r\n\r\n  setThumbnail(trackElement)\r\n  {\r\n    super.setThumbnail(getYouTubeThumbnailUrl(trackElement.getAttribute('data-track-source-uid')));\r\n  }\r\n}\r\n\r\n\r\n// ************************************************************************************************\r\n// SoundCloud player class\r\n// ************************************************************************************************\r\n\r\nclass SoundCloudPlayer extends MediaPlayer\r\n{\r\n  #volume  = VOLUME.MAX;\r\n  #isMuted = false;\r\n\r\n  #playerOptions = {\r\n    visual:        true,\r\n    single_active: true,\r\n    show_artwork:  true,\r\n  };\r\n\r\n  constructor(embeddedPlayer)\r\n  {\r\n    super(TRACK_TYPE.SOUNDCLOUD, null, null, embeddedPlayer);\r\n  }\r\n\r\n  resetState()\r\n  {\r\n    this.setIsPlayable(true);\r\n    this.setIsCued(false);\r\n  }\r\n\r\n  cueTrackById(sourceUid, positionSeconds = 0)\r\n  {\r\n    onSoundCloudPlayerStateChange('loading');\r\n    this.setIsCued(true);\r\n\r\n    return new Promise((resolve) => this.embedded.load(`https://${sourceUid}`, {...this.#playerOptions, callback: () => this.#cueOrPlayTrackById(positionSeconds, false, resolve) }));\r\n  }\r\n\r\n  playTrackById(sourceUid, positionSeconds = 0)\r\n  {\r\n    onSoundCloudPlayerStateChange('loading');\r\n    this.setIsCued(false);\r\n\r\n    return new Promise((resolve) => this.embedded.load(`https://${sourceUid}`, {...this.#playerOptions, callback: () => this.#cueOrPlayTrackById(positionSeconds, true, resolve) }));\r\n  }\r\n\r\n  #cueOrPlayTrackById(positionSeconds, playTrack, resolve)\r\n  {\r\n    this.embedded.getDuration(durationMilliseconds =>\r\n    {\r\n      this.setDuration(Math.round(durationMilliseconds / 1000));\r\n      this.seekTo(positionSeconds);\r\n\r\n      this.embedded.getCurrentSound((soundObject) =>\r\n      {\r\n        this.setThumbnail(null, soundObject);\r\n        onSoundCloudPlayerStateChange('ready');\r\n\r\n        if (playTrack)\r\n          this.#playSoundObject(soundObject);\r\n\r\n        resolve(this.isPlayable());\r\n      });\r\n    });\r\n  }\r\n\r\n  #playSoundObject(soundObject)\r\n  {\r\n    if ((this.isPlayable() === false) || (soundObject === null))\r\n    {\r\n      onPlayerError(TRACK_TYPE.SOUNDCLOUD);\r\n      this.setIsPlayable(true);\r\n    }\r\n    else\r\n    {\r\n      this.embedded.play();\r\n    }\r\n  }\r\n\r\n  play()\r\n  {\r\n    this.setIsCued(false);\r\n    this.embedded.getCurrentSound((soundObject) => this.#playSoundObject(soundObject));\r\n  }\r\n\r\n  pause() { this.embedded.pause(); }\r\n\r\n  stop()\r\n  {\r\n    this.pause();\r\n    super.seekTo(0);\r\n  }\r\n\r\n  // Override parent because SoundCloud seekTo() needs milliseconds instead of just seconds\r\n  seekTo(positionSeconds)\r\n  {\r\n    super.seekTo(positionSeconds * 1000);\r\n  }\r\n\r\n  getVolume(callback)\r\n  {\r\n    if (this.#isMuted === false)\r\n      this.embedded.getVolume(volume => callback(volume));\r\n  }\r\n\r\n  // Override parent setVolume() because we use it for mute() as well\r\n  setVolume(volume)\r\n  {\r\n    if (volume !== 0)\r\n      this.#volume = volume;\r\n\r\n    if ((this.#isMuted === false) || (volume === 0))\r\n      super.setVolume(volume);\r\n  }\r\n\r\n  mute()\r\n  {\r\n    this.#isMuted = true;\r\n    this.setVolume(0);\r\n  }\r\n\r\n  unMute()\r\n  {\r\n    this.#isMuted = false;\r\n    this.setVolume(this.#volume);\r\n  }\r\n\r\n  isMuted()\r\n  {\r\n    return this.#isMuted;\r\n  }\r\n\r\n  getPosition(callback)\r\n  {\r\n    this.embedded.getPosition(positionMilliseconds => callback((positionMilliseconds / 1000), this.duration));\r\n  }\r\n\r\n  setThumbnail(trackElement, soundObject = null)\r\n  {\r\n    if (soundObject === null)\r\n    {\r\n      if (trackElement === null)\r\n        super.setThumbnail({ src: THEME_ENV.defaultSCThumbnail, class: 'track-type-soundcloud' });\r\n      else\r\n        super.setThumbnail({ src: encodeURI(trackElement.getAttribute('data-track-thumbnail-url')), class: 'track-type-soundcloud' });\r\n    }\r\n    else\r\n    {\r\n      super.setThumbnail(getSoundCloudThumbnailUrl(soundObject));\r\n    }\r\n  }\r\n}\r\n\r\n\r\n// ************************************************************************************************\r\n// Local (HTML audio) player class\r\n// ************************************************************************************************\r\n\r\nclass LocalPlayer extends MediaPlayer\r\n{\r\n  constructor(embeddedPlayer)\r\n  {\r\n    super(TRACK_TYPE.LOCAL, null, null, embeddedPlayer);\r\n  }\r\n\r\n  resetState()\r\n  {\r\n  }\r\n\r\n  cueTrackById(sourceUid, positionSeconds = 0)\r\n  {\r\n    onLocalPlayerStateChange({ type: 'cued' });\r\n    this.embedded.src         = sourceUid;\r\n    this.embedded.currentTime = positionSeconds;\r\n    this.setIsCued(true);\r\n\r\n    return true;\r\n  }\r\n\r\n  playTrackById(sourceUid, positionSeconds = 0)\r\n  {\r\n    onLocalPlayerStateChange({ type: 'cued' });\r\n    this.embedded.src         = sourceUid;\r\n    this.embedded.currentTime = positionSeconds;\r\n    this.play();\r\n    this.setIsCued(false);\r\n\r\n    return true;\r\n  }\r\n\r\n  play()\r\n  {\r\n    this.embedded.play();\r\n  }\r\n\r\n  stop()\r\n  {\r\n    this.embedded.pause();\r\n    this.embedded.currentTime = 0;\r\n  }\r\n\r\n  pause()   { this.embedded.pause();       }\r\n  mute()    { this.embedded.muted = true;  }\r\n  unMute()  { this.embedded.muted = false; }\r\n  isMuted() { return this.embedded.muted;  }\r\n\r\n  getPosition(callback)\r\n  {\r\n    callback(Math.floor(this.embedded.currentTime), this.duration);\r\n  }\r\n\r\n  getDuration()\r\n  {\r\n    return Math.floor(this.embedded.duration);\r\n  }\r\n\r\n  seekTo(positionSeconds)\r\n  {\r\n    this.embedded.currentTime = positionSeconds;\r\n  }\r\n\r\n  getVolume(callback)\r\n  {\r\n    // Player volume is min 0.0 => 1.0 max, we use 0 => 100\r\n    callback(Math.round(this.embedded.volume * 100));\r\n  }\r\n\r\n  setVolume(volume)\r\n  {\r\n    // Our volume is 0 => 100, player uses min 0.0 => 1.0 max\r\n    this.embedded.volume = (volume / 100);\r\n  }\r\n\r\n  setThumbnail(trackElement)\r\n  {\r\n    super.setThumbnail({ src: encodeURI(trackElement.getAttribute('data-track-thumbnail-url')), class: 'track-type-local' });\r\n  }\r\n}\r\n\r\n\r\n// ************************************************************************************************\r\n// List Players proxy class\r\n// ************************************************************************************************\r\n\r\nexport class ListPlayers\r\n{\r\n  #youTubePlayer    = null;\r\n  #soundCloudPlayer = null;\r\n  #localPlayer      = null;\r\n  #currentPlayer    = null;\r\n\r\n  constructor(youTubePlayer, soundCloudPlayer, localPlayer)\r\n  {\r\n    this.#youTubePlayer    = new YouTubePlayer(youTubePlayer);\r\n    this.#soundCloudPlayer = new SoundCloudPlayer(soundCloudPlayer);\r\n    this.#localPlayer      = new LocalPlayer(localPlayer);\r\n  }\r\n\r\n  get current() { return this.#currentPlayer; }\r\n\r\n  setCurrentPlayer(trackType)\r\n  {\r\n    switch (trackType)\r\n    {\r\n      case TRACK_TYPE.YOUTUBE:    this.#currentPlayer = this.#youTubePlayer;    break;\r\n      case TRACK_TYPE.SOUNDCLOUD: this.#currentPlayer = this.#soundCloudPlayer; break;\r\n      case TRACK_TYPE.LOCAL:      this.#currentPlayer = this.#localPlayer;      break;\r\n    }\r\n  }\r\n\r\n  getTrackData(positionSeconds = 0)\r\n  {\r\n    return {\r\n      currentTrack: 1,\r\n      numTracks:    1,\r\n      artist:       this.#currentPlayer.getArtist(),\r\n      title:        this.#currentPlayer.getTitle(),\r\n      position:     positionSeconds,\r\n      duration:     this.#currentPlayer.getDuration(),\r\n      thumbnail:    { src: this.#currentPlayer.getThumbnailSrc(), class: this.#currentPlayer.getThumbnailClass() },\r\n    };\r\n  }\r\n}\r\n", "//\r\n// Event logging and matching classes\r\n//\r\n// https://ultrafunk.com\r\n//\r\n\r\n\r\nimport { newDebugLogger } from '../../shared/debuglogger.js';\r\n\r\n\r\n/*************************************************************************************************/\r\n\r\n\r\nconst debug = newDebugLogger('eventlogger');\r\n\r\n\r\n// ************************************************************************************************\r\n// EventLog base class\r\n// ************************************************************************************************\r\n\r\nclass EventLog\r\n{\r\n  SOURCE = {\r\n  // Default source\r\n    UNKNOWN: -10000,\r\n  // Playback event sources\r\n    YOUTUBE:    1,\r\n    SOUNDCLOUD: 2,\r\n    LOCAL:      3,\r\n    ULTRAFUNK:  50,\r\n  // Interaction event sources\r\n  //KEYBOARD: 1010,\r\n    MOUSE:    1020,\r\n  };\r\n\r\n  EVENT = {\r\n  // Default event\r\n    UNKNOWN:         -10000,\r\n  // Playback event types\r\n    STATE_ERROR:     -5,\r\n    STATE_UNSTARTED: -1,  // YT.PlayerState.UNSTARTED\r\n    STATE_ENDED:      0,  // YT.PlayerState.ENDED\r\n    STATE_PLAYING:    1,  // YT.PlayerState.PLAYING\r\n    STATE_PAUSED:     2,  // YT.PlayerState.PAUSED\r\n    STATE_BUFFERING:  3,  // YT.PlayerState.BUFFERING\r\n    STATE_CUED:       5,  // YT.PlayerState.CUED\r\n    RESUME_AUTOPLAY: 50,\r\n    PLAYER_ERROR:    60,\r\n    CROSSFADE_START: 70,\r\n  // Interaction event types\r\n  //KEY_ARROW_LEFT:  1010,\r\n  //KEY_ARROW_RIGHT: 1020,\r\n    MOUSE_CLICK:     1030,\r\n  };\r\n\r\n  #log        = [];\r\n  #maxEntries = 0;\r\n  #matchCount = 0;\r\n  #lastPos    = 0;\r\n\r\n  constructor(maxEntries = 10)\r\n  {\r\n    this.#maxEntries = maxEntries;\r\n  }\r\n\r\n  add(eventSource = this.SOURCE.UNKNOWN, eventType = this.EVENT.UNKNOWN, uId = null, timestamp = Date.now())\r\n  {\r\n    if (this.#log.length >= this.#maxEntries)\r\n      this.#log.shift();\r\n\r\n    this.#log.push({\r\n      eventSource: eventSource,\r\n      eventType:   eventType,\r\n      uId:         uId,\r\n      timestamp:   timestamp,\r\n    });\r\n  }\r\n\r\n  clear()      { this.#log = [];       }\r\n  getLastPos() { return this.#lastPos; }\r\n\r\n  initMatch()\r\n  {\r\n    this.#lastPos    = this.#log.length - 1;\r\n    this.#matchCount = 0;\r\n  }\r\n\r\n  matchesEvent(index, eventSource, eventType, uId = null)\r\n  {\r\n    if ((this.#log[this.#lastPos - index].eventSource === eventSource) &&\r\n        (this.#log[this.#lastPos - index].eventType   === eventType)   &&\r\n        (this.#log[this.#lastPos - index].uId         === uId))\r\n    {\r\n      this.#matchCount++;\r\n    }\r\n  }\r\n\r\n  matchesDelta(elements, delta)\r\n  {\r\n    if ((this.#log[this.#lastPos].timestamp - this.#log[this.#lastPos - elements].timestamp) <= delta)\r\n      this.#matchCount++;\r\n  }\r\n\r\n  isPatternMatch(matchCount, event)\r\n  {\r\n    if (this.#matchCount === matchCount)\r\n    {\r\n      debug.log(`MATCH for: ${event}`);\r\n      this.logEventMatch();\r\n\r\n      return true;\r\n    }\r\n\r\n    return false;\r\n  }\r\n\r\n  logEventMatch()\r\n  {\r\n    const entries = [];\r\n\r\n    this.#log.forEach((entry) =>\r\n    {\r\n      entries.push({\r\n        eventSource: debug.getKeyForValue(this.SOURCE, entry.eventSource),\r\n        eventType:   debug.getKeyForValue(this.EVENT,  entry.eventType),\r\n        uId:         entry.uId,\r\n        timestamp:   entry.timestamp,\r\n      });\r\n    });\r\n\r\n    debug.log(entries);\r\n  }\r\n}\r\n\r\n\r\n// ************************************************************************************************\r\n// Child classes\r\n// ************************************************************************************************\r\n\r\nexport class PlaybackLog extends EventLog\r\n{\r\n  scAutoplayBlocked(uId, deltaTime)\r\n  {\r\n    this.initMatch();\r\n\r\n    if (this.getLastPos() >= 3)\r\n    {\r\n      this.matchesEvent(3, this.SOURCE.ULTRAFUNK,  this.EVENT.RESUME_AUTOPLAY, null);\r\n      this.matchesEvent(2, this.SOURCE.SOUNDCLOUD, this.EVENT.STATE_PLAYING,   uId);\r\n      this.matchesEvent(1, this.SOURCE.SOUNDCLOUD, this.EVENT.STATE_PAUSED,    uId);\r\n      this.matchesEvent(0, this.SOURCE.SOUNDCLOUD, this.EVENT.STATE_PAUSED,    uId);\r\n      this.matchesDelta(3, deltaTime);\r\n    }\r\n\r\n    return this.isPatternMatch(5, 'SoundCloud Autoplay Blocked');\r\n  }\r\n\r\n  scPlayDoubleTrigger(uId, deltaTime)\r\n  {\r\n    this.initMatch();\r\n\r\n    if (this.getLastPos() >= 2)\r\n    {\r\n      this.matchesEvent(2, this.SOURCE.ULTRAFUNK,  this.EVENT.CROSSFADE_START, null);\r\n      this.matchesEvent(1, this.SOURCE.SOUNDCLOUD, this.EVENT.STATE_PLAYING,   uId);\r\n      this.matchesEvent(0, this.SOURCE.SOUNDCLOUD, this.EVENT.STATE_PLAYING,   uId);\r\n      this.matchesDelta(1, deltaTime);\r\n    }\r\n\r\n    return this.isPatternMatch(4, 'SoundCloud Play Double Trigger');\r\n  }\r\n}\r\n\r\nexport class InteractionLog extends EventLog\r\n{\r\n  doubleClicked(eventSource, eventType, deltaTime)\r\n  {\r\n    this.initMatch();\r\n\r\n    if (this.getLastPos() >= 1)\r\n    {\r\n      this.matchesEvent(1, eventSource, eventType);\r\n      this.matchesEvent(0, eventSource, eventType);\r\n      this.matchesDelta(1, deltaTime);\r\n    }\r\n\r\n    return this.isPatternMatch(3, `${debug.getKeyForValue(this.SOURCE, eventSource)} Double Clicked`);\r\n  }\r\n}\r\n", "//\r\n// Embedded players (YouTube, SoundCloud & Local HTML <audio>)\r\n//\r\n// https://ultrafunk.com\r\n//\r\n\r\n\r\nimport * as playbackEvents   from '../common/playback-events.js';\r\nimport * as listControls     from './list-controls.js';\r\nimport * as playbackControls from '../common/playback-controls.js';\r\nimport { newDebugLogger }    from '../../shared/debuglogger.js';\r\nimport { TRACK_TYPE }        from '../common/mediaplayer.js';\r\nimport { initLocalTracks }   from './local-tracks.js';\r\nimport { ListPlayers }       from './list-players.js';\r\nimport { settings }          from '../../shared/session-data.js';\r\nimport { STATE }             from '../common/element-wrappers.js';\r\nimport { getTimeString }     from '../../shared/utils.js';\r\nimport { PlaybackLog }       from '../common/eventlogger.js';\r\nimport { onEmbeddedPlayersReady } from './list-playback.js';\r\n\r\n\r\n/*************************************************************************************************/\r\n\r\n\r\nconst debug = newDebugLogger('embedded-players');\r\nexport const eventLog = new PlaybackLog(10);\r\n\r\nconst m = {\r\n  players:           null,\r\n  autoplayData:      null,\r\n  currentTrackId:    null,\r\n  initialPlayerType: TRACK_TYPE.NONE,\r\n  initialPlayerCued: false,\r\n};\r\n\r\n\r\n// ************************************************************************************************\r\n//\r\n// ************************************************************************************************\r\n\r\nexport function initEmbeddedPlayers(autoplayData, currentTrackId, initialPlayerType)\r\n{\r\n  debug.log('init()');\r\n\r\n  m.autoplayData      = autoplayData;\r\n  m.currentTrackId    = currentTrackId;\r\n  m.initialPlayerType = initialPlayerType;\r\n\r\n  window.onYouTubeIframeAPIReady = () =>\r\n  {\r\n    debug.log('onYouTubeIframeAPIReady()');\r\n\r\n    m.players = new ListPlayers(initYouTubePlayer(), initSoundCloudPlayer(), initLocalPlayer());\r\n    debug.log(m.players);\r\n\r\n    playbackControls.init((positionSeconds) => m.players.getTrackData(positionSeconds), (positionSeconds) => m.players.current.seekTo(positionSeconds));\r\n    playbackEvents.dispatch(playbackEvents.EVENT.PLAYBACK_LOADING, { loadingPercent: 33 });\r\n  };\r\n\r\n  const tag = document.createElement('script');\r\n  tag.id    = 'youtube-iframe-api';\r\n  tag.src   = 'https://www.youtube.com/iframe_api';\r\n  const firstScriptTag = document.getElementsByTagName('script')[0];\r\n  firstScriptTag.parentNode.insertBefore(tag, firstScriptTag);\r\n}\r\n\r\n\r\n// ************************************************************************************************\r\n// Shared functions for all player types\r\n// ************************************************************************************************\r\n\r\nexport function onPlayerError(trackType, errorNum = 0)\r\n{\r\n  if (trackType === TRACK_TYPE.YOUTUBE)\r\n  {\r\n    m.players.current.setPlayerError(errorNum);\r\n  }\r\n  else if (trackType === TRACK_TYPE.SOUNDCLOUD)\r\n  {\r\n    // SoundCloud player can trigger this too early because the initial widget load results in 404,\r\n    // so we skip error handling until the players are actually ready for playback...\r\n    if (m.initialPlayerCued === false)\r\n      return;\r\n\r\n    m.players.current.setIsPlayable(false);\r\n    listControls.setCurrentTrackState(STATE.PAUSED);\r\n  }\r\n\r\n  debug.log(`onPlayerError(${(errorNum !== 0) ? errorNum : ''}) - trackType: ${debug.getKeyForValue(TRACK_TYPE, trackType)} - trackId: ${m.currentTrackId} - isCued: ${m.players.current.isCued()}`);\r\n\r\n  playbackEvents.dispatch(playbackEvents.EVENT.MEDIA_UNAVAILABLE);\r\n}\r\n\r\nfunction onInitialPlayerCued()\r\n{\r\n  if (m.initialPlayerCued === false)\r\n  {\r\n    debug.log(`onInitialPlayerCued(): ${debug.getKeyForValue(TRACK_TYPE, m.players.current.getTrackType())}`);\r\n\r\n    m.initialPlayerCued = true;\r\n\r\n    if ((m.autoplayData?.position ?? 0) === 0)\r\n    {\r\n      playbackEvents.dispatch(playbackEvents.EVENT.PLAYBACK_LOADING, { loadingPercent: 100 });\r\n\r\n      setTimeout(() =>\r\n      {\r\n        if ((playbackControls.getProgressPercent() === 100) && (playbackControls.isPlaying() === false))\r\n          playbackEvents.dispatch(playbackEvents.EVENT.PLAYBACK_LOADING, { loadingPercent: 0 });\r\n      },\r\n      150);\r\n    }\r\n\r\n    if ((m.autoplayData?.autoplay === true) && (m.initialPlayerType === TRACK_TYPE.SOUNDCLOUD))\r\n      eventLog.add(eventLog.SOURCE.ULTRAFUNK, eventLog.EVENT.RESUME_AUTOPLAY);\r\n\r\n    m.autoplayData = null;\r\n  }\r\n}\r\n\r\nfunction onPlayerReady(trackType)\r\n{\r\n  debug.log(`onPlayerReady(): ${debug.getKeyForValue(TRACK_TYPE, trackType)}`);\r\n\r\n  if (trackType === m.initialPlayerType)\r\n    onEmbeddedPlayersReady(m.players, trackType);\r\n}\r\n\r\nfunction onLoadingState()\r\n{\r\n  playbackEvents.dispatch(playbackEvents.EVENT.MEDIA_LOADING);\r\n}\r\n\r\nfunction onPlayingState()\r\n{\r\n  playbackEvents.dispatch(playbackEvents.EVENT.MEDIA_PLAYING);\r\n}\r\n\r\nfunction onPausedState()\r\n{\r\n  playbackEvents.dispatch(playbackEvents.EVENT.MEDIA_PAUSED);\r\n}\r\n\r\nfunction onEndedState()\r\n{\r\n  playbackEvents.dispatch(playbackEvents.EVENT.MEDIA_ENDED);\r\n}\r\n\r\nfunction onAutoplayBlocked()\r\n{\r\n  playbackEvents.dispatch(playbackEvents.EVENT.AUTOPLAY_BLOCKED);\r\n}\r\n\r\nfunction setPlayerVolumeMute()\r\n{\r\n  debug.log(`setPlayerVolumeMute(${debug.getKeyForValue(TRACK_TYPE, m.players.current.getTrackType())}) - masterVolume: ${settings.playback.masterVolume} - masterMute: ${settings.playback.masterMute}`);\r\n\r\n  settings.playback.masterMute ? m.players.current.mute() : m.players.current.unMute();\r\n  m.players.current.setVolume(settings.playback.masterVolume);\r\n}\r\n\r\n\r\n// ************************************************************************************************\r\n// YouTube player init and state change handling\r\n// ************************************************************************************************\r\n\r\nfunction initYouTubePlayer()\r\n{\r\n  // eslint-disable-next-line no-undef\r\n  const player = new YT.Player('youtube-player',\r\n  {\r\n    events:\r\n    {\r\n      onReady:           () => onPlayerReady(TRACK_TYPE.YOUTUBE),\r\n      onStateChange:     onYouTubePlayerStateChange,\r\n      onError:           (event) => onPlayerError(TRACK_TYPE.YOUTUBE, event.data),\r\n      onAutoplayBlocked: onAutoplayBlocked,\r\n    },\r\n    playerVars: {\r\n      'disablekb': 1,\r\n    },\r\n  });\r\n\r\n  return player;\r\n}\r\n\r\nfunction onYouTubePlayerStateChange(event)\r\n{\r\n  if (m.players.current.getTrackType() !== TRACK_TYPE.YOUTUBE)\r\n    return;\r\n\r\n  // eslint-disable-next-line no-undef\r\n  debug.log(`onYouTubePlayerStateChange: ${debug.getKeyForValue(YT.PlayerState, event.data)} (trackId: ${m.currentTrackId})`);\r\n\r\n  // Set playback controls state to current YouTube Player state so we have a single source of truth:\r\n  // playbackControls.isPlaying()\r\n  if (event.data !== YT.PlayerState.PLAYING) // eslint-disable-line no-undef\r\n    playbackControls.setPauseState();\r\n\r\n  switch (event.data)\r\n  {\r\n    // eslint-disable-next-line no-undef\r\n    case YT.PlayerState.UNSTARTED:\r\n      onInitialPlayerCued();\r\n      break;\r\n\r\n    // eslint-disable-next-line no-undef\r\n    case YT.PlayerState.BUFFERING:\r\n      onLoadingState();\r\n      setPlayerVolumeMute();\r\n      break;\r\n\r\n    case YT.PlayerState.PLAYING: onPlayingState(); break; // eslint-disable-line no-undef\r\n    case YT.PlayerState.PAUSED:  onPausedState();  break; // eslint-disable-line no-undef\r\n    case YT.PlayerState.ENDED:   onEndedState();   break; // eslint-disable-line no-undef\r\n  }\r\n}\r\n\r\n\r\n// ************************************************************************************************\r\n// SoundCloud player init and state change handling\r\n// ************************************************************************************************\r\n\r\nfunction initSoundCloudPlayer()\r\n{\r\n  const player = SC.Widget('soundcloud-player');                              // eslint-disable-line no-undef\r\n  player.bind(SC.Widget.Events.READY, () => onSoundCloudPlayerReady(player)); // eslint-disable-line no-undef\r\n  return player;\r\n}\r\n\r\nfunction onSoundCloudPlayerReady(player)\r\n{\r\n  /* eslint-disable */\r\n  player.bind(SC.Widget.Events.PLAY,   () => onSoundCloudPlayerStateChange('playing'));\r\n  player.bind(SC.Widget.Events.PAUSE,  () => onSoundCloudPlayerStateChange('paused'));\r\n  player.bind(SC.Widget.Events.FINISH, () => onSoundCloudPlayerStateChange('ended'));\r\n  player.bind(SC.Widget.Events.ERROR,  () => onPlayerError(TRACK_TYPE.SOUNDCLOUD));\r\n  /* eslint-enable */\r\n\r\n  onPlayerReady(TRACK_TYPE.SOUNDCLOUD);\r\n}\r\n\r\nexport function onSoundCloudPlayerStateChange(playerState)\r\n{\r\n  if (m.players.current.getTrackType() !== TRACK_TYPE.SOUNDCLOUD)\r\n    return;\r\n\r\n  debug.log(`onSoundCloudPlayerStateChange: ${playerState.toUpperCase()} (trackId: ${m.currentTrackId})`);\r\n\r\n  // Set playback controls state to current SoundCloud Player state so we have a single source of truth:\r\n  // playbackControls.isPlaying()\r\n  if (playerState !== 'playing')\r\n    playbackControls.setPauseState();\r\n\r\n  switch (playerState)\r\n  {\r\n    case 'ready':\r\n      {\r\n        onInitialPlayerCued();\r\n        setPlayerVolumeMute();\r\n\r\n        const trackElement = listControls.getCurrentTrackElement();\r\n\r\n        trackElement.setAttribute('data-track-duration', m.players.current.getDuration());\r\n        trackElement.querySelector('div.track-duration').textContent = getTimeString(m.players.current.getDuration());\r\n        trackElement.setAttribute('data-track-thumbnail-url', m.players.current.getThumbnailSrc());\r\n        trackElement.querySelector('button.thumbnail img').src = m.players.current.getThumbnailSrc();\r\n\r\n        playbackControls.updateTrackData(0);\r\n      }\r\n      break;\r\n\r\n    case 'playing':\r\n      eventLog.add(eventLog.SOURCE.SOUNDCLOUD, eventLog.EVENT.STATE_PLAYING, m.currentTrackId);\r\n      onPlayingState();\r\n      break;\r\n\r\n    case 'paused':\r\n      {\r\n        eventLog.add(eventLog.SOURCE.SOUNDCLOUD, eventLog.EVENT.STATE_PAUSED, m.currentTrackId);\r\n\r\n        if (eventLog.scAutoplayBlocked(m.currentTrackId, 3000))\r\n          onAutoplayBlocked();\r\n        else\r\n          onPausedState();\r\n      }\r\n      break;\r\n\r\n    case 'loading': onLoadingState(); break;\r\n    case 'ended':   onEndedState();   break;\r\n  }\r\n}\r\n\r\n\r\n// ************************************************************************************************\r\n// Local HTML <audio> player init and state change handling\r\n// ************************************************************************************************\r\n\r\nfunction initLocalPlayer()\r\n{\r\n  if (settings.list.enableLocalPlayback)\r\n  {\r\n    initLocalTracks();\r\n\r\n    const player = document.getElementById('local-audio-player');\r\n\r\n    player.addEventListener('play',           onLocalPlayerStateChange);\r\n    player.addEventListener('pause',          onLocalPlayerStateChange);\r\n    player.addEventListener('ended',          onLocalPlayerStateChange);\r\n    player.addEventListener('durationchange', onLocalPlayerStateChange);\r\n\r\n    return player;\r\n  }\r\n}\r\n\r\nexport function onLocalPlayerStateChange(event)\r\n{\r\n  if (m.players.current.getTrackType() !== TRACK_TYPE.LOCAL)\r\n    return;\r\n\r\n  debug.log(`onLocalPlayerStateChange: ${event.type.toUpperCase()} (trackId: ${m.currentTrackId})`);\r\n\r\n  switch (event.type)\r\n  {\r\n    case 'durationchange':\r\n      {\r\n        const duration = Math.round(m.players.current.getDuration());\r\n\r\n        m.players.current.setDuration(duration);\r\n        listControls.getCurrentTrackElement().setAttribute('data-track-duration', duration);\r\n        listControls.getCurrentTrackElement().querySelector('div.track-duration').textContent = getTimeString(duration);\r\n        playbackControls.updateTrackData(0);\r\n      }\r\n      break;\r\n\r\n    case 'cued':  setPlayerVolumeMute(); break;\r\n    case 'play':  onPlayingState();      break;\r\n    case 'pause': onPausedState();       break;\r\n    case 'ended': onEndedState();        break;\r\n  }\r\n}\r\n", "//\r\n// List-player Up Next modal module\r\n//\r\n// https://ultrafunk.com\r\n//\r\n\r\n\r\n//import { newDebugLogger }    from '../../shared/debuglogger.js';\r\nimport { autoplay }          from '../../site/footer-toggles.js';\r\nimport { settings }          from '../../shared/session-data.js';\r\nimport { isPlaying }         from '../common/playback-controls.js';\r\nimport { showSnackbar }      from '../../shared/snackbar.js';\r\nimport { shuffleClickNavTo } from '../common/shared-gallery-list.js';\r\nimport { setCurrentTrack }   from './list-playback.js';\r\nimport { getTrackTypeClass } from '../common/mediaplayer.js';\r\n\r\nimport {\r\n  VERSION,\r\n  ULTRAFUNK_THEME_URI,\r\n} from '../../config.js';\r\n\r\nimport {\r\n  escAttribute,\r\n  getTimeString,\r\n  getScrollBehavior,\r\n} from '../../shared/utils.js';\r\n\r\nimport {\r\n  queryTrackId,\r\n  getNextPlayableId,\r\n  getCurrentTrackElement,\r\n} from './list-controls.js';\r\n\r\nimport {\r\n  showModal,\r\n  isShowingModal,\r\n  getModalRootElement,\r\n  getModalEntry,\r\n  updateModalTitle,\r\n  updateModalList,\r\n} from '../../shared/modal.js';\r\n\r\n\r\n/*************************************************************************************************/\r\n\r\n\r\n//const debug = newDebugLogger('up-next-modal');\r\n\r\nconst m = {\r\n  modalDialogId: null,\r\n  dragDropTouch: null,\r\n  dragStartY:    0,\r\n  dragEntryId:   null,\r\n};\r\n\r\n\r\n// ************************************************************************************************\r\n//\r\n// ************************************************************************************************\r\n\r\nexport async function showUpNextModal()\r\n{\r\n  const tracklist = getTracklist(isPlaying());\r\n\r\n  if (tracklist.length > 2)\r\n  {\r\n    m.modalDialogId = showModal({\r\n      modalTitle: getTitle(isPlaying()),\r\n      modalList:  tracklist,\r\n      modalType:  'tracklist',\r\n      onClickEntryCallback: (clickedId) => onTrackClick(tracklist, clickedId),\r\n      onClickCloseCallback: (event)     => shouldCloseModal(event),\r\n    });\r\n\r\n    addTitleListener();\r\n    addDragDropListeners();\r\n\r\n    // Only loads this dependency if we actually need it...\r\n    if (('ontouchstart' in window) && (m.dragDropTouch === null))\r\n      m.dragDropTouch = await import(`${ULTRAFUNK_THEME_URI}/inc/js/drag-drop-touch.min.js?ver=${VERSION}`);\r\n  }\r\n  else\r\n  {\r\n    showSnackbar({\r\n      message: 'No more tracks to play...',\r\n      duration: 5,\r\n      actionText: 'Shuffle',\r\n      actionClickCallback: () => shuffleClickNavTo(),\r\n    });\r\n  }\r\n}\r\n\r\nfunction onTrackClick(tracklist, clickedId)\r\n{\r\n  const nextTrackId = tracklist.find(item => (item.clickId === clickedId)).clickId;\r\n\r\n  if ((nextTrackId === getCurrentTrackElement().id) && isPlaying())\r\n    getCurrentTrackElement().scrollIntoView({ behavior: getScrollBehavior(), block: 'center' });\r\n  else\r\n    setCurrentTrack(nextTrackId, true, false);\r\n}\r\n\r\nfunction shouldCloseModal(event)\r\n{\r\n  if (event.target.closest('#modal-item-1'))\r\n    return true;\r\n  else if (event.target.classList.contains('modal-track-thumbnail'))\r\n    return true;\r\n\r\n  return false;\r\n}\r\n\r\nexport function updateUpNextModal(isPlayingTrack)\r\n{\r\n  if (isShowingModal(m.modalDialogId))\r\n  {\r\n    updateModalTitle(m.modalDialogId, getTitle(isPlayingTrack));\r\n    addTitleListener();\r\n\r\n    const modalEntry = getModalEntry(1);\r\n\r\n    if (modalEntry.getAttribute('data-click-id') === getCurrentTrackElement().id)\r\n    {\r\n      modalEntry.classList.remove('playing-track', 'cued-track');\r\n      modalEntry.classList.add(`${isPlayingTrack ? 'playing-track' : 'cued-track'}`);\r\n      modalEntry.title = `${isPlayingTrack ? 'Go To Track' : 'Play Track'}`;\r\n    }\r\n    else\r\n    {\r\n      updateModalList(m.modalDialogId, getTracklist(isPlayingTrack));\r\n      addDragDropListeners();\r\n    }\r\n  }\r\n}\r\n\r\nfunction getTitle(isPlayingTrack)\r\n{\r\n  return /*html*/ `${isPlayingTrack ? 'Playing' : 'Cued'}\r\n            <span class=\"light-text lowercase-text toggle-element\" title=\"Toggle Autoplay\">\r\n            Autoplay is <b>${settings.playback.autoplay ? 'On' : 'Off'}</b></span>`;\r\n}\r\n\r\nfunction getTracklist(isPlayingTrack)\r\n{\r\n  const tracklist  = [];\r\n  let trackElement = getCurrentTrackElement();\r\n\r\n  tracklist.push({\r\n    clickId: trackElement.id,\r\n    class:   `tracklist-entry ${isPlayingTrack ? 'playing-track' : 'cued-track'}`,\r\n    title:   `${isPlayingTrack ? 'Go To Track' : 'Play Track'}`,\r\n    content: getUpNextTrackHtml(trackElement, 'data-track-artist', 'data-track-title'),\r\n  });\r\n\r\n  tracklist.push({ class: 'header-entry', content: 'Up Next <span class=\"light-text\">(drag to reorder)</span>' });\r\n\r\n  for (let i = 0; i < 10; i++)\r\n  {\r\n    trackElement = queryTrackId(getNextPlayableId(trackElement));\r\n\r\n    if (trackElement === null)\r\n      break;\r\n\r\n    tracklist.push({\r\n      clickId: trackElement.id,\r\n      class:   'tracklist-entry',\r\n      content: getUpNextTrackHtml(trackElement, 'data-track-artist', 'data-track-title', true),\r\n    });\r\n  }\r\n\r\n  return tracklist;\r\n}\r\n\r\nfunction addTitleListener()\r\n{\r\n  getModalRootElement().querySelector('.modal-dialog-title span').addEventListener('click', (event) =>\r\n  {\r\n    autoplay.toggle();\r\n    event.target.closest('span').innerHTML = `Autoplay is <b>${settings.playback.autoplay ? 'On' : 'Off'}</b>`;\r\n  });\r\n}\r\n\r\n\r\n// ************************************************************************************************\r\n//\r\n// ************************************************************************************************\r\n\r\nfunction addDragDropListeners()\r\n{\r\n  document.querySelectorAll('.modal-tracklist-entry')?.forEach((element) =>\r\n  {\r\n    if (element.id !== 'modal-item-1')\r\n    {\r\n      element.addEventListener('mousedown', mouseDown);\r\n      element.addEventListener('dragstart', dragStart);\r\n      element.addEventListener('dragover',  dragOver);\r\n      element.addEventListener('drop',      dragDrop);\r\n    }\r\n  });\r\n}\r\n\r\n// Disable drag & drop for track play button (modal-track-thumbnail)\r\nfunction mouseDown(event)\r\n{\r\n  if (event.target.classList.contains('modal-track-thumbnail'))\r\n    event.preventDefault();\r\n}\r\n\r\nfunction dragStart(event)\r\n{\r\n  m.dragStartY  = event.clientY;\r\n  m.dragEntryId = event.target.closest('div.modal-tracklist-entry').id;\r\n  event.dataTransfer.effectAllowed = 'move';\r\n}\r\n\r\nfunction dragOver(event)\r\n{\r\n  event.preventDefault();\r\n  event.dataTransfer.dropEffect = 'move';\r\n  return false;\r\n}\r\n\r\nfunction dragDrop(event)\r\n{\r\n  event.preventDefault();\r\n\r\n  const insertPos = (event.clientY  > m.dragStartY) ? 'afterend' : 'beforebegin';\r\n\r\n  // Modal tracks drag & drop reorder\r\n  const modalDragSource = document.getElementById(m.dragEntryId);\r\n  const modalDropTarget = event.target.closest('div.modal-tracklist-entry');\r\n  modalDropTarget.insertAdjacentElement(insertPos, modalDragSource);\r\n\r\n  // List player tracks drag & drop reorder = sync track lists\r\n  const listTrackSource = document.getElementById(modalDragSource.getAttribute('data-click-id'));\r\n  const listTrackTarget = document.getElementById(modalDropTarget.getAttribute('data-click-id'));\r\n  listTrackTarget.insertAdjacentElement(insertPos, listTrackSource);\r\n\r\n  return false;\r\n}\r\n\r\n\r\n// ************************************************************************************************\r\n//\r\n// ************************************************************************************************\r\n\r\nfunction getUpNextTrackHtml(element, trackArtistAttr, trackTitleAttr, isDraggable = false)\r\n{\r\n  const trackDuration = getTimeString(parseInt(element.getAttribute('data-track-duration')));\r\n\r\n  return /*html*/ `\r\n    <div class=\"modal-track ${isDraggable ? 'modal-draggable-entry' : ''}\" ${isDraggable ? 'draggable=\"true\"' : ''}>\r\n      <div class=\"modal-track-thumbnail modal-ignore-touchmove ${getTrackTypeClass(element)}\" ${isDraggable ? 'title=\"Click to Play Track\"' : ''}>\r\n        <img src=\"${encodeURI(element.getAttribute('data-track-thumbnail-url'))}\">\r\n      </div>\r\n      <div class=\"modal-track-artist-title text-nowrap-ellipsis\" ${isDraggable ? 'title=\"Drag to Move Track\"' : ''}>\r\n        <span><b>${escAttribute(element, trackArtistAttr)}</b></span><br>\r\n        <span class=\"light-text\">${escAttribute(element, trackTitleAttr)}</span>\r\n      </div>\r\n      <div class=\"modal-track-duration text-nowrap-ellipsis\" ${isDraggable ? 'title=\"Drag to Move Track\"' : ''}>\r\n        ${(trackDuration !== '00:00') ? trackDuration : 'N / A'}\r\n      </div>\r\n      ${isDraggable ? getModalTrackButtons() : ''}\r\n    </div>`;\r\n}\r\n\r\nfunction getModalTrackButtons()\r\n{\r\n  return /*html*/ `\r\n    <div class=\"modal-track-buttons\">\r\n      <div class=\"drag-drop-button\" title=\"Drag to Move Track\"><span class=\"material-icons\">drag_handle</span></div>\r\n    </div>`;\r\n}\r\n", "//\r\n// Shared gallery and list-player functionality\r\n//\r\n// https://ultrafunk.com\r\n//\r\n\r\n\r\nimport { newDebugLogger }     from '../../shared/debuglogger.js';\r\nimport { showSnackbar }       from '../../shared/snackbar.js';\r\nimport { KEY, setCookie }     from '../../shared/storage.js';\r\nimport { showUpNextModal }    from '../list/up-next-modal.js';\r\nimport { response, settings } from '../../shared/session-data.js';\r\nimport { VOLUME }             from '../gallery/crossfade.js';\r\n\r\nimport {\r\n  getCssPropValue,\r\n  getPrefPlayerUrl,\r\n  getScrollBehavior,\r\n  navToUrl,\r\n} from '../../shared/utils.js';\r\n\r\n\r\n/*************************************************************************************************/\r\n\r\n\r\nconst debug = newDebugLogger('shared-gallery-list');\r\n\r\nexport const PLAYER_TYPE = {\r\n  NONE:    0,\r\n  GALLERY: 1,\r\n  LIST:    2,\r\n};\r\n\r\nconst isPlayer = {\r\n  gallery: false,\r\n  list:    false,\r\n};\r\n\r\n\r\n// ************************************************************************************************\r\n//\r\n// ************************************************************************************************\r\n\r\nexport function hasGalleryPlayer()\r\n{\r\n  isPlayer.gallery = (document.body.getAttribute('data-player-type') === 'gallery');\r\n  return isPlayer.gallery;\r\n}\r\n\r\nexport function hasListPlayer()\r\n{\r\n  isPlayer.list = (document.body.getAttribute('data-player-type') === 'list');\r\n  return isPlayer.list;\r\n}\r\n\r\nexport function noPlayback()\r\n{\r\n  return ((isPlayer.gallery === false) && (isPlayer.list === false));\r\n}\r\n\r\nexport function isGalleryPlayer() { return isPlayer.gallery; }\r\nexport function isListPlayer()    { return isPlayer.list;    }\r\n\r\nexport function shuffleClickNavTo(event = null)\r\n{\r\n  event?.preventDefault();\r\n  setCookie(KEY.UF_RESHUFFLE, 'true');\r\n  navToUrl(getPrefPlayerUrl(response.shufflePath));\r\n}\r\n\r\nexport function autoplayNavTo(destUrl, continueAutoplay = false)\r\n{\r\n  debug.log(`autoplayNavTo(): ${destUrl} - continueAutoplay: ${continueAutoplay}`);\r\n\r\n  if (destUrl)\r\n  {\r\n    sessionStorage.setItem(KEY.UF_AUTOPLAY, JSON.stringify({ autoplay: continueAutoplay, trackId: null, position: 0 }));\r\n    navToUrl(destUrl);\r\n  }\r\n}\r\n\r\nexport function updateVolumeMuteSettings(currentVolume, isMuted)\r\n{\r\n  /*\r\n  console.log(`updateVolumeMuteSettings() - currentVolume: ${currentVolume} - isMuted: ${isMuted}`);\r\n  */\r\n\r\n  // settings.playback.masterVolume has a range of 5 => 100% in multiples of 5 (5, 10, 15, 20 etc...)\r\n  let multipleOf5Volume = (Math.round(currentVolume / 5) * 5);\r\n\r\n  if (currentVolume < 5)\r\n  {\r\n    multipleOf5Volume = 5;\r\n    isMuted = true;\r\n  }\r\n\r\n  if (multipleOf5Volume !== settings.playback.masterVolume)\r\n    settings.playback.masterVolume = multipleOf5Volume;\r\n\r\n  if (isMuted !== settings.playback.masterMute)\r\n    settings.playback.masterMute = isMuted;\r\n}\r\n\r\nexport function onKeysVolumeChange(event, player)\r\n{\r\n  event?.preventDefault();\r\n\r\n  settings.playback.masterVolume = ((event.key === '+') || (event.key === 'ArrowUp'))\r\n    ? (settings.playback.masterVolume < 100) ? (settings.playback.masterVolume + 5) : 100\r\n    : (settings.playback.masterVolume > 5  ) ? (settings.playback.masterVolume - 5) : 5;\r\n\r\n  player.setVolume();\r\n}\r\n\r\nexport function resetVolumeMute(player)\r\n{\r\n  if (settings.playback.masterMute)\r\n    player.toggleMute();\r\n\r\n  settings.playback.masterVolume = VOLUME.MAX;\r\n  player.setVolume();\r\n\r\n  showSnackbar({ message: 'Volume & Mute reset to default values' });\r\n}\r\n\r\n\r\n// ************************************************************************************************\r\n//\r\n// ************************************************************************************************\r\n\r\nexport function playerScrollTo(elementId = 0)\r\n{\r\n  isListPlayer() ? listPlayerScrollTo(elementId) : galleryPlayerScrollTo(elementId);\r\n}\r\n\r\nfunction scrollToYPos(element, destYPos)\r\n{\r\n  element.scroll(\r\n  {\r\n    top:      destYPos,\r\n    left:     0,\r\n    behavior: getScrollBehavior(),\r\n  });\r\n}\r\n\r\nfunction listPlayerScrollTo(elementId = 0)\r\n{\r\n  if (elementId === 0)\r\n  {\r\n    let scrollDestPos = 0;\r\n\r\n    if ((window.scrollY === 0) || (Math.round(window.scrollY) <= 1))\r\n      scrollDestPos = getCssPropValue('--site-header-height') - getCssPropValue('--site-header-height-down');\r\n\r\n    scrollToYPos(window, scrollDestPos);\r\n  }\r\n  else\r\n  {\r\n    if (settings.list.showUpNextModal)\r\n      showUpNextModal();\r\n    else\r\n      document.getElementById(elementId)?.scrollIntoView({ behavior: getScrollBehavior(), block: 'center' });\r\n  }\r\n}\r\n\r\nfunction galleryPlayerScrollTo(elementId)\r\n{\r\n  if (settings.gallery.autoScroll)\r\n  {\r\n    // Actual functional 'offsetTop' calculation: https://stackoverflow.com/a/52477551\r\n    const offsetTop    = Math.round(window.scrollY + document.getElementById(elementId).getBoundingClientRect().top);\r\n    const scrollTop    = Math.round(window.scrollY); // Don't want float results that can cause jitter\r\n    let   headerHeight = getScrollHeaderHeight(offsetTop > scrollTop);\r\n\r\n    // If we get obscured by the sticky header menu, recalculate headerHeight to account for that\r\n    if ((scrollTop + headerHeight + getContentMarginTop()) > offsetTop)\r\n      headerHeight = getScrollHeaderHeight(false);\r\n\r\n    scrollToYPos(window, (offsetTop - (headerHeight + getContentMarginTop())));\r\n  }\r\n\r\n  function getScrollHeaderHeight(isScrollDown)\r\n  {\r\n    return (isScrollDown\r\n             ? getCssPropValue('--site-header-height-down')\r\n             : getCssPropValue('--site-header-height-up'));\r\n  }\r\n\r\n  function getContentMarginTop()\r\n  {\r\n    // -1 because of fractional pixels on HiDPI displays (iframe bottom 1 px would show on top)\r\n    return (getCssPropValue('--site-content-margin-top', document.body) - 1);\r\n  }\r\n}\r\n\r\nexport function playerOnKeysScroll(event)\r\n{\r\n  if (isListPlayer() && (event.shiftKey === true) && (window.innerWidth > 1350))\r\n  {\r\n    const tracklist = document.getElementById('tracklist');\r\n\r\n    event.preventDefault();\r\n\r\n    if ((event.key === 'PageUp') || (event.key === 'PageDown'))\r\n    {\r\n      const scrollByPx = tracklist.offsetHeight - ((tracklist.offsetHeight * 10)  / 100);\r\n\r\n      tracklist.scrollBy(\r\n      {\r\n        top:      (event.key === 'PageUp') ? -scrollByPx : scrollByPx,\r\n        left:     0,\r\n        behavior: getScrollBehavior(),\r\n      });\r\n    }\r\n    else if ((event.key === 'Home') || (event.key === 'End'))\r\n    {\r\n      scrollToYPos(tracklist, ((event.key === 'Home') ? 0 : tracklist.scrollHeight));\r\n    }\r\n  }\r\n}\r\n\r\n\r\n// ************************************************************************************************\r\n// Fullscreen Element enter / exit / toggle closure\r\n// ************************************************************************************************\r\n\r\nconst fullscreenElementClosure = (() =>\r\n{\r\n  const fseEvent = new Event('fullscreenElement');\r\n  let fseTarget  = null;\r\n\r\n  return {\r\n    init,\r\n    enter,\r\n    exit,\r\n    toggle,\r\n  };\r\n\r\n  function init()\r\n  {\r\n    document.addEventListener('fullscreenchange',       fullscreenChange);\r\n    document.addEventListener('webkitfullscreenchange', fullscreenChange);\r\n  }\r\n\r\n  function fullscreenChange()\r\n  {\r\n    fseTarget = (document.fullscreenElement !== null)\r\n                  ? document.fullscreenElement.id\r\n                  : null;\r\n\r\n    fseEvent.fullscreenTarget = fseTarget;\r\n    document.dispatchEvent(fseEvent);\r\n  }\r\n\r\n  function enter(element)\r\n  {\r\n    if (element.requestFullscreen)\r\n      element.requestFullscreen();\r\n    else\r\n      showSnackbar({ message: 'Unable to enter fullscreen mode!', duration: 3 });\r\n  }\r\n\r\n  function exit()\r\n  {\r\n    if (fseTarget !== null)\r\n    {\r\n      document.exitFullscreen();\r\n      fseTarget = null;\r\n    }\r\n  }\r\n\r\n  function toggle(element)\r\n  {\r\n    if (fseTarget === null)\r\n      enter(element);\r\n    else\r\n      exit();\r\n  }\r\n});\r\n\r\nexport const fullscreenElement = fullscreenElementClosure();\r\n", "//\r\n// Interaction footer toggle controls\r\n//\r\n// https://ultrafunk.com\r\n//\r\n\r\n\r\nimport { ElementToggle }      from '../shared/element-toggle.js';\r\nimport { showSnackbar }       from '../shared/snackbar.js';\r\nimport { response, settings } from '../shared/session-data.js';\r\nimport { TRACK_TYPE }         from '../playback/common/mediaplayer.js';\r\n\r\nimport {\r\n  replaceClass,\r\n  getPrefPlayerUrl,\r\n  navToUrl,\r\n} from '../shared/utils.js';\r\n\r\nimport {\r\n  PLAYER_TYPE,\r\n  isListPlayer,\r\n  onKeysVolumeChange,\r\n  resetVolumeMute,\r\n} from '../playback/common/shared-gallery-list.js';\r\n\r\nimport {\r\n  KEY,\r\n  YEAR_IN_SECONDS,\r\n  setCookie,\r\n  addSettingsObserver,\r\n} from '../shared/storage.js';\r\n\r\n\r\n/*************************************************************************************************/\r\n\r\n\r\nconst m = { player: null };\r\n\r\nexport let playerType = null;\r\nexport let crossfade  = null;\r\nexport let autoplay   = null;\r\n\r\n\r\n// ************************************************************************************************\r\n//\r\n// ************************************************************************************************\r\n\r\nexport function init(player)\r\n{\r\n  m.player = player;\r\n\r\n  new MuteToggle('footer-mute-toggle');\r\n  new VolumeToggle('footer-volume-toggle');\r\n\r\n  playerType = new PlayerTypeToggle('footer-player-type-toggle');\r\n\r\n  // Init crossfade before autoplay because autoplay can disable crossfade in update()\r\n  crossfade = new CrossfadeToggle('footer-crossfade-toggle');\r\n  autoplay  = new AutoplayToggle('footer-autoplay-toggle');\r\n}\r\n\r\n\r\n// ************************************************************************************************\r\n// Footer mute and volume toggles\r\n// ************************************************************************************************\r\n\r\nclass MuteToggle extends ElementToggle\r\n{\r\n  constructor(elementId)\r\n  {\r\n    super(elementId);\r\n    addSettingsObserver('masterMute', () => this.update());\r\n  }\r\n\r\n  toggle() { m.player.toggleMute(); }\r\n  update() { this.value = settings.playback.masterMute ? 'Yes' : 'No'; }\r\n}\r\n\r\nclass VolumeToggle extends ElementToggle\r\n{\r\n  constructor(elementId)\r\n  {\r\n    super(elementId);\r\n    addSettingsObserver('masterVolume', () => this.update());\r\n  }\r\n\r\n  toggle(event)\r\n  {\r\n    if (event.target.classList.contains('volume-up'))\r\n    {\r\n      event.key = '+';\r\n      onKeysVolumeChange(event, m.player);\r\n    }\r\n    else if (event.target.classList.contains('volume-down'))\r\n    {\r\n      event.key = '-';\r\n      onKeysVolumeChange(event, m.player);\r\n    }\r\n    else\r\n    {\r\n      resetVolumeMute(m.player);\r\n    }\r\n  }\r\n\r\n  update() { this.value = settings.playback.masterVolume; }\r\n}\r\n\r\n\r\n// ************************************************************************************************\r\n// Footer player type toggle: Gallery or List\r\n// ************************************************************************************************\r\n\r\nclass PlayerTypeToggle extends ElementToggle\r\n{\r\n  async toggle()\r\n  {\r\n    if (m.player.getStatus().trackType === TRACK_TYPE.LOCAL)\r\n    {\r\n      showSnackbar({ message: `Can't change Pref. Player for Local Tracks!` });\r\n      return;\r\n    }\r\n\r\n    const destData = await this.getDestData();\r\n\r\n    settings.playback.preferredPlayer = isListPlayer() ? PLAYER_TYPE.GALLERY : PLAYER_TYPE.LIST;\r\n    setCookie(KEY.UF_PREFERRED_PLAYER, `${isListPlayer() ? PLAYER_TYPE.GALLERY : PLAYER_TYPE.LIST}`, (YEAR_IN_SECONDS * 5));\r\n    sessionStorage.setItem(KEY.UF_AUTOPLAY, JSON.stringify(destData.trackData));\r\n\r\n    navToUrl(getPrefPlayerUrl(this.getDestUrl(destData)));\r\n  }\r\n\r\n  update()\r\n  {\r\n    this.value = (settings.playback.preferredPlayer === PLAYER_TYPE.LIST) ? 'List' : 'Gallery';\r\n  }\r\n\r\n  getDestUrl(destData)\r\n  {\r\n    const isPagedRegEx = /\\/page\\/(?!0)\\d{1,6}/;\r\n    const sourceUrl    = window.location.href;\r\n    let destUrl        = null;\r\n\r\n    // Add destination pagination or remove pagination if needed\r\n    if ((destData.pageNum > 1) && (sourceUrl.match(isPagedRegEx) !== null))\r\n    {\r\n      destUrl = sourceUrl.replace(isPagedRegEx, `/page/${destData.pageNum}`);\r\n    }\r\n    else if (destData.pageNum > 1)\r\n    {\r\n      const url = new URL(decodeURIComponent(sourceUrl));\r\n      destUrl   = `${url.origin}${url.pathname}page/${destData.pageNum}/${url.search}`;\r\n    }\r\n    else\r\n    {\r\n      destUrl = sourceUrl.replace(isPagedRegEx, '');\r\n    }\r\n\r\n    return destUrl;\r\n  }\r\n\r\n  async getDestData()\r\n  {\r\n    const urlParts          = window.location.href.split('/');\r\n    const pageIndex         = urlParts.findIndex(part => (part.toLowerCase() === 'page'));\r\n    const currentPage       = (pageIndex !== -1)\r\n                                ? parseInt(urlParts[pageIndex + 1])\r\n                                : 1;\r\n    const trackData         = await m.player.getStatus(true);\r\n    const tracksPerPageFrom = isListPlayer() ? response.listPerPage    : response.galleryPerPage;\r\n    const tracksPerPageTo   = isListPlayer() ? response.galleryPerPage : response.listPerPage;\r\n    const trackOffset       = trackData.currentTrack + ((currentPage - 1) * tracksPerPageFrom);\r\n\r\n    return {\r\n      pageNum: Math.ceil(trackOffset / tracksPerPageTo),\r\n      trackData: {\r\n        autoplay: trackData.isPlaying ?? false,\r\n        trackId:  trackData.trackId   ?? null,\r\n        position: trackData.position  ?? 0,\r\n      }\r\n    };\r\n  }\r\n}\r\n\r\n\r\n// ************************************************************************************************\r\n// Footer autoplay and crossfade toggles\r\n// ************************************************************************************************\r\n\r\nclass AutoplayToggle extends ElementToggle\r\n{\r\n  toggle()\r\n  {\r\n    settings.playback.autoplay = (settings.playback.autoplay === true) ? false : true;\r\n\r\n    showSnackbar({\r\n      duration: 5,\r\n      message: settings.playback.autoplay\r\n                 ? 'Autoplay enabled (<b>Shift</b> + <b>A</b> to Disable)'\r\n                 : 'Autoplay disabled (<b>Shift</b> + <b>A</b> to Enable)',\r\n    });\r\n  }\r\n\r\n  update()\r\n  {\r\n    this.value = settings.playback.autoplay ? 'ON' : 'OFF';\r\n\r\n    settings.playback.autoplay\r\n      ? replaceClass(document.body, 'autoplay-off', 'autoplay-on')\r\n      : replaceClass(document.body, 'autoplay-on', 'autoplay-off');\r\n\r\n    settings.playback.autoplay\r\n      ? crossfade?.classList.remove('disabled')\r\n      : crossfade?.classList.add('disabled');\r\n  }\r\n}\r\n\r\nclass CrossfadeToggle extends ElementToggle\r\n{\r\n  toggle()\r\n  {\r\n    settings.gallery.autoCrossfade = (settings.gallery.autoCrossfade === true) ? false : true;\r\n\r\n    showSnackbar({\r\n      duration: 5,\r\n      message: settings.gallery.autoCrossfade\r\n                 ? 'Auto Crossfade enabled (<b>x</b> to Disable)'\r\n                 : 'Auto Crossfade disabled (<b>x</b> to Enable)',\r\n    });\r\n  }\r\n\r\n  update()\r\n  {\r\n    this.value = settings.gallery.autoCrossfade ? 'ON' : 'OFF';\r\n  }\r\n}\r\n", "//\r\n// Playback UI controls\r\n//\r\n// https://ultrafunk.com\r\n//\r\n\r\n\r\nimport { newDebugLogger }      from '../../shared/debuglogger.js';\r\nimport { settings }            from '../../shared/session-data.js';\r\nimport { EVENT, addListener }  from './playback-events.js';\r\nimport { addSettingsObserver } from '../../shared/storage.js';\r\n\r\nimport {\r\n  playerType as playerTypeToggle\r\n} from '../../site/footer-toggles.js';\r\n\r\nimport {\r\n  STATE,\r\n  ElementWrapper,\r\n} from './element-wrappers.js';\r\n\r\nimport {\r\n  MATCH,\r\n  matchesMedia,\r\n  getTimeString,\r\n} from '../../shared/utils.js';\r\n\r\n\r\n/*************************************************************************************************/\r\n\r\n\r\nconst debug      = newDebugLogger('playback-controls');\r\nconst isInIframe = (window.frameElement !== null);\r\nconst m          = { getTrackData: null };\r\nconst ctrl       = {};\r\n\r\n\r\n// ************************************************************************************************\r\n// Set user settings controlled CSS as early as possible before init() call\r\n// ************************************************************************************************\r\n\r\nexport function setPlaybackControlsCss()\r\n{\r\n  ctrl.prevTrack = ElementWrapper('.playback-prev-button');\r\n  ctrl.playPause = ElementWrapper('.playback-play-pause-toggle');\r\n\r\n  if (matchesMedia(MATCH.SITE_MAX_WIDTH_MOBILE))\r\n  {\r\n    debug.log('setPlaybackControlsCss(): MATCH.SITE_MAX_WIDTH_MOBILE');\r\n\r\n    if (settings.mobile.showPrevTrackButton)\r\n      ctrl.prevTrack.addClass('show-on-mobile');\r\n\r\n    if (!settings.mobile.showPrevTrackButton && !settings.mobile.showTrackTimes)\r\n      ctrl.playPause.addClass('mobile-margin-10px');\r\n    else if (settings.mobile.showTrackTimes && !settings.mobile.showPrevTrackButton)\r\n      ctrl.playPause.addClass('mobile-margin-6px');\r\n    else if (settings.mobile.showPrevTrackButton && !settings.mobile.showTrackTimes)\r\n      ctrl.prevTrack.addClass('mobile-margin-3px');\r\n  }\r\n}\r\n\r\n\r\n// ************************************************************************************************\r\n// Init and make ready all controls\r\n// ************************************************************************************************\r\n\r\nexport function init(getTrackData, seekClickCallback)\r\n{\r\n  debug.log('init()');\r\n\r\n  m.getTrackData = getTrackData;\r\n  const playbackControls = document.getElementById('playback-controls');\r\n\r\n  ctrl.progressSeek = ElementWrapper('.progress-seek-control', document.getElementById('progress-controls'));\r\n  ctrl.progressSeek.clickCallback = seekClickCallback;\r\n  ctrl.progressBar = ElementWrapper('.progress-bar-control', document.getElementById('progress-controls'));\r\n  ctrl.progressBar.progressPercent = 0;\r\n\r\n  ctrl.thumbnail     = ElementWrapper('.playback-thumbnail-control', playbackControls);\r\n  ctrl.thumbnail.img = ctrl.thumbnail.getElement('img');\r\n\r\n  ctrl.details        = ElementWrapper('.playback-details-control', playbackControls);\r\n  ctrl.details.artist = ctrl.details.getElement('.playback-details-artist');\r\n  ctrl.details.title  = ctrl.details.getElement('.playback-details-title');\r\n\r\n  ctrl.timer                 = ElementWrapper('.playback-timer-control', playbackControls);\r\n  ctrl.timer.position        = ctrl.timer.getElement('.playback-timer-position');\r\n  ctrl.timer.duration        = ctrl.timer.getElement('.playback-timer-duration');\r\n  ctrl.timer.positionSeconds = -1; // Make sure initial value is set + shown when track plays\r\n  ctrl.timer.durationSeconds = -1; // Make sure initial value is set + shown when track plays\r\n\r\n  ctrl.playerType = ElementWrapper('.playback-player-type-toggle', playbackControls);\r\n\r\n  ctrl.playPause.icon = ctrl.playPause.getElement('span.material-icons');\r\n\r\n  ctrl.nextTrack = ElementWrapper('.playback-next-button', playbackControls);\r\n\r\n  ctrl.repeat      = ElementWrapper('.playback-repeat-toggle', playbackControls);\r\n  ctrl.repeat.icon = ctrl.repeat.getElement('span.material-icons');\r\n\r\n  ctrl.shuffle = ElementWrapper('.playback-shuffle-button', playbackControls);\r\n\r\n  ctrl.mute      = ElementWrapper('.playback-mute-toggle', playbackControls);\r\n  ctrl.mute.icon = ctrl.mute.getElement('span.material-icons');\r\n\r\n  ctrl.volume = ElementWrapper('.playback-volume-control', playbackControls);\r\n}\r\n\r\nexport function ready(prevClickCallback, playPauseClickCallback, nextClickCallback, muteClickCallback)\r\n{\r\n  ctrl.progressSeek.setState(STATE.ENABLED);\r\n  ctrl.progressSeek.addListener('click', progressSeekClick);\r\n  ctrl.progressBar.setState(STATE.ENABLED);\r\n\r\n  ctrl.thumbnail.setState(STATE.HIDDEN);\r\n  ctrl.details.setState(STATE.HIDDEN);\r\n  ctrl.timer.setState(STATE.HIDDEN);\r\n\r\n  if (settings.mobile.showTrackThumbnail)\r\n    ctrl.thumbnail.addClass('show-on-mobile');\r\n\r\n  if (settings.mobile.showTrackTimes)\r\n    ctrl.timer.addClass('show-on-mobile');\r\n\r\n  ctrl.playerType.setState(STATE.ENABLED);\r\n  ctrl.playerType.addListener('click', () => playerTypeToggle.toggle());\r\n\r\n  ctrl.prevTrack.setState(STATE.ENABLED);\r\n  ctrl.prevTrack.addListener('click', prevClickCallback);\r\n\r\n  ctrl.playPause.setState(STATE.PAUSED);\r\n  ctrl.playPause.addListener('click', playPauseClickCallback);\r\n\r\n  ctrl.nextTrack.setState(STATE.ENABLED);\r\n  ctrl.nextTrack.addListener('click', () => nextClickCallback());\r\n\r\n  ctrl.repeat.setState(STATE.ENABLED);\r\n  ctrl.repeat.addListener('click', toggleRepeat);\r\n\r\n  ctrl.shuffle.setState(STATE.ENABLED);\r\n\r\n  ctrl.mute.setState(STATE.ENABLED);\r\n  ctrl.mute.addListener('click', () => muteClickCallback());\r\n  ctrl.volume.setState(STATE.ENABLED);\r\n  updateVolumeMuteState();\r\n\r\n  addSettingsObserver('autoplay',     updateAutoplayState);\r\n  addSettingsObserver('masterVolume', updateVolumeMuteState);\r\n  addSettingsObserver('masterMute',   updateVolumeMuteState);\r\n\r\n  addListener(EVENT.MEDIA_CUE_TRACK,   () => updateProgressPercent(0));\r\n  addListener(EVENT.MEDIA_LOADING,     setLoadState);\r\n  addListener(EVENT.MEDIA_PLAYING,     setPlayState);\r\n  addListener(EVENT.MEDIA_PAUSED ,     setPauseState);\r\n  addListener(EVENT.MEDIA_ENDED,       setMediaEndState);\r\n  addListener(EVENT.MEDIA_UNAVAILABLE, setPauseState);\r\n  addListener(EVENT.AUTOPLAY_BLOCKED,  setPauseState);\r\n}\r\n\r\n\r\n// ************************************************************************************************\r\n// Progress bar and position seek\r\n// ************************************************************************************************\r\n\r\nexport function updateProgressPercent(progressPercent)\r\n{\r\n  ctrl.progressBar.progressPercent = progressPercent;\r\n  updateProgressBar(progressPercent / 100);\r\n}\r\n\r\nexport function getProgressPercent()\r\n{\r\n  return ctrl.progressBar.progressPercent;\r\n}\r\n\r\nfunction updateProgressBar(scaleX)\r\n{\r\n  ctrl.progressBar.style.transform = `scaleX(${scaleX})`;\r\n}\r\n\r\nexport function updateTimerAndProgress(positionMilliseconds, positionSeconds, durationSeconds)\r\n{\r\n  setTimer(positionSeconds, durationSeconds);\r\n\r\n  // Prevent division by zero\r\n  if (durationSeconds === 0)\r\n    updateProgressBar(0);\r\n  else\r\n    updateProgressBar(positionMilliseconds / (durationSeconds * 1000));\r\n}\r\n\r\nfunction progressSeekClick(event)\r\n{\r\n  if (ctrl.timer.durationSeconds > 0)\r\n  {\r\n    let progressPercent = ((event.clientX / document.documentElement.clientWidth) * 100);\r\n    let seekPosSeconds  = Math.round((ctrl.timer.durationSeconds * progressPercent) / 100);\r\n\r\n    if (!settings.mobile.showPrevTrackButton      &&\r\n        matchesMedia(MATCH.SITE_MAX_WIDTH_MOBILE) &&\r\n        (progressPercent <= 20))\r\n    {\r\n      ctrl.progressSeek.clickCallback(0);\r\n      progressPercent = 0;\r\n      seekPosSeconds  = 0;\r\n    }\r\n    else\r\n    {\r\n      ctrl.progressSeek.clickCallback(seekPosSeconds);\r\n    }\r\n\r\n    if (isPlaying() === false)\r\n    {\r\n      updateProgressPercent(progressPercent);\r\n      setTimer(seekPosSeconds, ctrl.timer.durationSeconds);\r\n    }\r\n  }\r\n}\r\n\r\n\r\n// ************************************************************************************************\r\n// Details (Artist + Title) and track timer\r\n// ************************************************************************************************\r\n\r\nexport function updateTrackData(initialPositionSeconds = 0)\r\n{\r\n  if (initialPositionSeconds !== 0) debug.log(`updateTrackData() - initialPositionSeconds: ${initialPositionSeconds}`);\r\n\r\n  const trackData = m.getTrackData(initialPositionSeconds);\r\n\r\n  clearTrackTimer(trackData);\r\n  setTrackDetails(trackData);\r\n}\r\n\r\nfunction setTrackDetails(trackData)\r\n{\r\n  if (ctrl.details.state.ID === STATE.HIDDEN.ID)\r\n  {\r\n    ctrl.details.setState(STATE.ENABLED);\r\n    ctrl.thumbnail.setState(STATE.ENABLED);\r\n    ctrl.timer.setState(STATE.ENABLED);\r\n    clearTrackTimer(trackData);\r\n  }\r\n\r\n  ctrl.details.artist.textContent = trackData.artist || ''; // Artist will contain the post title if all else fails\r\n  ctrl.details.title.textContent  = trackData.title  || '';\r\n\r\n  setThumbnail(trackData.thumbnail);\r\n  setTimerDisplayHoursMinutes(trackData.duration);\r\n  setTimer((isPlaying() ? ctrl.timer.positionSeconds : trackData.position), trackData.duration);\r\n}\r\n\r\nfunction setThumbnail(thumbnail)\r\n{\r\n  // Don't set thumbnail again if the image source / URL is unchanged\r\n  if (thumbnail.src !== ctrl.thumbnail.img.src)\r\n  {\r\n    ctrl.thumbnail.removeClass('track-type-default', 'track-type-youtube', 'track-type-soundcloud', 'track-type-local');\r\n    ctrl.thumbnail.addClass('loading', thumbnail.class);\r\n    ctrl.thumbnail.img.src = thumbnail.src;\r\n    ctrl.thumbnail.img.decode().then(() => ctrl.thumbnail.removeClass('loading'));\r\n  }\r\n}\r\n\r\nfunction setTimerDisplayHoursMinutes(durationSeconds)\r\n{\r\n  (durationSeconds > 3600)\r\n    ? ctrl.timer.replaceClass('display-minutes', 'display-hours')\r\n    : ctrl.timer.replaceClass('display-hours', 'display-minutes');\r\n}\r\n\r\nfunction setTimer(positionSeconds, durationSeconds)\r\n{\r\n  if (ctrl.timer.positionSeconds !== positionSeconds)\r\n  {\r\n    ctrl.timer.positionSeconds = positionSeconds;\r\n\r\n    if (settings.playback.autoplay === false)\r\n      positionSeconds = (durationSeconds - positionSeconds);\r\n\r\n    ctrl.timer.position.textContent = getTimeString(positionSeconds, (durationSeconds > 3600));\r\n  }\r\n\r\n  if (ctrl.timer.durationSeconds !== durationSeconds)\r\n  {\r\n    ctrl.timer.durationSeconds      = durationSeconds;\r\n    ctrl.timer.duration.textContent = getTimeString(durationSeconds, (durationSeconds > 3600));\r\n  }\r\n}\r\n\r\nfunction clearTrackTimer(trackData)\r\n{\r\n  if (trackData.position === 0)\r\n  {\r\n    ctrl.timer.position.textContent = settings.playback.autoplay\r\n      ? (trackData.duration > 3600) ? '00:00:00' : '00:00'\r\n      : getTimeString(trackData.duration, (trackData.duration > 3600));\r\n\r\n    ctrl.timer.duration.textContent = (trackData.duration > 3600) ? '00:00:00' : '00:00';\r\n    ctrl.timer.positionSeconds = -1;\r\n    ctrl.timer.durationSeconds = -1;\r\n  }\r\n}\r\n\r\n\r\n// ************************************************************************************************\r\n// Playback controls (prev, play/pause and next)\r\n// ************************************************************************************************\r\n\r\nexport function isPlaying()\r\n{\r\n  // ToDo: This might not be the best place to save / check playback state...?\r\n  return (ctrl.playPause.state.ID === STATE.PLAYING.ID);\r\n}\r\n\r\nfunction setLoadState()\r\n{\r\n  if (ctrl.thumbnail.state.ID === STATE.ENABLED.ID)\r\n    ctrl.thumbnail.addClass(STATE.LOADING.CLASS);\r\n}\r\n\r\nfunction setMediaEndState()\r\n{\r\n  updateProgressBar(0);\r\n  setTimer(0, m.getTrackData().duration);\r\n}\r\n\r\nfunction setIsIframePlaying(isIframePlaying)\r\n{\r\n  if (isInIframe)\r\n  {\r\n    isIframePlaying\r\n      ? window.frameElement.classList.add('is-playing')\r\n      : window.frameElement.classList.remove('is-playing');\r\n  }\r\n}\r\n\r\nexport function setPlayState()\r\n{\r\n  ctrl.thumbnail.removeClass(STATE.LOADING.CLASS);\r\n  ctrl.progressBar.setState(STATE.PLAYING);\r\n  ctrl.playPause.setState(STATE.PLAYING);\r\n  ctrl.playPause.icon.textContent = 'pause_circle_filled';\r\n  ctrl.prevTrack.setState(STATE.ENABLED);\r\n\r\n  setIsIframePlaying(true);\r\n  setTrackDetails(m.getTrackData());\r\n}\r\n\r\nexport function setPauseState()\r\n{\r\n  ctrl.thumbnail.removeClass(STATE.LOADING.CLASS);\r\n  ctrl.progressBar.setState(STATE.PAUSED);\r\n  ctrl.playPause.setState(STATE.PAUSED);\r\n  ctrl.playPause.icon.textContent = 'play_circle_filled';\r\n\r\n  setIsIframePlaying(false);\r\n}\r\n\r\nexport function timeRemainingWarningBlink(toggleBlink)\r\n{\r\n  if (toggleBlink)\r\n  {\r\n    ctrl.progressBar.toggleClass('time-remaining-warning');\r\n    ctrl.playPause.toggleClass('time-remaining-warning');\r\n  }\r\n  else\r\n  {\r\n    ctrl.progressBar.removeClass('time-remaining-warning');\r\n    ctrl.playPause.removeClass('time-remaining-warning');\r\n  }\r\n}\r\n\r\n\r\n// ************************************************************************************************\r\n// Repeat control\r\n// ************************************************************************************************\r\n\r\nexport const REPEAT = { OFF: 0, ALL: 1, ONE: 2 };\r\n\r\nconst repeatModes = [\r\n  { title: 'Repeat Off', icon: 'repeat'     },\r\n  { title: 'Repeat All', icon: 'repeat'     },\r\n  { title: 'Repeat One', icon: 'repeat_one' },\r\n];\r\n\r\nexport function getRepeatMode()\r\n{\r\n  return parseInt(ctrl.repeat.getAttribute('data-repeat-mode'));\r\n}\r\n\r\nexport function toggleRepeat()\r\n{\r\n  const index = ((getRepeatMode() + 1) < repeatModes.length)\r\n                  ? (getRepeatMode() + 1)\r\n                  : 0;\r\n\r\n  ctrl.repeat.setAttribute('data-repeat-mode', index);\r\n  ctrl.repeat.element.title    = `${repeatModes[index].title} (r)`;\r\n  ctrl.repeat.icon.textContent = repeatModes[index].icon;\r\n\r\n  return repeatModes[index];\r\n}\r\n\r\n\r\n// ************************************************************************************************\r\n// Set Mute control and Autoplay states\r\n// ************************************************************************************************\r\n\r\nfunction updateVolumeMuteState()\r\n{\r\n  ctrl.volume.element.textContent = `${settings.playback.masterVolume}`;\r\n\r\n  if (settings.playback.masterMute)\r\n  {\r\n    ctrl.mute.element.title    = 'Muted (m to Unmute), Reset: shift + v';\r\n    ctrl.mute.icon.textContent = 'volume_off';\r\n    ctrl.volume.setState(STATE.DISABLED);\r\n  }\r\n  else\r\n  {\r\n    ctrl.mute.element.title    = 'Unmuted (m to Mute), Reset: shift + v';\r\n    ctrl.mute.icon.textContent = (settings.playback.masterVolume > 50) ? 'volume_up' : 'volume_down_alt';\r\n    ctrl.volume.setState(STATE.ENABLED);\r\n  }\r\n}\r\n\r\nfunction updateAutoplayState()\r\n{\r\n  const position = ctrl.timer.positionSeconds;\r\n  const duration = ctrl.timer.durationSeconds;\r\n\r\n  if ((isPlaying() === false) && (position !== -1) && ((duration !== -1)))\r\n  {\r\n    ctrl.timer.position.textContent = settings.playback.autoplay\r\n      ? getTimeString(position, (duration > 3600))\r\n      : getTimeString((duration - position), (duration > 3600));\r\n\r\n    ctrl.timer.duration.textContent = getTimeString(duration, (duration > 3600));\r\n  }\r\n}\r\n", "//\r\n// Playback events module\r\n//\r\n// https://ultrafunk.com\r\n//\r\n\r\n\r\nimport { newDebugLogger }        from '../../shared/debuglogger.js';\r\nimport { updateProgressPercent } from './playback-controls.js';\r\n\r\n\r\n/*************************************************************************************************/\r\n\r\n\r\nconst debug = newDebugLogger('playback-events');\r\nexport let hasPlaybackStarted = false;\r\n\r\nexport const EVENT = {\r\n  PLAYBACK_LOADING:     'playbackLoading',\r\n  PLAYBACK_READY:       'playbackReady',\r\n  MEDIA_LOADING:        'mediaLoading',\r\n  MEDIA_PLAYING:        'mediaPlaying',\r\n  MEDIA_PAUSED:         'mediaPaused',\r\n  MEDIA_ENDED:          'mediaEnded',\r\n  MEDIA_CUE_TRACK:      'mediaCueTrack',\r\n  MEDIA_PREV_TRACK:     'mediaPrevTrack',\r\n  MEDIA_NEXT_TRACK:     'mediaNextTrack',\r\n  MEDIA_TIME_REMAINING: 'mediaTimeRemaining',\r\n  MEDIA_UNAVAILABLE:    'mediaUnavailable',\r\n  CONTINUE_AUTOPLAY:    'continueAutoplay',\r\n  RESUME_AUTOPLAY:      'resumeAutoplay',\r\n  AUTOPLAY_BLOCKED:     'autoplayBlocked',\r\n};\r\n\r\nconst eventListeners = {\r\n  [EVENT.PLAYBACK_LOADING]:     [ (playbackEvent) => updateProgressPercent(playbackEvent.data.loadingPercent) ],\r\n  [EVENT.PLAYBACK_READY]:       [ playbackReady ],\r\n  [EVENT.MEDIA_LOADING]:        [],\r\n  [EVENT.MEDIA_PLAYING]:        [ () => (hasPlaybackStarted = true) ],\r\n  [EVENT.MEDIA_PAUSED]:         [],\r\n  [EVENT.MEDIA_ENDED]:          [],\r\n  [EVENT.MEDIA_CUE_TRACK]:      [ () => (hasPlaybackStarted = false) ],\r\n  [EVENT.MEDIA_PREV_TRACK]:     [ (playbackEvent) => debug.log(playbackEvent) ],\r\n  [EVENT.MEDIA_NEXT_TRACK]:     [ (playbackEvent) => debug.log(playbackEvent) ],\r\n  [EVENT.MEDIA_TIME_REMAINING]: [],\r\n  [EVENT.MEDIA_UNAVAILABLE]:    [],\r\n  [EVENT.CONTINUE_AUTOPLAY]:    [],\r\n  [EVENT.RESUME_AUTOPLAY]:      [],\r\n  [EVENT.AUTOPLAY_BLOCKED]:     [],\r\n};\r\n\r\n\r\n// ************************************************************************************************\r\n//\r\n// ************************************************************************************************\r\n\r\nexport function addListener(playbackEvent, playbackEventListener)\r\n{\r\n  if (playbackEvent in eventListeners)\r\n    eventListeners[playbackEvent].push(playbackEventListener);\r\n}\r\n\r\nexport function dispatch(playbackEvent, playbackEventData = null, playbackEventCallback = null)\r\n{\r\n  eventListeners[playbackEvent].forEach(eventListener =>\r\n  {\r\n    eventListener({\r\n      event:    playbackEvent,\r\n      data:     playbackEventData,\r\n      callback: playbackEventCallback,\r\n    });\r\n  });\r\n}\r\n\r\n\r\n// ************************************************************************************************\r\n// Default event listeners\r\n// ************************************************************************************************\r\n\r\nfunction playbackReady(playbackEvent)\r\n{\r\n  debug.log(playbackEvent);\r\n\r\n  // Prevents fractional pixel \"extra\" 1px border\r\n  document.querySelectorAll('#list-players-container .wp-block-embed__wrapper').forEach((element) =>\r\n  {\r\n    element.style = 'background-color: var(--body-background-color)';\r\n  });\r\n\r\n  if (playbackEvent?.data.resetProgressBar)\r\n    updateProgressPercent(0);\r\n}\r\n", "//\n// Fetch & play single (standalone) tracks without page load\n//\n// https://ultrafunk.com\n//\n\n\nimport { newDebugLogger }    from '../../shared/debuglogger.js';\nimport { KEY }               from '../../shared/storage.js';\nimport { showSnackbar }      from '../../shared/snackbar.js';\nimport { shuffleClickNavTo } from '../common/shared-gallery-list.js';\n\nimport {\n  TRACK_TYPE,\n  getThumbnailData,\n} from '../common/mediaplayer.js';\n\nimport {\n  response,\n  settings,\n} from '../../shared/session-data.js';\n\nimport {\n  HTTP_RESPONSE,\n  fetchRest,\n} from '../../shared/fetch-rest.js';\n\n\n/*************************************************************************************************/\n\n\nconst debug = newDebugLogger('single-track-fetch');\n\nconst m = {\n  cueOrPlayTrackById: null,\n  prevTrackDateTime:  null,\n  nextTrackDateTime:  null,\n  isTrackLoading:     false,\n};\n\nexport const SINGLE_TRACK = {\n  PREV: 1,\n  NEXT: 2,\n};\n\n\n// ************************************************************************************************\n// Exports\n// ************************************************************************************************\n\nexport function isSingleTrackFetch()\n{\n  return (document.body.matches('.single.track') && settings.gallery.fetchSingleTracks);\n}\n\nexport function isSingleTrackLoading()\n{\n  return m.isTrackLoading;\n}\n\nexport function singleTrackFetchReady(cueOrPlayTrackByIdCallback)\n{\n  if (isSingleTrackFetch())\n  {\n    debug.log('singleTrackFetchReady()');\n\n    m.cueOrPlayTrackById = cueOrPlayTrackByIdCallback;\n    m.prevTrackDateTime  = document.querySelector('single-track').getAttribute('data-prev-track-date-time');\n    m.nextTrackDateTime  = document.querySelector('single-track').getAttribute('data-next-track-date-time');\n\n    window.addEventListener('popstate', (event) => onPopState(event));\n  }\n}\n\nexport async function cueOrPlaySingleTrack(prevNextTrack, playTrack = false)\n{\n  if (isSingleTrackFetch())\n  {\n    m.isTrackLoading   = true;\n    const restResponse = await fetchTracks(prevNextTrack);\n\n    if ((restResponse.status.code === HTTP_RESPONSE.OK) && (restResponse.data.length > 1))\n    {\n      cueOrPlayFetchedTrack(prevNextTrack, playTrack, restResponse);\n    }\n    else\n    {\n      if (restResponse.status.code !== HTTP_RESPONSE.OK)\n      {\n        showSnackbar({\n          message: 'Failed to fetch track data!',\n          duration: 30,\n          actionText: 'Retry',\n          actionClickCallback: () => cueOrPlaySingleTrack(prevNextTrack, playTrack),\n        });\n      }\n      else if ((restResponse.status.code === HTTP_RESPONSE.OK) && (restResponse.data.length === 1))\n      {\n        showSnackbar({\n          message: 'No more tracks to play...',\n          duration: 5,\n          actionText: 'Shuffle',\n          actionClickCallback: () => shuffleClickNavTo(),\n        });\n      }\n    }\n  }\n\n  m.isTrackLoading = false;\n}\n\nfunction cueOrPlayFetchedTrack(prevNextTrack, playTrack, restResponse)\n{\n  if (prevNextTrack === SINGLE_TRACK.PREV)\n  {\n    restResponse.data.reverse();\n\n    if (restResponse.data.length === 2)\n      restResponse.data.unshift(null);\n  }\n\n  m.prevTrackDateTime = (restResponse.data.length === 3) ? restResponse.data[2].date : '';\n  m.nextTrackDateTime = (restResponse.data[0] !== null)  ? restResponse.data[0].date : '';\n  const currentTrack  = restResponse.data[1];\n\n  debug.log(`cueOrPlayFetchedTrack() - prevNextTrack: ${debug.getKeyForValue(SINGLE_TRACK, prevNextTrack)} - playTrack: ${playTrack} - trackType: ${debug.getKeyForValue(TRACK_TYPE, currentTrack.meta.track_source_type)} => ${getTrackTitle(currentTrack.meta)}`);\n\n  if (currentTrack.meta.track_source_type === TRACK_TYPE.YOUTUBE)\n  {\n    updatePlayerAndPage(restResponse.data, playTrack, true);\n  }\n  else\n  {\n    showSnackbar({\n      message: 'SoundCloud track, skipping to next',\n      duration: 5,\n      actionText: 'Play',\n      actionClickCallback: () =>\n      {\n        sessionStorage.setItem(KEY.UF_AUTOPLAY, JSON.stringify({ autoplay: true, trackId: null, position: 0 }));\n        window.location.href = currentTrack.link;\n      },\n      afterCloseCallback: () => cueOrPlaySingleTrack(prevNextTrack, playTrack),\n    });\n  }\n}\n\n\n// ************************************************************************************************\n// Support functions\n// ************************************************************************************************\n\nfunction fetchTracks(prevNextTrack)\n{\n  if (prevNextTrack === SINGLE_TRACK.NEXT)\n  {\n    const queryTracksDateTime = (m.nextTrackDateTime !== '') ? m.nextTrackDateTime : '3000-01-01T00:00:01'; // Before the year 3000 should be enough for a while...\n\n    return fetchRest({\n      endpoint: 'tracks',\n      query:    `before=${queryTracksDateTime}&per_page=3&separator=true&_fields=id,date,link,meta,artists_links,channels_links`,\n    });\n  }\n  else\n  {\n    const queryTracksDateTime = (m.prevTrackDateTime !== '') ? m.prevTrackDateTime : '1000-01-01T00:00:01'; // After the year 1000 should be enough for a while...\n\n    return fetchRest({\n      endpoint: 'tracks',\n      query:    `after=${queryTracksDateTime}&order=asc&per_page=3&separator=true&_fields=id,date,link,meta,artists_links,channels_links`,\n    });\n  }\n}\n\nfunction onPopState(event)\n{\n  if (event.state === null)\n  {\n    location.reload();\n  }\n  else\n  {\n    // Set prev next track DateTime to the right values for this page\n    m.prevTrackDateTime = (event.state.length === 3) ? event.state[2].date : '';\n    m.nextTrackDateTime = (event.state[0] !== null)  ? event.state[0].date : '';\n\n    updatePlayerAndPage(event.state, false, false);\n  }\n}\n\nfunction getTrackTitle(titleData)\n{\n  return `${titleData.track_artist} - ${titleData.track_title}`;\n}\n\nfunction updatePlayerAndPage(trackData, playTrack = false, pushState = true)\n{\n  const thumbnailData = getThumbnailData(trackData[1].meta);\n\n  m.cueOrPlayTrackById(trackData[1].meta, thumbnailData, playTrack);\n  updatePage(trackData, thumbnailData, pushState);\n}\n\nfunction getTrackNavHtml(isNavPrev, navUrl, trackMeta)\n{\n  const trackArtistTitle  = `<b>${trackMeta.track_artist}</b><br>${trackMeta.track_title}`;\n  const prevNextThumbnail = getThumbnailData(trackMeta);\n  const prevNextThumbHtml = /*html*/ `\n    <div class=\"${isNavPrev ? 'prev' : 'next'}-track-nav-thumbnail ${prevNextThumbnail.class}\">\n      <img src=\"${prevNextThumbnail.src}\" alt=\"${isNavPrev ? 'Previous' : 'Next'} Track Thumbnail\">\n    </div>`;\n\n  return /*html*/ `\n    <div class=\"${isNavPrev ? 'nav-previous' : 'nav-next'}\">\n      <a href=\"${navUrl}\" rel=\"${isNavPrev ? 'prev' : 'next'}\" title=\"${isNavPrev ? 'Go to Previous track' : 'Go to Next track'}\">\n        ${isNavPrev ? '<div class=\"prev-track-arrow\">&#10094;</div>' : ''}\n        ${isNavPrev ? prevNextThumbHtml : ''}\n        <div class=\"${isNavPrev ? 'prev-track-artist-title' : 'next-track-artist-title'}\">${trackArtistTitle}</div>\n        ${!isNavPrev ? prevNextThumbHtml : ''}\n        ${!isNavPrev ? '<div class=\"next-track-arrow\">&#10095;</div>' : ''}\n      </a>\n    </div>`;\n}\n\n\n// ************************************************************************************************\n// Update DOM functions\n// ************************************************************************************************\n\nfunction updatePage(trackData, thumbnailData, pushState = true)\n{\n  response.prevPage = (trackData[0] !== null)  ? trackData[0].link : null;\n  response.nextPage = (trackData.length === 3) ? trackData[2].link : null;\n\n  updateSiteNavLinks(document.querySelectorAll('span.navbar-arrow-prev'), response.prevPage);\n  updateSiteNavLinks(document.querySelectorAll('span.navbar-arrow-next'), response.nextPage);\n  updateTrackNavLinks(document.querySelector('div.nav-links'), trackData);\n  updateTrackHeader(document.querySelector('header.track-header'), trackData[1]);\n  updateTrackAttributes(document.querySelector('single-track'), trackData[1], thumbnailData);\n\n  if (pushState)\n    history.pushState(trackData, '', trackData[1].link);\n\n  document.title = getTrackTitle(trackData[1].meta);\n}\n\nfunction updateSiteNavLinks(elements, url)\n{\n  elements?.forEach(element => { element.closest('a').href = (url !== null) ? url : '#'; });\n}\n\nfunction updateTrackNavLinks(element, trackData)\n{\n  let trackNavHtml = '';\n\n  if (trackData[0] !== null)\n    trackNavHtml += getTrackNavHtml(true, response.prevPage, trackData[0].meta);\n\n  if (trackData.length === 3)\n    trackNavHtml += getTrackNavHtml(false, response.nextPage, trackData[2].meta);\n\n  element.innerHTML = trackNavHtml;\n}\n\nfunction updateTrackHeader(element, trackData)\n{\n  element.querySelector('h2.track-artist-title').innerHTML            = `${trackData.meta.track_artist}<span class=\"normal-text\"> &nbsp;&#8212;&nbsp; ${trackData.meta.track_title}</span>`;\n  element.querySelector('h2.track-artist-title.type-split').innerHTML = `${trackData.meta.track_artist}<br><span class=\"track-title-part\">${trackData.meta.track_title}</span>`;\n  element.querySelector('div.track-meta-artists  .track-artists-links').innerHTML  = trackData.artists_links;\n  element.querySelector('div.track-meta-channels .track-channels-links').innerHTML = trackData.channels_links;\n}\n\nfunction updateTrackAttributes(element, trackData, thumbnailData)\n{\n  const attributes = {\n    'track-type':          trackData.meta.track_source_type,\n    'track-artist':        trackData.meta.track_artist,\n    'track-title':         trackData.meta.track_title,\n    'track-duration':      trackData.meta.track_duration,\n    'track-url':           trackData.link,\n    'track-thumbnail-url': thumbnailData.src,\n    'track-source-uid':    thumbnailData.uid,\n  };\n\n  Object.keys(attributes).forEach(key => element.setAttribute(`data-${key}`, attributes[key]));\n}\n"],
  "mappings": "6FAiBO,IAAMA,GAAU,UAEVC,GAC0B,oDAG1BC,EAAY,CACvB,QAAsD,wBACtD,gBAAuD,IACvD,oBAAsD,KACtD,2BAAsD,KACtD,4BAAsD,KACtD,mCAAsD,KACtD,sBAAsCD,GAAsB,iCAC5D,mBAAsCA,GAAsB,wCAC5D,mBAAsCA,GAAsB,wCAC5D,mBAAsCA,GAAsB,wCAC5D,0BAAsCA,GAAsB,mCAC9D,EClBO,SAASE,EAAeC,EAC/B,CACE,OAA8C,IAAIC,GAAUD,CAAU,CACxE,CAEA,IAAME,GAAN,KACA,CACE,YAAYF,EAAa,UACzB,CACE,KAAK,WAAcA,EAAW,OAAS,GACnCA,EAAW,MAAM,EAAG,EAAE,EAAE,YAAY,EACpCA,EAAW,OAAO,GAAI,GAAG,EAAE,YAAY,CAC7C,CAEA,KAAKG,EAAO,CAAE,QAAQ,KAAK,GAAG,KAAK,UAAU,IAAMA,CAAI,CAAG,CAC1D,MAAMA,EAAM,CAAE,QAAQ,MAAM,GAAG,KAAK,UAAU,IAAKA,CAAI,CAAG,CAC5D,EAEMC,GAAN,cAAuBF,EACvB,CACE,IAAIC,EACJ,CACE,QAAQ,IAAI,GAAG,KAAK,UAAU,IAAKA,CAAI,CACzC,CAEA,eAAeE,EAAQC,EACvB,CACE,OAAO,OAAO,KAAKD,CAAM,EAAE,KAAKE,GAAQF,EAAOE,CAAG,IAAMD,CAAM,CAChE,CACF,EAEML,GAAN,cAAwBC,EACxB,CACE,KAAM,CAAC,CACP,gBAAiB,CAAC,CACpB,EAOIM,GAAiB,EACjBC,GAAiB,EAEd,SAASC,IAChB,CACEF,GAAiB,YAAY,IAAI,CACnC,CAEO,IAAMG,GAAS;AAAA;AAAA,oBAIf,SAASC,IAChB,CACEH,GAAgB,YAAY,IAAI,EAChC,QAAQ,IAAI,wCAAyC,KAAK,OAAOA,GAAgBD,IAAkB,GAAG,EAAI,GAAI,YAAYK,EAAU,OAAO,GAAIF,EAAM,CACvJ,CC1DO,IAAMG,GAAc,CACzB,KAAS,EACT,QAAS,EACT,KAAS,CACX,EAQMC,GAA6B,CAAE,EAAM,GAAO,GAAO,GAAO,GAAO,GAAO,GAAO,GAAO,GAAO,GAAO,GAAO,GAAO,GAAO,GAAO,GAAO,GAAO,GAAO,GAAO,GAAO,GAAK,EACxKC,GAA6B,CAAC,KAAM,MAAO,MAAO,MAAO,MAAO,MAAO,MAAO,MAAO,MAAO,MAAO,MAAO,MAAO,MAAO,MAAO,MAAO,MAAO,MAAO,MAAO,MAAO,MAAM,EAExKC,GAA6B,CAAE,GAAM,GAAM,GAAM,GAAM,GAAM,GAAM,GAAM,GAAM,EAAG,EAClFC,GAA6B,CAAC,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,IAAI,EAElFC,GAA6B,CAAE,EAAK,EAAK,EAAK,GAAM,GAAM,GAAM,GAAM,GAAM,GAAM,GAAM,EAAG,EAC3FC,GAA6B,CAAC,IAAK,IAAK,IAAK,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,IAAI,EAEpFC,EAAiB,CAC5B,QAAS,CAAE,YAAa,GAAI,KAAM,EAAS,OAAQ,CAAC,EAAG,MAAM,EAAG,QAAS,GAAI,aAAc,CAAC,CAAE,EAC9F,SAAU,CACR,gBAAsB,CAAE,YAAa,mBAAmC,KAAM,EAAS,OAAQ,CAAC,EAAG,CAAC,EAAiB,QAAS,EAAO,aAAc,CAAC,UAAW,MAAM,CAAE,EACvK,kBAAsB,CAAE,YAAa,qBAAmC,KAAM,EAAS,OAAQ,CAAC,GAAM,EAAK,EAAU,QAAS,GAAO,aAAc,CAAC,KAAM,KAAK,CAAE,EACjK,aAAsB,CAAE,YAAa,gBAAmC,KAAM,EAAS,OAAQN,GAAsB,QAAS,IAAO,aAAcC,EAAyB,EAC5K,WAAsB,CAAE,YAAa,cAAmC,KAAM,EAAS,OAAQ,CAAC,GAAM,EAAK,EAAU,QAAS,GAAO,aAAc,CAAC,KAAM,KAAK,CAAE,EACjK,oBAAsB,CAAE,YAAa,gCAAmC,KAAM,EAAS,OAAQ,CAAC,GAAM,EAAK,EAAU,QAAS,GAAO,aAAc,CAAC,KAAM,KAAK,CAAE,EACjK,SAAsB,CAAE,YAAa,sBAAmC,KAAM,EAAS,OAAQ,CAAC,GAAM,EAAK,EAAU,QAAS,GAAO,aAAc,CAAC,KAAM,KAAK,CAAE,EACjK,mBAAsB,CAAE,YAAa,gCAAmC,KAAM,EAAS,OAAQ,CAAC,GAAM,EAAK,EAAU,QAAS,GAAO,aAAc,CAAC,KAAM,KAAK,CAAE,EACjK,qBAAsB,CAAE,YAAa,+BAAmC,KAAM,EAAS,OAAQ,CAAC,GAAM,EAAK,EAAU,QAAS,GAAO,aAAc,CAAC,KAAM,KAAK,CAAE,EACjK,qBAAsB,CAAE,YAAa,iCAAmC,KAAM,EAAS,OAAQ,CAAC,GAAI,GAAI,GAAI,GAAG,EAAM,QAAS,GAAO,aAAc,CAAC,SAAU,SAAU,SAAU,SAAS,CAAE,EAC7L,oBAAsB,CAAE,YAAa,kCAAmC,KAAM,EAAS,OAAQ,CAAC,GAAM,EAAK,EAAU,QAAS,GAAO,aAAc,CAAC,KAAM,KAAK,CAAE,CACnK,EACA,KAAM,CACJ,oBAAuB,CAAE,YAAa,qCAA0C,KAAM,EAAS,OAAQ,CAAC,GAAM,EAAK,EAAO,QAAS,GAAO,aAAc,CAAC,KAAM,KAAK,CAAE,EACtK,sBAAuB,CAAE,YAAa,qCAA0C,KAAM,EAAS,OAAQ,CAAC,GAAI,GAAI,GAAI,EAAE,EAAI,QAAS,GAAO,aAAc,CAAC,KAAM,KAAM,KAAM,IAAI,CAAE,EACjL,qBAAuB,CAAE,YAAa,wCAA0C,KAAM,EAAS,OAAQ,CAAC,GAAM,EAAK,EAAO,QAAS,GAAO,aAAc,CAAC,KAAM,KAAK,CAAE,EACtK,sBAAuB,CAAE,YAAa,yCAA0C,KAAM,EAAS,OAAQ,CAAC,GAAM,EAAK,EAAO,QAAS,GAAO,aAAc,CAAC,KAAM,KAAK,CAAE,EACtK,oBAAuB,CAAE,YAAa,6BAA0C,KAAM,EAAS,OAAQ,CAAC,GAAM,EAAK,EAAO,QAAS,GAAO,aAAc,CAAC,KAAM,KAAK,CAAE,EACtK,gBAAuB,CAAE,YAAa,qBAA0C,KAAM,EAAS,OAAQ,CAAC,GAAM,EAAK,EAAO,QAAS,GAAO,aAAc,CAAC,KAAM,KAAK,CAAE,EACtK,mBAAuB,CAAE,YAAa,oCAA0C,KAAM,EAAS,OAAQ,CAAC,GAAM,EAAK,EAAO,QAAS,GAAO,aAAc,CAAC,KAAM,KAAK,CAAE,EACtK,cAAuB,CAAE,YAAa,oCAA0C,KAAM,EAAS,OAAQC,GAAmB,QAAS,GAAO,aAAcC,EAAwB,EAChL,oBAAuB,CAAE,YAAa,wCAA0C,KAAM,EAAS,OAAQ,CAAC,GAAM,EAAK,EAAO,QAAS,GAAO,aAAc,CAAC,KAAM,KAAK,CAAE,CACxK,EACA,QAAS,CACP,OAAyB,CAAE,YAAa,eAAwC,KAAM,EAAS,OAAQ,CAAC,WAAY,WAAY,UAAU,EAAM,QAAS,WAAY,aAAc,CAAC,WAAY,WAAY,cAAc,CAAE,EAC5N,kBAAyB,CAAE,YAAa,uCAAwC,KAAM,EAAS,OAAQ,CAAC,GAAM,EAAK,EAAa,QAAS,GAAO,aAAc,CAAC,KAAM,KAAK,CAAE,EAC5K,cAAyB,CAAE,YAAa,oCAAwC,KAAM,EAAS,OAAQC,GAAyB,QAAS,GAAO,aAAcC,EAA2B,EACzL,cAAyB,CAAE,YAAa,+BAAwC,KAAM,EAAS,OAAQ,CAAC,GAAM,EAAK,EAAa,QAAS,GAAO,aAAc,CAAC,KAAM,KAAK,CAAE,EAC5K,oBAAyB,CAAE,YAAa,wBAAwC,KAAM,EAAS,OAAQ,CAAC,EAAG,GAAI,GAAI,GAAI,GAAI,EAAE,EAAG,QAAS,GAAO,aAAc,CAAC,QAAS,SAAU,SAAU,SAAU,SAAU,QAAQ,CAAE,EAC1N,mBAAyB,CAAE,YAAa,uBAAwC,KAAM,EAAS,OAAQ,CAAC,EAAG,CAAC,EAAoB,QAAS,EAAO,aAAc,CAAC,cAAe,QAAQ,CAAE,EACxL,WAAyB,CAAE,YAAa,2BAAwC,KAAM,EAAS,OAAQ,CAAC,GAAM,EAAK,EAAa,QAAS,GAAO,aAAc,CAAC,KAAM,KAAK,CAAE,EAC5K,sBAAyB,CAAE,YAAa,iCAAwC,KAAM,EAAS,OAAQ,CAAC,GAAM,EAAK,EAAa,QAAS,GAAO,aAAc,CAAC,KAAM,KAAK,CAAE,EAC5K,wBAAyB,CAAE,YAAa,8BAAwC,KAAM,EAAS,OAAQ,CAAC,EAAG,EAAG,EAAG,EAAG,EAAG,CAAC,EAAQ,QAAS,EAAO,aAAc,CAAC,mBAAoB,mBAAoB,mBAAoB,oBAAqB,oBAAqB,mBAAmB,CAAE,CAC5R,EACA,OAAQ,CACN,aAAqB,CAAE,YAAa,8BAA+B,KAAM,EAAS,OAAQ,CAAC,GAAM,EAAK,EAAG,QAAS,GAAO,aAAc,CAAC,KAAM,KAAK,CAAE,EACrJ,mBAAqB,CAAE,YAAa,uBAA+B,KAAM,EAAS,OAAQ,CAAC,GAAM,EAAK,EAAG,QAAS,GAAO,aAAc,CAAC,KAAM,KAAK,CAAE,EACrJ,eAAqB,CAAE,YAAa,mBAA+B,KAAM,EAAS,OAAQ,CAAC,GAAM,EAAK,EAAG,QAAS,GAAO,aAAc,CAAC,KAAM,KAAK,CAAE,EACrJ,oBAAqB,CAAE,YAAa,6BAA+B,KAAM,EAAS,OAAQ,CAAC,GAAM,EAAK,EAAG,QAAS,GAAO,aAAc,CAAC,KAAM,KAAK,CAAE,CACvJ,EACA,KAAM,CACJ,kBAAqB,CAAE,YAAa,qBAAyC,KAAM,EAAS,OAAQ,CAAC,GAAM,EAAK,EAA0B,QAAS,GAAQ,aAAc,CAAC,KAAM,KAAK,CAAE,EACvL,MAAqB,CAAE,YAAa,QAAyC,KAAM,EAAS,OAAQ,CAAC,QAAS,OAAQ,QAAS,MAAM,EAAK,QAAS,OAAQ,aAAc,CAAC,QAAS,OAAQ,QAAS,eAAe,CAAE,EACrN,gBAAqB,CAAE,YAAa,wCAAyC,KAAM,EAAS,OAAQ,CAAC,GAAM,EAAK,EAA0B,QAAS,GAAQ,aAAc,CAAC,KAAM,KAAK,CAAE,EACvL,eAAqB,CAAE,YAAa,kBAAyC,KAAM,EAAS,OAAQ,CAAC,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,EAAE,EAAG,QAAS,GAAQ,aAAc,CAAC,MAAO,MAAO,MAAO,MAAO,MAAO,MAAO,MAAO,MAAO,KAAK,CAAE,EACzO,mBAAqB,CAAE,YAAa,8BAAyC,KAAM,EAAS,OAAQ,CAAC,GAAM,EAAK,EAA0B,QAAS,GAAQ,aAAc,CAAC,KAAM,KAAK,CAAE,CACzL,EACA,SAAU,CAEV,EACA,aAAc,CAKd,CACF,EAEaE,GAAkB,CAC7B,QAASD,EAAe,QAAQ,QAChC,SAAU,CACR,gBAAsBA,EAAe,SAAS,gBAAgB,QAC9D,kBAAsBA,EAAe,SAAS,kBAAkB,QAChE,aAAsBA,EAAe,SAAS,aAAa,QAC3D,WAAsBA,EAAe,SAAS,WAAW,QACzD,oBAAsBA,EAAe,SAAS,oBAAoB,QAClE,SAAsBA,EAAe,SAAS,SAAS,QACvD,mBAAsBA,EAAe,SAAS,mBAAmB,QACjE,qBAAsBA,EAAe,SAAS,qBAAqB,QACnE,qBAAsBA,EAAe,SAAS,qBAAqB,QACnE,oBAAsBA,EAAe,SAAS,oBAAoB,OACpE,EACA,KAAM,CACJ,oBAAuBA,EAAe,KAAK,oBAAoB,QAC/D,sBAAuBA,EAAe,KAAK,sBAAsB,QACjE,qBAAuBA,EAAe,KAAK,qBAAqB,QAChE,sBAAuBA,EAAe,KAAK,sBAAsB,QACjE,oBAAuBA,EAAe,KAAK,oBAAoB,QAC/D,gBAAuBA,EAAe,KAAK,gBAAgB,QAC3D,mBAAuBA,EAAe,KAAK,mBAAmB,QAC9D,cAAuBA,EAAe,KAAK,cAAc,QACzD,oBAAuBA,EAAe,KAAK,oBAAoB,OACjE,EACA,QAAS,CACP,OAAyBA,EAAe,QAAQ,OAAO,QACvD,kBAAyBA,EAAe,QAAQ,kBAAkB,QAClE,cAAyBA,EAAe,QAAQ,cAAc,QAC9D,cAAyBA,EAAe,QAAQ,cAAc,QAC9D,oBAAyBA,EAAe,QAAQ,oBAAoB,QACpE,mBAAyBA,EAAe,QAAQ,mBAAmB,QACnE,WAAyBA,EAAe,QAAQ,WAAW,QAC3D,sBAAyBA,EAAe,QAAQ,sBAAsB,QACtE,wBAAyBA,EAAe,QAAQ,wBAAwB,OAC1E,EACA,OAAQ,CACN,aAAqBA,EAAe,OAAO,aAAa,QACxD,mBAAqBA,EAAe,OAAO,mBAAmB,QAC9D,eAAqBA,EAAe,OAAO,eAAe,QAC1D,oBAAqBA,EAAe,OAAO,oBAAoB,OACjE,EACA,KAAM,CACJ,kBAAqBA,EAAe,KAAK,kBAAkB,QAC3D,MAAqBA,EAAe,KAAK,MAAM,QAC/C,gBAAqBA,EAAe,KAAK,gBAAgB,QACzD,eAAqBA,EAAe,KAAK,eAAe,QACxD,mBAAqBA,EAAe,KAAK,mBAAmB,OAC9D,EACA,SAAU,CAEV,EACA,aAAc,CAKd,CACF,EAEaE,GAAuB,CAClC,SAAU,CACR,oBAAqB,kHACvB,EACA,KAAM,CACJ,mBAAoB,kIACtB,CACF,EAOaC,EAAgB,CAC3B,QAAS,CAAE,YAAa,GAAI,KAAM,EAAS,OAAQ,CAAC,EAAG,MAAM,EAAG,QAAS,EAAG,aAAc,CAAC,CAAE,EAC7F,UAAW,CACT,CACE,KAAQ,CAAE,YAAa,WAAoB,KAAM,EAAS,OAAQ,CAAC,EAAG,EAAE,EAAmB,QAAS,eAAgB,aAAc,CAAC,CAAE,EACrI,OAAQ,CAAE,YAAa,mBAAoB,KAAM,EAAS,OAAQ,CAAC,EAAG,GAAI,GAAI,GAAI,GAAI,EAAE,EAAG,QAAS,GAAgB,aAAc,CAAC,QAAS,SAAU,SAAU,SAAU,SAAU,QAAQ,CAAE,EAC9L,MAAQ,CAAE,YAAa,kBAAoB,KAAM,EAAS,OAAQ,CAAC,EAAG,CAAC,EAAoB,QAAS,EAAgB,aAAc,CAAC,cAAe,QAAQ,CAAE,CAC9J,EACA,CACE,KAAQ,CAAE,YAAa,WAAoB,KAAM,EAAS,OAAQ,CAAC,EAAG,EAAE,EAAmB,QAAS,eAAgB,aAAc,CAAC,CAAE,EACrI,OAAQ,CAAE,YAAa,mBAAoB,KAAM,EAAS,OAAQ,CAAC,EAAG,GAAI,GAAI,GAAI,GAAI,EAAE,EAAG,QAAS,GAAgB,aAAc,CAAC,QAAS,SAAU,SAAU,SAAU,SAAU,QAAQ,CAAE,EAC9L,MAAQ,CAAE,YAAa,kBAAoB,KAAM,EAAS,OAAQ,CAAC,EAAG,CAAC,EAAoB,QAAS,EAAgB,aAAc,CAAC,cAAe,QAAQ,CAAE,CAC9J,EACA,CACE,KAAQ,CAAE,YAAa,WAAoB,KAAM,EAAS,OAAQ,CAAC,EAAG,EAAE,EAAmB,QAAS,eAAgB,aAAc,CAAC,CAAE,EACrI,OAAQ,CAAE,YAAa,mBAAoB,KAAM,EAAS,OAAQ,CAAC,EAAG,GAAI,GAAI,GAAI,GAAI,EAAE,EAAG,QAAS,GAAgB,aAAc,CAAC,QAAS,SAAU,SAAU,SAAU,SAAU,QAAQ,CAAE,EAC9L,MAAQ,CAAE,YAAa,kBAAoB,KAAM,EAAS,OAAQ,CAAC,EAAG,CAAC,EAAoB,QAAS,EAAgB,aAAc,CAAC,cAAe,QAAQ,CAAE,CAC9J,EACA,CACE,KAAQ,CAAE,YAAa,WAAoB,KAAM,EAAS,OAAQ,CAAC,EAAG,EAAE,EAAmB,QAAS,gBAAiB,aAAc,CAAC,CAAE,EACtI,OAAQ,CAAE,YAAa,mBAAoB,KAAM,EAAS,OAAQ,CAAC,EAAG,GAAI,GAAI,GAAI,GAAI,EAAE,EAAG,QAAS,GAAiB,aAAc,CAAC,QAAS,SAAU,SAAU,SAAU,SAAU,QAAQ,CAAE,EAC/L,MAAQ,CAAE,YAAa,kBAAoB,KAAM,EAAS,OAAQ,CAAC,EAAG,CAAC,EAAoB,QAAS,EAAiB,aAAc,CAAC,cAAe,QAAQ,CAAE,CAC/J,EACA,CACE,KAAQ,CAAE,YAAa,WAAoB,KAAM,EAAS,OAAQ,CAAC,EAAG,EAAE,EAAmB,QAAS,gBAAiB,aAAc,CAAC,CAAE,EACtI,OAAQ,CAAE,YAAa,mBAAoB,KAAM,EAAS,OAAQ,CAAC,EAAG,GAAI,GAAI,GAAI,GAAI,EAAE,EAAG,QAAS,GAAiB,aAAc,CAAC,QAAS,SAAU,SAAU,SAAU,SAAU,QAAQ,CAAE,EAC/L,MAAQ,CAAE,YAAa,kBAAoB,KAAM,EAAS,OAAQ,CAAC,EAAG,CAAC,EAAoB,QAAS,EAAiB,aAAc,CAAC,cAAe,QAAQ,CAAE,CAC/J,EACA,CACE,KAAQ,CAAE,YAAa,WAAoB,KAAM,EAAS,OAAQ,CAAC,EAAG,EAAE,EAAmB,QAAS,gBAAiB,aAAc,CAAC,CAAE,EACtI,OAAQ,CAAE,YAAa,mBAAoB,KAAM,EAAS,OAAQ,CAAC,EAAG,GAAI,GAAI,GAAI,GAAI,EAAE,EAAG,QAAS,GAAiB,aAAc,CAAC,QAAS,SAAU,SAAU,SAAU,SAAU,QAAQ,CAAE,EAC/L,MAAQ,CAAE,YAAa,kBAAoB,KAAM,EAAS,OAAQ,CAAC,EAAG,CAAC,EAAoB,QAAS,EAAiB,aAAc,CAAC,cAAe,QAAQ,CAAE,CAC/J,CACF,CACF,EAEaC,GAAa,CACxB,QAASD,EAAc,QAAQ,QAC/B,UAAW,CACT,CACE,KAAQA,EAAc,UAAU,CAAC,EAAE,KAAK,QACxC,OAAQA,EAAc,UAAU,CAAC,EAAE,OAAO,QAC1C,MAAQA,EAAc,UAAU,CAAC,EAAE,MAAM,OAC3C,EACA,CACE,KAAQA,EAAc,UAAU,CAAC,EAAE,KAAK,QACxC,OAAQA,EAAc,UAAU,CAAC,EAAE,OAAO,QAC1C,MAAQA,EAAc,UAAU,CAAC,EAAE,MAAM,OAC3C,EACA,CACE,KAAQA,EAAc,UAAU,CAAC,EAAE,KAAK,QACxC,OAAQA,EAAc,UAAU,CAAC,EAAE,OAAO,QAC1C,MAAQA,EAAc,UAAU,CAAC,EAAE,MAAM,OAC3C,EACA,CACE,KAAQA,EAAc,UAAU,CAAC,EAAE,KAAK,QACxC,OAAQA,EAAc,UAAU,CAAC,EAAE,OAAO,QAC1C,MAAQA,EAAc,UAAU,CAAC,EAAE,MAAM,OAC3C,EACA,CACE,KAAQA,EAAc,UAAU,CAAC,EAAE,KAAK,QACxC,OAAQA,EAAc,UAAU,CAAC,EAAE,OAAO,QAC1C,MAAQA,EAAc,UAAU,CAAC,EAAE,MAAM,OAC3C,EACA,CACE,KAAQA,EAAc,UAAU,CAAC,EAAE,KAAK,QACxC,OAAQA,EAAc,UAAU,CAAC,EAAE,OAAO,QAC1C,MAAQA,EAAc,UAAU,CAAC,EAAE,MAAM,OAC3C,CACF,CACF,EC/NA,IAAME,GAAQC,EAAe,mBAAmB,EAOzC,SAASC,GAAiBC,EAAUC,EAC3C,CACE,IAAIC,EAAe,EAEnB,OAAAC,EAAkBH,EAAUC,CAAM,EAE3BC,EAEP,SAASC,EAAkBC,EAAgBC,EAC3C,CACE,QAAWC,KAAOF,EAEhB,GAAIA,GACAC,GACC,OAAOD,EAAeE,CAAG,GAAM,UAC/BF,EAAeE,CAAG,IAAa,MAC/B,OAAOD,EAAaC,CAAG,GAAQ,SAElCH,EAAkBC,EAAeE,CAAG,EAAGD,EAAaC,CAAG,CAAC,UAIpDD,EAAaC,CAAG,IAAM,OAEpBC,GAAeH,EAAgBC,EAAaC,CAAG,EAAGF,EAAeE,CAAG,EAAGA,CAAG,GAC5EJ,QAIF,MAAM,IAAII,CAAG,KAAM,OAAOF,EAAeE,CAAG,GAAM,SAAY,SAAW,UAAU,mBAI3F,CACF,CAEA,SAASC,GAAeP,EAAUQ,EAAaC,EAAcC,EAC7D,CACE,OAAQF,EAAY,KACpB,CACE,IAAK,GACH,GAAK,OAAO,UAAUC,CAAY,IAAM,IAAWA,EAAeD,EAAY,OAAO,CAAC,GAAOC,EAAeD,EAAY,OAAOA,EAAY,OAAO,OAAS,CAAC,EAE1J,OAAAX,GAAM,KAAK,iBAAiBa,CAAQ,wBAAwBD,CAAY,MAAMC,CAAQ,6BAA6BF,EAAY,OAAO,CAAC,CAAC,WAAWA,EAAY,OAAOA,EAAY,OAAO,OAAS,CAAC,CAAC,+BAA+BA,EAAY,OAAO,EAAE,EACxPR,EAASU,CAAQ,EAAIF,EAAY,QAC1B,GAET,MAEF,IAAK,GACH,GAAKC,IAAiB,IAAUA,IAAiB,GAE/C,OAAAZ,GAAM,KAAK,iBAAiBa,CAAQ,wBAAwBD,CAAY,MAAMC,CAAQ,iDAAiDF,EAAY,OAAO,EAAE,EAC5JR,EAASU,CAAQ,EAAIF,EAAY,QAC1B,GAET,MAEF,IAAK,GACH,GAAI,OAAOC,GAAiB,SAE1B,OAAAZ,GAAM,KAAK,iBAAiBa,CAAQ,wBAAwBD,CAAY,MAAMC,CAAQ,gDAAgDF,EAAY,OAAO,EAAE,EAC3JR,EAASU,CAAQ,EAAIF,EAAY,QAC1B,GAET,MAEF,QACE,OAAAX,GAAM,KAAK,iBAAiBa,CAAQ,uBAAuBF,EAAY,IAAI,EAAE,EACtE,EACX,CACF,CC9EA,IAAMG,EAAYC,EAAe,SAAS,EACpCC,GAAY,CAAC,EAENC,EAAM,CAEjB,YAAqB,cACrB,kBAAqB,oBACrB,kBAAqB,oBAErB,YAAqB,cACrB,eAAqB,iBACrB,cAAqB,gBACrB,kBAAqB,oBACrB,gBAAqB,kBAIrB,oBAAqB,sBACrB,iBAAqB,mBACrB,oBAAqB,sBACrB,eAAqB,iBAErB,aAAqB,cACvB,EAEMC,EAAkB,CAEtB,qBAAsB,uBACtB,iBAAsB,mBACtB,cAAsB,gBACtB,gBAAsB,kBACtB,kBAAsB,oBAEtB,mBAAqB,qBACrB,oBAAqB,sBACrB,eAAqB,iBACrB,aAAqB,eACrB,cAAqB,eACvB,EAEaC,GAAmB,GAAK,GAAK,GAAK,IAOxC,SAASC,GAAUC,EAASC,EAAW,GAAIC,EAASJ,GAAiBK,EAAO,IACnF,CACE,SAAS,OAAS,GAAGH,CAAO,IAAIC,CAAQ,aAAaC,CAAM,UAAUC,CAAI,2BAC3E,CAEO,SAASC,GAAaJ,EAASG,EAAO,IAC7C,CACE,SAAS,OAAS,GAAGH,CAAO,kDAAkDG,CAAI,EACpF,CAwBO,SAASE,GAASL,EAASC,EAClC,CACE,GACA,CACE,aAAa,QAAQD,EAASC,CAAQ,CACxC,OACMK,EACN,CACEb,EAAM,MAAMa,CAAS,CACvB,CACF,CAOO,SAASC,GAASP,EAASQ,EAAe,KAAMC,EAAa,GACpE,CACEhB,EAAM,IAAI,eAAeO,CAAO,MAAMQ,CAAY,MAAMC,CAAU,EAAE,EAEpE,IAAMR,EAAe,aAAa,QAAQD,CAAO,EAC7CU,EAAiB,KAErB,GAAIT,IAAa,KAEf,OAAIQ,GAAeD,IAAiB,MAClCG,GAAUX,EAASQ,CAAY,EAE1BA,EAIP,GACA,CACEE,EAAiB,KAAK,MAAMT,CAAQ,CACtC,OACMK,EACN,CACEb,EAAM,MAAMa,CAAS,EAGjBE,IAAiB,OACnBE,EAAiBF,EACrB,CAGF,OAAOE,CACT,CAEO,SAASC,GAAUX,EAASY,EACnC,CACEnB,EAAM,IAAI,gBAAgBO,CAAO,MAAMY,CAAO,EAAE,EAEhD,GACA,CACE,aAAa,QAAQZ,EAAS,KAAK,UAAUY,CAAO,CAAC,CACvD,OACMN,EACN,CACEb,EAAM,MAAMa,CAAS,CACvB,CACF,CAOA,SAASO,GAAcC,EAAaC,EAAaC,EACjD,CACEvB,EAAM,IAAI,4BAA4BuB,CAAW,iBAAiBF,EAAY,OAAO,eAAeC,EAAY,OAAO,EAAE,EAEzH,IAAME,EAAiB,CAAE,QAASF,EAAY,OAAQ,EAEtD,OAAAG,GAAUJ,EAAaC,EAAaE,CAAc,EAClDE,GAAUF,EAAgBF,CAAW,EAE9BE,CACT,CAEA,SAASC,GAAUJ,EAAaC,EAAaK,EAC7C,CACE,QAAWC,KAAON,EAEZ,OAAOA,EAAYM,CAAG,GAAM,WAE1BP,GAAgB,OAAOA,EAAYO,CAAG,GAAM,UAE9C5B,EAAM,IAAI,0BAA0B4B,CAAG,EAAE,EACzCD,EAAYC,CAAG,EAAI,CAAE,GAAGN,EAAYM,CAAG,EAAG,GAAGP,EAAYO,CAAG,CAAE,EAC9DH,GAAUJ,EAAYO,CAAG,EAAGN,EAAYM,CAAG,EAAGD,EAAYC,CAAG,CAAC,IAI9D5B,EAAM,IAAI,0BAA0B4B,CAAG,EAAE,EACzCD,EAAYC,CAAG,EAAI,CAAE,GAAGN,EAAYM,CAAG,CAAE,EACzCH,GAAU,CAAC,EAAGH,EAAYM,CAAG,EAAGD,EAAYC,CAAG,CAAC,GAIxD,CAKA,SAASF,GAAUF,EAAgBF,EACnC,CACE,QAAWM,KAAOJ,EAEXI,KAAON,IAEVtB,EAAM,IAAI,2BAA2B4B,CAAG,KAAM,OAAOJ,EAAeI,CAAG,GAAM,SAAY,SAAW,UAAU,GAAG,EACjH,OAAOJ,EAAeI,CAAG,GAGvB,OAAOJ,EAAeI,CAAG,GAAM,UACjCF,GAAUF,EAAeI,CAAG,EAAGN,EAAYM,CAAG,CAAC,CAErD,CAKO,SAASC,GAAeC,EAAmB,GAClD,CACE9B,EAAM,IAAI,qBAAqB8B,EAAmB,WAAa,kBAAkB,4BAA4B,GAEzGA,GAAqB,aAAa,QAAQ1B,EAAgB,aAAa,IAAM,QAE/EJ,EAAM,IAAI,sCAAsC,EAEhD,aAAa,WAAWI,EAAgB,oBAAoB,EAC5D,aAAa,WAAWA,EAAgB,gBAAgB,EACxD,aAAa,WAAWA,EAAgB,aAAa,EACrD,aAAa,WAAWA,EAAgB,eAAe,EACvD,aAAa,WAAWA,EAAgB,iBAAiB,EACzDO,GAAaP,EAAgB,kBAAkB,EAC/CO,GAAaP,EAAgB,mBAAmB,EAChDO,GAAaP,EAAgB,cAAc,EAC3CO,GAAaP,EAAgB,YAAY,EACzCO,GAAaP,EAAgB,aAAa,EAE9C,CAEA,SAAS2B,GAAiBR,EAAaS,EAAgBC,EACvD,CACE,GACA,CAC+BF,GAAqBC,EAAgBE,CAAc,EAErD,GACzBhB,GAAUK,EAAaS,CAAc,CACzC,OACMnB,EACN,CACE,OAAAb,EAAM,MAAM,iCAAiCa,CAAS,4BAA4B,EAElFK,GAAUK,EAAaU,CAAe,EAE/BA,CACT,CAEA,OAAOD,CACT,CAOO,SAASG,GAAuBZ,EAAaU,EAAkB,KAAMjB,EAAa,GACzF,CACE,IAAMoB,EAAatB,GAASS,EAAaU,EAAiBjB,CAAU,EAEpE,GAAKoB,IAAe,MAAUH,IAAoB,MAAUG,EAAW,UAAY,OACnF,CACE,IAAIJ,EAAiBI,EAGrB,OAAIA,EAAW,QAAUH,EAAgB,SAEvCjC,EAAM,IAAIoC,CAAU,EAEpBJ,EAAiBZ,GAAcgB,EAAYH,EAAiBV,CAAW,EACvEL,GAAUK,EAAaS,CAAc,EAGrCH,GAAe,EAAI,EAEnB7B,EAAM,IAAIgC,CAAc,GAKxBH,GAAe,EAAK,EAGfQ,GAAiBd,EAAaQ,GAAiBR,EAAaS,EAAgBC,CAAe,CAAC,CACrG,CAEA,OAAIA,IAAoB,MAEtBjC,EAAM,KAAK,0CAA0CuB,CAAW,4BAA4B,EAE5FL,GAAUK,EAAaU,CAAe,EAE/BI,GAAiBd,EAAaU,CAAe,IAGtDjC,EAAM,MAAM,+CAA+CuB,CAAW,8BAA8B,EAE7F,KACT,CAOA,IAAMc,GAAmB,CAACd,EAAaS,IACvC,CACE,IAAMM,EACN,CACE,IAAIC,EAAQC,EAAUC,EACtB,CAGE,GAAID,KAAYD,EAChB,CACE,IAAMG,EAAQ,QAAQ,IAAIH,EAAQC,EAAUC,CAAQ,EAEpD,OAAI,OAAOC,GAAU,SACZ,IAAI,MAAMA,EAAOJ,CAAO,EAE1BI,CACT,CAEA1C,EAAM,MAAM,6CAA6CwC,CAAQ,EAAE,CACrE,EAEA,IAAID,EAAQC,EAAUG,EAAUF,EAChC,CAGE,GAAID,KAAYD,EAChB,CACE,IAAMK,EAAW,QAAQ,IAAIL,EAAQC,EAAUC,CAAQ,EAGvD,OAAIE,IAAaC,IAEf,QAAQ,IAAIL,EAAQC,EAAUG,CAAQ,EACtCzB,GAAUK,EAAaS,CAAc,EACrCa,GAAsBL,EAAUI,EAAUD,CAAQ,GAG7C,EACT,CAEA,OAAA3C,EAAM,MAAM,6CAA6CwC,CAAQ,EAAE,EAC5D,EACT,CACF,EAEA,OAAO,IAAI,MAAMR,EAAgBM,CAAO,CAC1C,EAOO,SAASQ,GAAoBN,EAAUO,EAC9C,CACE/C,EAAM,IAAI,uCAAuCwC,CAAQ,EAAE,EAEtDA,KAAYtC,KACfA,GAAUsC,CAAQ,EAAI,CAAC,GAEzBtC,GAAUsC,CAAQ,EAAE,KAAKO,CAAQ,CACnC,CAEA,SAASF,GAAsBL,EAAUI,EAAUD,EACnD,CACMH,KAAYtC,KAEdF,EAAM,IAAI,wCAAwCwC,CAAQ,gBAAgBI,CAAQ,gBAAgBD,CAAQ,EAAE,EAC5GzC,GAAUsC,CAAQ,EAAE,QAAQO,GAAYA,EAASH,EAAUD,CAAQ,CAAC,EAExE,CCjXA,IAAMK,GAAQC,EAAe,cAAc,EAEhCC,EAAW,CAAC,EACZC,EAAW,CAAC,EAOhB,SAASC,IAChB,CACEJ,GAAM,IAAI,iBAAiB,EAC3BE,EAAW,gBACXF,GAAM,IAAIE,CAAQ,EAElBG,GAAa,CACf,CAEO,SAASA,IAChB,CACEF,EAAWG,GAAuBC,EAAI,YAAaC,GAAiB,EAAI,EACxER,GAAM,IAAIG,CAAQ,CACpB,CC1BO,IAAMM,EAAa,CACxB,KAAY,EACZ,QAAY,EACZ,WAAY,EACZ,MAAY,CACd,EAOaC,GAAN,KACP,CACEC,GACAC,GAAkB,KAClBC,GAAkB,KAClBC,GAAkB,KAClBC,GAAkB,KAClBC,GAAkB,GAClBC,GAAkB,GAElB,SAAiB,EACjB,OAAiB,KACjB,MAAiB,KACjB,aAAiBC,EAAU,sBAC3B,eAAiB,qBAEjB,YAAYC,EAAWC,EAASC,EAAUC,EAC1C,CACE,KAAKX,GAAkBQ,EACvB,KAAKP,GAAkBQ,EACvB,KAAKP,GAAkBQ,EACvB,KAAKP,GAAkBQ,EAEvB,KAAK,UAAqB,IAAI,MAC9B,KAAK,UAAU,SAAW,OAC5B,CAEA,cAAkB,CAAE,OAAO,KAAKX,EAAiB,CACjD,YAAkB,CAAE,OAAO,KAAKC,EAAiB,CACjD,aAAkB,CAAE,OAAO,KAAKC,EAAiB,CACjD,IAAI,UAAc,CAAE,OAAO,KAAKC,EAAiB,CACjD,cAAkB,CAAE,OAAO,KAAKC,EAAiB,CACjD,aAAaQ,EAAK,CAAE,KAAKR,GAAaQ,CAAW,CAEjD,YAA0B,CAAE,OAAO,KAAKP,EAAmB,CAC3D,cAAcQ,EAAY,CAAE,KAAKR,GAAcQ,CAAY,CAE3D,QAAkB,CAAE,OAAO,KAAKP,EAAW,CAC3C,UAAUQ,EAAQ,CAAE,KAAKR,GAAUQ,CAAQ,CAE3C,aAAsB,CAAE,OAAO,KAAK,QAAc,CAClD,YAAYC,EAAU,CAAE,KAAK,SAAWA,CAAU,CAElD,WAAkB,CAAE,OAAO,KAAK,MAAU,CAC1C,UAAUC,EAAQ,CAAE,KAAK,OAASA,CAAQ,CAE1C,UAAgB,CAAE,OAAO,KAAK,KAAQ,CACtC,SAASC,EAAO,CAAE,KAAK,MAAQA,CAAO,CAEtC,iBAAoB,CAAE,OAAO,KAAK,YAAgB,CAClD,mBAAoB,CAAE,OAAO,KAAK,cAAgB,CAGlD,OAAOC,EAAW,CAAE,KAAKf,GAAgB,OAAOe,CAAQ,CAAI,CAC5D,UAAUC,EAAQ,CAAE,KAAKhB,GAAgB,UAAUgB,CAAM,CAAG,CAE5D,kBAAkBH,EAAQC,EAC1B,CACE,KAAK,OAASD,EACd,KAAK,MAASC,CAChB,CAEA,aAAaG,EACb,CACE,KAAK,aAAiBA,EAAU,IAChC,KAAK,eAAiBA,EAAU,MAChC,KAAK,UAAU,IAAOA,EAAU,GAClC,CACF,EAQMC,GAAkB,CAAE,IAAKd,EAAU,sBAAuB,MAAO,qBAAsB,IAAK,EAAG,EAG/Fe,GAAsB,sCAErB,SAASC,GAAuBC,EACvC,CACE,IAAMC,EAAiBD,EAAe,MAAMF,EAAmB,EAE/D,OAAIG,IAAmB,KACd,CAAE,IAAK,0BAA0BA,EAAe,CAAC,CAAC,eAAgB,MAAO,qBAAsB,IAAKA,EAAe,CAAC,CAAE,EAExHJ,EACT,CAEO,SAASK,GAA0BC,EAC1C,CACE,IAAMC,EAAgBD,EAAY,cAAgB,KACzBA,EAAY,YACZA,EAAY,KAAK,WAE1C,OAAIC,EACK,CAAE,IAAKA,EAAc,MAAO,wBAAyB,IAAK,EAAG,EAE/DP,EACT,CAEO,SAASQ,GAAiBC,EACjC,CACE,GAAIA,EAAS,oBAAsBhC,EAAW,QAC9C,CACE,IAAMiC,EAAgBR,GAAuBO,EAAS,iBAAiB,EAEvE,MAAI,KAAkB,KACpBC,EAAc,IAAMxB,EAAU,oBAEzBwB,CACT,CAEA,GAAID,EAAS,oBAAsBhC,EAAW,WAC5C,MAAO,CAAE,IAAKS,EAAU,mBAAoB,MAAO,wBAAyB,IAAKuB,EAAS,iBAAkB,EAE9G,GAAIA,EAAS,oBAAsBhC,EAAW,MAC5C,MAAO,CAAE,IAAKS,EAAU,mBAAoB,MAAO,mBAAoB,IAAKuB,EAAS,iBAAkB,CAC3G,CAEO,SAASE,GAAiBC,EACjC,CACE,IAAMzB,EAAYyB,EAAQ,aAAa,iBAAiB,EAExD,OAAIzB,IAAc,KACT,SAASA,CAAS,EAEpBV,EAAW,IACpB,CAEO,SAASoC,GAAuBC,EACvC,CACE,OAAOH,GAAiB,SAAS,eAAeG,CAAS,CAAC,CAC5D,CAEA,IAAMC,GAAmB,CACvB,qBACA,qBACA,wBACA,kBACF,EAEO,SAASC,GAAkBJ,EAClC,CACE,OAAOG,GAAiBJ,GAAiBC,CAAO,CAAC,CACnD,CC1JA,IAAMK,GAAQC,EAAe,OAAO,EAE9BC,GAAgB,GAAGC,EAAU,OAAO,QAEpCC,GACoB,oDAGpBC,GAAoB,IAAI,UAEjBC,EAAQ,CACnB,oBAAuB,EACvB,eAAuB,EACvB,sBAAuB,CACzB,EAEMC,GAAqB,OAAO,WAAW,eAAeC,GAAiB,uBAAuB,CAAC,GAAG,EAClGC,GAAqB,OAAO,WAAW,eAAeD,GAAiB,kBAAkB,CAAC,GAAG,EAC7FE,GAAqB,OAAO,WAAW,eAAeF,GAAiB,yBAAyB,CAAC,GAAG,EAOnG,SAASG,GAAYC,EAAWC,EAAMC,EAC7C,CACE,SAAS,cAAcF,CAAS,GAAG,iBAAiBC,EAAMC,CAAQ,CACpE,CAIO,SAASC,GAAeH,EAAWC,EAAMC,EAChD,CACsB,SAAS,iBAAiBF,CAAS,EAC3C,QAAQI,GAAWA,EAAQ,iBAAiBH,EAAMC,CAAQ,CAAC,CACzE,CAEO,SAASN,GAAiBS,EAAMD,EAAU,SAAS,gBAC1D,CACE,IAAIE,EAAS,iBAAiBF,CAAO,EAAE,iBAAiBC,CAAI,EAE5D,OAAIC,EAAO,SAAW,EACpBA,EAASA,EAAO,QAAQ,OAAQ,EAAE,EAAE,KAAK,EAEzClB,GAAM,MAAM,oBAAoBiB,CAAI,0CAA0C,EAEzEC,CACT,CAEO,SAASC,GAAgBF,EAAMD,EAAU,SAAS,gBACzD,CACE,IAAME,EAASV,GAAiBS,EAAMD,CAAO,EACzCI,EAAW,IAEf,OAAIF,EAAO,SAAW,IACpBE,EAAQ,SAASF,CAAM,GAErB,MAAME,CAAK,GACbpB,GAAM,MAAM,mBAAmBiB,CAAI,uCAAuC,EAErEG,CACT,CAGO,SAASC,GAAaC,EAC7B,CACE,OAAQA,EACR,CACE,KAAKhB,EAAM,oBACT,OAAOC,GAAiB,QAE1B,KAAKD,EAAM,eACT,OAAOG,GAAa,QAEtB,KAAKH,EAAM,sBACT,OAAOI,GAAmB,OAC9B,CAEA,MAAO,EACT,CAEO,SAASa,GAAaP,EAASQ,EAAaC,EACnD,CACET,EAAQ,UAAU,OAAOQ,CAAW,EACpCR,EAAQ,UAAU,IAAIS,CAAQ,CAChC,CAEO,SAASC,IAChB,CACE,OAAQC,EAAS,KAAK,gBAAkB,SAAW,MACrD,CAEO,SAASC,IAChB,CACE,MAAO,iBAAiB,KAAK,MAAM,IAAMD,EAAS,KAAK,eAAiB,IAAI,EAAI,EAAE,GACpF,CAOA,IAAME,GAAY,CAChB,IAAK,QACL,IAAK,OACL,IAAK,OACL,IAAK,SACL,IAAK,QACL,IAAK,SACL,IAAK,SACL,IAAK,QACP,EAEO,SAASC,EAAQZ,EACxB,CACE,OAAO,OAAOA,CAAM,EAAE,QAAQ,cAAgBa,GAAMF,GAAUE,CAAC,CAAC,CAClE,CAEO,SAASC,GAAahB,EAASiB,EACtC,CACE,IAAMb,EAAQJ,EAAQ,aAAaiB,CAAS,EAE5C,OAAIb,IAAU,KACLU,EAAQV,CAAK,EAEfA,CACT,CAQO,SAASc,GAAUhB,EAC1B,CACE,IAAMiB,EAAa9B,GAAkB,gBAAgBa,EAAQ,WAAW,EAKxE,OAJmBb,GAAkB,gBAAgB8B,EAAU,KAAK,YAAa,WAAW,EAI1E,KAAK,WACzB,CAEO,SAASC,EAAepB,EAASiB,EACxC,CACE,IAAMb,EAAQJ,EAAQ,aAAaiB,CAAS,EAE5C,OAAIb,IAAU,KACLc,GAAUd,CAAK,EAEjBA,CACT,CAOO,SAASiB,GAASC,EACzB,CACMA,GAAYA,EAAQ,MAAMlC,EAAa,IAAM,MAE/CJ,GAAM,IAAI,+BAA+BsC,CAAO,EAAE,EAClD,OAAO,SAAS,KAAOA,GAEhBA,IAAY,OAEnBtC,GAAM,MAAM,iCAAiCsC,CAAO,EAAE,EAEtDC,EAAa,CACX,QAAS,2BACT,SAAU,EACV,WAAY,SACZ,oBAAqB,IAAM,SAAS,OAAO,CAC7C,CAAC,EAEL,CAEO,SAASC,GAAiBF,EACjC,CACE,OAAOA,EAAQ,QAAQnC,EAAU,QAASD,EAAa,CACzD,CAEO,SAASuC,GAAoBH,EACpC,CACE,OAAOA,EAAQ,QAAQpC,GAAeC,EAAU,OAAO,CACzD,CAEO,SAASuC,GAAiBJ,EACjC,CACE,GAAIA,GAEF,GAAIX,EAAS,SAAS,kBAAoBgB,GAAY,MAEpD,GAAIL,EAAQ,WAAWpC,EAAa,IAAM,GACxC,OAAOsC,GAAiBF,CAAO,UAE1BX,EAAS,SAAS,kBAAoBgB,GAAY,SAErDL,EAAQ,WAAWpC,EAAa,IAAM,GACxC,OAAOuC,GAAoBH,CAAO,EAIxC,OAAOA,CACT,CAEO,SAASM,GAAuBC,EACvC,CACMA,EAAM,OAAO,QAAQ,GAAG,IAE1BA,EAAM,eAAe,EACrBR,GAASK,GAAiBG,EAAM,OAAO,IAAI,CAAC,EAEhD,CAEO,SAASC,EAAcC,EAASC,EAAe,GACtD,CACE,GAAI,OAAO,UAAUD,CAAO,EAC5B,CACE,IAAME,EAAa,IAAI,KAAKF,EAAU,GAAI,EAAE,YAAY,EAExD,OAASA,EAAU,MAASC,EACxBC,EAAW,MAAM,GAAI,EAAE,EACvBA,EAAW,MAAM,GAAI,EAAE,CAC7B,KAGE,QAAOD,EAAe,WAAa,OAEvC,CAMO,SAASE,GAAqBC,EAAOC,EAAW,EACvD,CACE,GAAI,CAAC,CAACD,EACJ,MAAO,UAET,IAAME,EAAI,KACJC,EAAKF,EAAW,EAAI,EAAIA,EACxBG,EAAQ,CAAC,QAAS,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,IAAI,EAEhEC,EAAI,KAAK,MAAM,KAAK,IAAIL,CAAK,EAAI,KAAK,IAAIE,CAAC,CAAC,EAElD,MAAO,GAAG,YAAYF,EAAQ,KAAK,IAAIE,EAAGG,CAAC,GAAG,QAAQF,CAAE,CAAC,CAAC,IAAIC,EAAMC,CAAC,CAAC,EACxE,CAEO,SAASC,GAAmBZ,EACnC,CAEE,OAASA,EAAM,cAAgB,SAAaA,EAAM,iBAAmB,CACvE,CAOO,IAAMa,GAAsBC,GACnC,CACE,IAAIC,EAAQD,EAEZ,gBAAS,iBAAiB,yBAA0B,IACpD,CACMA,IACFC,EAAQ,GACZ,CAAC,EAED,SAAS,iBAAiB,wBAAyB,IACnD,CACMD,IACFC,EAAQ,GACZ,CAAC,EAEM,CACL,OAAQ,CAAE,OAAOA,CAAO,CAC1B,CACF,EAEO,SAASC,GAAaC,EAC7B,CACE,OAASA,IAAQ,aACRA,IAAQ,cACRA,IAAQ,QACRA,IAAQ,OACRA,IAAQ,OACnB,CC1SO,SAASC,IAChB,CACE,MAAgB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,WAWlB,CAEO,SAASC,GAAiBC,EAAWC,EAAkB,EAC9D,CACE,IAAIC,EAAO,GACLC,EAAqBF,GAAmB,GAAM,kBAAoB,GAExE,OAAAD,EAAU,QAAQ,CAACI,EAAOC,IAC1B,CACE,IAAMC,EAAkBF,EAAM,MAAa,SAASA,EAAM,KAAK,GAAgE,kBACzHE,EAAkBF,EAAM,MAAa,GAAGE,CAAU,UAAUF,EAAM,KAAK,GAAkDE,EAC/H,IAAMC,EAAkBH,EAAM,MAAaA,EAAM,MAA8E,GACzHI,EAAkBJ,EAAM,KAAa,6CAA6CA,EAAM,IAAI,UAA6B,GACzHK,EAAkBL,EAAM,WAAc,UAAUA,EAAM,UAAU,IAAyD,GACzHM,EAAkBN,EAAM,UAAa,2CAA2CK,CAAU,IAAIL,EAAM,SAAS,UAAY,GACzHO,EAAkBP,EAAM,UAAa,iCAAiCI,CAAS,GAAGE,CAAc,SAAyBF,EACzHI,EAAkBR,EAAM,KAAa,sCAAsCA,EAAM,OAAO,UAAiCA,EAAM,QAC/HS,EAAkBT,EAAM,WAAa,WAAWA,EAAM,UAAU,IAAyD,GAG/H,GAFAA,EAAM,IAAkB,cAAcC,EAAQ,CAAC,GAE3CD,EAAM,KACV,CACE,IAAMU,EAAUV,GAAO,QAAU,kBAAkBA,EAAM,OAAO,IAAM,GACtEF,GAAQ,UAAUE,EAAM,GAAG,KAAKU,CAAO,UAAUV,EAAM,IAAI,KAAKS,CAAe,4BAA4BP,CAAU,IAAIH,CAAiB,YAAYI,CAAU,KAAKI,CAAc,GAAGC,CAAY,MACpM,MACSR,EAAM,QAEbF,GAAQ,YAAYE,EAAM,GAAG,oBAAoBA,EAAM,OAAO,6BAA6BE,CAAU,IAAIH,CAAiB,YAAYI,CAAU,KAAKI,CAAc,GAAGC,CAAY,SAIlLV,GAAQ,eAAeI,CAAU,YAAYC,CAAU,KAAKI,CAAc,GAAGC,CAAY,QAE7F,CAAC,EAEMV,CACT,CAEO,SAASa,GAAkBC,EAASC,EAAaC,EACxD,CACE,MAAgB;AAAA;AAAA,0CAEwBC,GAAkBH,CAAO,CAAC;AAAA,oBAChD,UAAUA,EAAQ,aAAa,0BAA0B,CAAC,CAAC;AAAA;AAAA;AAAA,mBAG5DC,CAAW;AAAA,mCACKC,CAAU;AAAA;AAAA,WAG7C,CC1DA,IAAME,GAAQC,EAAe,OAAO,EAE9BC,EAAI,CACR,aAAqB,KACrB,aAAqB,KACrB,oBAAqB,KACrB,QAAqB,EACrB,gBAAqB,EACrB,YAAqB,GACrB,gBAAqB,GACrB,iBAAqB,EACvB,EAEMC,EAAW,CACf,QAAW,KACX,UAAW,KACX,KAAW,IACb,EAOO,SAASC,GAAU,CACxB,UAAAC,EAAa,UACb,WAAAC,EAAa,cACb,UAAAC,EAAa,KACb,UAAAC,EAAa,CAAC,EACd,qBAAAC,EAAuB,IAAM,GAC7B,qBAAAC,EAAuB,IAAM,CAAC,EAC9B,oBAAAC,EAAuB,IACzB,EAAI,CAAC,EACL,CACE,IAAMC,EAAgBJ,EAAU,OAAS,GAAOD,IAAc,KAE9D,OAAAP,GAAM,IAAI,0BAA0BE,EAAE,QAAU,CAAC,iBAAiBG,CAAS,KAAKO,EAAc,OAAS,MAAM,mBAAmBN,CAAU,EAAE,EAE5IO,GAAa,EACbC,GAAW,EAEXZ,EAAE,aAAsBO,EACxBP,EAAE,aAAsBQ,EACxBR,EAAE,oBAAsBS,EACxBT,EAAE,gBAAsB,EAEpBU,EACFG,GAAaP,EAAWH,CAAS,EAEjCF,EAAS,KAAK,UAAYI,EAE5BJ,EAAS,UAAU,UAAY,cAAcE,CAAS,GACtDF,EAAS,UAAU,UAAU,IAAKD,EAAE,gBAAkB,GAAM,8BAAgC,4BAA4B,EACxHC,EAAS,UAAU,cAAc,qBAAqB,EAAE,UAAYG,EAEpEH,EAAS,QAAQ,MAAM,gBAAkBa,GAA0B,EACnEb,EAAS,QAAQ,UAAU,IAAI,MAAM,EACrCA,EAAS,QAAQ,iBAAiB,UAAWc,EAAO,EACpDd,EAAS,QAAQ,MAAM,EAEvBe,GAAqB,EAAI,EAElB,EAAEhB,EAAE,OACb,CAEO,SAASiB,GAAeC,EAAiB,GAChD,CACE,OAASA,IAAmBlB,EAAE,SACrBC,EAAS,YAAc,MACvBA,EAAS,QAAQ,UAAU,SAAS,MAAM,CACrD,CAEO,SAASkB,IAChB,CACE,OAAOlB,EAAS,SAClB,CAEO,SAASmB,GAAcC,EAC9B,CACE,OAAO,SAAS,eAAe,cAAcA,CAAQ,EAAE,CACzD,CAEO,SAASC,GAAiBC,EAAeC,EAChD,CACMD,IAAkBvB,EAAE,UACtBC,EAAS,UAAU,cAAc,qBAAqB,EAAE,UAAYuB,EACxE,CAEO,SAASC,GAAgBF,EAAejB,EAC/C,CACMiB,IAAkBvB,EAAE,SACtBa,GAAaP,CAAS,CAC1B,CAOA,SAASK,IACT,CACMV,EAAS,YAAc,OAEzB,SAAS,KAAK,mBAAmB,YAAayB,GAAgB,CAAC,EAE/DzB,EAAS,QAAY,SAAS,eAAe,sBAAsB,EACnEA,EAAS,UAAY,SAAS,eAAe,wBAAwB,EACrEA,EAAS,KAAYA,EAAS,UAAU,cAAc,oBAAoB,EAE1EA,EAAS,QAAQ,iBAAiB,QAAU0B,GAC5C,CACMA,EAAM,SAAW1B,EAAS,SAC5BW,GAAW,CACf,CAAC,EAEDX,EAAS,UAAU,cAAc,0BAA0B,EAAE,iBAAiB,QAASW,EAAU,EACjGX,EAAS,UAAU,cAAc,4BAA4B,EAAE,iBAAiB,QAASW,EAAU,EAEvG,CAEA,SAASA,IACT,CACMK,GAAejB,EAAE,OAAO,IAE1B,SAAS,KAAK,oBAAoB,YAAa4B,GAAW,CAAE,QAAS,EAAM,CAAC,EAC5E,SAAS,KAAK,oBAAoB,aAAcC,EAAU,EAC1D5B,EAAS,QAAQ,oBAAoB,UAAWc,EAAO,EACvDd,EAAS,QAAQ,UAAY,GAC7Be,GAAqB,EAAK,EAC1BhB,EAAE,qBAAqB,MAAM,EAEjC,CAEA,SAASa,GAAaP,EAAWH,EAAY,UAC7C,CACMA,IAAc,iBAChBG,EAAU,QAAQwB,GAASA,EAAK,MAAQ9B,EAAE,iBAAkB,EAE9DC,EAAS,KAAK,UAAY8B,GAAiBzB,EAAWN,EAAE,eAAe,EACvEC,EAAS,KAAK,iBAAiB,QAAS+B,EAAc,CACxD,CAEA,SAASA,GAAeL,EACxB,CACE,IAAMM,EAAsBN,EAAM,OAAO,QAAQ,mBAAmB,EAEpE,GAAIM,GAAwBjC,EAAE,aAAa2B,CAAK,IAAM,GACtD,CACE,IAAMO,EAAeD,GAAqB,aAAa,eAAe,EAEtErB,GAAW,EAEPsB,GACFlC,EAAE,aAAakC,EAAcP,CAAK,CACtC,CACF,CAEA,SAASZ,GAAQY,EACjB,CACEA,EAAM,gBAAgB,EAElBA,EAAM,MAAQ,UAChBf,GAAW,CACf,CAEA,SAASI,GAAqBmB,EAC9B,CACMA,GAEF,SAAS,KAAK,UAAU,IAAI,oBAAoB,EAE5C,iBAAkB,SAEpB,SAAS,KAAK,iBAAiB,aAAcN,EAAU,EACvD,SAAS,KAAK,iBAAiB,YAAcD,GAAW,CAAE,QAAS,EAAM,CAAC,IAK5E,SAAS,KAAK,UAAU,OAAO,oBAAoB,CAEvD,CAEA,SAASC,GAAWF,EACpB,CACE3B,EAAE,YAAoBC,EAAS,UAAU,aAAeA,EAAS,UAAU,aAC3ED,EAAE,gBAA+B2B,EAAM,OAAO,UAAU,SAAS,wBAAwB,IAAnE,GACtB3B,EAAE,iBAA+B2B,EAAM,OAAO,QAAQ,wBAAwB,GAAG,aAAa,WAAW,IAAnF,MACxB,CAEA,SAASC,GAAUD,EACnB,CACM3B,EAAE,cAGDA,EAAE,mBAAqB,IAAUA,EAAE,kBACtC2B,EAAM,eAAe,CACzB,CCvMA,IAAMS,GAAQC,EAAe,UAAU,EAEjCC,EAAI,CACR,WAAe,EACf,YAAe,KACf,WAAe,KACf,cAAe,GACf,WAAe,CAAC,CAClB,EAEMC,GAAoB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EAUpBC,EAAW,CACf,SAAY,KACZ,WAAY,KACZ,UAAY,IACd,EAOO,SAASC,EAAa,CAC3B,QAAAC,EAAU,mBACV,SAAAC,EAAW,EACX,WAAAC,EAAa,KACb,oBAAAC,EAAsB,IAAM,CAAC,EAC7B,mBAAAC,EAAsB,IAAM,CAAC,EAC7B,sBAAAC,EAAwB,kCAC1B,EAAI,CAAC,EACL,CACE,OAAAX,GAAM,IAAI,mBAAmBM,CAAO,KAAMC,IAAa,EAAK,aAAaA,CAAQ,QAAU,oBAAoB,GAAG,EAElHK,GAAa,EACbC,GAAW,EAAK,EAEZC,EAAS,KAAK,oBAChBC,GAAST,CAAO,EAElBF,EAAS,SAAS,cAAc,mBAAmB,EAAE,UAAYE,EACjEF,EAAS,SAAS,cAAc,qBAAqB,EAAE,MAAQ,qBAAqBO,CAAqB,IACzGP,EAAS,SAAS,UAAU,IAAI,MAAM,EACtCA,EAAS,WAAW,MAAM,QAAU,OACpCF,EAAE,WAAaQ,EAEXF,IAAe,MAEjBN,EAAE,YAAcO,EAChBL,EAAS,WAAW,MAAM,QAAU,QACpCA,EAAS,WAAW,YAAgBI,EACpCJ,EAAS,WAAW,iBAAiB,QAASY,EAAe,GAKzDC,GAAaC,EAAM,qBAAqB,EAC1Cd,EAAS,UAAU,MAAM,YAAc,OAEvCA,EAAS,UAAU,MAAM,YAAc,OAGvCG,IAAa,IACfL,EAAE,cAAgB,WAAW,IAAME,EAAS,SAAS,UAAU,IAAI,MAAM,EAAIG,EAAW,GAAK,GAExF,EAAEL,EAAE,UACb,CAEO,SAASiB,IAChB,CACE,OAASf,EAAS,WAAa,MACtBA,EAAS,SAAS,UAAU,SAAW,GACvCA,EAAS,SAAS,UAAU,SAAS,MAAM,CACtD,CAEO,SAASgB,GAAgBC,EAAY,EAC5C,CACMF,GAAkB,IAEfjB,EAAE,aAAe,GAAOA,EAAE,aAAemB,IAC5CjB,EAAS,SAAS,UAAU,IAAI,MAAM,CAE5C,CAOA,SAASQ,IACT,CACMR,EAAS,WAAa,OAExB,SAAS,KAAK,mBAAmB,YAAaD,EAAQ,EAEtDC,EAAS,SAAa,SAAS,eAAe,UAAU,EACxDA,EAAS,WAAaA,EAAS,SAAS,cAAc,uBAAuB,EAC7EA,EAAS,UAAaA,EAAS,SAAS,cAAc,sBAAsB,EAE5EA,EAAS,SAAS,iBAAiB,eAAgB,IACnD,CACMA,EAAS,SAAS,UAAU,SAAS,MAAM,IAE7CS,GAAW,EAAI,EACfX,EAAE,WAAW,EAEjB,CAAC,EAEDE,EAAS,UAAU,iBAAiB,QAAS,IAC7C,CACES,GAAW,EAAI,EACfX,EAAE,WAAW,CACf,CAAC,EAEL,CAEA,SAASc,IACT,CACEH,GAAW,EAAI,EACfX,EAAE,YAAY,CAChB,CAEA,SAASW,GAAWS,EAAe,GACnC,CACMpB,EAAE,gBAAkB,KAEtB,aAAaA,EAAE,aAAa,EAC5BA,EAAE,cAAgB,IAGhBE,EAAS,aAAe,MAC1BA,EAAS,WAAW,oBAAoB,QAASY,EAAe,EAE9DM,IACFlB,EAAS,SAAS,UAAY,GAClC,CAOA,SAASW,GAAST,EAClB,CACEiB,GAAQ,EAEJrB,EAAE,WAAW,QAAU,IACzBA,EAAE,WAAW,MAAM,EAErBA,EAAE,WAAW,KAAK,CAAE,UAAW,KAAK,IAAI,EAAG,QAASI,CAAQ,CAAC,EAE7D,aAAa,QAAQkB,EAAI,gBAAiB,KAAK,UAAU,CAAE,YAAatB,EAAE,UAAW,CAAC,CAAC,CACzF,CAEA,SAASqB,IACT,CACE,GAAIrB,EAAE,WAAW,SAAW,EAC5B,CACE,IAAMuB,EAAc,KAAK,MAAM,aAAa,QAAQD,EAAI,eAAe,CAAC,EAEnEC,IAAgB,MAAUA,EAAY,cAAgB,SACzDvB,EAAE,WAAauB,EAAY,YAC/B,CACF,CAEO,SAASC,IAChB,CAGE,GAFAH,GAAQ,EAEJrB,EAAE,WAAW,OAAS,EAC1B,CAWE,IAAIyB,EATF;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,eAWFzB,EAAE,WAAW,QAAS0B,GACtB,CACED,GACE;AAAA,2CACmC,IAAI,KAAKC,EAAM,SAAS,EAAE,aAAa,EAAE,MAAM,EAAG,EAAE,CAAC;AAAA;AAAA,2CAErD,IAAI,KAAKA,EAAM,SAAS,EAAE,aAAa,EAAE,MAAM,EAAG,CAAC,CAAC;AAAA;AAAA,gBAE/EA,EAAM,OAAO;AAAA,cAEzB,CAAC,EAEDC,GAAU,CAAE,WAAY,uBAAwB,UAAWF,EAAY,UAAW,CAAC,CACrF,MAGEE,GAAU,CAAE,WAAY,uBAAwB,UAAW,uDAAwD,CAAC,CAExH,CCrNO,IAAMC,GAAN,KACP,CACEC,GAAgB,KAChBC,GAAgB,KAChBC,GAAgB,KAChBC,GAAgB,KAEhB,YAAYC,EAAWC,EAAoB,GAC3C,CACE,KAAKL,GAAgB,SAAS,eAAeI,CAAS,EACtD,KAAKH,GAAgB,KAAKD,GAAS,cAAc,YAAY,EAC7D,KAAKE,GAAgB,KAAK,OAC1B,KAAK,OAAgB,KAAK,YAC1B,KAAKC,GAAgB,KAAK,OAC1B,KAAK,OAAgB,KAAK,YAE1B,KAAKH,GAAS,iBAAiB,QAAUM,GACzC,CACEA,GAAO,eAAe,EACtB,KAAK,OAAOA,CAAK,CACnB,CAAC,EAEGD,GACF,KAAK,OAAO,CAChB,CAEAE,IAAwB,CAAE,OAAQ,KAAKP,GAAS,UAAU,SAAS,UAAU,IAAM,EAAc,CACjGQ,IAAwB,CAAE,OAAQC,GAAiB,iBAAkB,KAAKT,EAAQ,IAAM,MAAS,CAEjG,IAAI,SAAa,CAAE,OAAO,KAAKA,EAA4B,CAC3D,IAAI,WAAa,CAAE,OAAO,KAAKA,GAAS,SAAmB,CAC3D,IAAI,MAAMU,EAAO,CAAE,KAAKT,GAAc,YAAcS,CAAO,CAI3D,OAAOJ,EAAO,CAAC,CAGf,YAAYA,EACZ,CACM,KAAKC,GAAW,GAAK,KAAKC,GAAsB,IAElD,KAAKN,GAAcI,CAAK,EACxB,KAAKH,GAAcG,CAAK,EAE5B,CAIA,OAAOA,EAAO,CAAC,CAGf,aACA,CACE,KAAKH,GAAc,CACrB,CACF,ECrEA,IAAAQ,GAAA,GAAAC,GAAAD,GAAA,wBAAAE,GAAA,cAAAC,GAAA,SAAAC,GAAA,cAAAC,GAAA,2BAAAC,GAAA,UAAAC,GAAA,SAAAC,GAAA,cAAAC,GAAA,oBAAAC,EAAA,cAAAC,GAAA,oBAAAC,GAAA,wBAAAC,GAAA,eAAAC,GAAA,oBAAAC,KCgBO,IAAMC,GAAN,KACP,CACEC,GAAW,KACXC,GAAW,KAEX,YAAYC,EAAWC,EAAmB,GAC1C,CACMA,EACFC,GAAeF,EAAW,QAAUG,GAAU,KAAKC,GAAcD,CAAK,CAAC,EAEvEE,GAAYL,EAAW,QAAUG,GAAU,KAAKC,GAAcD,CAAK,CAAC,CACxE,CAEAC,GAAcD,EACd,CACE,KAAKL,GAASK,EACd,KAAK,eAAe,CACtB,CAEA,IAAI,SAAU,CAAE,OAAO,KAAKJ,EAAU,CACtC,IAAI,OAAU,CAAE,OAAO,KAAKD,EAAU,CAGtC,gBAAiB,CAAC,CAElB,QAAQQ,EACR,CAGE,OAFA,KAAKP,GAAW,KAAKD,GAAO,OAAO,QAAQQ,CAAQ,EAE/C,KAAKP,KAAa,MAEpB,KAAKD,GAAO,yBAAyB,EAC9B,IAGF,EACT,CAEA,QAAQQ,EACR,CACE,OAAO,KAAKP,GAAS,QAAQO,CAAQ,CACvC,CAEA,cAAcA,EACd,CACE,OAAO,KAAKP,GAAS,cAAcO,CAAQ,CAC7C,CACF,EClDO,IAAMC,EAAQ,CACnB,QAAU,CAAE,GAAK,EAAG,MAAO,eAAiB,EAC5C,OAAU,CAAE,GAAI,GAAI,MAAO,cAAiB,EAC5C,SAAU,CAAE,GAAI,GAAI,MAAO,gBAAiB,EAC5C,QAAU,CAAE,GAAI,GAAI,MAAO,eAAiB,EAC5C,QAAU,CAAE,GAAI,GAAI,MAAO,eAAiB,EAC5C,OAAU,CAAE,GAAI,GAAI,MAAO,cAAiB,EAC5C,QAAU,CAAE,GAAI,GAAI,MAAO,eAAiB,CAC9C,EAOaC,EAAiB,SAASC,EAAgBC,EAAgB,SAAUC,EAAeJ,EAAM,SACtG,CACE,IAAMK,EAAYF,EAAc,cAAcD,CAAc,EACtDI,EAAYF,EACZG,EAAYF,EAAQ,UAE1B,MAAO,CACL,IAAI,SAAU,CAAE,OAAOA,CAAe,EACtC,IAAI,OAAU,CAAE,OAAOC,CAAe,EACtC,IAAI,OAAU,CAAE,OAAOD,EAAQ,KAAO,EAEtC,WAAWG,EAAkB,CAAE,OAAOH,EAAQ,cAAcG,CAAQ,CAAM,EAC1E,YAAYC,EAAOC,EAAU,CAAEL,EAAQ,iBAAiBI,EAAOC,CAAQ,CAAG,EAE1E,YAAYC,EAAc,CAAEJ,EAAU,IAAI,GAAGI,CAAQ,CAAW,EAChE,eAAeA,EAAW,CAAEJ,EAAU,OAAO,GAAGI,CAAQ,CAAQ,EAChE,aAAaC,EAAQC,EAAK,CAAEC,GAAaT,EAASO,EAAQC,CAAG,CAAG,EAChE,YAAYF,EAAc,CAAEJ,EAAU,OAAOI,CAAQ,CAAW,EAEhE,aAAaI,EAAkB,CAAE,OAAOV,EAAQ,aAAaU,CAAS,CAAG,EACzE,aAAaA,EAAWC,EAAO,CAAEX,EAAQ,aAAaU,EAAWC,CAAK,CAAG,EAEzE,SAAAC,CACF,EAEA,SAASA,EAASC,EAAWlB,EAAM,SACnC,CAEE,OAAIM,EAAM,KAAOY,EAAS,IAExBX,EAAU,OAAOD,EAAM,KAAK,EAC5BC,EAAU,IAAIW,EAAS,KAAK,EAC5BZ,EAAQY,EAED,IAGF,EACT,CACF,EAEaC,GAAkB,SAASC,EAAiBjB,EAAgB,SACzE,CACE,IAAMkB,EAAWlB,EAAc,iBAAiBiB,CAAe,EAE/D,MAAO,CACL,IAAI,QAAc,CAAE,OAAOC,EAAS,MAAY,EAChD,QAAQC,EAAU,CAAED,EAAS,QAAQC,CAAQ,CAAG,CAClD,CACF,EChEA,IAAMC,GAAQC,EAAe,YAAY,EAE5BC,EAAgB,CAC3B,GAAI,GACN,EAEaC,GAAc,CACzB,QAAS,EACT,QAAS,EACT,QAAS,CACX,EAOO,SAASC,GAAU,CACxB,KAAAC,EAAW,kBACX,SAAAC,EAAW,KACX,GAAAC,EAAW,KACX,MAAAC,EAAW,KACX,eAAAC,EAAiB,EACnB,EAAI,CAAC,EACL,CACE,IAAIC,EAAcL,EAEbC,IAAa,MAAUC,IAAO,KACjCG,GAAe,GAAGJ,CAAQ,IAAI,SAASC,CAAE,CAAC,GACnCD,IAAa,OACpBI,GAAeJ,GAEbE,IAAU,OACZE,GAAe,IAAIF,CAAK,IAE1BR,GAAM,IAAI,IAAIU,CAAW,gBAAgBD,CAAc,OAAO,EAE9D,IAAME,EAAa,IAAI,gBACvB,kBAAW,IAAMA,EAAW,MAAM,EAAIF,EAAiB,GAAK,EAErD,MAAMC,EAAa,CAAE,OAAQC,EAAW,MAAO,CAAC,EACtD,KAAK,MAAOC,GAENA,EAAS,GAMP,CAAE,OAAQ,CAAE,KAAMA,EAAS,MAAO,EAAG,KAAM,MAAMA,EAAS,KAAK,CAAE,GAJtEZ,GAAM,KAAKY,CAAQ,EACZ,CAAE,OAAQ,CAAE,KAAMA,EAAS,OAAQ,QAAS,MAAMA,EAAS,KAAK,CAAE,EAAG,KAAM,CAAC,CAAE,EAIxF,EACA,MAAMC,IAELb,GAAM,MAAMa,CAAS,EACd,CAAE,OAAQ,CAAE,KAAM,EAAG,UAAWC,GAAkBD,CAAS,EAAG,aAAcA,EAAU,OAAQ,EAAG,KAAM,CAAC,CAAE,EAClH,CACH,CAEA,SAASC,GAAkBC,EAC3B,CACE,OAAIA,aAAiB,UACZZ,GAAY,QAEjBY,aAAiB,aACZZ,GAAY,QAEdA,GAAY,OACrB,CCvDO,SAASa,GAAqBC,EAAcC,EACnD,CACE,IAAMC,EAAUF,EAAa,SAAS,QAAQ,0BAA2B,SAASC,CAAW,GAAG,EAEhG,MAAgB;AAAA,8BACYA,CAAW,wDAAwDA,CAAW;AAAA;AAAA;AAAA,iBAG3FC,CAAO,uBAAuBD,CAAW,UAAUA,CAAW;AAAA;AAAA;AAAA,WAI/E,CAEO,SAASE,GAAkBC,EAAOC,EAAU,UACnD,CACE,IAAMC,EAAoBC,GAAiBH,EAAM,IAAI,EAC/CI,EAAoBC,EAAQL,EAAM,KAAK,YAAY,EACnDM,EAAoBD,EAAQL,EAAM,KAAK,WAAW,EAClDO,EAAoB,SAASP,EAAM,KAAK,cAAc,EACtDQ,EAAoBR,EAAM,SAAS,SAASS,EAAU,eAAe,EAAI,WAAa,WAE5F,MAAgB;AAAA,eACHT,EAAM,GAAG,wBAAwBC,CAAO,YAAYC,EAAc,KAAK,IAAIM,CAAiB;AAAA,yBAClFR,EAAM,KAAK,iBAAiB;AAAA,6BACxBA,EAAM,EAAE;AAAA,2BACVI,CAAW;AAAA,0BACZE,CAAU;AAAA,6BACPC,CAAa;AAAA,wBAClBP,EAAM,IAAI;AAAA,kCACAE,EAAc,GAAG;AAAA,gCACnBA,EAAc,GAAG;AAAA;AAAA,gEAEeF,EAAM,QAAQ,SAAS,CAAC,KAAKA,EAAM,eAAkB,EAAE;AAAA,kEACrDA,EAAM,SAAS,SAAS,CAAC,KAAKA,EAAM,gBAAkB,EAAE;AAAA;AAAA;AAAA;AAAA,sBAIpGE,EAAc,GAAG;AAAA;AAAA,kEAE2BE,CAAW,wBAAwBE,CAAU;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,gFAY7BN,EAAM,KAAK,oBAAsBU,EAAW,QAAWC,EAAcJ,CAAa,EAAI,OAAQ;AAAA,WAEhL,CAEO,SAASK,GACdC,EACAC,EACAC,EACAC,EAEF,CACEH,EAAU,QAAQb,GAClB,CACE,IAAMiB,EAAe,SAAS,eAAejB,EAAM,GAAG,EAAE,cAAcc,CAAkB,EAClFI,EAAeD,EAAa,aAAaF,CAAgB,GAAG,MAAM,GAAG,EACrEI,EAAe,GAErBD,GAAS,QAAQE,GACjB,CACE,IAAMC,EAAY,SAASD,CAAM,EAC3BE,EAAatB,EAAM,KAAK,kBAAoBqB,EAAU,UAAY,YACxEF,GAAiB,aAAaG,CAAS,WAAWC,GAAiBP,EAAS,IAAIK,CAAM,EAAE,IAAI,CAAC,KAAKL,EAAS,IAAIK,CAAM,EAAE,IAAI,MAC7H,CAAC,EAEDJ,EAAa,mBAAmB,aAAcE,CAAS,CACzD,CAAC,CACH,CC3EA,IAAMK,GAAQC,EAAe,kBAAkB,EAEzCC,GAAI,CACR,aAAe,IAAI,IACnB,cAAe,IAAI,GACrB,EAOA,eAAsBC,GAAWC,EAAUC,EAC3C,CACE,IAAMC,EAAe,SAASC,EAAa,YAAc,CAAC,EACpDC,EAAe,MAAMC,GAAYL,EAAUC,EAAQC,EAAa,SAASC,EAAa,WAAW,CAAC,EAExG,GAAIC,EAAa,OAAO,OAASE,EAAc,GAC/C,CACE,IAAMC,EAAaH,EAAa,KAC1BI,EAAa,IAAI,IACjBC,EAAa,IAAI,IACnBC,EAAeC,GAAqBR,EAAcD,CAAW,EAEjEK,EAAU,QAAQ,CAACK,EAAOC,IAC1B,CACED,EAAM,QAAQ,QAAQE,GAAQhB,GAAE,aAAa,IAAIgB,CAAG,IAAM,IAAUN,EAAU,IAAIM,CAAG,CAAC,EACtFF,EAAM,SAAS,QAAQE,GAAQhB,GAAE,cAAc,IAAIgB,CAAG,IAAM,IAAUL,EAAW,IAAIK,CAAG,CAAC,EACzFF,EAAM,IAAM,SAAU,KAAK,IAAI,EAAIC,CAAM,GACzCH,GAAcK,GAAkBH,CAAK,CACvC,CAAC,EAED,SAAS,eAAe,4BAA4B,EAAE,mBAAmB,cAAeF,CAAU,EAElGd,GAAM,IAAI,aAAaY,EAAU,IAAI,aAAaV,GAAE,aAAa,IAAI,wBAAwBW,EAAW,IAAI,cAAcX,GAAE,cAAc,IAAI,UAAU,EAExJ,IAAIkB,EAAkB,KAClBC,EAAkB,KAElBT,EAAU,KAAO,IACnBQ,EAAiBE,GAAW,UAAY,CAAC,GAAGV,CAAS,EAAG,GAAG,GAEzDC,EAAW,KAAO,IACpBQ,EAAkBC,GAAW,WAAY,CAAC,GAAGT,CAAU,EAAG,GAAG,GAE/D,GAAM,CAACU,EAAqBC,CAAoB,EAAI,MAAM,QAAQ,IAAI,CAACJ,EAAgBC,CAAe,CAAC,EAEvG,OAAKE,IAAwB,MAAUA,EAAoB,OAAO,OAASb,EAAc,IACvFa,EAAoB,KAAK,QAAQE,GAASvB,GAAE,aAAa,IAAIuB,EAAM,GAAI,CAAE,KAAMA,EAAM,KAAM,KAAMA,EAAM,IAAK,CAAC,CAAC,EAE3GD,IAAyB,MAAUA,EAAqB,OAAO,OAASd,EAAc,IACzFc,EAAqB,KAAK,QAAQC,GAASvB,GAAE,cAAc,IAAIuB,EAAM,GAAI,CAAE,KAAMA,EAAM,KAAM,KAAMA,EAAM,IAAK,CAAC,CAAC,EAElHC,GAAaf,EAAW,uBAAyB,wBAA0BT,GAAE,YAAY,EACzFwB,GAAaf,EAAW,wBAAyB,yBAA0BT,GAAE,aAAa,EAEnF,EACT,CAEA,MAAO,EACT,CAOA,SAASO,GAAYL,EAAW,GAAIC,EAAS,GAAIsB,EAAO,EAAGC,EAAgB,GAC3E,CACE5B,GAAM,IAAI,6BAA8BI,EAAS,SAAW,EAAK,MAAQA,CAAQ,cAAeC,EAAO,SAAW,EAAK,MAAQA,CAAM,YAAYsB,CAAI,qBAAqBC,CAAa,EAAE,EAEzL,IAAIC,EAAe,GACbC,EAAa,QAAQH,CAAI,aAAaC,CAAa,GACnDG,EAAa,yCAEnB,OAAKxB,EAAa,IAAI,cAAgB,WAAeA,EAAa,IAAI,cAAgB,SACpFsB,EAASG,GAAmB5B,EAAUC,CAAM,EACrCE,EAAa,IAAI,cAAgB,UACxCsB,EAASI,GAAsB,EACxB1B,EAAa,IAAI,cAAgB,WACxCsB,EAASK,GAAqB,GAEzBC,GAAU,CACf,SAAU,SACV,MAAU,GAAGN,CAAM,GAAGC,CAAU,GAAGC,CAAM,EAC3C,CAAC,CACH,CAEA,SAAST,GAAWlB,EAAUgC,EAASC,EAAW,GAClD,CACE,OAAOF,GAAU,CACf,SAAU/B,EACV,MAAU,WAAWgC,CAAO,aAAaC,CAAQ,uBACnD,CAAC,CACH,CAEA,SAASL,GAAmB5B,EAAUC,EACtC,CACE,GAAKD,EAAS,SAAW,GAAOC,EAAO,SAAW,EAClD,CACE,IAAIiC,EAAa,GAAGlC,CAAQ,IAAI,SAASC,CAAM,CAAC,IAEhD,OAAIE,EAAa,QAAQ,UAAYA,EAAa,QAAQ,cACxD+B,GAAc,oBAAoB/B,EAAa,OAAO,QAAQ,IAAIA,EAAa,OAAO,WAAW,KAE5F+B,CACT,CAEA,MAAO,EACT,CAEA,SAASL,IACT,CACE,IAAIM,EAAgB,6BAA6BhC,EAAa,IAAI,YAAY,IAE9E,OAAIA,EAAa,IAAI,eAAiB,OACpCgC,GAAiB,gBAAgBhC,EAAa,IAAI,YAAY,KAEzDgC,CACT,CAKA,SAASL,IACT,CACE,IAAIM,EAAiB,GACfC,EAAe,IAAI,gBAAgB,OAAO,SAAS,MAAM,EAE/D,OAAIA,EAAa,IAAI,GAAG,IAEtBD,EAAeC,EAAa,IAAI,GAAG,EAAE,WAAW,IAAK,GAAG,EACxDD,EAAe,mBAAmBA,CAAY,EAAE,WAAW,sBAAuB,SAAS,GAGtF,UAAUA,CAAY,kCAC/B,CCrJA,IAAME,GAAQC,EAAe,WAAW,EAOjC,SAASC,GAAoBC,EAAeC,EAAqB,UACxE,CACM,UAAU,WAAaC,GAA4B,EAErD,UAAU,UAAU,UAAUF,CAAa,EAAE,KAAK,IAClD,CACEH,GAAM,IAAI,sCAAsCG,CAAa,YAAYC,CAAkB,EAAE,EAC7FE,EAAa,CAAE,QAAS,GAAGF,CAAkB,uBAAwB,SAAU,CAAE,CAAC,CACpF,EACCG,GACD,CACEC,GAAsBD,EAAQJ,EAAeC,CAAkB,CACjE,CAAC,EAKGK,GAA+BN,CAAa,GAE9CH,GAAM,IAAI,iDAAiDG,CAAa,YAAYC,CAAkB,EAAE,EACxGE,EAAa,CAAE,QAAS,GAAGF,CAAkB,uBAAwB,SAAU,CAAE,CAAC,GAIlFI,GAAsB,qCAAqCL,CAAa,YAAaA,EAAeC,CAAkB,CAG5H,CAOA,SAASC,IACT,CACE,GACA,CACE,GAAI,UAAU,YAAY,MACxB,MAAO,EACX,OACMK,EACN,CACEV,GAAM,IAAI,kCAAkCU,CAAS,EAAE,CACzD,CAEA,MAAO,EACT,CAEA,SAASD,GAA+BN,EACxC,CACE,IAAMQ,EAAU,SAAS,cAAc,UAAU,EAEjD,SAAS,KAAK,YAAYA,CAAO,EACjCA,EAAQ,YAAcR,EACtBQ,EAAQ,OAAO,EACf,IAAMC,EAAW,SAAS,YAAY,MAAM,EAC5C,gBAAS,KAAK,YAAYD,CAAO,EAE1BC,CACT,CAEA,SAASJ,GAAsBK,EAAUV,EAAeC,EACxD,CACEJ,GAAM,MAAM,gCAAgCa,CAAQ,EAAE,EAEtD,IAAMC,EAAyB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,uDAQsBV,CAAkB;AAAA,yCAChCD,CAAa,OAEpDY,GAAU,CAAE,WAAY,2BAA4B,UAAWD,CAAc,CAAC,CAChF,CCpFA,IAAME,GAAqB,IAC3B,CACE,IAAMC,EAAsB,oCACxBC,EAAOC,EAAUC,EAAgBC,EAAUC,EAAKC,EAASC,EAAWC,EAAgBC,EAAMC,EAAMC,EAEpG,MAAO,CACL,KAAAC,CACF,EAEA,SAASA,EAAKC,EACd,CACE,MAAC,CACC,MAAAZ,EAAiB,qBACjB,SAAAC,EAAiB,KACjB,eAAAC,EAAiB,GACjB,SAAAC,EAAiB,KACjB,IAAAC,EAAiB,KACjB,QAAAC,EAAiB,OACjB,UAAAC,EAAiB,KACjB,eAAAC,EAAiB,KACjB,KAAAC,EAAiB,OACjB,KAAAC,EAAiB,OACjB,oBAAAC,EAAsB,IACxB,EAAIE,EAEGC,GAAU,CACf,WAAYb,EACZ,UAAYc,EAAa,EACzB,UAAY,QACZ,qBAAsB,IAAMC,GAAoBX,EAAKC,CAAO,EAC5D,oBAAqBK,CACvB,CAAC,CACH,CAEA,SAASI,GACT,CACE,IAAME,EAAa,mBAAmB,mBAAmB,aAAaX,CAAO,KAAKJ,CAAQ,EAAE,CAAC,SAAS,UAAUG,CAAG,CAAC,SAE9Ga,GACF,mBADiBf,EACED,EAAS,QAAQF,EAAqB,GAAG,EACzCE,CAD0C,EAI3DiB,GAAe,OAAO,WAAW,mBAAmB,EAAE,QACxD,2CAA2CD,EAAY,GACvD,mCAAmCA,EAAY,GAE7CE,GAAeb,IAAcc,EAAW,QAC1C,qCAAqCb,CAAc,GACnD,sCAAsCU,EAAY,GAEhDI,EAAY,CAChB,CAAE,KAAM,eAAgB,QAAS,gCAAmC,QAAS,mBAAoB,EACjG,CAAE,KAAM,QAAgB,QAAS,wBAAmC,KAAML,CAAuB,EACjG,CAAE,KAAM,SAAgB,QAAS,0BAAmC,KAAM,mCAAmCC,EAAY,GAAW,WAAY,QAAS,EACzJ,CAAE,KAAMR,EAAgB,QAAS,MAAMD,CAAI,uBAAyB,KAAM,mCAAmCS,EAAY,GAAW,WAAY,QAAS,EACzJ,CAAE,KAAMR,EAAgB,QAAS,MAAMD,CAAI,sBAAyB,KAAM,0CAA0CS,EAAY,GAAI,WAAY,QAAS,EACzJ,CAAE,KAAMR,EAAgB,QAAS,MAAMD,CAAI,qBAAyB,KAAM,WAAWD,CAAc,GAAiC,WAAY,QAAS,EACzJ,CAAE,KAAME,EAAgB,QAAS,MAAMD,CAAI,kBAAyB,KAAMU,GAA0D,WAAY,QAAS,EACzJ,CAAE,KAAMT,EAAgB,QAAS,MAAMD,CAAI,wBAAyB,KAAMW,GAA0D,WAAY,QAAS,CAC3J,EAEA,OAAIb,IAAcc,EAAW,QAE3BC,EAAU,CAAC,EAAE,MAAQ,WACrBA,EAAU,CAAC,EAAE,MAAQ,YAGnBf,IAAcc,EAAW,YAC3B,OAAOC,EAAU,CAAC,EAEhBlB,IAAa,MACfkB,EAAU,QAAQ,CAAE,MAAO,oBAAqB,QAASlB,CAAS,CAAC,EAE9DkB,CACT,CACF,EAEaC,GAAaxB,GAAkB,ECxD5C,IAAMyB,GAAQC,EAAe,cAAc,EAErCC,EAAI,CACR,cAAoB,KACpB,WAAoB,KACpB,YAAoB,KACpB,mBAAoB,KACpB,iBAAoB,KACpB,aAAoB,IAAI,IACxB,iBAAoB,GACpB,QAAoB,EACtB,EAEMC,GAAwB,EAOvB,SAASC,IAChB,CACEJ,GAAM,IAAI,QAAQ,EAEdK,EAAS,KAAK,sBAEhBH,EAAE,cAAqBI,GAAcC,GAAmB,GAAG,EAC3DL,EAAE,WAAqB,IAAIM,GAAW,0CAA0C,EAChFN,EAAE,YAAqB,SAAS,cAAc,sCAAsC,EACpFA,EAAE,mBAAqB,SAAS,eAAe,sBAAsB,EACrEA,EAAE,iBAAqBA,EAAE,mBAAmB,cAAc,oBAAoB,EAE9E,OAAO,iBAAiB,OAAQ,IAChC,CACEA,EAAE,YAAY,iBAAiB,QAAWO,GAAUP,EAAE,cAAcO,EAAOP,EAAE,YAAY,MAAM,YAAY,CAAC,CAAC,EAC7GA,EAAE,YAAY,iBAAiB,SAAU,IAAMK,GAAkBL,EAAE,YAAY,MAAM,YAAY,CAAC,CAAC,EAG9FA,EAAE,YAAY,QAAU,IAAQA,EAAE,YAAY,MAAM,QAAUC,IACjEI,GAAkBL,EAAE,YAAY,MAAM,YAAY,CAAC,EAGrD,OAAO,iBAAiB,OAAQ,IAChC,CACMQ,GAA4B,GAAM,SAAS,eAAe,KAAO,kBACnEC,GAAU,KAAK,CACnB,CAAC,CACH,CAAC,EAEL,CAEO,SAASC,GAA6BC,EAC7C,CACMX,EAAE,qBAAuB,OAGzBW,GAEFX,EAAE,mBAAmB,MAAM,QAAWA,EAAE,YAAY,MAAM,QAAUC,GAAyB,QAAU,OACvG,SAAS,iBAAiB,QAASW,GAAoB,CAAE,QAAS,EAAK,CAAC,IAIxEZ,EAAE,mBAAmB,MAAM,QAAU,OACrC,SAAS,oBAAoB,QAASY,GAAoB,CAAE,QAAS,EAAK,CAAC,GAE/E,CAEA,SAASA,GAAmBL,EAC5B,CACOP,EAAE,YAAY,SAASO,EAAM,MAAM,IAAY,IAC/CP,EAAE,iBAAiB,SAASO,EAAM,MAAM,IAAO,IAC/CA,EAAM,OAAO,QAAQ,oBAAoB,IAAM,MAC/CM,GAAeb,EAAE,OAAO,IAAuB,IAElDS,GAAU,KAAK,CAEnB,CAEO,SAASD,IAChB,CACE,OAAQR,EAAE,oBAAoB,MAAM,UAAY,OAClD,CAEA,SAASI,GAAcU,EAAUC,EACjC,CACE,IAAIC,EAAe,EAEnB,OAAO,SAAST,EAAOU,EACvB,CACE,aAAaD,CAAY,EAErB,CAAAE,GAAaX,EAAM,GAAG,IAGrBU,EAAa,QAAUhB,IAA2BD,EAAE,aAAa,IAAIiB,CAAY,IAAM,QAEtFjB,EAAE,aAAa,OAAS,IAC1BA,EAAE,mBAAmB,MAAM,QAAU,SAEvCgB,EAAe,WAAW,IAAMF,EAASG,CAAY,EAAGF,CAAiB,GAIzED,EAASG,CAAY,EAEzB,CACF,CAOA,IAAMX,GAAN,cAAyBa,EACzB,CACE,gBACA,CACE,GAAI,KAAK,QAAQ,kBAAkB,EACjC,OAAOC,GAAe,KAAK,QAAQ,iBAAiB,CAAC,EAEvD,GAAI,KAAK,QAAQ,kBAAkB,EACjC,OAAOC,GAAsB,KAAK,MAAO,KAAK,QAAQ,iBAAiB,CAAC,EAE1E,GAAI,KAAK,QAAQ,yBAAyB,EACxC,OAAOC,GAAc,KAAK,QAAQ,iBAAiB,CAAC,EAEtD,GAAI,KAAK,QAAQ,0BAA0B,EACzC,OAAOtB,EAAE,QAAUuB,GAAmB,KAAK,QAAQ,iBAAiB,EAAGvB,EAAE,WAAW,EAEtF,GAAI,KAAK,QAAQ,uBAAuB,EACtC,OAAOA,EAAE,QAAUwB,GAAiB,KAAK,QAAQ,iBAAiB,EAAGxB,EAAE,WAAW,CACtF,CACF,EAEA,SAASoB,GAAeK,EACxB,CACEC,EAAgBC,GAAkBF,CAAO,EAAE,GAAI,GAAM,EAAK,EAC1DhB,GAAU,KAAK,CACjB,CAEA,SAASY,GAAsBd,EAAOkB,EACtC,CACMG,GAAmBrB,CAAK,IAC1BP,EAAE,QAAUwB,GAAiBC,EAASzB,EAAE,WAAW,EACvD,CAEA,SAASsB,GAAcG,EACvB,CACEE,GAAkBF,CAAO,EACzBI,EAAa,CAAE,QAAS,uBAAwB,SAAU,EAAG,WAAY,UAAW,oBAAqB,IAAOL,GAAiBC,CAAO,CAAE,CAAC,EAC3IhB,GAAU,KAAK,CACjB,CAEA,SAASkB,GAAkBF,EAC3B,CACE,IAAMK,EAAgBL,EAAQ,UAAU,EAAI,EAE5C,OAAAK,EAAc,GAAK,SAAS,KAAK,IAAI,CAAC,GACtCA,EAAc,UAAU,QAAQ,kBAAmB,iBAAiB,EACpEA,EAAc,UAAU,IAAI,QAAQ,EACpCA,EAAc,iBAAiB,eAAgB,IAAMA,EAAc,UAAU,OAAO,QAAQ,CAAC,EAE7FC,EAAuB,GAAG,sBAAsB,WAAYD,CAAa,EAElEA,CACT,CAOA,eAAsBzB,GAAkBY,EACxC,CACE,IAAMe,EAAc,YAAY,IAAI,EAChCC,EAAgB,EAEpB,GAAIhB,EAAa,OAAShB,GAExBD,EAAE,YAAY,aAAe,KAC7BA,EAAE,mBAAmB,MAAM,QAAU,OACrCA,EAAE,iBAAmB,OAGvB,CACE,GAAKiB,IAAiBjB,EAAE,kBAAsBA,EAAE,aAAa,IAAIiB,CAAY,IAAM,OAEjFjB,EAAE,YAAY,aAAe,MAC7BA,EAAE,iBAAmBiB,EAErBgB,EAAgB,MAAMC,GAAgBjB,CAAY,UAE3CA,IAAiBjB,EAAE,iBAC5B,CACE,IAAMmC,EAAenC,EAAE,aAAa,IAAIiB,CAAY,EAEpDjB,EAAE,YAAY,aAAe,MAC7BA,EAAE,iBAAmBiB,EAEhBkB,EAAa,OAAO,OAASC,EAAc,IAAQD,EAAa,KAAK,SAAW,EACnFE,GAAeF,CAAY,EAE3BG,GAAmBC,GAAoBtB,CAAY,CAAC,EAEtDnB,GAAM,IAAI,wCAAwCmB,CAAY,uBAAuBjB,EAAE,aAAa,IAAI,EAAE,CAC5G,CAEKA,EAAE,mBAAmB,MAAM,UAAY,QAAWS,GAAU,UAAU,IACzET,EAAE,mBAAmB,MAAM,QAAU,QACzC,CAGIA,EAAE,aAAa,KAAO,KACxBA,EAAE,aAAa,MAAM,EAEvB,IAAMwC,EAAa,YAAY,IAAI,EAG9BA,EAAaR,EAAe,KAC/B,QAAQ,IAAI,sBAAsBS,GAAiBC,GAAgB,CAAC,CAAC,KAAK,KAAK,KAAKF,EAAaR,CAAW,CAAC,gBAAgB,KAAK,KAAKC,CAAa,CAAC,aAAaU,EAAU,OAAO,GAAIC,EAAM,CACjM,CAEA,eAAeV,GAAgBjB,EAC/B,CACE,IAAM4B,EAAuB5B,EAAa,WAAW,IAAK,GAAG,EAEvD6B,EAAe,UADQ,mBAAmBD,CAAoB,EAAE,WAAW,sBAAuB,SAAS,CAC/D,+BAA+B1C,EAAS,KAAK,sBAAwB,CAAC,YAAYuC,GAAgB,CAAC,IAC/IK,EAAe,YAAY,IAAI,EAE/BC,EAAe,MAAMC,GAAU,CACnC,SAAU,SACV,MAAU,GAAGH,CAAY,oEAC3B,CAAC,EAEKI,EAAY,YAAY,IAAI,EAElC,OAAKF,EAAa,OAAO,OAASZ,EAAc,IAAQY,EAAa,KAAK,QAAU,GAElFhD,EAAE,aAAa,IAAIiB,EAAc+B,CAAY,EAC7CX,GAAeW,CAAY,EAE3BlD,GAAM,IAAI,uBAAuBmB,CAAY,MAAM+B,EAAa,KAAK,MAAM,+BAA+BhD,EAAE,aAAa,IAAI,EAAE,GAI3HgD,EAAa,OAAO,OAASZ,EAAc,GAE7CE,GAAmB,iCAAiC,EAE5CU,EAAa,OAAO,OAASZ,EAAc,IAAQY,EAAa,KAAK,SAAW,IAExFhD,EAAE,aAAa,IAAIiB,EAAc+B,CAAY,EAC7CV,GAAmBC,GAAoBtB,CAAY,CAAC,GAIhDiC,EAAYH,CACtB,CAEA,IAAMN,GAAmB,CACvB,CAACE,EAAU,mBAAmB,EAAkB,iBAChD,CAACA,EAAU,0BAA0B,EAAW,2BAChD,CAACA,EAAU,2BAA2B,EAAU,4BAChD,CAACA,EAAU,kCAAkC,EAAG,qCAClD,EAEA,SAASD,IACT,CACE,OAAIvC,EAAS,KAAK,sBAAwBA,EAAS,KAAK,sBAC/CwC,EAAU,mCACVxC,EAAS,KAAK,qBACdwC,EAAU,2BACVxC,EAAS,KAAK,sBACdwC,EAAU,4BAEZA,EAAU,mBACnB,CAEA,SAASN,GAAeW,EACxB,CACE,IAAIG,EAAa,GAEjBH,EAAa,KAAK,QAAQ,CAACI,EAAOC,IAClC,CACMA,EAAQlD,EAAS,KAAK,wBAExBiD,EAAM,IAAQ,SAAU,KAAK,IAAI,EAAIC,CAAM,GAC3CF,GAAcG,GAAkBF,EAAO,SAAS,EAEpD,CAAC,EAEGJ,EAAa,KAAK,OAAS7C,EAAS,KAAK,wBAE3CgD,GAAc;AAAA;AAAA,oBAEEhD,EAAS,KAAK,qBAAqB,wDAAwD,mBAAmBH,EAAE,YAAY,KAAK,CAAC;AAAA,eAIpJA,EAAE,iBAAiB,UAAYmD,EAG/B,WAAW,IAAM,CAAEnD,EAAE,mBAAmB,cAAc,0BAA0B,EAAE,UAAY,CAAG,EAAG,CAAC,CACvG,CAEA,SAASuC,GAAoBtB,EAC7B,CAEE,MAAO,qBAAqBsC,EAAQtC,CAAY,CAAC,wEAAgC,mBAAmBA,CAAY,CAAC,mBACnH,CAEA,SAASqB,GAAmBkB,EAC5B,CACExD,EAAE,iBAAiB,UAAY,2DAC/BA,EAAE,iBAAiB,cAAc,qBAAqB,EAAE,UAAYwD,CACtE,CC/UA,IAAMC,GAAoB,IAC1B,CACE,IAAMC,EAA8B,IAAI,MAAM,wBAAwB,EAChEC,EAA8B,IAAI,MAAM,uBAAuB,EACjEC,EAAa,KAAMC,EAAkB,KAAMC,EAAc,KACzDC,EAAY,GAEhB,MAAO,CACL,WAAY,CAAE,OAAOA,CAAW,EAChC,KAAAC,EACA,OAAAC,EACA,KAAAC,EACA,KAAAC,CACF,EAEA,SAASH,GACT,CACEJ,EAAkB,SAAS,eAAe,aAAa,EACvDC,EAAkB,SAAS,eAAe,uBAAuB,EACjEC,EAAkBD,EAAgB,cAAc,eAAe,EAEzDO,GAAe,qBAAsB,QAASH,CAAM,EAGpDG,GAAe,qBAAsB,YAAcC,GAAUA,EAAM,eAAe,CAAC,EAGzFP,EAAY,iBAAiB,OAAQ,IACrC,CACMQ,GAA4B,IAAM,IACpCH,EAAK,CACT,CAAC,EAGDL,EAAY,iBAAiB,UAAYO,GACzC,CACOA,EAAM,MAAQ,UAAaN,IAE9BM,EAAM,gBAAgB,EACtBF,EAAK,EAET,CAAC,CACH,CAEA,SAASF,GACT,CACEF,EAAYI,EAAK,EAAID,EAAK,CAC5B,CAEA,SAASA,EAAKK,EAAe,KAC7B,CACMA,IAAiB,OACnBT,EAAY,MAAQS,GAElBC,EAA0B,IAExBT,IAAc,IAChBU,EAAkB,EAAI,EAExBX,EAAY,MAAM,EAClBA,EAAY,kBAAkB,KAAM,IAAI,EAE5C,CAEA,SAASK,GACT,CACMJ,GACFU,EAAkB,EAAK,CAC3B,CAEA,SAASD,GACT,CACE,OAAIX,EAAgB,MAAM,QAAQ,SAAW,EAGvC,EAAAD,EAAW,eAAiB,GAItBc,GAAmBC,EAAM,qBAAqB,GAEjDf,EAAW,cAAc,8BAA8B,EAAE,eAAiB,GAC1EA,EAAW,cAAc,6BAA6B,EAAE,eAAkB,GAS5E,EACT,CAEA,SAASa,EAAkBG,EAC3B,CACEb,EAAYa,EAEZb,EAAY,SAAS,cAAcJ,CAA0B,EACjD,SAAS,cAAcD,CAA2B,EAE9DK,EAAY,SAAS,eAAe,mBAAmB,EAAE,UAAU,IAAI,MAAM,EACjE,SAAS,eAAe,mBAAmB,EAAE,UAAU,OAAO,MAAM,EAEhFF,EAAgB,MAAM,QAAUE,EAAY,OAAS,GACrDc,GAA6Bd,CAAS,EAEtC,SAAS,iBAAiB,+BAA+B,EAAE,QAASe,GACpE,CACEA,EAAQ,YAAcf,EAAY,QAAU,QAC9C,CAAC,CACH,CACF,EAEagB,GAAYtB,GAAiB,EClGnC,SAASuB,GAAmBC,EAASC,EAAsB,KAClE,CACE,IAAMC,EAAcC,EAAeH,EAAS,mBAAmB,EACzDI,EAAcD,EAAeH,EAAS,kBAAkB,EAExDK,EAAUC,GAAW,KAAK,CAC9B,SAAgB,GAAGJ,CAAW,MAAME,CAAU,GAC9C,eAAgB,GAChB,SAAgBG,GAAkBP,EAASE,EAAaE,CAAU,EAClE,IAAgBD,EAAeH,EAAS,gBAAgB,EACxD,QAAgB,aAChB,UAAgBQ,GAAiBR,CAAO,EACxC,eAAgBG,EAAeH,EAAS,uBAAuB,EAC/D,oBAAqBC,CACvB,CAAC,EAED,OAAAQ,GAAuB,GAAGP,CAAW,MAAME,CAAU,EAAE,EAEhDC,CACT,CAEO,SAASK,GAAiBV,EAASC,EAAsB,KAChE,CACE,IAAMC,EAAgBC,EAAeH,EAAS,mBAAmB,EAC3DI,EAAgBD,EAAeH,EAAS,kBAAkB,EAC1DW,EAAgB,SAASX,EAAQ,aAAa,qBAAqB,CAAC,EACpEY,EAAgB,CAAC,EAEvBA,EAAa,KAAK,CAChB,MAAS,sBACT,QAASL,GAAkBP,EAASE,EAAaE,CAAU,CAC7D,CAAC,EAED,IAAMS,EAAa,wDAA0DF,EAAgB,EAAKG,EAAcH,CAAa,EAAI,cAAe,UAE5IH,GAAiBR,CAAO,IAAMe,EAAW,MAC3CC,GAAqBhB,EAASY,CAAY,EAE1CK,GAAgBjB,EAASY,CAAY,EAEvC,IAAMP,EAAUa,GAAU,CACxB,WAAYL,EACZ,UAAYD,EACZ,UAAY,gBACZ,oBAAqBX,EACrB,qBAAsB,CAACkB,EAAcC,IAAUC,GAAuBD,CAAK,CAC7E,CAAC,EAED,OAAAX,GAAuB,GAAGP,CAAW,MAAME,CAAU,EAAE,EAEhDC,CACT,CAEA,SAASW,GAAqBhB,EAASY,EACvC,CACEA,EAAa,KAAK,CAAE,MAAO,eAAgB,QAAS,UAAW,CAAC,EAChEA,EAAa,KAAK,CAAE,MAAO,eAAgB,QAAS,GAAGT,EAAeH,EAAS,sBAAsB,CAAC,EAAG,CAAC,EAC1GY,EAAa,KAAK,CAAE,MAAO,eAAgB,QAAS,MAAO,CAAC,EAC5DA,EAAa,KAAK,CAAE,MAAO,eAAgB,QAAS,aAAaT,EAAeH,EAAS,sBAAsB,CAAC,aAAc,CAAC,EAC/HY,EAAa,KAAK,CAAE,MAAO,eAAgB,QAAS,MAAO,CAAC,EAC5DA,EAAa,KAAK,CAAE,MAAO,eAAgB,QAASU,GAAqB,SAAStB,EAAQ,aAAa,sBAAsB,CAAC,CAAC,CAAE,CAAC,CACpI,CAEA,SAASiB,GAAgBjB,EAASY,EAClC,CACE,IAAMW,EAAWvB,EAAQ,cAAc,sBAAsB,EAAE,iBAAiB,GAAG,EAC7EwB,EAAWxB,EAAQ,cAAc,uBAAuB,EAAE,iBAAiB,GAAG,EAEpFY,EAAa,KAAK,CAAE,MAAO,eAAgB,QAAS,SAAU,CAAC,EAE/DW,EAAQ,QAAQE,GAChB,CACEb,EAAa,KAAK,CAChB,MAAW,mBAAmBa,EAAK,UAAU,CAAC,GAAK,EAAE,GACrD,MAAW,eACX,QAAWA,EAAK,UAChB,KAAWC,GAAiBD,EAAK,IAAI,EACrC,KAAW,OACX,UAAW,SACX,WAAY,cAAcA,EAAK,SAAS,GACxC,QAAWzB,EAAQ,EACrB,CAAC,CACH,CAAC,EAEDY,EAAa,KAAK,CAAE,MAAO,eAAgB,QAAS,UAAW,CAAC,EAEhEY,EAAS,QAAQC,GACjB,CACEb,EAAa,KAAK,CAChB,MAAW,kBACX,MAAW,gBACX,QAAWa,EAAK,UAChB,KAAWC,GAAiBD,EAAK,IAAI,EACrC,KAAW,OACX,UAAW,SACX,WAAY,cAAcA,EAAK,SAAS,GACxC,QAAWzB,EAAQ,EACrB,CAAC,CACH,CAAC,EAED,IAAM2B,EAAanB,GAAiBR,CAAO,IAAMe,EAAW,QAAW,UAAY,aAC7Ea,EAAapB,GAAiBR,CAAO,IAAMe,EAAW,QACxD,UAAU,qCAAqCf,EAAQ,aAAa,uBAAuB,CAAC,EAAE,EAC9F,UAAU,WAAWA,EAAQ,aAAa,uBAAuB,CAAC,EAAE,EAExEY,EAAa,KAAK,CAAE,MAAO,eAAgB,QAAS,oBAAqB,CAAC,EAC1EA,EAAa,KAAK,CAAE,QAAS,GAAGe,CAAS,SAAU,KAAMC,EAAW,KAAM,OAAQ,WAAY,SAAU,MAAO,WAAWD,CAAS,QAAS,CAAC,CAC/I,CAEA,SAASN,GAAuBD,EAChC,CACE,GAAIA,EAAM,OAAO,QAAQ,sBAAsB,EAC/C,CACEA,EAAM,eAAe,EACrB,IAAMS,EAAeT,EAAM,OAAO,QAAQ,GAAG,GAAG,cAAc,2BAA2B,EAAE,YAC3FU,GAAU,KAAKD,CAAY,EAEvBE,GAAa,GACfC,GAAkBH,EAAa,YAAY,CAAC,CAChD,CACF,CAEA,SAASpB,GAAuBwB,EAChC,CACEC,GAAoB,EAAE,cAAc,qCAAqC,EAAE,MAAQ,qCACnFA,GAAoB,EAAE,cAAc,KAAK,GAAG,iBAAiB,QAAS,IAAMC,GAAoBF,EAAa,mBAAmB,CAAC,CACnI,CC7HA,IAAMG,GAAQC,EAAe,eAAe,EAEtCC,EAAI,CACR,UAAsB,KACtB,kBAAsB,KACtB,kBAAsB,KACtB,aAAsB,KACtB,aAAsBC,EAAM,QAC5B,kBAAsB,KACtB,qBAAsB,KACtB,WAAsB,KACtB,eAAsB,KACtB,qBAAsB,CACxB,EAOO,SAASC,IAChB,CACEJ,GAAM,IAAI,QAAQ,EAElBE,EAAE,UAAuB,SAAS,eAAe,WAAW,EAC5DA,EAAE,kBAAuB,IAAI,qBAAqBG,GAAkB,CAAE,KAAMH,EAAE,SAAU,CAAC,EACzFA,EAAE,qBAAuB,SAAS,cAAc,qEAAqE,EACrHA,EAAE,WAAuB,IAAII,GAAW,YAAY,EACpDJ,EAAE,eAAuB,SAAS,cAAc,qCAAqC,CACvF,CAEO,SAASK,IAChB,CACEL,EAAE,aAAa,UAAU,IAAI,SAAS,EAEvBM,EAA2BC,EAAM,cAAiB,IAAWC,GAAqBP,EAAM,OAAO,CAAC,EAChGK,EAA2BC,EAAM,cAAiB,IAAWC,GAAqBP,EAAM,OAAO,CAAC,EAChGK,EAA2BC,EAAM,aAAiB,IAAWC,GAAqBP,EAAM,MAAM,CAAC,EAC/FK,EAA2BC,EAAM,gBAAkBE,GAAUC,GAAkBD,EAAM,KAAK,QAASA,EAAM,KAAK,cAAc,CAAC,EAExIE,EAAS,KAAK,oBAChBC,GAAmB,EAEjBD,EAAS,KAAK,qBAEVL,GAAY,sBAAuB,QAAUG,GACnD,CACEI,GAAgB,EAChBC,GAA+BL,CAAK,CACtC,CAAC,CAEL,CAEA,SAASN,GAAiBY,EAC1B,CACEf,EAAE,kBAAkB,UAAUA,EAAE,YAAY,EAEvC,KAAK,KAAKe,EAAQ,CAAC,EAAE,kBAAoB,GAAG,EAAI,MAAS,IAC5Df,EAAE,UAAU,UAAaA,EAAE,aAAa,UAAYA,EAAE,UAAU,aAAgBA,EAAE,aAAa,aACnG,CAOO,SAASgB,GAAWC,EAC3B,CACE,OAAOjB,EAAE,UAAU,cAAciB,CAAS,CAC5C,CAEO,SAASC,GAAcD,EAC9B,CACE,OAAOjB,EAAE,UAAU,iBAAiBiB,CAAS,CAC/C,CAEO,SAASE,GAAaC,EAC7B,CACE,OAAO,SAAS,eAAeA,CAAE,CACnC,CAEO,SAASC,GAChB,CACE,OAAOrB,EAAE,YACX,CAEO,SAASsB,IAChB,CACE,IAAIC,EAAevB,EAAE,eAAiB,KAChBA,EAAE,aAAa,uBACf,KAEtB,KAAQuB,IAAgB,MAAUC,GAAiBD,CAAW,IAAME,EAAW,MAC7EF,EAAcA,EAAY,uBAE5B,OAASA,IAAgB,KAAQA,EAAY,GAAK,IACpD,CAEO,SAASG,GAAkBC,EAAe3B,EAAE,aACnD,CACE,IAAIuB,EAAeI,IAAiB,KACdA,EAAa,mBACbX,GAAW,iBAAiB,EAElD,KAAQO,IAAgB,MAAUC,GAAiBD,CAAW,IAAME,EAAW,MAC7EF,EAAcA,EAAY,mBAE5B,OAASA,IAAgB,KAAQA,EAAY,GAAK,IACpD,CAEO,SAASK,GAAgBC,EAChC,CACE7B,EAAE,aAAemB,GAAaU,CAAO,EACrC7B,EAAE,kBAAkB,QAAQA,EAAE,YAAY,CAC5C,CAEO,SAAS8B,GAAoBC,EACpC,CACEjC,GAAM,IAAI,0BAA0BA,GAAM,eAAe2B,EAAYM,CAAS,CAAC,EAAE,EAEjF,SAAS,cAAc,2CAA2C,EAAE,MAAM,QAAU,OACpF,SAAS,cAAc,uCAAuC,EAAE,MAAM,QAAeA,IAAcN,EAAW,QAAc,QAAU,GACtI,SAAS,cAAc,0CAA0C,EAAE,MAAM,QAAYM,IAAcN,EAAW,WAAc,QAAU,GACtIzB,EAAE,eAAe,MAAM,QAA8D+B,IAAcN,EAAW,MAAc,QAAU,EACxI,CAEO,SAASX,GAA+BL,EAC/C,CACE,GAAUuB,GAAmBvB,CAAK,EAClC,CACE,IAAMwB,EAAcjC,EAAE,eAAe,cAAc,yBAAyB,EACtEkC,EAAclC,EAAE,eAAe,cAAc,OAAO,EAE1DiC,EAAY,MAAM,QAAU,QAC5BC,EAAY,MAAM,QAAU,QAExBlC,EAAE,uBAAyB,GAC7B,aAAaA,EAAE,oBAAoB,EAErCA,EAAE,qBAAuB,WAAW,IACpC,CACEiC,EAAY,MAAM,QAAU,GAC5BC,EAAY,MAAM,QAAU,GAC5BlC,EAAE,qBAA0B,CAC9B,EACA,GAAI,CACN,CACF,CAOA,IAAMI,GAAN,cAAyB+B,EACzB,CACE,gBACA,CACE,GAAI,KAAK,QAAQ,kBAAkB,EACjC,OAAOC,EAAgB,KAAK,QAAQ,iBAAiB,EAAE,GAAI,GAAM,EAAI,EAEvE,GAAI,KAAK,QAAQ,6BAA6B,EAC5C,OAAOC,GAAkB,KAAK,QAAQ,iBAAiB,CAAC,EAE1D,GAAI,KAAK,QAAQ,sBAAsB,EACrC,OAAOC,GAAY,KAAK,QAAQ,iBAAiB,CAAC,EAEpD,GAAI,KAAK,QAAQ,yBAAyB,EACxC,OAAOC,GAAc,KAAK,QAAQ,iBAAiB,CAAC,EAEtD,GAAI,KAAK,QAAQ,0BAA0B,EACzC,OAAOC,GAAmB,KAAK,QAAQ,iBAAiB,CAAC,EAE3D,GAAI,KAAK,QAAQ,uBAAuB,EACtC,OAAOC,GAAiB,KAAK,QAAQ,iBAAiB,CAAC,EAEzD,GAAI,KAAK,QAAQ,wBAAwB,GAAK,KAAK,QAAQ,0BAA0B,EACnF,OAAOC,GAAiB,KAAK,QAAQ,8BAA8B,EAAG,KAAK,QAAQ,wBAAwB,CAAC,EAE9G,GAAI,KAAK,QAAQ,2BAA2B,GAAK,KAAK,QAAQ,0BAA0B,EACtF,OAAOC,GAAoB,KAAK,QAAQ,2BAA2B,CAAC,CACxE,CACF,EAEA,SAASN,GAAkBO,EAC3B,CACE,IAAMC,EAAqBD,EAAQ,cAAc,uBAAuB,EAEnE5C,EAAE,oBAAsB,MAAUA,EAAE,oBAAsB6C,IAC7D7C,EAAE,kBAAkB,MAAM,QAAU,IAElC6C,EAAmB,MAAM,UAAY,GACvCA,EAAmB,MAAM,QAAU,OAEnCA,EAAmB,MAAM,QAAU,GAErC7C,EAAE,kBAAoB6C,CACxB,CAEA,SAASN,GAAcO,EACvB,CACE,GAAI9C,EAAE,eAAiB,KACvB,CACE,IAAM+C,EAAmBD,EAAa,UAAU,EAAI,EAEpDE,GAAgBD,CAAgB,EAChCA,EAAiB,GAAK,SAAS,KAAK,IAAI,CAAC,GAErCpC,EAAS,KAAK,qBAAwBmC,IAAiB9C,EAAE,aAC3DsC,GAAYQ,EAAc,GAAO,IAAMG,GAASF,EAAkB/C,EAAE,aAAc,UAAU,CAAC,EAE7FiD,GAASF,EAAkB/C,EAAE,aAAc,UAAU,EAEvDkD,EAAa,CAAE,QAAS,uBAAwB,SAAU,EAAG,WAAY,UAAW,oBAAqB,IAAOT,GAAiBM,CAAgB,CAAE,CAAC,CACtJ,MAGEG,EAAa,CAAC,QAAS,sBAAuB,SAAU,CAAE,CAAC,CAE/D,CAEA,SAASZ,GAAYQ,EAAcK,EAAY,GAAMC,EAAuB,IAAM,CAAC,EACnF,CACE,GAAIN,IAAiB9C,EAAE,aACvB,CACE,IAAMqD,EAAoBP,EAAa,UAAU,EAAI,EAC/CQ,EAAoBR,EAAa,uBAEvCA,EAAa,iBAAiB,eAAgB,IAC9C,CACEA,EAAa,OAAO,EACpBM,EAAqB,CACvB,CAAC,EAEDN,EAAa,UAAU,IAAI,UAAU,EAEjCK,GAEFD,EAAa,CACX,QAAS,gBACT,SAAU,EACV,WAAY,OACZ,oBAAqB,IACrB,CACED,GAASI,EACCC,IAAoB,KAAQtD,EAAE,UAAasD,EAC3CA,IAAoB,KAAQ,aAAe,UAAW,CAClE,CACF,CAAC,CAEL,CACF,CAEA,SAASL,GAASH,EAAcS,EAAeC,EAC/C,CACEV,EAAa,UAAU,IAAI,QAAQ,EACnCA,EAAa,cAAc,uBAAuB,EAAE,MAAM,QAAU,GACpEA,EAAa,iBAAiB,eAAgB,IAAMA,EAAa,UAAU,OAAO,QAAQ,CAAC,EAC3FS,EAAc,sBAAsBC,EAAgBV,CAAY,CAClE,CAEA,SAASJ,GAAiBa,EAAeE,EACzC,CACE,IAAMC,EAAc,SAASH,EAAc,aAAa,kBAAkB,CAAC,EACrEI,EAAcF,EAAkBC,EAAa,EAAMA,EAAa,EAClEE,EAAgB,SAAS,eAAe,kBAAkBD,CAAW,EAAE,EACvEE,EAAgB,SAEhBD,IAAgB,OAElBA,EAAcH,EAAiBzD,EAAE,UAAU,kBAAoB,SAAS,eAAe,4BAA4B,EACnH6D,EAAcJ,EAAiB,MAAU,OAAO,WAAa,KAAQ,UAAY,SAE5EA,IAAmB,IAAWE,EAAcG,EAAS,WACxDF,EAAcA,GAAa,yBAG/BA,GAAa,eAAe,CAAE,SAAgBG,GAAkB,EAAG,MAAOF,CAAY,CAAC,CACzF,CAEA,SAASlB,GAAoBqB,EAC7B,CACE,GAAIA,EAEE,OAAO,WAAa,KACtBhE,EAAE,UAAU,kBAAkB,eAAe,CAAE,SAAgB+D,GAAkB,EAAG,MAAO,QAAS,CAAC,EAErG,OAAO,OAAO,CAAE,IAAK,EAAG,KAAM,EAAG,SAAgBA,GAAkB,CAAE,CAAC,MAG1E,CACE,IAAME,EAAY/C,GAAc,cAAc,EAC9C+C,EAAUA,EAAU,OAAS,CAAC,EAAE,eAAe,CAAE,SAAgBF,GAAkB,EAAG,MAAO,QAAS,CAAC,CACzG,CACF,CAOA,SAASnD,IACT,EACMkD,EAAS,IAAI,cAAgB,OAC7BA,EAAS,IAAI,cAAgB,WAC7BA,EAAS,IAAI,cAAgB,UAC7BA,EAAS,IAAI,cAAgB,WAC7BA,EAAS,IAAI,cAAgB,WAE1BA,EAAS,WAAa,MAAUA,EAAS,YAAcA,EAAS,WAEnE9D,EAAE,kBAAoB,SAAS,eAAe,4BAA4B,EAC1EA,EAAE,kBAAkB,cAAc,uBAAuB,EAAE,YAAc,MAAM8D,EAAS,YAAc,CAAC,MAAMA,EAAS,QAAQ,KAC9H9D,EAAE,kBAAkB,MAAM,QAAU,QACpCA,EAAE,kBAAkB,iBAAiB,QAASkE,EAAc,EAGlE,CAEA,eAAsBA,IACtB,CACE,IAAIC,EAAe,GAEnB,OAAKL,EAAS,YAAc,GAAMA,EAAS,WAEzCM,GAAmB,EAAI,EACvBD,EAAe,MAAME,GAAiBC,EAAetE,EAAE,UAAW,gBAAgB,EAASsE,EAAetE,EAAE,UAAW,cAAc,CAAC,EACtIoE,GAAmB,EAAK,EAEpBD,GAEFL,EAAS,cACT9D,EAAE,kBAAkB,cAAc,uBAAuB,EAAE,YAAc,MAAM8D,EAAS,YAAc,CAAC,MAAMA,EAAS,QAAQ,MAI9HZ,EAAa,CACX,QAAS,2BACT,SAAU,GACV,WAAY,QACZ,oBAAqB,IAAMgB,GAAe,CAC5C,CAAC,GAIAJ,EAAS,aAAeA,EAAS,UAAcK,IAAiB,KACnEnE,EAAE,kBAAkB,MAAM,QAAU,QAE/BmE,CACT,CAEA,SAASC,GAAmBG,EAC5B,CACEvE,EAAE,kBAAkB,MAAM,cAA6CuE,EAAkB,OAAU,QACnGvE,EAAE,kBAAkB,cAAc,kBAAkB,EAAE,MAAM,QAAWuE,EAAkB,OAAU,QACnGvE,EAAE,kBAAkB,cAAc,mBAAmB,EAAE,MAAM,QAAUuE,EAAkB,QAAU,MACrG,CAOA,SAASvB,GAAgBJ,EACzB,CACEA,EAAQ,UAAU,OAAO,UAAW3C,EAAM,QAAQ,MAAOA,EAAM,QAAQ,MAAOA,EAAM,OAAO,KAAK,CAClG,CAEO,SAASO,GAAqBgE,EAAUC,EAAgB,GAC/D,EACOzE,EAAE,aAAa,KAAOwE,EAAS,IAAOC,KAEzCzE,EAAE,aAAewE,EAEbA,EAAS,KAAOvE,EAAM,QAAQ,IAEhCD,EAAE,aAAa,UAAU,OAAOC,EAAM,OAAO,MAAOA,EAAM,QAAQ,KAAK,EACvED,EAAE,aAAa,UAAU,IAAIC,EAAM,QAAQ,KAAK,IAIhDD,EAAE,aAAa,UAAU,OAAOC,EAAM,QAAQ,KAAK,EAE/CuE,EAAS,KAAOvE,EAAM,QAAQ,GAC1ByE,GAAa1E,EAAE,aAAcC,EAAM,OAAO,MAAOA,EAAM,QAAQ,KAAK,EAEpEyE,GAAa1E,EAAE,aAAcC,EAAM,QAAQ,MAAOA,EAAM,OAAO,KAAK,EAE5E0E,GAAkBH,EAAS,KAAOvE,EAAM,QAAQ,EAAE,GAGxD,CAKA,SAAS2E,IACT,CACM5E,EAAE,aAAa,UAAU,SAAS,UAAU,EAC9CA,EAAE,qBAAqB,UAAU,QAAQ,mBAAoB,mBAAmB,EAEhFA,EAAE,qBAAqB,UAAU,QAAQ,oBAAqB,kBAAkB,CACpF,CAEO,SAASU,GAAkBmE,EAAaC,EAC/C,CACE9B,GAAgBhD,EAAE,YAAY,EAE9BA,EAAE,aAAemB,GAAa0D,CAAW,EAErCC,IAAmB,IACrB9E,EAAE,kBAAkB,QAAQA,EAAE,YAAY,EAE5CA,EAAE,aAAa,UAAU,IAAI,SAAS,CACxC,CAEO,SAAS+E,GAAgBC,EAChC,CACEhF,EAAE,aAAa,cAAc,gBAAgB,EAAE,YAAgBgF,EAC/DhF,EAAE,aAAa,cAAc,gBAAgB,EAAE,MAAM,QAAU,OACjE,CAEA,SAASiF,GAAsBC,EAC/B,CACE,GAAIvE,EAAS,KAAK,qBAEZuE,EAAO,aAAa,IAAMzD,EAAW,MACzC,CACE,IAAMQ,EAAeiD,EAAO,SAAS,EAAE,SAAW,EAC9C,MAAYC,EAAQD,EAAO,UAAU,CAAC,CAAC,UAAgBC,EAAQD,EAAO,SAAS,CAAC,CAAC,GAC3EC,EAAQD,EAAO,UAAU,CAAC,EAEpClF,EAAE,eAAe,cAAc,eAAe,EAAE,UAAYiC,EAC5D,SAAS,eAAe,oBAAoB,EAAE,IAAM,UAAUjC,EAAE,aAAa,aAAa,sBAAsB,CAAC,CACnH,CAEJ,CAEO,SAASoF,GAAmBF,EACnC,CACEA,EAAO,kBAAkBlF,EAAE,aAAa,aAAa,mBAAmB,EAAGA,EAAE,aAAa,aAAa,kBAAkB,CAAC,EAC1HkF,EAAO,YAAY,SAASlF,EAAE,aAAa,aAAa,qBAAqB,CAAC,CAAC,EAC/EkF,EAAO,aAAalF,EAAE,YAAY,EAClCiF,GAAsBC,CAAM,EAC5BN,GAAqB,CACvB,CC7cO,IAAMS,GAAN,KACP,CACEC,GAAkB,GAClBC,GAAkB,EAClB,cAAkB,EAClB,UAAkB,GAElB,OAAS,CACP,oBAAqB,IACrB,kBAAqB,EACrB,iBAAqB,CACvB,EAEA,MACA,CACE,SAAS,iBAAiB,mBAAoB,IAC9C,CACE,KAAK,UAAa,SAAS,kBAAoB,SACjD,CAAC,EAEDC,EAAYC,EAAM,cAAmB,IAAM,KAAK,MAAM,CAAC,EACvDD,EAAYC,EAAM,aAAmB,IAAM,KAAK,KAAK,CAAC,EACtDD,EAAYC,EAAM,YAAmB,IAAM,KAAK,KAAK,CAAC,EACtDD,EAAYC,EAAM,gBAAmB,IAAM,KAAK,KAAK,CAAC,EACtDD,EAAYC,EAAM,kBAAmB,IAAM,KAAK,KAAK,CAAC,EACtDD,EAAYC,EAAM,iBAAmB,IAAM,KAAK,KAAK,CAAC,CACxD,CAGA,aAAc,CAAC,CACf,kBAAmB,CAAC,CAEpB,OACA,CACE,KAAK,KAAK,EACV,KAAKH,GAAc,YAAY,IAAM,KAAK,YAAY,EAAG,KAAK,OAAO,mBAAmB,CAC1F,CAEA,MACA,CACM,KAAKA,KAAgB,KAEvB,cAAc,KAAKA,EAAW,EAC9B,KAAKA,GAAc,IAGrB,KAAKC,GAAkB,EACvB,KAAK,cAAkB,EAEvBG,GAA0B,EAAK,CACjC,CAEA,oBAAoBC,EAAiBC,EACrC,CACE,GAAI,KAAKL,KAAoBI,IAE3B,KAAKJ,GAAkBI,EACvB,KAAK,gBACL,KAAK,iBAAiB,EAEjBE,EAAS,SAAS,WAAa,IAAUA,EAAS,SAAS,sBAChE,CACE,IAAMC,EAAmBF,EAAkBD,EAEvCG,GAAoBD,EAAS,SAAS,sBAExCH,GAA0B,EAAI,EAC9BK,EAASN,EAAM,qBAAsB,CAAE,qBAAsBK,CAAiB,CAAC,GAI/EJ,GAA0B,EAAK,CAEnC,CAEJ,CACF,EC7EA,IAAMM,GAAN,cAAgCC,EAChC,CACEC,GAAW,KAEXC,GAAgBC,EAAwBC,EACxC,CACE,GAAID,IAA2B,OAC/B,CACE,IAAME,EAAkB,KAAK,MAAMF,CAAsB,EAEzDG,GAAwBH,EAAyB,IAAOE,EAAiBD,CAAe,EAEnFC,EAAkB,GAAOD,EAAkB,GAC9C,MAAM,oBAAoBC,EAAiBD,CAAe,CAC9D,CACF,CAEA,MAAMG,EACN,CACE,MAAM,KAAK,EACX,KAAKN,GAAWM,CAClB,CAEA,aACA,CACM,KAAK,WAAaC,EAAU,GAC9B,KAAKP,GAAS,QAAQ,YAAY,CAACQ,EAAUC,IAAa,KAAKR,GAAgBO,EAAUC,CAAQ,CAAC,CACtG,CAEA,kBACA,CACO,KAAK,eAAiB,KAAK,OAAO,kBAAqBF,EAAU,GACpE,KAAKP,GAAS,QAAQ,UAAWU,GAAWC,GAAyBD,EAAQ,KAAKV,GAAS,QAAQ,QAAQ,CAAC,CAAC,CACjH,CACF,EAEaY,GAAgB,IAAId,GCtBjC,IAAMe,GAAQC,EAAe,cAAc,EAErCC,GAAI,CACR,YAAa,KACb,mBAAoB,EACpB,kBAAoB,CACtB,EAEMC,GAA8B;AAAA;AAAA;AAAA;AAAA;AAAA,UAY7B,SAASC,IAChB,CACEJ,GAAM,IAAI,QAAQ,EAElB,SAAS,eAAe,WAAW,EAAE,mBAAmB,YAAaG,EAAkB,EAEvFE,GAAY,sBAAuB,SAAWC,GAAUC,GAAiBD,EAAM,OAAO,KAAK,CAAC,EAC5FD,GAAY,sBAAuB,SAAWC,GAAUC,GAAiBD,EAAM,OAAO,KAAK,CAAC,EAC5FD,GAAY,sBAAuB,QAAUG,EAAgB,CAC/D,CAOA,SAASD,GAAiBE,EAC1B,CACMA,EAAU,SAAW,EAEvBC,EAAa,CAAE,QAAS,qBAAsB,SAAU,CAAE,CAAC,GAI3DA,EAAa,CAAE,QAAS,UAAUD,EAAU,MAAM,UAAWA,EAAU,SAAW,EAAK,QAAU,QAAQ,MAAO,SAAU,CAAE,CAAC,EAE7HP,GAAE,mBAAqB,YAAY,IAAI,EAEnCA,GAAE,cAAgB,KACpBS,GAAsB,IAAMC,GAAkBH,EAAWI,GAAqBJ,CAAS,CAAC,CAAC,EAEzFG,GAAkBH,EAAWI,GAAqBJ,CAAS,CAAC,EAElE,CAEA,SAASE,GAAsBG,EAC/B,CACEd,GAAM,IAAI,4BAA4Be,EAAmB,kCAAkCC,EAAO,EAAE,EAEpG,IAAMC,EAAiB,SAAS,cAAc,QAAQ,EAChDC,EAAiB,SAAS,qBAAqB,QAAQ,EAAE,CAAC,EAEhED,EAAU,KAAO,kBACjBA,EAAU,GAAO,gBACjBA,EAAU,IAAO,GAAGF,EAAmB,kCAAkCC,EAAO,GAEhFE,EAAe,WAAW,aAAaD,EAAWC,CAAc,EAEhED,EAAU,OAAS,IACnB,CACEf,GAAE,YAAc,OAAO,YACvBY,EAAiB,CACnB,CACF,CAEA,SAASN,IACT,CACEW,GAAc,kCAAkC,GAAG,QAAQC,GAC3D,CACE,GAAIA,EAAa,UAAU,SAAS,SAAS,IAAM,GACnD,CACE,IAAMC,EAAoBD,EAAa,aAAa,gBAAgB,EAC9DE,EAAoBF,EAAa,aAAa,sBAAsB,EAEtEC,IAAiB,MACnB,IAAI,gBAAgBA,CAAY,EAE7BC,IAAsB,MAAUA,EAAkB,WAAW,OAAO,GACvE,IAAI,gBAAgBA,CAAiB,EAEvCF,EAAa,OAAO,CACtB,CACF,CAAC,EAEDV,EAAa,CAAE,QAAS,uBAAwB,SAAU,CAAE,CAAC,CAC/D,CAEA,SAASa,GAAYC,EACrB,CACE,IAAMC,EAAgB,YAAY,IAAI,EACtC,QAAQ,IAAI,WAAWD,CAAU,sBAAsB,KAAK,KAAKC,EAAgBvB,GAAE,kBAAkB,CAAC,sBAAsB,KAAK,KAAKA,GAAE,kBAAoBA,GAAE,kBAAkB,CAAC,aAAawB,EAAU,OAAO,GAAIC,EAAM,CAC3N,CAOA,SAASd,GAAqBJ,EAC9B,CACE,IAAMmB,EAAY,CAAC,EACfC,EAAc,EACdC,EAAc,GAElB,QAAWC,KAAQtB,EACnB,CACE,IAAMuB,EAAW,UAAU,IAAI,gBAAgBD,CAAI,CAAC,EAEpDH,EAAU,KAAK,SAAU,KAAK,IAAI,EAAIC,CAAM,EAAE,EAE9CC,GAAcG,GACd,CACE,IAAKL,EAAUC,GAAO,EACtB,GAAI,QACJ,KAAMG,EACN,QAAS,CAAC,EACV,SAAU,CAAC,EACX,KAAM,CACJ,kBAAmBE,EAAW,MAC9B,kBAAmBF,EACnB,aAAc,aACd,YAAa,GACb,eAAgB,CAClB,CACF,CAAC,CACH,CAEA,gBAAS,eAAe,WAAW,EAAE,mBAAmB,YAAaF,CAAU,EAC/E5B,GAAE,kBAAoB,YAAY,IAAI,EAE/B0B,CACT,CAEA,SAAShB,GAAkBH,EAAWmB,EACtC,CACE,IAAIC,EAAQ,EACRM,EAAkB,EAEtB,QAAWJ,KAAQtB,EACnB,CACE,IAAMW,EAAgB,SAAS,eAAeQ,EAAUC,GAAO,CAAC,EAC1DO,EAAgBC,GAAUC,EAAQP,EAAK,IAAI,CAAC,EAC5CQ,EAAgBH,EAAS,YAAY,GAAG,EACxCI,EAAiBD,IAAiB,GAAMH,EAAS,MAAM,EAAGG,CAAY,EAAIH,EAC1EK,EAAiBF,IAAiB,GAAMH,EAAS,MAAMG,EAAe,CAAC,EAAE,YAAY,EAAIR,EAAK,KAEpGX,EAAa,aAAa,uBAAwBM,EAAU,yBAAyB,EACrFN,EAAa,aAAa,uBAAwBgB,CAAQ,EAC1DhB,EAAa,aAAa,uBAAwBqB,CAAQ,EAC1DrB,EAAa,aAAa,uBAAwBW,EAAK,IAAI,EAE3D7B,GAAE,YAAY,KAAK6B,EACnB,CACE,UAAYW,GACZ,CACM,OAAO,KAAKA,EAAU,IAAI,EAAE,SAAW,EACzCC,GAAoBD,EAAU,KAAMtB,EAAcoB,CAAa,EAE/DI,GAA4BxB,EAAcoB,CAAa,EAErD,EAAEL,IAAoB1B,EAAU,QAClCc,GAAYd,EAAU,MAAM,CAChC,EACA,QAAS,IACT,CACEmC,GAA4BxB,EAAcoB,CAAa,EAEnD,EAAEL,IAAoB1B,EAAU,QAClCc,GAAYd,EAAU,MAAM,CAChC,CACF,CAAC,CACH,CACF,CAEA,SAASkC,GAAoBE,EAAMzB,EAAcoB,EACjD,CACE,GAAKK,EAAK,SAAW,QAAeA,EAAK,QAAU,OAEjDD,GAA4BxB,EAAcoB,CAAa,MAGzD,CACE,IAAIM,EAASN,EACTO,EAASP,EAERK,EAAK,SAAW,QAAeA,EAAK,OAAO,SAAW,IACzDC,EAAST,GAAUQ,EAAK,MAAM,GAE3BA,EAAK,QAAU,QAAeA,EAAK,MAAM,SAAW,IACvDE,EAAQV,GAAUQ,EAAK,KAAK,GAE9BzB,EAAa,aAAa,oBAAqB0B,CAAM,EACrD1B,EAAa,aAAa,mBAAqB2B,CAAK,EACpD3B,EAAa,cAAc,kBAAkB,EAAE,UAAY,YAAY0B,CAAM,wBAAwBC,CAAK,UAE1GC,GAAeH,EAAMzB,CAAY,CACnC,CACF,CAEA,SAASwB,GAA4BxB,EAAcoB,EACnD,CACEpB,EAAa,aAAa,oBAAqBoB,CAAa,EAC5DpB,EAAa,cAAc,kBAAkB,EAAE,UAAY,YAAYoB,CAAa,aACtF,CAEA,eAAeQ,GAAeH,EAAMzB,EACpC,CACE,GAAIyB,EAAK,UAAY,OACrB,CACE,IAAMI,EAAa,IAAI,MACjBC,EAAa,IAAI,KAAK,CAAC,IAAI,WAAWL,EAAK,QAAQ,IAAI,EAAE,MAAM,EAAG,CAAE,KAAMA,EAAK,QAAQ,MAAO,CAAC,EAC/FM,EAAa,UAAU,IAAI,gBAAgBD,CAAS,CAAC,EAE3DD,EAAW,IAAME,EACjB,MAAMF,EAAW,OAAO,EAExB7B,EAAa,cAAc,sBAAsB,EAAE,IAAM+B,EACzD/B,EAAa,aAAa,2BAA4B+B,CAAQ,EAC9D/B,EAAa,aAAa,uBAAwB+B,CAAQ,CAC5D,CACF,CCzPA,IAAMC,GAAQC,EAAe,WAAW,EAE3BC,GAAS,CACpB,IAAO,EACP,IAAK,GACP,EAEMC,GAAO,CACX,KAAO,EACP,KAAO,EACP,MAAO,CACT,EAIA,IAAMC,GAAQ,CACZ,KAAa,EACb,YAAa,EACb,OAAa,CACf,EAEMC,GAAQ,CACZ,KAAQ,EACR,KAAQ,EACR,OAAQ,CACV,EAEMC,GAAoB,GAEpBC,GAAS,CACb,cAAiB,GACjB,eAAgB,GAClB,EAOaC,GAAqBC,GAClC,CACE,IAAMC,EAAgBD,EAClBE,EAAkBN,GAAM,KACxBO,EAAkBN,GAClBO,EAAkB,KAClBC,EAAkB,KAClBC,EAAkB,EAClBC,EAAkB,EAClBC,EAAkBC,GAAK,KACvBC,EAAkB,KAClBC,EAAkB,EAEtB,MAAO,CACL,UAAW,CAAE,OAAQT,IAAcN,GAAM,IAAO,EAChD,KAAAgB,EACA,MAAAC,EACA,KAAAC,EACA,KAAAC,CACF,EAEA,SAASH,EAAKI,EAAeC,EAAiBC,EAAY,KAC1D,CACE,OAAKhB,IAAcN,GAAM,MAAUuB,GAAoBD,CAAS,IAAM,IAEpEE,GAAM,IAAI,kBAAkBA,GAAM,eAAeX,GAAMO,CAAa,CAAC,iBAAiBE,CAAS,cAAcD,EAAgB,MAAM,QAAQG,GAAM,eAAezB,GAAOsB,EAAgB,KAAK,CAAC,WAAWA,EAAgB,IAAI,GAAG,EAE/Nf,EAAkBN,GAAM,KACxBW,EAAkBc,EAAS,SAAS,aACpCb,EAAkBQ,EAClBN,EAAkBO,EAElBZ,EAAa,UAAU,CAAC,EAEjB,IAGF,EACT,CAEA,SAASQ,GACT,CACMX,IAAcN,GAAM,OAEtBM,EAAYN,GAAM,OAElBQ,EAAc,YAAakB,GAC3B,CACE,IAAMC,EAAkBb,EAAW,QAAUf,GAAM,YAAeG,GAAO,cAAgBA,GAAO,eAChGa,GAAyBW,EAAuBC,GAAkB,IAClE,IAAMC,EAAiBpB,EAAc,YAAY,EAAIO,EAC/Cc,GAAiBD,EAAiBD,EAAiB,IAErDf,IAAaC,GAAK,KACpBH,EAAamB,GACNjB,IAAaC,GAAK,QACzBH,EAAckB,EAAgBd,EAAW,OAAUA,EAAW,OAASe,IAEzEL,GAAM,IAAI,4BAA4BT,EAAc,QAAQ,CAAC,CAAC,yBAAyBa,EAAc,QAAQ,CAAC,CAAC,sBAAsBlB,EAAW,QAAQ,CAAC,CAAC,0BAA0BiB,CAAc,KAAK,EAEvMpB,EAAa,YAAaO,EAAW,QAAUf,GAAM,YAAe+B,GAAiBC,GAAYJ,CAAc,CACjH,CAAC,EAEL,CAEA,SAAST,GACT,CACEM,GAAM,IAAI,uBAAuBA,GAAM,eAAexB,GAAOM,CAAS,CAAC,EAAE,EAErEA,IAAcN,GAAM,OAElBO,IAAeN,KAEjB,cAAcM,CAAU,EACxBA,EAAaN,IAGXO,IAAkB,OAEpBA,EAAc,MAAM,EACpBA,EAAc,OAAO,CAAC,EAGtB,WAAW,IACX,CACEA,EAAc,UAAUiB,EAAS,SAAS,YAAY,EACtDjB,EAAgB,IAClB,EACA,GAAG,GAGDC,IAAiB,OAGnBA,EAAa,UAAUE,CAAe,EACtCF,EAAe,MAGjBH,EAAkBN,GAAM,KACxBU,EAAkB,EAClBC,EAAkB,EAClBC,EAAkBC,GAAK,KACvBC,EAAkB,KAClBC,EAAkB,EAEtB,CAEA,SAASI,EAAKa,EACd,CACMxB,IAAkB,MACpBA,EAAc,KAAKwB,CAAO,CAC9B,CAEA,SAAST,GAAoBD,EAC7B,CAIE,OAHAd,EAAgBH,EAAQ,QACxBI,EAAiBa,IAAc,KAAQjB,EAAQ,KAAOA,EAAQ,mBAAmBiB,CAAS,EAEtF,GAAAd,EAAc,WAAW,GAAKC,EAAa,WAAW,EAI5D,CAKA,SAASqB,IACT,CACEtB,EAAc,YAAakB,GAC3B,CAEE,GAAInB,IAAeN,GACjB,OAGF,IAAMgC,EAAiBP,EAAuB,IAAQX,EAChDmB,EAAgBD,GAAY,EAAKA,EAAW,EAG5CE,GAAaxB,EAAmBA,GAAmBuB,EAAexB,GAClE0B,GAAcD,IAAUE,GAAO,IAAOF,GAASE,GAAO,IAEtDC,GAAgB,KAAK,MAAM,KAAK,KAAK3B,EAAkByB,EAAU,CAAC,EAClEG,GAAgB,KAAK,MAAM,KAAK,KAAK5B,GAAmBA,EAAkByB,GAAW,CAAC,EAEvFF,GAAgBxB,GAAgB0B,IAAcC,GAAO,KAASE,IAAgB5B,GAEjFH,EAAc,UAAU6B,GAAO,GAAG,EAClC5B,EAAa,UAAUE,CAAe,EACtCO,EAAK,IAILV,EAAc,UAAU8B,EAAa,EACrC7B,EAAa,UAAU8B,EAAY,EAEvC,CAAC,CACH,CAEA,SAASR,IACT,CACEvB,EAAc,YAAakB,GAC3B,CAEE,GAAInB,IAAeN,GACjB,OAEF,IAAMiC,EAAkBR,EAAuB,IAAQX,EACjDwB,EAAgB,KAAK,MAAM5B,GAAmBuB,EAAexB,EAAW,EACxE4B,GAAgB3B,EAAkB4B,EAEnCL,EAAexB,GAAgB4B,GAAgBD,GAAO,KAASE,EAAe5B,GAEjFH,EAAc,UAAU6B,GAAO,GAAG,EAClC5B,EAAa,UAAUE,CAAe,EACtCO,EAAK,IAILV,EAAc,UAAU8B,EAAa,EACrC7B,EAAa,UAAU8B,CAAY,EAEvC,CAAC,CACH,CACF,EClNA,IAAMC,GAAN,cAA4BC,EAC5B,CACEC,GAAe,GAEf,YAAYC,EACZ,CACE,MAAMC,EAAW,QAAS,KAAM,KAAMD,CAAc,CACtD,CAEA,eAAeE,EAAU,CAAE,KAAKH,GAAeG,CAAU,CAEzD,YACA,CACE,KAAKH,GAAe,GACpB,KAAK,UAAU,EAAK,CACtB,CAEA,aAAaI,EAAWC,EAAkB,EAC1C,CACE,YAAK,SAAS,aAAaD,EAAWC,CAAe,EACrD,KAAK,UAAU,EAAI,EAEZ,EACT,CAEA,cAAcD,EAAWC,EAAkB,EAC3C,CACE,YAAK,SAAS,cAAcD,EAAWC,CAAe,EACtD,KAAK,UAAU,EAAK,EAEb,EACT,CAEA,MACA,CACE,KAAK,UAAU,EAAK,EAEhB,KAAKL,KAAiB,IAExBM,GAAcJ,EAAW,QAAS,KAAKF,EAAY,EACnD,KAAKA,GAAe,IAIpB,KAAK,SAAS,UAAU,CAE5B,CAEA,OAAU,CAAE,KAAK,SAAS,WAAW,CAAO,CAC5C,MAAU,CAAE,KAAK,SAAS,UAAU,CAAQ,CAC5C,MAAU,CAAE,KAAK,SAAS,KAAK,CAAa,CAC5C,QAAU,CAAE,KAAK,SAAS,OAAO,CAAW,CAC5C,SAAU,CAAE,OAAO,KAAK,SAAS,QAAQ,CAAG,CAE5C,UAAUO,EACV,CACEA,EAAS,KAAK,SAAS,UAAU,CAAC,CACpC,CAEA,YAAYA,EACZ,CACEA,EAAS,KAAK,SAAS,eAAe,EAAG,KAAK,QAAQ,CACxD,CAEA,aAAaC,EACb,CACE,MAAM,aAAaC,GAAuBD,EAAa,aAAa,uBAAuB,CAAC,CAAC,CAC/F,CACF,EAOME,GAAN,cAA+BX,EAC/B,CACEY,GAAWC,GAAO,IAClBC,GAAW,GAEXC,GAAiB,CACf,OAAe,GACf,cAAe,GACf,aAAe,EACjB,EAEA,YAAYb,EACZ,CACE,MAAMC,EAAW,WAAY,KAAM,KAAMD,CAAc,CACzD,CAEA,YACA,CACE,KAAK,cAAc,EAAI,EACvB,KAAK,UAAU,EAAK,CACtB,CAEA,aAAaG,EAAWC,EAAkB,EAC1C,CACE,OAAAU,GAA8B,SAAS,EACvC,KAAK,UAAU,EAAI,EAEZ,IAAI,QAASC,GAAY,KAAK,SAAS,KAAK,WAAWZ,CAAS,GAAI,CAAC,GAAG,KAAKU,GAAgB,SAAU,IAAM,KAAKG,GAAoBZ,EAAiB,GAAOW,CAAO,CAAE,CAAC,CAAC,CAClL,CAEA,cAAcZ,EAAWC,EAAkB,EAC3C,CACE,OAAAU,GAA8B,SAAS,EACvC,KAAK,UAAU,EAAK,EAEb,IAAI,QAASC,GAAY,KAAK,SAAS,KAAK,WAAWZ,CAAS,GAAI,CAAC,GAAG,KAAKU,GAAgB,SAAU,IAAM,KAAKG,GAAoBZ,EAAiB,GAAMW,CAAO,CAAE,CAAC,CAAC,CACjL,CAEAC,GAAoBZ,EAAiBa,EAAWF,EAChD,CACE,KAAK,SAAS,YAAYG,GAC1B,CACE,KAAK,YAAY,KAAK,MAAMA,EAAuB,GAAI,CAAC,EACxD,KAAK,OAAOd,CAAe,EAE3B,KAAK,SAAS,gBAAiBe,GAC/B,CACE,KAAK,aAAa,KAAMA,CAAW,EACnCL,GAA8B,OAAO,EAEjCG,GACF,KAAKG,GAAiBD,CAAW,EAEnCJ,EAAQ,KAAK,WAAW,CAAC,CAC3B,CAAC,CACH,CAAC,CACH,CAEAK,GAAiBD,EACjB,CACO,KAAK,WAAW,IAAM,IAAWA,IAAgB,MAEpDd,GAAcJ,EAAW,UAAU,EACnC,KAAK,cAAc,EAAI,GAIvB,KAAK,SAAS,KAAK,CAEvB,CAEA,MACA,CACE,KAAK,UAAU,EAAK,EACpB,KAAK,SAAS,gBAAiBkB,GAAgB,KAAKC,GAAiBD,CAAW,CAAC,CACnF,CAEA,OAAQ,CAAE,KAAK,SAAS,MAAM,CAAG,CAEjC,MACA,CACE,KAAK,MAAM,EACX,MAAM,OAAO,CAAC,CAChB,CAGA,OAAOf,EACP,CACE,MAAM,OAAOA,EAAkB,GAAI,CACrC,CAEA,UAAUE,EACV,CACM,KAAKM,KAAa,IACpB,KAAK,SAAS,UAAUS,GAAUf,EAASe,CAAM,CAAC,CACtD,CAGA,UAAUA,EACV,CACMA,IAAW,IACb,KAAKX,GAAUW,IAEZ,KAAKT,KAAa,IAAWS,IAAW,IAC3C,MAAM,UAAUA,CAAM,CAC1B,CAEA,MACA,CACE,KAAKT,GAAW,GAChB,KAAK,UAAU,CAAC,CAClB,CAEA,QACA,CACE,KAAKA,GAAW,GAChB,KAAK,UAAU,KAAKF,EAAO,CAC7B,CAEA,SACA,CACE,OAAO,KAAKE,EACd,CAEA,YAAYN,EACZ,CACE,KAAK,SAAS,YAAYgB,GAAwBhB,EAAUgB,EAAuB,IAAO,KAAK,QAAQ,CAAC,CAC1G,CAEA,aAAaf,EAAcY,EAAc,KACzC,CACMA,IAAgB,KAEdZ,IAAiB,KACnB,MAAM,aAAa,CAAE,IAAKgB,EAAU,mBAAoB,MAAO,uBAAwB,CAAC,EAExF,MAAM,aAAa,CAAE,IAAK,UAAUhB,EAAa,aAAa,0BAA0B,CAAC,EAAG,MAAO,uBAAwB,CAAC,EAI9H,MAAM,aAAaiB,GAA0BL,CAAW,CAAC,CAE7D,CACF,EAOMM,GAAN,cAA0B3B,EAC1B,CACE,YAAYE,EACZ,CACE,MAAMC,EAAW,MAAO,KAAM,KAAMD,CAAc,CACpD,CAEA,YACA,CACA,CAEA,aAAaG,EAAWC,EAAkB,EAC1C,CACE,OAAAsB,GAAyB,CAAE,KAAM,MAAO,CAAC,EACzC,KAAK,SAAS,IAAcvB,EAC5B,KAAK,SAAS,YAAcC,EAC5B,KAAK,UAAU,EAAI,EAEZ,EACT,CAEA,cAAcD,EAAWC,EAAkB,EAC3C,CACE,OAAAsB,GAAyB,CAAE,KAAM,MAAO,CAAC,EACzC,KAAK,SAAS,IAAcvB,EAC5B,KAAK,SAAS,YAAcC,EAC5B,KAAK,KAAK,EACV,KAAK,UAAU,EAAK,EAEb,EACT,CAEA,MACA,CACE,KAAK,SAAS,KAAK,CACrB,CAEA,MACA,CACE,KAAK,SAAS,MAAM,EACpB,KAAK,SAAS,YAAc,CAC9B,CAEA,OAAU,CAAE,KAAK,SAAS,MAAM,CAAS,CACzC,MAAU,CAAE,KAAK,SAAS,MAAQ,EAAO,CACzC,QAAU,CAAE,KAAK,SAAS,MAAQ,EAAO,CACzC,SAAU,CAAE,OAAO,KAAK,SAAS,KAAQ,CAEzC,YAAYE,EACZ,CACEA,EAAS,KAAK,MAAM,KAAK,SAAS,WAAW,EAAG,KAAK,QAAQ,CAC/D,CAEA,aACA,CACE,OAAO,KAAK,MAAM,KAAK,SAAS,QAAQ,CAC1C,CAEA,OAAOF,EACP,CACE,KAAK,SAAS,YAAcA,CAC9B,CAEA,UAAUE,EACV,CAEEA,EAAS,KAAK,MAAM,KAAK,SAAS,OAAS,GAAG,CAAC,CACjD,CAEA,UAAUe,EACV,CAEE,KAAK,SAAS,OAAUA,EAAS,GACnC,CAEA,aAAad,EACb,CACE,MAAM,aAAa,CAAE,IAAK,UAAUA,EAAa,aAAa,0BAA0B,CAAC,EAAG,MAAO,kBAAmB,CAAC,CACzH,CACF,EAOaoB,GAAN,KACP,CACEC,GAAoB,KACpBC,GAAoB,KACpBC,GAAoB,KACpBC,GAAoB,KAEpB,YAAYC,EAAeC,EAAkBC,EAC7C,CACE,KAAKN,GAAoB,IAAI/B,GAAcmC,CAAa,EACxD,KAAKH,GAAoB,IAAIpB,GAAiBwB,CAAgB,EAC9D,KAAKH,GAAoB,IAAIL,GAAYS,CAAW,CACtD,CAEA,IAAI,SAAU,CAAE,OAAO,KAAKH,EAAgB,CAE5C,iBAAiBI,EACjB,CACE,OAAQA,EACR,CACE,KAAKlC,EAAW,QAAY,KAAK8B,GAAiB,KAAKH,GAAmB,MAC1E,KAAK3B,EAAW,WAAY,KAAK8B,GAAiB,KAAKF,GAAmB,MAC1E,KAAK5B,EAAW,MAAY,KAAK8B,GAAiB,KAAKD,GAAmB,KAC5E,CACF,CAEA,aAAa1B,EAAkB,EAC/B,CACE,MAAO,CACL,aAAc,EACd,UAAc,EACd,OAAc,KAAK2B,GAAe,UAAU,EAC5C,MAAc,KAAKA,GAAe,SAAS,EAC3C,SAAc3B,EACd,SAAc,KAAK2B,GAAe,YAAY,EAC9C,UAAc,CAAE,IAAK,KAAKA,GAAe,gBAAgB,EAAG,MAAO,KAAKA,GAAe,kBAAkB,CAAE,CAC7G,CACF,CACF,EC5WA,IAAMK,GAAQC,EAAe,aAAa,EAOpCC,GAAN,KACA,CACE,OAAS,CAEP,QAAS,KAET,QAAY,EACZ,WAAY,EACZ,MAAY,EACZ,UAAY,GAGZ,MAAU,IACZ,EAEA,MAAQ,CAEN,QAAiB,KAEjB,YAAiB,GACjB,gBAAiB,GACjB,YAAkB,EAClB,cAAkB,EAClB,aAAkB,EAClB,gBAAkB,EAClB,WAAkB,EAClB,gBAAiB,GACjB,aAAiB,GACjB,gBAAiB,GAIjB,YAAiB,IACnB,EAEAC,GAAc,CAAC,EACfC,GAAc,EACdC,GAAc,EACdC,GAAc,EAEd,YAAYC,EAAa,GACzB,CACE,KAAKH,GAAcG,CACrB,CAEA,IAAIC,EAAc,KAAK,OAAO,QAASC,EAAY,KAAK,MAAM,QAASC,EAAM,KAAMC,EAAY,KAAK,IAAI,EACxG,CACM,KAAKR,GAAK,QAAU,KAAKC,IAC3B,KAAKD,GAAK,MAAM,EAElB,KAAKA,GAAK,KAAK,CACb,YAAaK,EACb,UAAaC,EACb,IAAaC,EACb,UAAaC,CACf,CAAC,CACH,CAEA,OAAa,CAAE,KAAKR,GAAO,CAAC,CAAS,CACrC,YAAa,CAAE,OAAO,KAAKG,EAAU,CAErC,WACA,CACE,KAAKA,GAAc,KAAKH,GAAK,OAAS,EACtC,KAAKE,GAAc,CACrB,CAEA,aAAaO,EAAOJ,EAAaC,EAAWC,EAAM,KAClD,CACO,KAAKP,GAAK,KAAKG,GAAWM,CAAK,EAAE,cAAgBJ,GACjD,KAAKL,GAAK,KAAKG,GAAWM,CAAK,EAAE,YAAgBH,GACjD,KAAKN,GAAK,KAAKG,GAAWM,CAAK,EAAE,MAAgBF,GAEpD,KAAKL,IAET,CAEA,aAAaQ,EAAUC,EACvB,CACO,KAAKX,GAAK,KAAKG,EAAQ,EAAE,UAAY,KAAKH,GAAK,KAAKG,GAAWO,CAAQ,EAAE,WAAcC,GAC1F,KAAKT,IACT,CAEA,eAAeU,EAAYC,EAC3B,CACE,OAAI,KAAKX,KAAgBU,GAEvBf,GAAM,IAAI,cAAcgB,CAAK,EAAE,EAC/B,KAAK,cAAc,EAEZ,IAGF,EACT,CAEA,eACA,CACE,IAAMC,EAAU,CAAC,EAEjB,KAAKd,GAAK,QAASe,GACnB,CACED,EAAQ,KAAK,CACX,YAAajB,GAAM,eAAe,KAAK,OAAQkB,EAAM,WAAW,EAChE,UAAalB,GAAM,eAAe,KAAK,MAAQkB,EAAM,SAAS,EAC9D,IAAaA,EAAM,IACnB,UAAaA,EAAM,SACrB,CAAC,CACH,CAAC,EAEDlB,GAAM,IAAIiB,CAAO,CACnB,CACF,EAOaE,GAAN,cAA0BjB,EACjC,CACE,kBAAkBQ,EAAKU,EACvB,CACE,YAAK,UAAU,EAEX,KAAK,WAAW,GAAK,IAEvB,KAAK,aAAa,EAAG,KAAK,OAAO,UAAY,KAAK,MAAM,gBAAiB,IAAI,EAC7E,KAAK,aAAa,EAAG,KAAK,OAAO,WAAY,KAAK,MAAM,cAAiBV,CAAG,EAC5E,KAAK,aAAa,EAAG,KAAK,OAAO,WAAY,KAAK,MAAM,aAAiBA,CAAG,EAC5E,KAAK,aAAa,EAAG,KAAK,OAAO,WAAY,KAAK,MAAM,aAAiBA,CAAG,EAC5E,KAAK,aAAa,EAAGU,CAAS,GAGzB,KAAK,eAAe,EAAG,6BAA6B,CAC7D,CAEA,oBAAoBV,EAAKU,EACzB,CACE,YAAK,UAAU,EAEX,KAAK,WAAW,GAAK,IAEvB,KAAK,aAAa,EAAG,KAAK,OAAO,UAAY,KAAK,MAAM,gBAAiB,IAAI,EAC7E,KAAK,aAAa,EAAG,KAAK,OAAO,WAAY,KAAK,MAAM,cAAiBV,CAAG,EAC5E,KAAK,aAAa,EAAG,KAAK,OAAO,WAAY,KAAK,MAAM,cAAiBA,CAAG,EAC5E,KAAK,aAAa,EAAGU,CAAS,GAGzB,KAAK,eAAe,EAAG,gCAAgC,CAChE,CACF,EAEaC,GAAN,cAA6BnB,EACpC,CACE,cAAcM,EAAaC,EAAWW,EACtC,CACE,YAAK,UAAU,EAEX,KAAK,WAAW,GAAK,IAEvB,KAAK,aAAa,EAAGZ,EAAaC,CAAS,EAC3C,KAAK,aAAa,EAAGD,EAAaC,CAAS,EAC3C,KAAK,aAAa,EAAGW,CAAS,GAGzB,KAAK,eAAe,EAAG,GAAGpB,GAAM,eAAe,KAAK,OAAQQ,CAAW,CAAC,iBAAiB,CAClG,CACF,ECpKA,IAAMc,EAAQC,EAAe,kBAAkB,EAClCC,EAAW,IAAIC,GAAY,EAAE,EAEpCC,EAAI,CACR,QAAmB,KACnB,aAAmB,KACnB,eAAmB,KACnB,kBAAmBC,EAAW,KAC9B,kBAAmB,EACrB,EAOO,SAASC,GAAoBC,EAAcC,EAAgBC,EAClE,CACET,EAAM,IAAI,QAAQ,EAElBI,EAAE,aAAoBG,EACtBH,EAAE,eAAoBI,EACtBJ,EAAE,kBAAoBK,EAEtB,OAAO,wBAA0B,IACjC,CACET,EAAM,IAAI,2BAA2B,EAErCI,EAAE,QAAU,IAAIM,GAAYC,GAAkB,EAAGC,GAAqB,EAAGC,GAAgB,CAAC,EAC1Fb,EAAM,IAAII,EAAE,OAAO,EAEFU,GAAMC,GAAoBX,EAAE,QAAQ,aAAaW,CAAe,EAAIA,GAAoBX,EAAE,QAAQ,QAAQ,OAAOW,CAAe,CAAC,EACnIC,EAAwBC,EAAM,iBAAkB,CAAE,eAAgB,EAAG,CAAC,CACvF,EAEA,IAAMC,EAAM,SAAS,cAAc,QAAQ,EAC3CA,EAAI,GAAQ,qBACZA,EAAI,IAAQ,qCACZ,IAAMC,EAAiB,SAAS,qBAAqB,QAAQ,EAAE,CAAC,EAChEA,EAAe,WAAW,aAAaD,EAAKC,CAAc,CAC5D,CAOO,SAASC,GAAcC,EAAWC,EAAW,EACpD,CACE,GAAID,IAAchB,EAAW,QAE3BD,EAAE,QAAQ,QAAQ,eAAekB,CAAQ,UAElCD,IAAchB,EAAW,WAClC,CAGE,GAAID,EAAE,oBAAsB,GAC1B,OAEFA,EAAE,QAAQ,QAAQ,cAAc,EAAK,EACxBmB,GAAqBC,EAAM,MAAM,CAChD,CAEAxB,EAAM,IAAI,iBAAkBsB,IAAa,EAAKA,EAAW,EAAE,kBAAkBtB,EAAM,eAAeK,EAAYgB,CAAS,CAAC,eAAejB,EAAE,cAAc,cAAcA,EAAE,QAAQ,QAAQ,OAAO,CAAC,EAAE,EAElLY,EAAwBC,EAAM,iBAAiB,CAChE,CAEA,SAASQ,IACT,CACMrB,EAAE,oBAAsB,KAE1BJ,EAAM,IAAI,0BAA0BA,EAAM,eAAeK,EAAYD,EAAE,QAAQ,QAAQ,aAAa,CAAC,CAAC,EAAE,EAExGA,EAAE,kBAAoB,IAEjBA,EAAE,cAAc,UAAY,KAAO,IAEvBY,EAAwBC,EAAM,iBAAkB,CAAE,eAAgB,GAAI,CAAC,EAEtF,WAAW,IACX,CACwBS,GAAmB,IAAM,KAA0BC,EAAU,IAAM,IACxEX,EAAwBC,EAAM,iBAAkB,CAAE,eAAgB,CAAE,CAAC,CACxF,EACA,GAAG,GAGAb,EAAE,cAAc,WAAa,IAAUA,EAAE,oBAAsBC,EAAW,YAC7EH,EAAS,IAAIA,EAAS,OAAO,UAAWA,EAAS,MAAM,eAAe,EAExEE,EAAE,aAAe,KAErB,CAEA,SAASwB,GAAcP,EACvB,CACErB,EAAM,IAAI,oBAAoBA,EAAM,eAAeK,EAAYgB,CAAS,CAAC,EAAE,EAEvEA,IAAcjB,EAAE,mBAClByB,GAAuBzB,EAAE,QAASiB,CAAS,CAC/C,CAEA,SAASS,IACT,CACiBd,EAAwBC,EAAM,aAAa,CAC5D,CAEA,SAASc,IACT,CACiBf,EAAwBC,EAAM,aAAa,CAC5D,CAEA,SAASe,IACT,CACiBhB,EAAwBC,EAAM,YAAY,CAC3D,CAEA,SAASgB,IACT,CACiBjB,EAAwBC,EAAM,WAAW,CAC1D,CAEA,SAASiB,IACT,CACiBlB,EAAwBC,EAAM,gBAAgB,CAC/D,CAEA,SAASkB,IACT,CACEnC,EAAM,IAAI,uBAAuBA,EAAM,eAAeK,EAAYD,EAAE,QAAQ,QAAQ,aAAa,CAAC,CAAC,qBAAqBgC,EAAS,SAAS,YAAY,kBAAkBA,EAAS,SAAS,UAAU,EAAE,EAEtMA,EAAS,SAAS,WAAahC,EAAE,QAAQ,QAAQ,KAAK,EAAIA,EAAE,QAAQ,QAAQ,OAAO,EACnFA,EAAE,QAAQ,QAAQ,UAAUgC,EAAS,SAAS,YAAY,CAC5D,CAOA,SAASzB,IACT,CAgBE,OAde,IAAI,GAAG,OAAO,iBAC7B,CACE,OACA,CACE,QAAmB,IAAMiB,GAAcvB,EAAW,OAAO,EACzD,cAAmBgC,GACnB,QAAoBC,GAAUlB,GAAcf,EAAW,QAASiC,EAAM,IAAI,EAC1E,kBAAmBJ,EACrB,EACA,WAAY,CACV,UAAa,CACf,CACF,CAAC,CAGH,CAEA,SAASG,GAA2BC,EACpC,CACE,GAAIlC,EAAE,QAAQ,QAAQ,aAAa,IAAMC,EAAW,QAWpD,OAPAL,EAAM,IAAI,+BAA+BA,EAAM,eAAe,GAAG,YAAasC,EAAM,IAAI,CAAC,cAAclC,EAAE,cAAc,GAAG,EAItHkC,EAAM,OAAS,GAAG,YAAY,SACfC,GAAc,EAEzBD,EAAM,KACd,CAEE,KAAK,GAAG,YAAY,UAClBb,GAAoB,EACpB,MAGF,KAAK,GAAG,YAAY,UAClBK,GAAe,EACfK,GAAoB,EACpB,MAEF,KAAK,GAAG,YAAY,QAASJ,GAAe,EAAG,MAC/C,KAAK,GAAG,YAAY,OAASC,GAAc,EAAI,MAC/C,KAAK,GAAG,YAAY,MAASC,GAAa,EAAK,KACjD,CACF,CAOA,SAASrB,IACT,CACE,IAAM4B,EAAS,GAAG,OAAO,mBAAmB,EAC5C,OAAAA,EAAO,KAAK,GAAG,OAAO,OAAO,MAAO,IAAMC,GAAwBD,CAAM,CAAC,EAClEA,CACT,CAEA,SAASC,GAAwBD,EACjC,CAEEA,EAAO,KAAK,GAAG,OAAO,OAAO,KAAQ,IAAME,GAA8B,SAAS,CAAC,EACnFF,EAAO,KAAK,GAAG,OAAO,OAAO,MAAQ,IAAME,GAA8B,QAAQ,CAAC,EAClFF,EAAO,KAAK,GAAG,OAAO,OAAO,OAAQ,IAAME,GAA8B,OAAO,CAAC,EACjFF,EAAO,KAAK,GAAG,OAAO,OAAO,MAAQ,IAAMpB,GAAcf,EAAW,UAAU,CAAC,EAG/EuB,GAAcvB,EAAW,UAAU,CACrC,CAEO,SAASqC,GAA8BC,EAC9C,CACE,GAAIvC,EAAE,QAAQ,QAAQ,aAAa,IAAMC,EAAW,WAUpD,OAPAL,EAAM,IAAI,kCAAkC2C,EAAY,YAAY,CAAC,cAAcvC,EAAE,cAAc,GAAG,EAIlGuC,IAAgB,WACDJ,GAAc,EAEzBI,EACR,CACE,IAAK,QACH,CACElB,GAAoB,EACpBU,GAAoB,EAEpB,IAAMS,EAA4BC,EAAuB,EAEzDD,EAAa,aAAa,sBAAuBxC,EAAE,QAAQ,QAAQ,YAAY,CAAC,EAChFwC,EAAa,cAAc,oBAAoB,EAAE,YAAcE,EAAc1C,EAAE,QAAQ,QAAQ,YAAY,CAAC,EAC5GwC,EAAa,aAAa,2BAA4BxC,EAAE,QAAQ,QAAQ,gBAAgB,CAAC,EACzFwC,EAAa,cAAc,sBAAsB,EAAE,IAAMxC,EAAE,QAAQ,QAAQ,gBAAgB,EAE1E2C,GAAgB,CAAC,CACpC,CACA,MAEF,IAAK,UACH7C,EAAS,IAAIA,EAAS,OAAO,WAAYA,EAAS,MAAM,cAAeE,EAAE,cAAc,EACvF2B,GAAe,EACf,MAEF,IAAK,SAED7B,EAAS,IAAIA,EAAS,OAAO,WAAYA,EAAS,MAAM,aAAcE,EAAE,cAAc,EAElFF,EAAS,kBAAkBE,EAAE,eAAgB,GAAI,EACnD8B,GAAkB,EAElBF,GAAc,EAElB,MAEF,IAAK,UAAWF,GAAe,EAAG,MAClC,IAAK,QAAWG,GAAa,EAAK,KACpC,CACF,CAOA,SAASpB,IACT,CACE,GAAIuB,EAAS,KAAK,oBAClB,CACEY,GAAgB,EAEhB,IAAMR,EAAS,SAAS,eAAe,oBAAoB,EAE3D,OAAAA,EAAO,iBAAiB,OAAkBS,EAAwB,EAClET,EAAO,iBAAiB,QAAkBS,EAAwB,EAClET,EAAO,iBAAiB,QAAkBS,EAAwB,EAClET,EAAO,iBAAiB,iBAAkBS,EAAwB,EAE3DT,CACT,CACF,CAEO,SAASS,GAAyBX,EACzC,CACE,GAAIlC,EAAE,QAAQ,QAAQ,aAAa,IAAMC,EAAW,MAKpD,OAFAL,EAAM,IAAI,6BAA6BsC,EAAM,KAAK,YAAY,CAAC,cAAclC,EAAE,cAAc,GAAG,EAExFkC,EAAM,KACd,CACE,IAAK,iBACH,CACE,IAAMY,EAAW,KAAK,MAAM9C,EAAE,QAAQ,QAAQ,YAAY,CAAC,EAE3DA,EAAE,QAAQ,QAAQ,YAAY8C,CAAQ,EACzBL,EAAuB,EAAE,aAAa,sBAAuBK,CAAQ,EACrEL,EAAuB,EAAE,cAAc,oBAAoB,EAAE,YAAcC,EAAcI,CAAQ,EAC7FH,GAAgB,CAAC,CACpC,CACA,MAEF,IAAK,OAASZ,GAAoB,EAAG,MACrC,IAAK,OAASJ,GAAe,EAAQ,MACrC,IAAK,QAASC,GAAc,EAAS,MACrC,IAAK,QAASC,GAAa,EAAU,KACvC,CACF,ClBtSA,IAAMkB,GAAQC,EAAe,eAAe,EAEtC,EAAI,CACR,SAAmB,KACnB,QAAmB,KACnB,aAAmB,KACnB,eAAmB,KACnB,kBAAmB,GACnB,kBAAmB,CACrB,EAOO,SAASC,IAChB,CACEF,GAAM,IAAI,QAAQ,EAElB,EAAE,SAAWG,EAEAD,GAAK,EAClBE,GAAgB,EAChBC,GAAgB,EAChBC,GAAoB,EAAE,aAAc,EAAE,eAAgBC,GAAuB,EAAE,cAAc,CAAC,CAChG,CAEA,SAASF,IACT,CAKE,GAJA,EAAE,eAA8BG,GAAkB,EAClD,EAAE,aAAiB,KAAK,MAAM,eAAe,QAAQC,EAAI,WAAW,CAAC,EACrE,eAAe,WAAWA,EAAI,WAAW,EAEpC,EAAE,eAAiB,MAAU,EAAE,aAAa,UAAY,KAC7D,CACE,IAAMC,EAA4BC,GAAW,mBAAmB,EAAE,aAAa,OAAO,IAAI,EAEtFD,IAAiB,KACnB,EAAE,eAAiBA,EAAa,GAEhCE,EAAa,CAAE,QAAS,kCAAmC,SAAU,CAAE,CAAC,CAC5E,CAEaP,GAAgB,EAAE,cAAc,EAE7C,IAAMQ,EAAkBb,GAAM,eAAec,EAAYP,GAAuB,EAAE,cAAc,CAAC,EACjGP,GAAM,IAAI,kCAAkCa,CAAe,sBAAsB,EAAE,cAAc,oBAAqB,EAAE,eAAiB,KAAQ,KAAK,UAAU,EAAE,YAAY,EAAI,KAAK,EAAE,CAC3L,CAOO,SAASE,EAAgBC,EAAaC,EAAY,GAAMC,EAAiB,GAChF,CACE,IAAMC,EAAgBZ,GAAuBS,CAAW,EAExDhB,GAAM,IAAI,sCAAsCA,GAAM,eAAec,EAAYK,CAAa,CAAC,mBAAmBH,CAAW,iBAAiBC,CAAS,sBAAsBC,CAAc,EAAE,EAEzLF,IAAgB,EAAE,eAEpBI,GAAgB,GAIKC,EAAU,GAAM,EAAE,QAAQ,QAAQ,aAAa,IAAMF,GACxE,EAAE,QAAQ,QAAQ,KAAK,EAEzB,EAAE,eAAiBH,EAEf,EAAE,QAAQ,QAAQ,aAAa,IAAMG,IAEvC,EAAE,QAAQ,iBAAiBA,CAAa,EAC3BG,GAAoBH,CAAa,GAGjCI,EAAwBC,EAAM,gBAAiB,CAAE,QAASR,EAAa,eAAgBE,CAAe,CAAC,EACtHO,GAAsBR,CAAS,EAEnC,CAEA,eAAeQ,GAAsBR,EAAWS,EAAkB,EAClE,CACE,IAAMC,EAAwBC,EAAuB,EAAE,aAAa,uBAAuB,EAE3F5B,GAAM,IAAI,sCAAsC,EAAE,cAAc,iBAAiB2B,CAAQ,mBAAmBV,CAAS,gBAAgBS,CAAe,EAAE,EAEzIG,GAAmB,EAAE,QAAQ,OAAO,EAChCC,GAAgBJ,CAAe,EAEhD,EAAE,QAAQ,QAAQ,WAAW,EAEzBT,EAEE,MAAM,EAAE,QAAQ,QAAQ,cAAcU,EAAUD,CAAe,GACpDK,GAAqBC,EAAM,QAAS,EAAI,GAInD,MAAM,EAAE,QAAQ,QAAQ,aAAaL,EAAUD,CAAe,GACnDK,GAAqBC,EAAM,OAAQ,EAAI,EAElDN,IAAoB,GACLO,GAAwBP,EAAkB,IAAOA,EAAiB,EAAE,QAAQ,QAAQ,YAAY,CAAC,EAExH,CAOO,SAASQ,IAChB,CACE,EAAE,QAAQ,QAAQ,KAAK,CACzB,CAEO,SAASC,IAChB,CACE,EAAE,QAAQ,QAAQ,MAAM,CAC1B,CAEO,SAASf,IAChB,CACM,EAAE,iBAAmB,KACvBL,EAA6BJ,GAAW,yBAAyB,EAAE,EAAE,EAEpDU,EAAU,EAAIc,GAAM,EAAID,GAAK,CAClD,CAEO,SAASE,IAChB,CACE,EAAE,QAAQ,QAAQ,UAAUC,EAAS,SAAS,YAAY,CAC5D,CAEO,SAASC,IAChB,CACED,EAAS,SAAS,WAAcA,EAAS,SAAS,aAAe,GACjEA,EAAS,SAAS,WAAa,EAAE,QAAQ,QAAQ,KAAK,EAAI,EAAE,QAAQ,QAAQ,OAAO,CACrF,CAEO,SAASE,IAChB,CACE,IAAMC,EAA2BC,GAAkB,EAEnD,EAAE,QAAQ,QAAQ,YAAaC,GAC/B,CACOF,IAAgB,MAAUE,GAAY,EAEzC3B,EAAgByB,EAA8BnB,EAAU,CAAC,EAElDqB,IAAa,IAEpB,EAAE,QAAQ,QAAQ,OAAO,CAAC,EACTT,GAAuB,EAAG,EAAG,EAAE,QAAQ,QAAQ,YAAY,CAAC,EAEjF,CAAC,CACH,CAEO,SAASU,IAChB,CACE,IAAM3B,EAA2BR,GAAkB,EAE/CQ,IAAgB,MAClBD,EAAgBC,EAA8BK,EAAU,CAAC,CAC7D,CAEA,eAAsBuB,GAAmBC,EAAW,GAAOC,EAAkB,GAC7E,CACE,IAAMC,EAAcD,EAAmCE,GAAO,IAAuBC,GAAc,EAC7FjC,EAA2BR,GAAkB,EAInD,GAFAR,GAAM,IAAI,oCAAoC6C,CAAQ,uBAAuBC,CAAe,mBAAmB9B,CAAW,kBAAkBhB,GAAM,eAAgCgD,GAAQD,CAAU,CAAC,EAAE,EAEnMF,GAAaE,IAAgCC,GAAO,IAEtD,EAAE,QAAQ,QAAQ,OAAO,CAAC,EAC1B,EAAE,QAAQ,QAAQ,KAAK,UAEhBH,GAAa7B,IAAgB,MAAU+B,IAAgCC,GAAO,IAErFjC,EAA6BP,GAAkB,IAAI,CAAC,EACpD0C,GAAe,CAAC,UAIZlC,IAAgB,KAElB,GAAIqB,EAAS,KAAK,mBAClB,CACE,IAAMc,EAAe,MAAmBC,GAAe,EAEnDP,GAAYM,GACdpC,EAA6BP,GAAkB,CAAC,CACpD,MAGE6C,GAAcC,EAAS,SAAUT,CAAQ,OAK3CA,EAAW9B,EAAgBC,CAAW,EAAiBe,GAAqBC,EAAM,MAAM,CAG9F,CAEO,SAASuB,IAChB,CACuBlC,EAAU,IAAM,KAEnC,EAAE,SAAS,IAAI,EAAE,SAAS,OAAO,UAAW,EAAE,SAAS,MAAM,eAAe,EAC5EuB,GAAmB,GAAM,EAAI,EAEjC,CAEO,SAASY,IAChB,CACE,EAAE,eAAiB,KACNzB,GAAqBC,EAAM,MAAM,CAChD,CAEO,SAASyB,GAAUC,EAAqB,GAC/C,CACE,IAAIC,EAAsB,KAM1B,GAJC,EAAE,iBAAmB,KAClBA,EAAmCC,GAAa,EAAE,cAAc,EAChED,EAAmChD,GAAW,yBAAyB,EAEvEgD,IAAwB,KAC5B,CACE,IAAIE,EAAoB,EAExB,GAAIH,EACJ,CACE,IAAMI,EAA6BC,GAAc,iBAAiB,EAClEF,EAAoB,MAAM,UAAU,QAAQ,KAAKC,EAAeH,CAAmB,EACnF3D,GAAM,IAAI,kCAAkC6D,EAAoB,CAAC,eAAeF,EAAoB,aAAa,eAAe,CAAC,EAAE,CACrI,CAEA,IAAMK,EAAmB,CAAE,GAAI,iBAAkB,oBAAqB,cAAe,EAE/EC,EAAS,CACb,UAAiC5C,EAAU,EAC3C,aAAiBwC,EAAoB,EACrC,UAAgB,EAAE,QAAQ,QAAQ,aAAa,EAC/C,SAAgB,EAChB,UAAgB,EAChB,QAAgBF,EAAoB,aAAa,eAAe,EAChE,eAAgBA,EAAoB,GACpC,SAAgBK,EAAiB,EAAE,QAAQ,QAAQ,aAAa,CAAC,CACnE,EAEA,OAAIN,EAEK,IAAI,QAASQ,GACpB,CACE,EAAE,QAAQ,QAAQ,YAAaxC,GAC/B,CACEuC,EAAO,SAAW,KAAK,MAAMvC,CAAe,EAC5CwC,EAAQD,CAAM,CAChB,CAAC,CACH,CAAC,EAGIA,CACT,CAEA,MAAO,CAAE,UAAW,GAAO,aAAc,EAAG,SAAU,EAAG,QAAS,CAAE,CACtE,CAOO,SAASE,GAAuBC,EAASC,EAChD,CACErE,GAAM,IAAI,6BAA6BA,GAAM,eAAec,EAAYuD,CAAgB,CAAC,EAAE,EAE3F,EAAE,QAAUD,EAEGE,EAA2B9C,EAAM,cAAmB+C,EAAc,EAClED,EAA2B9C,EAAM,YAAmB,IAAMoB,GAAmBP,EAAS,SAAS,QAAQ,CAAC,EACxGiC,EAA2B9C,EAAM,kBAAmBgD,EAAkB,EACtEF,EAA2B9C,EAAM,iBAAmBiD,EAAiB,EAEnEC,GAAMnC,GAAWnB,GAAiBuB,GAAWL,EAAU,EACzDf,EAAwBC,EAAM,iBAAkB,CAAE,eAAgB,EAAG,CAAC,EAErFmD,GAAc,MAAM,EAAE,OAAO,EAChBD,GAAM,EAEnB,EAAE,QAAQ,iBAAiBL,CAAgB,EAC9B/C,GAAoB+C,CAAgB,EAElC9C,EAAwBC,EAAM,eAAgB,CAAE,iBAAkB,EAAM,CAAC,EACxFC,GAAuB,EAAE,cAAc,WAAa,GAAQ,EAAE,cAAc,UAAY,CAAE,CAC5F,CAEA,SAAS8C,IACT,CACEK,GAAgB,EAAE,iBAAiB,EAE/B,EAAE,oBAEJ,EAAE,kBAAoB,GAEtB,WAAW,IACX,CACMvC,EAAS,SAAS,UACDhB,EAAU,GAC1B,KAAK,MAAM,OAAO,OAAO,GAAK,GAC/BwD,GAAaC,EAAM,qBAAqB,GAE1C5B,GAAe,CAAC,CAEpB,EACA,GAAI,EAER,CAEA,SAASsB,IACT,CACM,EAAE,QAAQ,QAAQ,OAAO,IAAM,KAEhBO,GAAsB,CAAC,EAC3BC,GAAgB,QAAQ,EAErCpE,EAAa,CACX,QAAS,yCACT,SAAU,EACV,WAAY,OACZ,oBAAqB4C,GACrB,mBAAqBD,EACvB,CAAC,EAEL,CAEA,SAASkB,IACT,CACe1C,GAAqBC,EAAM,MAAM,EAE9C,EAAE,kBAAoBpB,EAAa,CACjC,QAAS,qCACT,SAAU,EACV,WAAY,OACZ,oBAAqB,IAAMsB,GAAK,CAClC,CAAC,CACH,CmB9VA,IAAM+C,GAAI,CACR,cAAe,KACf,cAAe,KACf,WAAe,EACf,YAAe,IACjB,EAOA,eAAsBC,IACtB,CACE,IAAMC,EAAYC,GAAaC,EAAU,CAAC,EAEtCF,EAAU,OAAS,GAErBF,GAAE,cAAgBK,GAAU,CAC1B,WAAYC,GAASF,EAAU,CAAC,EAChC,UAAYF,EACZ,UAAY,YACZ,qBAAuBK,GAAcC,GAAaN,EAAWK,CAAS,EACtE,qBAAuBE,GAAcC,GAAiBD,CAAK,CAC7D,CAAC,EAEDE,GAAiB,EACjBC,GAAqB,EAGhB,iBAAkB,QAAYZ,GAAE,gBAAkB,OACrDA,GAAE,cAAgB,MAAM,OAAO,GAAGa,EAAmB,sCAAsCC,EAAO,MAIpGC,EAAa,CACX,QAAS,4BACT,SAAU,EACV,WAAY,UACZ,oBAAqB,IAAMC,GAAkB,CAC/C,CAAC,CAEL,CAEA,SAASR,GAAaN,EAAWK,EACjC,CACE,IAAMU,EAAcf,EAAU,KAAKgB,GAASA,EAAK,UAAYX,CAAU,EAAE,QAEpEU,IAAgBE,EAAuB,EAAE,IAAOf,EAAU,EAC7De,EAAuB,EAAE,eAAe,CAAE,SAAUC,GAAkB,EAAG,MAAO,QAAS,CAAC,EAE1FC,EAAgBJ,EAAa,GAAM,EAAK,CAC5C,CAEA,SAASP,GAAiBD,EAC1B,CACE,OAAIA,EAAM,OAAO,QAAQ,eAAe,EAC/B,GACA,EAAAA,EAAM,OAAO,UAAU,SAAS,uBAAuB,CAIlE,CAEO,SAASa,GAAkBC,EAClC,CACE,GAAIC,GAAexB,GAAE,aAAa,EAClC,CACEyB,GAAiBzB,GAAE,cAAeM,GAASiB,CAAc,CAAC,EAC1DZ,GAAiB,EAEjB,IAAMe,EAAaC,GAAc,CAAC,EAE9BD,EAAW,aAAa,eAAe,IAAMP,EAAuB,EAAE,IAExEO,EAAW,UAAU,OAAO,gBAAiB,YAAY,EACzDA,EAAW,UAAU,IAAI,GAAGH,EAAiB,gBAAkB,YAAY,EAAE,EAC7EG,EAAW,MAAQ,GAAGH,EAAiB,cAAgB,YAAY,KAInEK,GAAgB5B,GAAE,cAAeG,GAAaoB,CAAc,CAAC,EAC7DX,GAAqB,EAEzB,CACF,CAEA,SAASN,GAASiB,EAClB,CACE,MAAgB,GAAGA,EAAiB,UAAY,MAAM;AAAA;AAAA,6BAE3BM,EAAS,SAAS,SAAW,KAAO,KAAK,aACtE,CAEA,SAAS1B,GAAaoB,EACtB,CACE,IAAMrB,EAAa,CAAC,EAChB4B,EAAeX,EAAuB,EAE1CjB,EAAU,KAAK,CACb,QAAS4B,EAAa,GACtB,MAAS,mBAAmBP,EAAiB,gBAAkB,YAAY,GAC3E,MAAS,GAAGA,EAAiB,cAAgB,YAAY,GACzD,QAASQ,GAAmBD,EAAc,oBAAqB,kBAAkB,CACnF,CAAC,EAED5B,EAAU,KAAK,CAAE,MAAO,eAAgB,QAAS,2DAA4D,CAAC,EAE9G,QAAS8B,EAAI,EAAGA,EAAI,KAElBF,EAAeG,GAAaC,GAAkBJ,CAAY,CAAC,EAEvDA,IAAiB,MAJCE,IAOtB9B,EAAU,KAAK,CACb,QAAS4B,EAAa,GACtB,MAAS,kBACT,QAASC,GAAmBD,EAAc,oBAAqB,mBAAoB,EAAI,CACzF,CAAC,EAGH,OAAO5B,CACT,CAEA,SAASS,IACT,CACEwB,GAAoB,EAAE,cAAc,0BAA0B,EAAE,iBAAiB,QAAU1B,GAC3F,CACE2B,GAAS,OAAO,EAChB3B,EAAM,OAAO,QAAQ,MAAM,EAAE,UAAY,kBAAkBoB,EAAS,SAAS,SAAW,KAAO,KAAK,MACtG,CAAC,CACH,CAOA,SAASjB,IACT,CACE,SAAS,iBAAiB,wBAAwB,GAAG,QAASyB,GAC9D,CACMA,EAAQ,KAAO,iBAEjBA,EAAQ,iBAAiB,YAAaC,EAAS,EAC/CD,EAAQ,iBAAiB,YAAaE,EAAS,EAC/CF,EAAQ,iBAAiB,WAAaG,EAAQ,EAC9CH,EAAQ,iBAAiB,OAAaI,EAAQ,EAElD,CAAC,CACH,CAGA,SAASH,GAAU7B,EACnB,CACMA,EAAM,OAAO,UAAU,SAAS,uBAAuB,GACzDA,EAAM,eAAe,CACzB,CAEA,SAAS8B,GAAU9B,EACnB,CACET,GAAE,WAAcS,EAAM,QACtBT,GAAE,YAAcS,EAAM,OAAO,QAAQ,2BAA2B,EAAE,GAClEA,EAAM,aAAa,cAAgB,MACrC,CAEA,SAAS+B,GAAS/B,EAClB,CACE,OAAAA,EAAM,eAAe,EACrBA,EAAM,aAAa,WAAa,OACzB,EACT,CAEA,SAASgC,GAAShC,EAClB,CACEA,EAAM,eAAe,EAErB,IAAMiC,EAAajC,EAAM,QAAWT,GAAE,WAAc,WAAa,cAG3D2C,EAAkB,SAAS,eAAe3C,GAAE,WAAW,EACvD4C,EAAkBnC,EAAM,OAAO,QAAQ,2BAA2B,EACxEmC,EAAgB,sBAAsBF,EAAWC,CAAe,EAGhE,IAAME,EAAkB,SAAS,eAAeF,EAAgB,aAAa,eAAe,CAAC,EAE7F,OADwB,SAAS,eAAeC,EAAgB,aAAa,eAAe,CAAC,EAC7E,sBAAsBF,EAAWG,CAAe,EAEzD,EACT,CAOA,SAASd,GAAmBM,EAASS,EAAiBC,EAAgBC,EAAc,GACpF,CACE,IAAMC,EAAgBC,EAAc,SAASb,EAAQ,aAAa,qBAAqB,CAAC,CAAC,EAEzF,MAAgB;AAAA,8BACYW,EAAc,wBAA0B,EAAE,KAAKA,EAAc,mBAAqB,EAAE;AAAA,iEACjDG,GAAkBd,CAAO,CAAC,KAAKW,EAAc,8BAAgC,EAAE;AAAA,oBAC5H,UAAUX,EAAQ,aAAa,0BAA0B,CAAC,CAAC;AAAA;AAAA,mEAEZW,EAAc,6BAA+B,EAAE;AAAA,mBAC/FI,GAAaf,EAASS,CAAe,CAAC;AAAA,mCACtBM,GAAaf,EAASU,CAAc,CAAC;AAAA;AAAA,+DAETC,EAAc,6BAA+B,EAAE;AAAA,UACnGC,IAAkB,QAAWA,EAAgB,OAAO;AAAA;AAAA,QAEvDD,EAAcK,GAAqB,EAAI,EAAE;AAAA,WAEjD,CAEA,SAASA,IACT,CACE,MAAgB;AAAA;AAAA;AAAA,WAIlB,CCvPA,IAAMC,GAAQC,EAAe,qBAAqB,EAErCC,GAAc,CACzB,KAAS,EACT,QAAS,EACT,KAAS,CACX,EAEMC,GAAW,CACf,QAAS,GACT,KAAS,EACX,EAOO,SAASC,IAChB,CACE,OAAAD,GAAS,QAAW,SAAS,KAAK,aAAa,kBAAkB,IAAM,UAChEA,GAAS,OAClB,CAEO,SAASE,IAChB,CACE,OAAAF,GAAS,KAAQ,SAAS,KAAK,aAAa,kBAAkB,IAAM,OAC7DA,GAAS,IAClB,CAEO,SAASG,IAChB,CACE,OAASH,GAAS,UAAY,IAAWA,GAAS,OAAS,EAC7D,CAEO,SAASI,IAAkB,CAAE,OAAOJ,GAAS,OAAS,CACtD,SAASK,IAAkB,CAAE,OAAOL,GAAS,IAAS,CAEtD,SAASM,GAAkBC,EAAQ,KAC1C,CACEA,GAAO,eAAe,EACtBC,GAAUC,EAAI,aAAc,MAAM,EAClCC,GAASC,GAAiBC,EAAS,WAAW,CAAC,CACjD,CAEO,SAASC,GAAcC,EAASC,EAAmB,GAC1D,CACElB,GAAM,IAAI,oBAAoBiB,CAAO,wBAAwBC,CAAgB,EAAE,EAE3ED,IAEF,eAAe,QAAQL,EAAI,YAAa,KAAK,UAAU,CAAE,SAAUM,EAAkB,QAAS,KAAM,SAAU,CAAE,CAAC,CAAC,EAClHL,GAASI,CAAO,EAEpB,CAEO,SAASE,GAAyBC,EAAeC,EACxD,CAME,IAAIC,EAAqB,KAAK,MAAMF,EAAgB,CAAC,EAAI,EAErDA,EAAgB,IAElBE,EAAoB,EACpBD,EAAU,IAGRC,IAAsBC,EAAS,SAAS,eAC1CA,EAAS,SAAS,aAAeD,GAE/BD,IAAYE,EAAS,SAAS,aAChCA,EAAS,SAAS,WAAaF,EACnC,CAEO,SAASG,GAAmBd,EAAOe,EAC1C,CACEf,GAAO,eAAe,EAEtBa,EAAS,SAAS,aAAiBb,EAAM,MAAQ,KAASA,EAAM,MAAQ,UACnEa,EAAS,SAAS,aAAe,IAAQA,EAAS,SAAS,aAAe,EAAK,IAC/EA,EAAS,SAAS,aAAe,EAAQA,EAAS,SAAS,aAAe,EAAK,EAEpFE,EAAO,UAAU,CACnB,CAEO,SAASC,GAAgBD,EAChC,CACMF,EAAS,SAAS,YACpBE,EAAO,WAAW,EAEpBF,EAAS,SAAS,aAAeI,GAAO,IACxCF,EAAO,UAAU,EAEjBG,EAAa,CAAE,QAAS,uCAAwC,CAAC,CACnE,CAOO,SAASC,GAAeC,EAAY,EAC3C,CACEtB,GAAa,EAAIuB,GAAmBD,CAAS,EAAIE,GAAsBF,CAAS,CAClF,CAEA,SAASG,GAAaC,EAASC,EAC/B,CACED,EAAQ,OACR,CACE,IAAUC,EACV,KAAU,EACV,SAAUC,GAAkB,CAC9B,CAAC,CACH,CAEA,SAASL,GAAmBD,EAAY,EACxC,CACE,GAAIA,IAAc,EAClB,CACE,IAAIO,EAAgB,GAEf,OAAO,UAAY,GAAO,KAAK,MAAM,OAAO,OAAO,GAAK,KAC3DA,EAAgBC,GAAgB,sBAAsB,EAAIA,GAAgB,2BAA2B,GAEvGL,GAAa,OAAQI,CAAa,CACpC,MAGMd,EAAS,KAAK,gBAChBgB,GAAgB,EAEhB,SAAS,eAAeT,CAAS,GAAG,eAAe,CAAE,SAAUM,GAAkB,EAAG,MAAO,QAAS,CAAC,CAE3G,CAEA,SAASJ,GAAsBF,EAC/B,CACE,GAAIP,EAAS,QAAQ,WACrB,CAEE,IAAMiB,EAAe,KAAK,MAAM,OAAO,QAAU,SAAS,eAAeV,CAAS,EAAE,sBAAsB,EAAE,GAAG,EACzGW,EAAe,KAAK,MAAM,OAAO,OAAO,EACxCC,EAAeC,EAAsBH,EAAYC,CAAS,EAG3DA,EAAYC,EAAeE,EAAoB,EAAKJ,IACvDE,EAAeC,EAAsB,EAAK,GAE5CV,GAAa,OAASO,GAAaE,EAAeE,EAAoB,EAAG,CAC3E,CAEA,SAASD,EAAsBE,EAC/B,CACE,OAAQA,EACGP,GAAgB,2BAA2B,EAC3CA,GAAgB,yBAAyB,CACtD,CAEA,SAASM,GACT,CAEE,OAAQN,GAAgB,4BAA6B,SAAS,IAAI,EAAI,CACxE,CACF,CAEO,SAASQ,GAAmBpC,EACnC,CACE,GAAIF,GAAa,GAAME,EAAM,WAAa,IAAU,OAAO,WAAa,KACxE,CACE,IAAMqC,EAAY,SAAS,eAAe,WAAW,EAIrD,GAFArC,EAAM,eAAe,EAEhBA,EAAM,MAAQ,UAAcA,EAAM,MAAQ,WAC/C,CACE,IAAMsC,EAAaD,EAAU,aAAiBA,EAAU,aAAe,GAAO,IAE9EA,EAAU,SACV,CACE,IAAWrC,EAAM,MAAQ,SAAY,CAACsC,EAAaA,EACnD,KAAU,EACV,SAAUZ,GAAkB,CAC9B,CAAC,CACH,MACU1B,EAAM,MAAQ,QAAYA,EAAM,MAAQ,QAEhDuB,GAAac,EAAarC,EAAM,MAAQ,OAAU,EAAIqC,EAAU,YAAa,CAEjF,CACF,CAOA,IAAME,GAA4B,IAClC,CACE,IAAMC,EAAW,IAAI,MAAM,mBAAmB,EAC1CC,EAAa,KAEjB,MAAO,CACL,KAAAC,EACA,MAAAC,EACA,KAAAC,EACA,OAAAC,CACF,EAEA,SAASH,GACT,CACE,SAAS,iBAAiB,mBAA0BI,CAAgB,EACpE,SAAS,iBAAiB,yBAA0BA,CAAgB,CACtE,CAEA,SAASA,GACT,CACEL,EAAa,SAAS,oBAAsB,KAC5B,SAAS,kBAAkB,GAC3B,KAEhBD,EAAS,iBAAmBC,EAC5B,SAAS,cAAcD,CAAQ,CACjC,CAEA,SAASG,EAAMnB,EACf,CACMA,EAAQ,kBACVA,EAAQ,kBAAkB,EAE1BN,EAAa,CAAE,QAAS,mCAAoC,SAAU,CAAE,CAAC,CAC7E,CAEA,SAAS0B,GACT,CACMH,IAAc,OAEhB,SAAS,eAAe,EACxBA,EAAY,KAEhB,CAEA,SAASI,EAAOrB,EAChB,CACMiB,IAAc,KAChBE,EAAMnB,CAAO,EAEboB,EAAK,CACT,CACF,EAEaG,GAAoBR,GAAyB,ECpP1D,IAAMS,GAAI,CAAE,OAAQ,IAAK,EAEdC,GAAa,KACbC,GAAa,KACbC,GAAa,KAOjB,SAASC,GAAKC,EACrB,CACEL,GAAE,OAASK,EAEX,IAAIC,GAAW,oBAAoB,EACnC,IAAIC,GAAa,sBAAsB,EAEvCN,GAAa,IAAIO,GAAiB,2BAA2B,EAG7DN,GAAY,IAAIO,GAAgB,yBAAyB,EACzDN,GAAY,IAAIO,GAAe,wBAAwB,CACzD,CAOA,IAAMJ,GAAN,cAAyBK,EACzB,CACE,YAAYC,EACZ,CACE,MAAMA,CAAS,EACfC,GAAoB,aAAc,IAAM,KAAK,OAAO,CAAC,CACvD,CAEA,QAAS,CAAEb,GAAE,OAAO,WAAW,CAAG,CAClC,QAAS,CAAE,KAAK,MAAQc,EAAS,SAAS,WAAa,MAAQ,IAAM,CACvE,EAEMP,GAAN,cAA2BI,EAC3B,CACE,YAAYC,EACZ,CACE,MAAMA,CAAS,EACfC,GAAoB,eAAgB,IAAM,KAAK,OAAO,CAAC,CACzD,CAEA,OAAOE,EACP,CACMA,EAAM,OAAO,UAAU,SAAS,WAAW,GAE7CA,EAAM,IAAM,IACZC,GAAmBD,EAAOf,GAAE,MAAM,GAE3Be,EAAM,OAAO,UAAU,SAAS,aAAa,GAEpDA,EAAM,IAAM,IACZC,GAAmBD,EAAOf,GAAE,MAAM,GAIlCiB,GAAgBjB,GAAE,MAAM,CAE5B,CAEA,QAAS,CAAE,KAAK,MAAQc,EAAS,SAAS,YAAc,CAC1D,EAOMN,GAAN,cAA+BG,EAC/B,CACE,MAAM,QACN,CACE,GAAIX,GAAE,OAAO,UAAU,EAAE,YAAckB,EAAW,MAClD,CACEC,EAAa,CAAE,QAAS,6CAA8C,CAAC,EACvE,MACF,CAEA,IAAMC,EAAW,MAAM,KAAK,YAAY,EAExCN,EAAS,SAAS,gBAAkBO,GAAa,EAAIC,GAAY,QAAUA,GAAY,KACvFC,GAAUC,EAAI,oBAAqB,GAAGH,GAAa,EAAIC,GAAY,QAAUA,GAAY,IAAI,GAAKG,GAAkB,CAAE,EACtH,eAAe,QAAQD,EAAI,YAAa,KAAK,UAAUJ,EAAS,SAAS,CAAC,EAE1EM,GAASC,GAAiB,KAAK,WAAWP,CAAQ,CAAC,CAAC,CACtD,CAEA,QACA,CACE,KAAK,MAASN,EAAS,SAAS,kBAAoBQ,GAAY,KAAQ,OAAS,SACnF,CAEA,WAAWF,EACX,CACE,IAAMQ,EAAe,uBACfC,EAAe,OAAO,SAAS,KACjCC,EAAiB,KAGrB,GAAKV,EAAS,QAAU,GAAOS,EAAU,MAAMD,CAAY,IAAM,KAE/DE,EAAUD,EAAU,QAAQD,EAAc,SAASR,EAAS,OAAO,EAAE,UAE9DA,EAAS,QAAU,EAC5B,CACE,IAAMW,EAAM,IAAI,IAAI,mBAAmBF,CAAS,CAAC,EACjDC,EAAY,GAAGC,EAAI,MAAM,GAAGA,EAAI,QAAQ,QAAQX,EAAS,OAAO,IAAIW,EAAI,MAAM,EAChF,MAGED,EAAUD,EAAU,QAAQD,EAAc,EAAE,EAG9C,OAAOE,CACT,CAEA,MAAM,aACN,CACE,IAAME,EAAoB,OAAO,SAAS,KAAK,MAAM,GAAG,EAClDC,EAAoBD,EAAS,UAAUE,GAASA,EAAK,YAAY,IAAM,MAAO,EAC9EC,EAAqBF,IAAc,GACX,SAASD,EAASC,EAAY,CAAC,CAAC,EAChC,EACxBG,EAAoB,MAAMpC,GAAE,OAAO,UAAU,EAAI,EACjDqC,EAAoBhB,GAAa,EAAIiB,EAAS,YAAiBA,EAAS,eACxEC,EAAoBlB,GAAa,EAAIiB,EAAS,eAAiBA,EAAS,YACxEE,EAAoBJ,EAAU,cAAiBD,EAAc,GAAKE,EAExE,MAAO,CACL,QAAS,KAAK,KAAKG,EAAcD,CAAe,EAChD,UAAW,CACT,SAAUH,EAAU,WAAa,GACjC,QAAUA,EAAU,SAAa,KACjC,SAAUA,EAAU,UAAa,CACnC,CACF,CACF,CACF,EAOM1B,GAAN,cAA6BC,EAC7B,CACE,QACA,CACEG,EAAS,SAAS,SAAYA,EAAS,SAAS,WAAa,GAE7DK,EAAa,CACX,SAAU,EACV,QAASL,EAAS,SAAS,SACd,wDACA,uDACf,CAAC,CACH,CAEA,QACA,CACE,KAAK,MAAQA,EAAS,SAAS,SAAW,KAAO,MAEjDA,EAAS,SAAS,SACd2B,GAAa,SAAS,KAAM,eAAgB,aAAa,EACzDA,GAAa,SAAS,KAAM,cAAe,cAAc,EAE7D3B,EAAS,SAAS,SACdZ,IAAW,UAAU,OAAO,UAAU,EACtCA,IAAW,UAAU,IAAI,UAAU,CACzC,CACF,EAEMO,GAAN,cAA8BE,EAC9B,CACE,QACA,CACEG,EAAS,QAAQ,cAAiBA,EAAS,QAAQ,gBAAkB,GAErEK,EAAa,CACX,SAAU,EACV,QAASL,EAAS,QAAQ,cACb,+CACA,8CACf,CAAC,CACH,CAEA,QACA,CACE,KAAK,MAAQA,EAAS,QAAQ,cAAgB,KAAO,KACvD,CACF,EC3MA,IAAM4B,GAAaC,EAAe,mBAAmB,EAC/CC,GAAc,OAAO,eAAiB,KACtCC,GAAa,CAAE,aAAc,IAAK,EAClCC,EAAa,CAAC,EAOb,SAASC,IAChB,CACED,EAAK,UAAYE,EAAe,uBAAuB,EACvDF,EAAK,UAAYE,EAAe,6BAA6B,EAEzDC,GAAaC,EAAM,qBAAqB,IAE1CR,GAAM,IAAI,uDAAuD,EAE7DS,EAAS,OAAO,qBAClBL,EAAK,UAAU,SAAS,gBAAgB,EAEtC,CAACK,EAAS,OAAO,qBAAuB,CAACA,EAAS,OAAO,eAC3DL,EAAK,UAAU,SAAS,oBAAoB,EACrCK,EAAS,OAAO,gBAAkB,CAACA,EAAS,OAAO,oBAC1DL,EAAK,UAAU,SAAS,mBAAmB,EACpCK,EAAS,OAAO,qBAAuB,CAACA,EAAS,OAAO,gBAC/DL,EAAK,UAAU,SAAS,mBAAmB,EAEjD,CAOO,SAASM,GAAKC,EAAcC,EACnC,CACEZ,GAAM,IAAI,QAAQ,EAElBG,GAAE,aAAeQ,EACjB,IAAME,EAAmB,SAAS,eAAe,mBAAmB,EAEpET,EAAK,aAAeE,EAAe,yBAA0B,SAAS,eAAe,mBAAmB,CAAC,EACzGF,EAAK,aAAa,cAAgBQ,EAClCR,EAAK,YAAcE,EAAe,wBAAyB,SAAS,eAAe,mBAAmB,CAAC,EACvGF,EAAK,YAAY,gBAAkB,EAEnCA,EAAK,UAAgBE,EAAe,8BAA+BO,CAAgB,EACnFT,EAAK,UAAU,IAAMA,EAAK,UAAU,WAAW,KAAK,EAEpDA,EAAK,QAAiBE,EAAe,4BAA6BO,CAAgB,EAClFT,EAAK,QAAQ,OAASA,EAAK,QAAQ,WAAW,0BAA0B,EACxEA,EAAK,QAAQ,MAASA,EAAK,QAAQ,WAAW,yBAAyB,EAEvEA,EAAK,MAAwBE,EAAe,0BAA2BO,CAAgB,EACvFT,EAAK,MAAM,SAAkBA,EAAK,MAAM,WAAW,0BAA0B,EAC7EA,EAAK,MAAM,SAAkBA,EAAK,MAAM,WAAW,0BAA0B,EAC7EA,EAAK,MAAM,gBAAkB,GAC7BA,EAAK,MAAM,gBAAkB,GAE7BA,EAAK,WAAaE,EAAe,+BAAgCO,CAAgB,EAEjFT,EAAK,UAAU,KAAOA,EAAK,UAAU,WAAW,qBAAqB,EAErEA,EAAK,UAAYE,EAAe,wBAAyBO,CAAgB,EAEzET,EAAK,OAAcE,EAAe,0BAA2BO,CAAgB,EAC7ET,EAAK,OAAO,KAAOA,EAAK,OAAO,WAAW,qBAAqB,EAE/DA,EAAK,QAAUE,EAAe,2BAA4BO,CAAgB,EAE1ET,EAAK,KAAYE,EAAe,wBAAyBO,CAAgB,EACzET,EAAK,KAAK,KAAOA,EAAK,KAAK,WAAW,qBAAqB,EAE3DA,EAAK,OAASE,EAAe,2BAA4BO,CAAgB,CAC3E,CAEO,SAASC,GAAMC,EAAmBC,EAAwBC,EAAmBC,EACpF,CACEd,EAAK,aAAa,SAASe,EAAM,OAAO,EACxCf,EAAK,aAAa,YAAY,QAASgB,EAAiB,EACxDhB,EAAK,YAAY,SAASe,EAAM,OAAO,EAEvCf,EAAK,UAAU,SAASe,EAAM,MAAM,EACpCf,EAAK,QAAQ,SAASe,EAAM,MAAM,EAClCf,EAAK,MAAM,SAASe,EAAM,MAAM,EAE5BV,EAAS,OAAO,oBAClBL,EAAK,UAAU,SAAS,gBAAgB,EAEtCK,EAAS,OAAO,gBAClBL,EAAK,MAAM,SAAS,gBAAgB,EAEtCA,EAAK,WAAW,SAASe,EAAM,OAAO,EACtCf,EAAK,WAAW,YAAY,QAAS,IAAMiB,GAAiB,OAAO,CAAC,EAEpEjB,EAAK,UAAU,SAASe,EAAM,OAAO,EACrCf,EAAK,UAAU,YAAY,QAASW,CAAiB,EAErDX,EAAK,UAAU,SAASe,EAAM,MAAM,EACpCf,EAAK,UAAU,YAAY,QAASY,CAAsB,EAE1DZ,EAAK,UAAU,SAASe,EAAM,OAAO,EACrCf,EAAK,UAAU,YAAY,QAAS,IAAMa,EAAkB,CAAC,EAE7Db,EAAK,OAAO,SAASe,EAAM,OAAO,EAClCf,EAAK,OAAO,YAAY,QAASkB,EAAY,EAE7ClB,EAAK,QAAQ,SAASe,EAAM,OAAO,EAEnCf,EAAK,KAAK,SAASe,EAAM,OAAO,EAChCf,EAAK,KAAK,YAAY,QAAS,IAAMc,EAAkB,CAAC,EACxDd,EAAK,OAAO,SAASe,EAAM,OAAO,EAClCI,GAAsB,EAEtBC,GAAoB,WAAgBC,EAAmB,EACvDD,GAAoB,eAAgBD,EAAqB,EACzDC,GAAoB,aAAgBD,EAAqB,EAEzDG,EAAYC,EAAM,gBAAmB,IAAMC,GAAsB,CAAC,CAAC,EACnEF,EAAYC,EAAM,cAAmBE,EAAY,EACjDH,EAAYC,EAAM,cAAmBG,EAAY,EACjDJ,EAAYC,EAAM,aAAmBI,EAAa,EAClDL,EAAYC,EAAM,YAAmBK,EAAgB,EACrDN,EAAYC,EAAM,kBAAmBI,EAAa,EAClDL,EAAYC,EAAM,iBAAmBI,EAAa,CACpD,CAOO,SAASH,GAAsBK,EACtC,CACE7B,EAAK,YAAY,gBAAkB6B,EACnCC,GAAkBD,EAAkB,GAAG,CACzC,CAEO,SAASE,IAChB,CACE,OAAO/B,EAAK,YAAY,eAC1B,CAEA,SAAS8B,GAAkBE,EAC3B,CACEhC,EAAK,YAAY,MAAM,UAAY,UAAUgC,CAAM,GACrD,CAEO,SAASC,GAAuBC,EAAsBC,EAAiBC,EAC9E,CACEC,GAASF,EAAiBC,CAAe,EAIvCN,GADEM,IAAoB,EACJ,EAEAF,GAAwBE,EAAkB,IAFzC,CAGvB,CAEA,SAASpB,GAAkBsB,EAC3B,CACE,GAAItC,EAAK,MAAM,gBAAkB,EACjC,CACE,IAAI6B,EAAoBS,EAAM,QAAU,SAAS,gBAAgB,YAAe,IAC5EC,EAAkB,KAAK,MAAOvC,EAAK,MAAM,gBAAkB6B,EAAmB,GAAG,EAEjF,CAACxB,EAAS,OAAO,qBACjBF,GAAaC,EAAM,qBAAqB,GACvCyB,GAAmB,IAEtB7B,EAAK,aAAa,cAAc,CAAC,EACjC6B,EAAkB,EAClBU,EAAkB,GAIlBvC,EAAK,aAAa,cAAcuC,CAAc,EAG5CC,EAAU,IAAM,KAElBhB,GAAsBK,CAAe,EACrCQ,GAASE,EAAgBvC,EAAK,MAAM,eAAe,EAEvD,CACF,CAOO,SAASyC,GAAgBC,EAAyB,EACzD,CACMA,IAA2B,GAAG9C,GAAM,IAAI,+CAA+C8C,CAAsB,EAAE,EAEnH,IAAMC,EAAY5C,GAAE,aAAa2C,CAAsB,EAEvDE,GAAgBD,CAAS,EACzBE,GAAgBF,CAAS,CAC3B,CAEA,SAASE,GAAgBF,EACzB,CACM3C,EAAK,QAAQ,MAAM,KAAOe,EAAM,OAAO,KAEzCf,EAAK,QAAQ,SAASe,EAAM,OAAO,EACnCf,EAAK,UAAU,SAASe,EAAM,OAAO,EACrCf,EAAK,MAAM,SAASe,EAAM,OAAO,EACjC6B,GAAgBD,CAAS,GAG3B3C,EAAK,QAAQ,OAAO,YAAc2C,EAAU,QAAU,GACtD3C,EAAK,QAAQ,MAAM,YAAe2C,EAAU,OAAU,GAEtDG,GAAaH,EAAU,SAAS,EAChCI,GAA4BJ,EAAU,QAAQ,EAC9CN,GAAUG,EAAU,EAAIxC,EAAK,MAAM,gBAAkB2C,EAAU,SAAWA,EAAU,QAAQ,CAC9F,CAEA,SAASG,GAAaE,EACtB,CAEMA,EAAU,MAAQhD,EAAK,UAAU,IAAI,MAEvCA,EAAK,UAAU,YAAY,qBAAsB,qBAAsB,wBAAyB,kBAAkB,EAClHA,EAAK,UAAU,SAAS,UAAWgD,EAAU,KAAK,EAClDhD,EAAK,UAAU,IAAI,IAAMgD,EAAU,IACnChD,EAAK,UAAU,IAAI,OAAO,EAAE,KAAK,IAAMA,EAAK,UAAU,YAAY,SAAS,CAAC,EAEhF,CAEA,SAAS+C,GAA4BX,EACrC,CACGA,EAAkB,KACfpC,EAAK,MAAM,aAAa,kBAAmB,eAAe,EAC1DA,EAAK,MAAM,aAAa,gBAAiB,iBAAiB,CAChE,CAEA,SAASqC,GAASF,EAAiBC,EACnC,CACMpC,EAAK,MAAM,kBAAoBmC,IAEjCnC,EAAK,MAAM,gBAAkBmC,EAEzB9B,EAAS,SAAS,WAAa,KACjC8B,EAAmBC,EAAkBD,GAEvCnC,EAAK,MAAM,SAAS,YAAciD,EAAcd,EAAkBC,EAAkB,IAAK,GAGvFpC,EAAK,MAAM,kBAAoBoC,IAEjCpC,EAAK,MAAM,gBAAuBoC,EAClCpC,EAAK,MAAM,SAAS,YAAciD,EAAcb,EAAkBA,EAAkB,IAAK,EAE7F,CAEA,SAASQ,GAAgBD,EACzB,CACMA,EAAU,WAAa,IAEzB3C,EAAK,MAAM,SAAS,YAAcK,EAAS,SAAS,SAC/CsC,EAAU,SAAW,KAAQ,WAAa,QAC3CM,EAAcN,EAAU,SAAWA,EAAU,SAAW,IAAK,EAEjE3C,EAAK,MAAM,SAAS,YAAe2C,EAAU,SAAW,KAAQ,WAAa,QAC7E3C,EAAK,MAAM,gBAAkB,GAC7BA,EAAK,MAAM,gBAAkB,GAEjC,CAOO,SAASwC,GAChB,CAEE,OAAQxC,EAAK,UAAU,MAAM,KAAOe,EAAM,QAAQ,EACpD,CAEA,SAASU,IACT,CACMzB,EAAK,UAAU,MAAM,KAAOe,EAAM,QAAQ,IAC5Cf,EAAK,UAAU,SAASe,EAAM,QAAQ,KAAK,CAC/C,CAEA,SAASa,IACT,CACEE,GAAkB,CAAC,EACnBO,GAAS,EAAGtC,GAAE,aAAa,EAAE,QAAQ,CACvC,CAEA,SAASmD,GAAmBC,EAC5B,CACMrD,KAEFqD,EACI,OAAO,aAAa,UAAU,IAAI,YAAY,EAC9C,OAAO,aAAa,UAAU,OAAO,YAAY,EAEzD,CAEO,SAASzB,IAChB,CACE1B,EAAK,UAAU,YAAYe,EAAM,QAAQ,KAAK,EAC9Cf,EAAK,YAAY,SAASe,EAAM,OAAO,EACvCf,EAAK,UAAU,SAASe,EAAM,OAAO,EACrCf,EAAK,UAAU,KAAK,YAAc,sBAClCA,EAAK,UAAU,SAASe,EAAM,OAAO,EAErCmC,GAAmB,EAAI,EACvBL,GAAgB9C,GAAE,aAAa,CAAC,CAClC,CAEO,SAAS4B,IAChB,CACE3B,EAAK,UAAU,YAAYe,EAAM,QAAQ,KAAK,EAC9Cf,EAAK,YAAY,SAASe,EAAM,MAAM,EACtCf,EAAK,UAAU,SAASe,EAAM,MAAM,EACpCf,EAAK,UAAU,KAAK,YAAc,qBAElCkD,GAAmB,EAAK,CAC1B,CAEO,SAASE,GAA0BC,EAC1C,CACMA,GAEFrD,EAAK,YAAY,YAAY,wBAAwB,EACrDA,EAAK,UAAU,YAAY,wBAAwB,IAInDA,EAAK,YAAY,YAAY,wBAAwB,EACrDA,EAAK,UAAU,YAAY,wBAAwB,EAEvD,CAOO,IAAMsD,GAAS,CAAE,IAAK,EAAG,IAAK,EAAG,IAAK,CAAE,EAEzCC,GAAc,CAClB,CAAE,MAAO,aAAc,KAAM,QAAa,EAC1C,CAAE,MAAO,aAAc,KAAM,QAAa,EAC1C,CAAE,MAAO,aAAc,KAAM,YAAa,CAC5C,EAEO,SAASC,IAChB,CACE,OAAO,SAASxD,EAAK,OAAO,aAAa,kBAAkB,CAAC,CAC9D,CAEO,SAASkB,IAChB,CACE,IAAMuC,EAAUD,GAAc,EAAI,EAAKD,GAAY,OAChCC,GAAc,EAAI,EACnB,EAElB,OAAAxD,EAAK,OAAO,aAAa,mBAAoByD,CAAK,EAClDzD,EAAK,OAAO,QAAQ,MAAW,GAAGuD,GAAYE,CAAK,EAAE,KAAK,OAC1DzD,EAAK,OAAO,KAAK,YAAcuD,GAAYE,CAAK,EAAE,KAE3CF,GAAYE,CAAK,CAC1B,CAOA,SAAStC,IACT,CACEnB,EAAK,OAAO,QAAQ,YAAc,GAAGK,EAAS,SAAS,YAAY,GAE/DA,EAAS,SAAS,YAEpBL,EAAK,KAAK,QAAQ,MAAW,wCAC7BA,EAAK,KAAK,KAAK,YAAc,aAC7BA,EAAK,OAAO,SAASe,EAAM,QAAQ,IAInCf,EAAK,KAAK,QAAQ,MAAW,wCAC7BA,EAAK,KAAK,KAAK,YAAeK,EAAS,SAAS,aAAe,GAAM,YAAc,kBACnFL,EAAK,OAAO,SAASe,EAAM,OAAO,EAEtC,CAEA,SAASM,IACT,CACE,IAAMqC,EAAW1D,EAAK,MAAM,gBACtB2D,EAAW3D,EAAK,MAAM,gBAEvBwC,EAAU,IAAM,IAAWkB,IAAa,IAASC,IAAa,KAEjE3D,EAAK,MAAM,SAAS,YAAcK,EAAS,SAAS,SAChD4C,EAAcS,EAAWC,EAAW,IAAK,EACzCV,EAAeU,EAAWD,EAAYC,EAAW,IAAK,EAE1D3D,EAAK,MAAM,SAAS,YAAciD,EAAcU,EAAWA,EAAW,IAAK,EAE/E,CC3aA,IAAMC,GAAQC,EAAe,iBAAiB,EACnCC,GAAqB,GAEnBC,EAAQ,CACnB,iBAAsB,kBACtB,eAAsB,gBACtB,cAAsB,eACtB,cAAsB,eACtB,aAAsB,cACtB,YAAsB,aACtB,gBAAsB,gBACtB,iBAAsB,iBACtB,iBAAsB,iBACtB,qBAAsB,qBACtB,kBAAsB,mBACtB,kBAAsB,mBACtB,gBAAsB,iBACtB,iBAAsB,iBACxB,EAEMC,GAAiB,CACrB,CAACD,EAAM,gBAAgB,EAAO,CAAGE,GAAkBC,GAAsBD,EAAc,KAAK,cAAc,CAAE,EAC5G,CAACF,EAAM,cAAc,EAAS,CAAEI,EAAc,EAC9C,CAACJ,EAAM,aAAa,EAAU,CAAC,EAC/B,CAACA,EAAM,aAAa,EAAU,CAAE,IAAOD,GAAqB,EAAM,EAClE,CAACC,EAAM,YAAY,EAAW,CAAC,EAC/B,CAACA,EAAM,WAAW,EAAY,CAAC,EAC/B,CAACA,EAAM,eAAe,EAAQ,CAAE,IAAOD,GAAqB,EAAO,EACnE,CAACC,EAAM,gBAAgB,EAAO,CAAGE,GAAkBL,GAAM,IAAIK,CAAa,CAAE,EAC5E,CAACF,EAAM,gBAAgB,EAAO,CAAGE,GAAkBL,GAAM,IAAIK,CAAa,CAAE,EAC5E,CAACF,EAAM,oBAAoB,EAAG,CAAC,EAC/B,CAACA,EAAM,iBAAiB,EAAM,CAAC,EAC/B,CAACA,EAAM,iBAAiB,EAAM,CAAC,EAC/B,CAACA,EAAM,eAAe,EAAQ,CAAC,EAC/B,CAACA,EAAM,gBAAgB,EAAO,CAAC,CACjC,EAOO,SAASK,EAAYH,EAAeI,EAC3C,CACMJ,KAAiBD,IACnBA,GAAeC,CAAa,EAAE,KAAKI,CAAqB,CAC5D,CAEO,SAASC,EAASL,EAAeM,EAAoB,KAAMC,EAAwB,KAC1F,CACER,GAAeC,CAAa,EAAE,QAAQQ,GACtC,CACEA,EAAc,CACZ,MAAUR,EACV,KAAUM,EACV,SAAUC,CACZ,CAAC,CACH,CAAC,CACH,CAOA,SAASL,GAAcF,EACvB,CACEL,GAAM,IAAIK,CAAa,EAGvB,SAAS,iBAAiB,kDAAkD,EAAE,QAASS,GACvF,CACEA,EAAQ,MAAQ,gDAClB,CAAC,EAEGT,GAAe,KAAK,kBACtBC,GAAsB,CAAC,CAC3B,CC5DA,IAAMS,GAAQC,EAAe,oBAAoB,EAE3CC,EAAI,CACR,mBAAoB,KACpB,kBAAoB,KACpB,kBAAoB,KACpB,eAAoB,EACtB,EAEaC,GAAe,CAC1B,KAAM,EACN,KAAM,CACR,EAOO,SAASC,IAChB,CACE,OAAQ,SAAS,KAAK,QAAQ,eAAe,GAAKC,EAAS,QAAQ,iBACrE,CAEO,SAASC,IAChB,CACE,OAAOJ,EAAE,cACX,CAEO,SAASK,GAAsBC,EACtC,CACMJ,GAAmB,IAErBJ,GAAM,IAAI,yBAAyB,EAEnCE,EAAE,mBAAqBM,EACvBN,EAAE,kBAAqB,SAAS,cAAc,cAAc,EAAE,aAAa,2BAA2B,EACtGA,EAAE,kBAAqB,SAAS,cAAc,cAAc,EAAE,aAAa,2BAA2B,EAEtG,OAAO,iBAAiB,WAAaO,GAAUC,GAAWD,CAAK,CAAC,EAEpE,CAEA,eAAsBE,GAAqBC,EAAeC,EAAY,GACtE,CACE,GAAIT,GAAmB,EACvB,CACEF,EAAE,eAAmB,GACrB,IAAMY,EAAe,MAAMC,GAAYH,CAAa,EAE/CE,EAAa,OAAO,OAASE,EAAc,IAAQF,EAAa,KAAK,OAAS,EAEjFG,GAAsBL,EAAeC,EAAWC,CAAY,EAIxDA,EAAa,OAAO,OAASE,EAAc,GAE7CE,EAAa,CACX,QAAS,8BACT,SAAU,GACV,WAAY,QACZ,oBAAqB,IAAMP,GAAqBC,EAAeC,CAAS,CAC1E,CAAC,EAEOC,EAAa,OAAO,OAASE,EAAc,IAAQF,EAAa,KAAK,SAAW,GAExFI,EAAa,CACX,QAAS,4BACT,SAAU,EACV,WAAY,UACZ,oBAAqB,IAAMC,GAAkB,CAC/C,CAAC,CAGP,CAEAjB,EAAE,eAAiB,EACrB,CAEA,SAASe,GAAsBL,EAAeC,EAAWC,EACzD,CACMF,IAAkBT,GAAa,OAEjCW,EAAa,KAAK,QAAQ,EAEtBA,EAAa,KAAK,SAAW,GAC/BA,EAAa,KAAK,QAAQ,IAAI,GAGlCZ,EAAE,kBAAqBY,EAAa,KAAK,SAAW,EAAKA,EAAa,KAAK,CAAC,EAAE,KAAO,GACrFZ,EAAE,kBAAqBY,EAAa,KAAK,CAAC,IAAM,KAASA,EAAa,KAAK,CAAC,EAAE,KAAO,GACrF,IAAMM,EAAgBN,EAAa,KAAK,CAAC,EAEzCd,GAAM,IAAI,4CAA4CA,GAAM,eAAeG,GAAcS,CAAa,CAAC,iBAAiBC,CAAS,iBAAiBb,GAAM,eAAeqB,EAAYD,EAAa,KAAK,iBAAiB,CAAC,OAAOE,GAAcF,EAAa,IAAI,CAAC,EAAE,EAE5PA,EAAa,KAAK,oBAAsBC,EAAW,QAErDE,GAAoBT,EAAa,KAAMD,EAAW,EAAI,EAItDK,EAAa,CACX,QAAS,qCACT,SAAU,EACV,WAAY,OACZ,oBAAqB,IACrB,CACE,eAAe,QAAQM,EAAI,YAAa,KAAK,UAAU,CAAE,SAAU,GAAM,QAAS,KAAM,SAAU,CAAE,CAAC,CAAC,EACtG,OAAO,SAAS,KAAOJ,EAAa,IACtC,EACA,mBAAoB,IAAMT,GAAqBC,EAAeC,CAAS,CACzE,CAAC,CAEL,CAOA,SAASE,GAAYH,EACrB,CACE,GAAIA,IAAkBT,GAAa,KACnC,CACE,IAAMsB,EAAuBvB,EAAE,oBAAsB,GAAMA,EAAE,kBAAoB,sBAEjF,OAAOwB,GAAU,CACf,SAAU,SACV,MAAU,UAAUD,CAAmB,mFACzC,CAAC,CACH,KAEA,CACE,IAAMA,EAAuBvB,EAAE,oBAAsB,GAAMA,EAAE,kBAAoB,sBAEjF,OAAOwB,GAAU,CACf,SAAU,SACV,MAAU,SAASD,CAAmB,6FACxC,CAAC,CACH,CACF,CAEA,SAASf,GAAWD,EACpB,CACMA,EAAM,QAAU,KAElB,SAAS,OAAO,GAKhBP,EAAE,kBAAqBO,EAAM,MAAM,SAAW,EAAKA,EAAM,MAAM,CAAC,EAAE,KAAO,GACzEP,EAAE,kBAAqBO,EAAM,MAAM,CAAC,IAAM,KAASA,EAAM,MAAM,CAAC,EAAE,KAAO,GAEzEc,GAAoBd,EAAM,MAAO,GAAO,EAAK,EAEjD,CAEA,SAASa,GAAcK,EACvB,CACE,MAAO,GAAGA,EAAU,YAAY,MAAMA,EAAU,WAAW,EAC7D,CAEA,SAASJ,GAAoBK,EAAWf,EAAY,GAAOgB,EAAY,GACvE,CACE,IAAMC,EAAgBC,GAAiBH,EAAU,CAAC,EAAE,IAAI,EAExD1B,EAAE,mBAAmB0B,EAAU,CAAC,EAAE,KAAME,EAAejB,CAAS,EAChEmB,GAAWJ,EAAWE,EAAeD,CAAS,CAChD,CAEA,SAASI,GAAgBC,EAAWC,EAAQC,EAC5C,CACE,IAAMC,EAAoB,MAAMD,EAAU,YAAY,WAAWA,EAAU,WAAW,GAChFE,EAAoBP,GAAiBK,CAAS,EAC9CG,EAA6B;AAAA,kBACnBL,EAAY,OAAS,MAAM,wBAAwBI,EAAkB,KAAK;AAAA,kBAC1EA,EAAkB,GAAG,UAAUJ,EAAY,WAAa,MAAM;AAAA,YAG9E,MAAgB;AAAA,kBACAA,EAAY,eAAiB,UAAU;AAAA,iBACxCC,CAAM,UAAUD,EAAY,OAAS,MAAM,YAAYA,EAAY,uBAAyB,kBAAkB;AAAA,UACrHA,EAAY,+CAAiD,EAAE;AAAA,UAC/DA,EAAYK,EAAoB,EAAE;AAAA,sBACtBL,EAAY,0BAA4B,yBAAyB,KAAKG,CAAgB;AAAA,UACjGH,EAAgC,GAApBK,CAAsB;AAAA,UAClCL,EAA6D,GAAjD,8CAAmD;AAAA;AAAA,WAG1E,CAOA,SAASF,GAAWJ,EAAWE,EAAeD,EAAY,GAC1D,CACEW,EAAS,SAAYZ,EAAU,CAAC,IAAM,KAASA,EAAU,CAAC,EAAE,KAAO,KACnEY,EAAS,SAAYZ,EAAU,SAAW,EAAKA,EAAU,CAAC,EAAE,KAAO,KAEnEa,GAAmB,SAAS,iBAAiB,wBAAwB,EAAGD,EAAS,QAAQ,EACzFC,GAAmB,SAAS,iBAAiB,wBAAwB,EAAGD,EAAS,QAAQ,EACzFE,GAAoB,SAAS,cAAc,eAAe,EAAGd,CAAS,EACtEe,GAAkB,SAAS,cAAc,qBAAqB,EAAGf,EAAU,CAAC,CAAC,EAC7EgB,GAAsB,SAAS,cAAc,cAAc,EAAGhB,EAAU,CAAC,EAAGE,CAAa,EAErFD,GACF,QAAQ,UAAUD,EAAW,GAAIA,EAAU,CAAC,EAAE,IAAI,EAEpD,SAAS,MAAQN,GAAcM,EAAU,CAAC,EAAE,IAAI,CAClD,CAEA,SAASa,GAAmBI,EAAUC,EACtC,CACED,GAAU,QAAQE,GAAW,CAAEA,EAAQ,QAAQ,GAAG,EAAE,KAAQD,IAAQ,KAAQA,EAAM,GAAK,CAAC,CAC1F,CAEA,SAASJ,GAAoBK,EAASnB,EACtC,CACE,IAAIoB,EAAe,GAEfpB,EAAU,CAAC,IAAM,OACnBoB,GAAgBf,GAAgB,GAAMO,EAAS,SAAUZ,EAAU,CAAC,EAAE,IAAI,GAExEA,EAAU,SAAW,IACvBoB,GAAgBf,GAAgB,GAAOO,EAAS,SAAUZ,EAAU,CAAC,EAAE,IAAI,GAE7EmB,EAAQ,UAAYC,CACtB,CAEA,SAASL,GAAkBI,EAASnB,EACpC,CACEmB,EAAQ,cAAc,uBAAuB,EAAE,UAAuB,GAAGnB,EAAU,KAAK,YAAY,kDAAkDA,EAAU,KAAK,WAAW,UAChLmB,EAAQ,cAAc,kCAAkC,EAAE,UAAY,GAAGnB,EAAU,KAAK,YAAY,sCAAsCA,EAAU,KAAK,WAAW,UACpKmB,EAAQ,cAAc,8CAA8C,EAAE,UAAanB,EAAU,cAC7FmB,EAAQ,cAAc,+CAA+C,EAAE,UAAYnB,EAAU,cAC/F,CAEA,SAASgB,GAAsBG,EAASnB,EAAWE,EACnD,CACE,IAAMmB,EAAa,CACjB,aAAuBrB,EAAU,KAAK,kBACtC,eAAuBA,EAAU,KAAK,aACtC,cAAuBA,EAAU,KAAK,YACtC,iBAAuBA,EAAU,KAAK,eACtC,YAAuBA,EAAU,KACjC,sBAAuBE,EAAc,IACrC,mBAAuBA,EAAc,GACvC,EAEA,OAAO,KAAKmB,CAAU,EAAE,QAAQC,GAAOH,EAAQ,aAAa,QAAQG,CAAG,GAAID,EAAWC,CAAG,CAAC,CAAC,CAC7F",
  "names": ["VERSION", "ULTRAFUNK_THEME_URI", "THEME_ENV", "newDebugLogger", "moduleName", "ProdBuild", "DebugLog", "data", "DevBuild", "object", "value", "key", "executionStart", "executionStop", "measureStartupExecutionTime", "logCss", "logStartupExecutionTime", "THEME_ENV", "PREF_PLAYER", "masterVolumeValues", "masterVolumeValueStrings", "listPerPageValues", "listPerPageValueStrings", "galleryPerPageValues", "galleryPerPageValueStrings", "settingsSchema", "defaultSettings", "settingsDescriptions", "presetsSchema", "presetList", "debug", "newDebugLogger", "validateSettings", "settings", "schema", "invalidCount", "validateRecursive", "settingsObject", "schemaObject", "key", "isEntryInvalid", "schemaEntry", "settingValue", "entryKey", "debug", "newDebugLogger", "observers", "KEY", "DEPRECATED_KEYS", "YEAR_IN_SECONDS", "setCookie", "keyName", "keyValue", "maxAge", "path", "deleteCookie", "setValue", "exception", "readJson", "defaultValue", "setDefault", "parsedKeyValue", "writeJson", "keyData", "mergeSettings", "oldSettings", "newSettings", "settingsKey", "mergedSettings", "mergeDeep", "cleanDeep", "destination", "key", "cleanupOldData", "skipOldDataCheck", "validateSettings", "settingsObject", "defaultSettings", "settingsSchema", "readWriteSettingsProxy", "parsedJson", "onSettingsChange", "handler", "target", "property", "receiver", "value", "newValue", "oldValue", "callSettingsObservers", "addSettingsObserver", "observer", "debug", "newDebugLogger", "response", "settings", "getSessionData", "readSettings", "readWriteSettingsProxy", "KEY", "defaultSettings", "TRACK_TYPE", "MediaPlayer", "#trackType", "#trackId", "#iframeId", "#embeddedPlayer", "#sourceUid", "#isPlayable", "#isCued", "THEME_ENV", "trackType", "trackId", "iframeId", "embeddedPlayer", "uid", "isPlayable", "isCued", "duration", "artist", "title", "position", "volume", "thumbnail", "defThumbnailObj", "youTubeVideoIdRegEx", "getYouTubeThumbnailUrl", "trackSourceUrl", "youTubeVideoId", "getSoundCloudThumbnailUrl", "soundObject", "thumbnailSrc", "getThumbnailData", "metaData", "thumbnailData", "getDataTrackType", "element", "getDataTrackTypeFromId", "elementId", "trackTypeClasses", "getTrackTypeClass", "debug", "newDebugLogger", "SITE_URL_LIST", "THEME_ENV", "validUrlRegEx", "DOMParserInstance", "MATCH", "siteMinWidthWide", "getCssPropString", "siteMaxWidth", "siteMaxWidthMobile", "addListener", "selectors", "type", "listener", "addListenerAll", "element", "prop", "string", "getCssPropValue", "value", "matchesMedia", "matchMedia", "replaceClass", "removeClass", "addClass", "getScrollBehavior", "settings", "getOverlayOpacityCssValue", "entityMap", "escHtml", "s", "escAttribute", "attribute", "stripHtml", "firstPass", "stripAttribute", "navToUrl", "destUrl", "showSnackbar", "getListPlayerUrl", "getGalleryPlayerUrl", "getPrefPlayerUrl", "PREF_PLAYER", "linkClickUsePrefPlayer", "event", "getTimeString", "seconds", "includeHours", "timeString", "getReadableBytesSize", "bytes", "decimals", "k", "dm", "sizes", "i", "isPointerTypeTouch", "keyboardShortcuts", "keyboardShortcutsSetting", "allow", "isControlKey", "key", "getTemplateHtml", "getModalListHtml", "modalList", "modalItemsCount", "html", "entryColumnsClass", "entry", "index", "entryClass", "entryTitle", "entryIcon", "hoverTitle", "entryHoverIcon", "modalItemIcons", "entryContent", "entryLinkTarget", "clickId", "getModalTrackHtml", "element", "trackArtist", "trackTitle", "getTrackTypeClass", "debug", "newDebugLogger", "m", "elements", "showModal", "modalType", "modalTitle", "modalBody", "modalList", "onClickCloseCallback", "onClickEntryCallback", "onCloseFocusElement", "isModalList", "initElements", "resetState", "setModalList", "getOverlayOpacityCssValue", "keyDown", "disablePageScrolling", "isShowingModal", "showingModalId", "getModalRootElement", "getModalEntry", "entryNum", "updateModalTitle", "updateModalId", "updateTitle", "updateModalList", "getTemplateHtml", "event", "touchMove", "touchStart", "item", "getModalListHtml", "modalListClick", "clickedEntryElement", "entryClickId", "disableScrolling", "debug", "newDebugLogger", "m", "template", "elements", "showSnackbar", "message", "duration", "actionText", "actionClickCallback", "afterCloseCallback", "backgroundColorCssVal", "initElements", "resetState", "settings", "writeLog", "actionTextClick", "matchesMedia", "MATCH", "isShowingSnackbar", "dismissSnackbar", "dismissId", "hideSnackbar", "readLog", "KEY", "messageLogs", "showSnackbarLog", "htmlTable", "entry", "showModal", "ElementToggle", "#element", "#valueElement", "#toggleTarget", "#updateTarget", "elementId", "updateOnConstruct", "event", "#isEnabled", "#pointerEventsEnabled", "getCssPropString", "value", "list_playback_exports", "__export", "advanceToNextTrack", "getStatus", "init", "nextTrack", "onEmbeddedPlayersReady", "pause", "play", "prevTrack", "setCurrentTrack", "setVolume", "skipToNextTrack", "stopSkipToNextTrack", "toggleMute", "togglePlayPause", "ElementClick", "#event", "#element", "selectors", "addToAllMatching", "addListenerAll", "event", "#clickHandler", "addListener", "selector", "STATE", "ElementWrapper", "elmentSelector", "parentElement", "initialState", "element", "state", "classList", "selector", "event", "listener", "cssClass", "remove", "add", "replaceClass", "attribute", "value", "setState", "newState", "ElementsWrapper", "elmentsSelector", "elements", "callback", "debug", "newDebugLogger", "HTTP_RESPONSE", "FETCH_ERROR", "fetchRest", "path", "endpoint", "id", "query", "timeoutSeconds", "restRequest", "controller", "response", "exception", "getFetchErrorType", "error", "getPageSeparatorHtml", "responseData", "loadingPage", "pageUrl", "getTrackEntryHtml", "track", "density", "thumbnailData", "getThumbnailData", "trackArtist", "escHtml", "trackTitle", "trackDuration", "isAudioVideoClass", "THEME_ENV", "TRACK_TYPE", "getTimeString", "setTrackMeta", "trackData", "trackLinksSelector", "linkIdsAttribute", "linksMap", "linksElement", "linkIds", "linksHtml", "linkId", "mapKey", "linkClass", "getListPlayerUrl", "debug", "newDebugLogger", "m", "loadTracks", "termType", "termId", "loadingPage", "response", "restResponse", "fetchTracks", "HTTP_RESPONSE", "trackData", "artistIds", "channelIds", "tracksHtml", "getPageSeparatorHtml", "track", "index", "key", "getTrackEntryHtml", "artistsPromise", "channelsPromise", "fetchTerms", "artistsRestResponse", "channelsRestResponse", "entry", "setTrackMeta", "page", "tracksPerPage", "params", "pagination", "fields", "getTermQueryParams", "getShuffleQueryParams", "getSearchQueryParams", "fetchRest", "termIds", "maxItems", "termParams", "shuffleParams", "searchString", "searchParams", "debug", "newDebugLogger", "copyTextToClipboard", "clipboardText", "contentDescription", "hasClipboardWritePermission", "showSnackbar", "reason", "onClipboardWriteError", "copyTextToClipboardExecCommand", "exception", "element", "isCopied", "logError", "modalBodyHtml", "showModal", "shareModalClosure", "filterBodyTextRegEx", "title", "bodyText", "filterBodyText", "bodyHtml", "url", "urlType", "trackType", "trackSourceUid", "verb", "icon", "onCloseFocusElement", "show", "args", "showModal", "getModalList", "copyTextToClipboard", "mailtoLink", "searchString", "spotifyLink", "youTubeLink", "TRACK_TYPE", "modalList", "shareModal", "debug", "newDebugLogger", "m", "minSearchStringLength", "initTrackSearch", "settings", "debounceKeyup", "showSearchResults", "uiElements", "event", "isTrackSearchResultsVisible", "navSearch", "setTrackSearchResultsVisible", "isSearchVisible", "onClickCloseSearch", "isShowingModal", "callback", "delayMilliseconds", "delayTimerId", "searchString", "isControlKey", "ElementClick", "playTrackClick", "showTrackDetailsTouch", "playNextClick", "showTrackSharePlay", "showTrackDetails", "element", "setCurrentTrack", "insertResultTrack", "isPointerTypeTouch", "showSnackbar", "insertElement", "getCurrentTrackElement", "searchStart", "fetchRestTime", "showRestResults", "cachedResult", "HTTP_RESPONSE", "setResultsHtml", "showResultsMessage", "getNoMatchesMessage", "searchStop", "searchTypeString", "getSearchTypeId", "THEME_ENV", "logCss", "replacedSearchString", "searchParams", "fetchStart", "restResponse", "fetchRest", "fetchStop", "tracksHtml", "track", "index", "getTrackEntryHtml", "escHtml", "message", "navSearchClosure", "allowKeyboardShortcutsEvent", "denyKeyboardShortcutsEvent", "siteHeader", "searchContainer", "searchField", "isVisible", "init", "toggle", "show", "hide", "addListenerAll", "event", "isTrackSearchResultsVisible", "searchString", "hasVisibleSearchContainer", "setNavSearchProps", "matchesMedia", "MATCH", "showHide", "setTrackSearchResultsVisible", "element", "navSearch", "showTrackSharePlay", "element", "onCloseFocusElement", "trackArtist", "stripAttribute", "trackTitle", "modalId", "shareModal", "getModalTrackHtml", "getDataTrackType", "setTrackThumbnailClick", "showTrackDetails", "trackDuration", "modalEntries", "modalTitle", "getTimeString", "TRACK_TYPE", "getLocalTrackDetails", "getTrackDetails", "showModal", "entryClickId", "event", "onIconClickTrackSearch", "getReadableBytesSize", "artists", "channels", "item", "getPrefPlayerUrl", "trackType", "trackLink", "searchString", "navSearch", "isListPlayer", "showSearchResults", "artistTitle", "getModalRootElement", "copyTextToClipboard", "debug", "newDebugLogger", "m", "STATE", "init", "observerCallback", "UiElements", "ready", "addListener", "EVENT", "setCurrentTrackState", "event", "setNextTrackState", "settings", "initLoadMoreTracks", "togglePlayPause", "showLocalPlayerInfoAndControls", "entries", "queryTrack", "selectors", "queryTrackAll", "queryTrackId", "id", "getCurrentTrackElement", "getPrevPlayableId", "destElement", "getDataTrackType", "TRACK_TYPE", "getNextPlayableId", "startElement", "setInitialTrack", "trackId", "showTrackTypePlayer", "trackType", "isPointerTypeTouch", "artistTitle", "audioPlayer", "ElementClick", "setCurrentTrack", "trackActionsClick", "removeClick", "playNextClick", "showTrackSharePlay", "showTrackDetails", "arrowUpDownClick", "arrowFirstLastClick", "element", "trackActionButtons", "trackElement", "nextTrackElement", "clearTrackState", "addTrack", "showSnackbar", "allowUndo", "animationEndCallback", "undoRemoveElement", "undoPrevElement", "targetElement", "insertPosition", "isArrowUpClick", "pageNumber", "gotoPageNum", "gotoElement", "blockOption", "response", "getScrollBehavior", "isArrowFirstClick", "allTracks", "loadMoreTracks", "tracksLoaded", "setIsLoadingTracks", "loadTracks", "stripAttribute", "isLoadingTracks", "newState", "isTrackChange", "replaceClass", "updateUpNextModal", "setPlayerAspectRatio", "nextTrackId", "isPointerClick", "setTrackMessage", "message", "setLocalPlayerDetails", "player", "escHtml", "updateTrackDetails", "PlaybackTimer", "#intervalId", "#lastPosSeconds", "addListener", "EVENT", "timeRemainingWarningBlink", "positionSeconds", "durationSeconds", "settings", "remainingSeconds", "dispatch", "ListPlaybackTimer", "PlaybackTimer", "#players", "#updateCallback", "positionSecondsDecimal", "durationSeconds", "positionSeconds", "updateTimerAndProgress", "players", "isPlaying", "position", "duration", "volume", "updateVolumeMuteSettings", "playbackTimer", "debug", "newDebugLogger", "m", "tracklistLocalHtml", "initLocalTracks", "addListener", "event", "getSelectedFiles", "clearLocalTracks", "filesList", "showSnackbar", "loadJsMediaTagsScript", "setTracksMetadata", "inserLocalTracksHtml", "onLoadedCallback", "ULTRAFUNK_THEME_URI", "VERSION", "scriptTag", "firstScriptTag", "queryTrackAll", "trackElement", "trackBlobUrl", "trackImageBlobUrl", "logPerfTime", "filesCount", "addTracksStop", "THEME_ENV", "logCss", "tracksUid", "index", "tracksHtml", "file", "trackUri", "getTrackEntryHtml", "TRACK_TYPE", "processedTracks", "fileName", "stripHtml", "escHtml", "fileExtIndex", "fileNameNoExt", "fileType", "mediaTags", "setTrackArtistTitle", "setFallbackTrackArtistTitle", "tags", "artist", "title", "setTrackImages", "trackImage", "imageBlob", "imageUrl", "debug", "newDebugLogger", "VOLUME", "TYPE", "CURVE", "STATE", "stoppedIntervalId", "config", "crossfadeClosure", "galleryPlayers", "players", "fadeState", "intervalId", "fadeOutPlayer", "fadeInPlayer", "fadeLength", "fadeStartVolume", "fadeType", "TYPE", "fadePreset", "fadeStartTime", "init", "start", "stop", "mute", "crossfadeType", "crossfadePreset", "fadeInUid", "setFadeOutInPlayers", "debug", "settings", "positionMilliseconds", "updateInterval", "timeRemaining", "fadeRemaining", "equalPowerFade", "linearFade", "setMute", "position", "fadePosition", "volume", "fadeVolume", "VOLUME", "fadeOutVolume", "fadeInVolume", "YouTubePlayer", "MediaPlayer", "#playerError", "embeddedPlayer", "TRACK_TYPE", "errorNum", "sourceUid", "positionSeconds", "onPlayerError", "callback", "trackElement", "getYouTubeThumbnailUrl", "SoundCloudPlayer", "#volume", "VOLUME", "#isMuted", "#playerOptions", "onSoundCloudPlayerStateChange", "resolve", "#cueOrPlayTrackById", "playTrack", "durationMilliseconds", "soundObject", "#playSoundObject", "volume", "positionMilliseconds", "THEME_ENV", "getSoundCloudThumbnailUrl", "LocalPlayer", "onLocalPlayerStateChange", "ListPlayers", "#youTubePlayer", "#soundCloudPlayer", "#localPlayer", "#currentPlayer", "youTubePlayer", "soundCloudPlayer", "localPlayer", "trackType", "debug", "newDebugLogger", "EventLog", "#log", "#maxEntries", "#matchCount", "#lastPos", "maxEntries", "eventSource", "eventType", "uId", "timestamp", "index", "elements", "delta", "matchCount", "event", "entries", "entry", "PlaybackLog", "deltaTime", "InteractionLog", "debug", "newDebugLogger", "eventLog", "PlaybackLog", "m", "TRACK_TYPE", "initEmbeddedPlayers", "autoplayData", "currentTrackId", "initialPlayerType", "ListPlayers", "initYouTubePlayer", "initSoundCloudPlayer", "initLocalPlayer", "init", "positionSeconds", "dispatch", "EVENT", "tag", "firstScriptTag", "onPlayerError", "trackType", "errorNum", "setCurrentTrackState", "STATE", "onInitialPlayerCued", "getProgressPercent", "isPlaying", "onPlayerReady", "onEmbeddedPlayersReady", "onLoadingState", "onPlayingState", "onPausedState", "onEndedState", "onAutoplayBlocked", "setPlayerVolumeMute", "settings", "onYouTubePlayerStateChange", "event", "setPauseState", "player", "onSoundCloudPlayerReady", "onSoundCloudPlayerStateChange", "playerState", "trackElement", "getCurrentTrackElement", "getTimeString", "updateTrackData", "initLocalTracks", "onLocalPlayerStateChange", "duration", "debug", "newDebugLogger", "init", "eventLog", "initTrackSearch", "setInitialTrack", "initEmbeddedPlayers", "getDataTrackTypeFromId", "getNextPlayableId", "KEY", "trackElement", "queryTrack", "showSnackbar", "trackTypeString", "TRACK_TYPE", "setCurrentTrack", "nextTrackId", "playTrack", "isPointerClick", "nextTrackType", "togglePlayPause", "isPlaying", "showTrackTypePlayer", "dispatch", "EVENT", "cueOrPlayCurrentTrack", "positionSeconds", "trackUid", "getCurrentTrackElement", "updateTrackDetails", "updateTrackData", "setCurrentTrackState", "STATE", "updateTimerAndProgress", "play", "pause", "setVolume", "settings", "toggleMute", "prevTrack", "prevTrackId", "getPrevPlayableId", "position", "nextTrack", "advanceToNextTrack", "autoplay", "isPlaybackError", "repeatMode", "REPEAT", "getRepeatMode", "playerScrollTo", "tracksLoaded", "loadMoreTracks", "autoplayNavTo", "response", "skipToNextTrack", "stopSkipToNextTrack", "getStatus", "getCurrentTrackNum", "currentTrackElement", "queryTrackId", "currentTrackIndex", "allTracksList", "queryTrackAll", "playerElementIds", "status", "resolve", "onEmbeddedPlayersReady", "players", "initialTrackType", "addListener", "onMediaPlaying", "onMediaUnavailable", "onAutoplayBlocked", "ready", "playbackTimer", "dismissSnackbar", "matchesMedia", "MATCH", "updateProgressPercent", "setTrackMessage", "m", "showUpNextModal", "tracklist", "getTracklist", "isPlaying", "showModal", "getTitle", "clickedId", "onTrackClick", "event", "shouldCloseModal", "addTitleListener", "addDragDropListeners", "ULTRAFUNK_THEME_URI", "VERSION", "showSnackbar", "shuffleClickNavTo", "nextTrackId", "item", "getCurrentTrackElement", "getScrollBehavior", "setCurrentTrack", "updateUpNextModal", "isPlayingTrack", "isShowingModal", "updateModalTitle", "modalEntry", "getModalEntry", "updateModalList", "settings", "trackElement", "getUpNextTrackHtml", "i", "queryTrackId", "getNextPlayableId", "getModalRootElement", "autoplay", "element", "mouseDown", "dragStart", "dragOver", "dragDrop", "insertPos", "modalDragSource", "modalDropTarget", "listTrackSource", "trackArtistAttr", "trackTitleAttr", "isDraggable", "trackDuration", "getTimeString", "getTrackTypeClass", "escAttribute", "getModalTrackButtons", "debug", "newDebugLogger", "PLAYER_TYPE", "isPlayer", "hasGalleryPlayer", "hasListPlayer", "noPlayback", "isGalleryPlayer", "isListPlayer", "shuffleClickNavTo", "event", "setCookie", "KEY", "navToUrl", "getPrefPlayerUrl", "response", "autoplayNavTo", "destUrl", "continueAutoplay", "updateVolumeMuteSettings", "currentVolume", "isMuted", "multipleOf5Volume", "settings", "onKeysVolumeChange", "player", "resetVolumeMute", "VOLUME", "showSnackbar", "playerScrollTo", "elementId", "listPlayerScrollTo", "galleryPlayerScrollTo", "scrollToYPos", "element", "destYPos", "getScrollBehavior", "scrollDestPos", "getCssPropValue", "showUpNextModal", "offsetTop", "scrollTop", "headerHeight", "getScrollHeaderHeight", "getContentMarginTop", "isScrollDown", "playerOnKeysScroll", "tracklist", "scrollByPx", "fullscreenElementClosure", "fseEvent", "fseTarget", "init", "enter", "exit", "toggle", "fullscreenChange", "fullscreenElement", "m", "playerType", "crossfade", "autoplay", "init", "player", "MuteToggle", "VolumeToggle", "PlayerTypeToggle", "CrossfadeToggle", "AutoplayToggle", "ElementToggle", "elementId", "addSettingsObserver", "settings", "event", "onKeysVolumeChange", "resetVolumeMute", "TRACK_TYPE", "showSnackbar", "destData", "isListPlayer", "PLAYER_TYPE", "setCookie", "KEY", "YEAR_IN_SECONDS", "navToUrl", "getPrefPlayerUrl", "isPagedRegEx", "sourceUrl", "destUrl", "url", "urlParts", "pageIndex", "part", "currentPage", "trackData", "tracksPerPageFrom", "response", "tracksPerPageTo", "trackOffset", "replaceClass", "debug", "newDebugLogger", "isInIframe", "m", "ctrl", "setPlaybackControlsCss", "ElementWrapper", "matchesMedia", "MATCH", "settings", "init", "getTrackData", "seekClickCallback", "playbackControls", "ready", "prevClickCallback", "playPauseClickCallback", "nextClickCallback", "muteClickCallback", "STATE", "progressSeekClick", "playerType", "toggleRepeat", "updateVolumeMuteState", "addSettingsObserver", "updateAutoplayState", "addListener", "EVENT", "updateProgressPercent", "setLoadState", "setPlayState", "setPauseState", "setMediaEndState", "progressPercent", "updateProgressBar", "getProgressPercent", "scaleX", "updateTimerAndProgress", "positionMilliseconds", "positionSeconds", "durationSeconds", "setTimer", "event", "seekPosSeconds", "isPlaying", "updateTrackData", "initialPositionSeconds", "trackData", "clearTrackTimer", "setTrackDetails", "setThumbnail", "setTimerDisplayHoursMinutes", "thumbnail", "getTimeString", "setIsIframePlaying", "isIframePlaying", "timeRemainingWarningBlink", "toggleBlink", "REPEAT", "repeatModes", "getRepeatMode", "index", "position", "duration", "debug", "newDebugLogger", "hasPlaybackStarted", "EVENT", "eventListeners", "playbackEvent", "updateProgressPercent", "playbackReady", "addListener", "playbackEventListener", "dispatch", "playbackEventData", "playbackEventCallback", "eventListener", "element", "debug", "newDebugLogger", "m", "SINGLE_TRACK", "isSingleTrackFetch", "settings", "isSingleTrackLoading", "singleTrackFetchReady", "cueOrPlayTrackByIdCallback", "event", "onPopState", "cueOrPlaySingleTrack", "prevNextTrack", "playTrack", "restResponse", "fetchTracks", "HTTP_RESPONSE", "cueOrPlayFetchedTrack", "showSnackbar", "shuffleClickNavTo", "currentTrack", "TRACK_TYPE", "getTrackTitle", "updatePlayerAndPage", "KEY", "queryTracksDateTime", "fetchRest", "titleData", "trackData", "pushState", "thumbnailData", "getThumbnailData", "updatePage", "getTrackNavHtml", "isNavPrev", "navUrl", "trackMeta", "trackArtistTitle", "prevNextThumbnail", "prevNextThumbHtml", "response", "updateSiteNavLinks", "updateTrackNavLinks", "updateTrackHeader", "updateTrackAttributes", "elements", "url", "element", "trackNavHtml", "attributes", "key"]
}
